{"version":3,"sources":["shared/constants/openmrs.tsx","shared/util/url-util.tsx","redux/action-type.util.ts","redux/reducers/concept.ts","redux/reducers/setttings.ts","shared/util/date-util.ts","redux/reducers/condition.ts","redux/reducers/breadcrumbs.ts","shared/constants/condition.tsx","redux/page.util.ts","redux/reducers/patient.ts","components/conditions/Condition.tsx","assets/img/search.png","shared/constants/patient.tsx","shared/util/omrs-entity-util.ts","shared/util/person-util.tsx","shared/util/patient-util.tsx","shared/constants/input.tsx","shared/util/table-util.tsx","components/common/InfiniteTable.tsx","shared/constants/columns-configuration.ts","components/find-patient/FindPatient.tsx","shared/constants/privilege.tsx","redux/reducers/cfl-people.ts","shared/util/cfl-person-util.tsx","components/find-caregiver/FindCaregiver.tsx","assets/img/check.svg","assets/img/check-circle.svg","shared/constants/error.tsx","redux/reducers/registration.ts","redux/reducers/person.ts","shared/util/patient-form-util.tsx","components/common/form/Buttons.tsx","components/register/inputs/Buttons.tsx","components/register/inputs/ValidationError.tsx","components/register/inputs/Input.tsx","components/register/inputs/Select.tsx","assets/img/plus.png","assets/img/minus.png","redux/reducers/relationship-type.ts","components/register/inputs/Relatives.tsx","components/register/inputs/DateInput.tsx","components/register/inputs/PhoneInput.tsx","components/register/inputs/Field.tsx","redux/reducers/location.ts","components/register/Step.tsx","components/register/Confirm.tsx","components/common/form/ConfirmationModal.tsx","components/register/RegisterPatientConfirmationModal.tsx","shared/constants/vmp-config.tsx","components/register/RegistrationForm.tsx","components/register/RegisterPatient.tsx","components/register/RegisterCaregiver.tsx","components/dashboard/Dashboard.tsx","assets/img/find-patient.png","assets/img/find-caregiver.png","assets/img/register-patient.png","components/conditions/Conditions.tsx","shared/constants/vmp-vaccination-schedule.tsx","shared/util/json-util.tsx","shared/util/form-util.tsx","components/vmp-config/SyncScope.tsx","shared/util/array-util.tsx","components/common/form/SortableSelect.tsx","components/common/radio-buttons/RadioButtons.tsx","components/common/form/withPlaceholder.tsx","components/vmp-config/OperatorTimeout.tsx","components/common/form/ValidationError.tsx","components/common/form/PlusMinusButtons.tsx","components/vmp-config/Manufacturer.tsx","components/vmp-config/Regimen.tsx","components/vmp-config/PersonLanguages.tsx","components/vmp-config/AuthSteps.tsx","components/vmp-config/IrisScore.tsx","shared/constants/address.tsx","components/vmp-config/AddressFields.tsx","components/vmp-config/ParticipantId.tsx","components/vmp-config/SearchWithoutPhone.tsx","shared/util/window-util.tsx","components/vmp-config/VmpConfig.tsx","redux/reducers/visit.ts","components/vmp-vaccination-schedule/VmpVaccinationSchedule.tsx","shared/constants/address-data.tsx","redux/reducers/address-data.ts","components/common/dropzone/Dropzone.tsx","components/address-data/AddressData.tsx","shared/constants/vmp-translations.tsx","components/vmp-translations/add-language-modal/AddLanguageModal.tsx","components/common/filter-input/FilterInput.tsx","components/common/filter-select/FilterSelect.tsx","components/vmp-translations/VmpTranslations.tsx","redux/reducers/provider.ts","components/common/expandable-section/ExpandableSection.tsx","components/common/switch/Switch.tsx","components/common/divider/Divider.tsx","components/common/time-picker/TimePicker.tsx","shared/constants/notification-configuration.ts","components/notification-configuration/NotificationConfiguration.tsx","redux/reducers/messages.ts","shared/constants/notification-templates.ts","components/common/textarea/Textarea.tsx","components/common/code-editor/VelocityCodeEditor.tsx","components/notification-templates/NotificationTemplates.tsx","shared/constants/location.ts","components/locations/Location.tsx","shared/constants/user-account.ts","components/user-account/PersonDetails.tsx","components/user-account/AuditInfo.tsx","components/user-account/UserAccountDetails.tsx","redux/reducers/role.ts","redux/reducers/user.ts","components/user-account/UserAccount.tsx","shared/constants/manage-regimens.ts","redux/reducers/manage-regimens.ts","components/manage-regimens/Drug.tsx","components/manage-regimens/Regimen.tsx","redux/reducers/order-set.ts","redux/reducers/drugs.ts","redux/reducers/order-frequency.ts","redux/reducers/order-type.ts","components/manage-regimens/ManageRegimens.tsx","redux/reducers/columns-configuration.ts","components/find-patient-columns-configuration/ColumnRow.tsx","components/find-patient-columns-configuration/FindPatientColumnsConfiguration.tsx","shared/constants/routes.tsx","components/common/Breadcrumbs.tsx","components/common/Header.tsx","components/common/ErrorBoundary.tsx","components/common/Unauthorized.tsx","components/Routes.tsx","redux/reducers/session.ts","shared/util/app-util.tsx","shared/constants/app.tsx","redux/reducers/apps.ts","components/App.tsx","reportWebVitals.ts","redux/reducers/index.ts","redux/store.ts","index.tsx"],"names":["ROOT_URL","PATIENT_PAGE_URL","redirectUrl","search","queryString","parse","toString","REQUEST","actionType","SUCCESS","FAILURE","ACTION_TYPES","initialState","loading","concepts","concept","query","uuid","setMembers","errorMessage","reducer","state","action","type","payload","message","meta","q","data","results","settings","setting","success","isSettingExist","settingPropertyUrl","value","getSettings","prefix","requestUrl","axios","get","getSettingByQuery","createSetting","property","description","post","updateSetting","length","config","url","DATE_FORMAT","formatDate","intl","date","Intl","DateTimeFormat","day","month","year","format","isoDateString","jsDate","toISOString","split","condition","conditions","conditionUpdated","saveCondition","prepareCondition","conditionNonCoded","additionalBreadcrumbs","addBreadcrumbs","breadcrumbs","resetBreadcrumbs","concat","STATUS_ACTIVE","STATUS_INACTIVE","DEFAULT_PAGE_SIZE","pageOf","entities","currentPage","pageSize","slice","patients","patient","patientRelationships","totalCount","hasNext","hasPrev","patientLinkedRegimens","page","limit","getPatient","id","reset","links","find","link","rel","Condition","conceptQuery","conceptInput","onsetDate","endDate","active","loadOptions","_","debounce","searchConcepts","setConceptInput","setState","onConceptChange","conditionId","props","location","conceptListClasses","onConceptFocus","label","onQueryChange","conceptOptions","map","display","onOnsetDateChange","onEndDateChange","onActiveChange","cancel","history","push","match","params","patientUuid","save","status","__isNew__","name","shortName","onSetDate","Date","voided","additionalDetail","endReason","this","getCondition","prevProps","prevState","snapshot","person","preferredName","order","successToast","formatMessage","className","error","options","onInputChange","onChange","classNamePrefix","placeholder","inputValue","onFocus","isDisabled","placeholderText","selected","peekNextMonth","showMonthDropdown","showYearDropdown","dropdownMode","dateFormat","FormGroup","check","inline","Button","onClick","disabled","React","Component","mapDispatchToProps","conceptClasses","connect","cflPatient","injectIntl","withRouter","PATIENT_IDENTIFIER","DISPLAY","GENDER","BIRTHDATE","DEATH_DATE","PHONE_NUMBER","PERSON_LANGUAGE","PERSON_IDENTIFIER","GIVEN_NAME","FAMILY_NAME","TELEPHONE_NUMBER_ATTRIBUTE_TYPE","PERSON_LANGUAGE_ATTRIBUTE_TYPE","DEFAULT_FIND_CAREGIVER_TABLE_COLUMNS","GENDER_DICT","M","F","DEFAULT_COLUMN_VALUE","extractValue","prop","Array","isArray","extractAttribute","entity","attr","attributes","a","attributeType","toLowerCase","getPhoneNumberWithPlusSign","phoneNumber","columnContent","column","preferredAddress","attributesValue","personValue","formatPhoneNumberIntl","identifier","identifiers","identifierType","extractIdentifier","extractPatientOrPersonData","gender","personId","givenName","middleName","familyName","address1","address2","cityVillage","stateProvince","country","postalCode","patientId","birthdate","forEach","extractAttributes","extractIdentifiers","SEARCH_INPUT_DELAY","EMPTY_STRING","DEFAULT_TIME_FORMAT","STRING_TRUE","STRING_FALSE","helperText","InfiniteTable","useIntl","isColumnObject","columns","constructor","Object","dataLength","next","switchPage","hasMore","loader","Spinner","borderless","striped","responsive","i","getRecordLink","window","href","handleRowClick","columnValue","undefined","COLUMNS_CONFIGURATION_SETTING_KEY","DEFAULT_COLUMN_CONFIGURATION","isValid","FIRST_COLUMN_NAME_LETTERS_REGEX","ADJACENT_LOWER_AND_UPPER_LETTERS_REGEX","FIXED_COLUMNS","DEFAULT_COLUMNS","FindPatient","searchAfterDelay","event","target","onSearchClick","e","preventDefault","Form","onSubmit","src","searchIcon","alt","color","size","tableColumns","JSON","PRIVILEGES","people","names","personName","deathDate","patientIdentifier","personIdentifier","FindCaregiver","caregivers","cflPeople","apps","findCaregiverTableColumns","GENERIC_ERROR_MESSAGE","errors","patientIdentifierTypes","extractFormData","validRelatives","relatives","filter","relative","relationshipType","otherPerson","relationships","otherPersonUuid","formData","birthdateEstimated","response","replace","personRelationships","getPerson","getPlaceholder","fieldName","required","join","getCommonInputProps","field","isInvalid","isDirty","onPatientChange","onKeyDown","setValueOnChange","setValue","callback","Buttons","handleOnChange","evt","option","render","hasValue","Input","ESTIMATED_BIRTHDATE_FIELDS","includes","BIRTHDATE_FIELD","mask","maskChar","Select","setDirty","getSelectOptions","fieldDefinition","selectOptions","opts","hidden","dataTestId","data-testid","relationshipTypes","OTHER_PERSON_NAME","relationshipTypeField","otherPersonField","rowFields","emptyRelative","otherPersonInput","Relatives","invalidFields","addRelative","relationshipTypeOptions","retired","flatMap","displayAIsToB","displayBIsToA","removeRelative","rowNo","splice","onChangeEvent","setOtherPersonInput","selectedOpt","patientOptions","otherPersonPlaceholder","isFocused","Plus","Minus","getRelationshipTypes","DateInput","inputRef","createRef","getErrorMessage","isPossiblePhoneNumber","removePlusSign","substring","ref","international","numberInputProps","DEFAULT_INPUT","inputsByType","buttons","select","number","text","phone","PhoneInput","Field","InputComponent","loadingLocations","locations","locationAttributeTypes","loadingLocationAttributeTypes","loadingLocation","searchLocations","LOCATIONS_OPTION_SOURCE","RELATIVES_FIELD_TYPE","PHONE_FIELD_TYPE","Step","dirtyFields","fetchOptionSources","stepDefinition","fields","optionSource","os","getOptions","l","getClassName","validateField","patientIdentifierType","getPatientIdentifierType","regex","re","RegExp","test","every","isFieldNonEmpty","validate","nonEmptyFields","isStepValid","isStepDirty","setValidity","handleLastFieldKeyDown","key","shiftKey","stepNumber","setStep","title","subtitle","additionalProps","formatDescription","class","f","stepButtons","Confirm","birthdateYears","birthdateMonths","yearPart","monthPart","Boolean","loc","relationshipTypeId","indexOf","endsWith","getFieldLabel","defaultMessage","getFieldValue","val","opt","sections","steps","step","locField","renderField","err","Alert","itemsPerColumn","Math","floor","isCaregiver","registration","ConfirmationModal","header","headerId","values","headerValues","body","bodyId","bodyValues","onYes","onNo","isOpen","Modal","fade","ModalHeader","br","ModalBody","tagName","ModalFooter","cx","RegisterPatientConfirmationModal","SETTING_KEY","EMPTY_COUNTRY","COUNTRY_OPTIONS","sortBy","getData","ORDERED_ADDRESS_FIELD_PARTS","DEFAULT_SYNC_SCOPES","DEFAULT_AUTH_STEPS","DEFAULT_VMP_CONFIG","syncScope","operatorCredentialsRetentionTime","operatorOfflineSessionTimeout","vaccine","canUseDifferentManufacturers","allowManualParticipantIDEntry","manufacturers","personLanguages","authSteps","irisScore","addressFields","participantIDRegex","isBiometricOnlySearchWithoutPhone","RegistrationForm","stepValidity","visitedSteps","entityName","caregiverSteps","patientSteps","formName","isEdit","highestVisitedStep","max","apply","canVisitStep","onStepClick","stepList","isConfirmActive","ListGroup","isVisited","isActive","icon","CheckCircle","Check","ListGroupItem","stepForm","regimenOptions","regimens","regimen","onNextClick","isFormValid","isEmpty","pickBy","onConfirmClick","updateRelationships","editPerson","editPatient","registerPerson","register","stepCount","stringifyUrl","getPatientIdentifierTypes","VMP_CONFIG_SETTING_KEY","getPersonRelationships","relationship","personA","personB","isPersonA","settingsLoading","Row","Col","xs","sm","put","querystring","stringify","cflPerson","patientRegistrationSteps","defaultSteps","caregiverRegistrationSteps","caregiverDefaultSteps","RegisterPatient","RegisterCaregiver","Dashboard","to","conditionToDelete","goBack","editCondition","setConditionToDelete","switchConditionActive","renderConditionRow","lastCondition","switchActive","voidCondition","saveConditions","renderDeleteModal","closeButton","renderConditionTable","getConditionHistory","headerProps","dashboardType","displayTelephone","pathname","VMP_VACCINATION_SCHEDULE_SETTING_KEY","DEFAULT_DOSING_VISIT_TYPES","EMPTY_VISIT","doseNumber","nameOfDose","numberOfFutureVisit","lowWindow","midPointWindow","upWindow","EMPTY_REGIMEN","DEFAULT_VMP_VACCINATION_SCHEDULE","parseJson","defaultValue","extractEventValue","checked","validateRegex","expr","ordinalIndicator","j","selectDefaultTheme","theme","colors","primary","primary25","primary50","translationId","yesNoOptions","SyncScope","syncScopes","onValueChange","Label","aria-hidden","swapPositions","array","idx","offset","targetIdx","NONE","SortableMultiValue","SortableElement","innerProps","onMouseDown","stopPropagation","MultiValue","SortableMultiValueLabel","SortableHandle","MultiValueLabel","SortableSelect","SortableContainer","SortableMultiSelect","useDragHandle","axis","onSortEnd","oldIndex","newIndex","newValue","distance","getHelperDimensions","node","getBoundingClientRect","isMulti","components","closeMenuOnSelect","styles","indicatorsContainer","base","multiValueLabel","paddingRight","multiValueRemove","RadioButtons","htmlFor","withPlaceholder","WrappedComponent","wrapperClassName","menu","provided","zIndex","showPlaceholder","InputWithPlaceholder","SelectWithPlaceholder","SortableSelectWithPlaceholder","RadioButtonsWithPlaceholder","TextareaAutosize","OperatorCredentialsOfflineRetentionTime","onNumberValueChange","operatorCredentialsOfflineRetentionTime","pattern","min","OperatorSessionTimeout","operatorSessionTimeout","PlusMinusButtons","onPlusClick","onMinusClick","isPlusButtonVisible","EMPTY_MANUFACTURER","barcodeRegex","CanUseDifferentManufacturers","Manufacturers","showValidationErrors","openModal","closeModal","onManufacturerRemove","manufacturerName","some","addManufacturer","v","mf","removeManufacturer","clone","onManufacturerChange","manufacturer","isNameEmpty","isBarcodeRegexInvalid","Regimen","vaccinationSchedule","savedRegimen","isRegimenNameDuplicated","readOnly","onVaccinationScheduleChange","onVaccineChange","isMultiselect","onRegimenRemove","regimenName","linkedRegimen","anyPatientLinkedWithRegimen","vs","addRegimen","removeRegimen","isNameDuplicated","isManufacturersEmpty","isOptionSelected","LANGUAGE_OPTIONS","ISO6391","getAllNames","PersonLanguages","lang","selectedOptions","AuthSteps","onAuthStepsChange","isSelect","addAuthStep","mandatory","moveAuthStep","authStep","as","IrisScore","DROPDOWN","FREE_INPUT","ADDRESS_FIELDS","ADDRESS_FIELD_TYPE","countyDistrict","AddressFields","onCountryChange","countryIdx","fieldIdx","countryName","onAddressPartFieldChange","addressPartField","moveAddressPart","addCountry","cloneDeep","addressPartOptions","addressPartIdx","selectedAddressParts","addressPart","addressParts","sort","ap1","ap2","displayOrder","addAddressPart","removeAddressPart","ParticipantIDRegex","AllowManualParticipantIDEntry","EnableBiometricOnlySearchWithoutPhone","scrollToTop","scrollTo","top","behavior","MS_IN_A_MINUTE","MS_IN_A_DAY","VmpConfig","vmpConfig","vmpConfigSetting","vmpVaccinationSchedule","vmpVaccinationScheduleSetting","isModalOpen","modalHeader","modalBody","onModalConfirm","onModalCancel","extractConfigData","defaults","keys","generateConfig","reduce","obj","vc","trim","vcm","pl","extractedEventValue","Number","parseInt","isInteger","return","configJson","r","modal","getPatientLinkedRegimens","errorToast","appError","appLoading","regimenUpdatePermitted","vmpSyncScopes","vmpAuthSteps","vmpRegimenUpdatePermitted","visitTypes","VmpVaccinationSchedule","savedVmpVaccinationSchedule","visits","visit","getVaccineByRegimenIndex","regimenIdx","onSave","allRegimen","configuredRegimen","isAllRegimenConfigured","deleteRegimenConfig","addRegimenConfig","onDeleteRegimenConfig","recalculateNumberOfFutureVisit","reverse","dosingVisitTypes","selectedRegimen","onRegimenChange","numberOfDose","addVisit","prevVisitIdx","removeVisit","visitIdx","visitTypeOptions","isAllDosesConfigured","visitType","onVisitTypeChange","onWindowChange","doseManufacturer","vaccineManufacturers","configuredDoses","canSave","regimenConfig","isReadOnly","renderConfirmationModal","getVisitTypes","restUrl","visitTypeUrl","vmpDosingVisitTypes","ADDRESS_DATA_TABLE_COLUMNS","DEFAULT_DOWNLOAD_FILENAME","addressData","hasNextPage","loadingAddressData","downloadableAddressData","addressDataUploading","getAddressData","content","pageNumber","nextPage","addressDataUploaded","Dropzone","acceptedFileExt","instructionMessageId","onFileAccepted","useState","isDragActive","setIsDragActive","acceptedFile","setAcceptedFile","rejectedFile","setRejectedFile","accept","multiple","onDropAccepted","file","onDropRejected","onDragEnter","onDragLeave","getRootProps","getInputProps","b","AddressData","isOverwriteAddressData","isDownloadableAddressDataValid","onUpload","postAddressData","onOverwriteAddressDataChange","getAddressDataPage","triggerAddressDataDownload","downloadCsv","downloadAddressData","confirmationModal","instructions","download","overwriteAddressDataRadioButtons","defaultChecked","uploadButton","uploadError","downloadButton","uploadedFileTable","addressDataLoading","isTotalCountMoreThanZero","displaySpinner","rows","FormData","append","headers","VMP_TRANSLATIONS_SETTING_KEY","LANGUAGES_ALLOWED_SETTING_KEY","getAllCodes","code","getName","DEFAULT_VMP_TRANSLATIONS_SETTING","localization","AddLanguageModal","languages","language","setLanguage","FilterInput","placeholderId","FilterSelect","LANGUAGE_FILTER_EMPTY_VALUE","CSV_FILE_DEFAULT_COLUMN_LABEL","VmpTranslations","isConfirmationModalOpen","confirmationModalHeader","confirmationModalBody","onConfirmationModalConfirm","onConfirmationModalCancel","translations","downloadableTranslations","translationsTableLanguages","vmpTranslationsSetting","languagesAllowed","isAddLanguageModalOpen","phraseFilterValue","languageFilterValue","loadTranslations","isRequestedSettingNotExist","extractTranslations","parsedConfig","emptyTranslation","extractConfigTranslations","extractAddressDataTranslations","distinctAddressFields","address","addressField","isNaN","vmpConfigTranslations","translation","extractLocationsTranslations","sortTranslationsAlphabetically","settingValue","settingValueJson","resetState","onReturn","closeConfirmationModal","addLanguageModal","addLanguage","uploadTranslationFile","translationFile","Papa","delimiter","complete","parsedTranslationFile","row","default","translationValues","from","Set","onDownloadTranslations","downloadTranslations","csvData","filters","phrase","addLanguageButton","onAddLanguage","languageColumnLabel","languageOption","unshift","filteredTableColumns","filteredTableRows","smsProviders","callflowsProviders","getSmsProviders","getCallflowsProviders","configs","ExpandableSection","headerComponent","disabledHeaderComponent","bodyComponent","isRemovable","onRemove","isExpandTriggered","setIsOpen","prevIsExpandTriggeredRef","useRef","prevIsOpenRef","useEffect","current","isExpandTriggeredChanged","isOpenChanged","isExpanded","Switch","checkedTranslationId","uncheckedTranslationId","labelTranslationId","checkedChildren","unCheckedChildren","Divider","TimePicker","showNow","COUNTRY_SETTINGS_MAP_SETTING_KEY","DEFAULT_COUNTRY_CONFIGURATION_NAME","DEFAULT_COUNTRY_SETTINGS_MAP","CONFIGURATION_NAME_PROPERTY_NAME","SMS_PROPERTY_NAME","CALL_PROPERTY_NAME","PERFORM_CALL_UPON_REGISTRATION_PROPERTY_NAME","SEND_SMS_UPON_REGISTRATION_PROPERTY_NAME","SEND_CALL_REMINDER_PROPERTY_NAME","SEND_SMS_REMINDER_PROPERTY_NAME","NOTIFICATION_TIME_WINDOW_FROM_PROPERTY_NAME","NOTIFICATION_TIME_WINDOW_TO_PROPERTY_NAME","BEST_CONTACT_TIME_PROPERTY_NAME","VISIT_REMINDER_PROPERTY_NAME","DEFAULT_COUNTRY_CONFIGURATION","NotificationConfiguration","notificationConfiguration","isAllSectionsExpanded","configurationName","configuration","hasOwnProperty","moment","isSaveDisabled","configurationProps","isMoment","configurationIdx","propertyName","selectTextOption","smsSettings","smsProviderOptions","provider","smsProvider","shouldSendSmsUponRegistration","shouldSendSmsReminder","callSettings","callflowsProviderOptions","callflowsProvider","shouldPerformCallUponRegistration","shouldSendCallReminder","notificationWindowAndBestContactTime","notificationTimeWindowFrom","notificationTimeWindowTo","bestContactTime","onVisitReminderChange","reminderIdx","addVisitReminder","removeVisitReminder","visitReminder","visitReminders","reminder","addNewCountryConfiguration","removeCountryConfiguration","countryConfiguration","isDefaultCountryConfiguration","countryOptions","expandOrCollapseAllButton","messagesTemplatesGlobalProperties","NOTIFICATION_TEMPLATE_SETTING_KEY_PREFIX","INJECTED_SERVICES_SETTING_KEY_SUFFIX","INJECTED_SERVICES_SETTING_KEY","TEMPLATE_NAME_PROPERTY_NAME","TEMPLATE_DESCRIPTION_PROPERTY_NAME","TEMPLATE_VALUE_PROPERTY_NAME","TEMPLATE_NAME_REGEX","INJECTED_SERVICES_KEY_VALUE_DELIMITER","INJECTED_SERVICES_KEY","INJECTED_SERVICES_VALUE","DEFAULT_INJECTED_SERVICE","TextareaAutosizeWithPlaceholder","TextareaWithPlaceholder","minRows","maxRows","isResizable","VelocityCodeEditorWithPlaceholder","lineNumbers","mode","autoCursor","editor","notificationTemplates","savedNotificationTemplates","unremovableGlobalProperties","dirtyNotificationTemplates","unifiedSuccessToastDisplayed","isAllRequestsSent","template","templateNameRegex","templateName","injectedServices","accumulator","currentService","counter","savedTemplate","deleteSetting","has","templateIdx","globalPropertyName","globalPropertyFullName","templateUuid","add","addNewTemplate","onRemoveTemplate","removeTemplate","customTemplateHeader","isTemplateNameEmpty","isTemplateNameInvalid","addInjectedService","removeInjectedService","injectedServiceIdx","onInjectedServicePropertyChange","injectedServicesBody","service","serviceIdx","isInjectedServices","isSavedTemplate","getMessagesTemplatesGlobalProperties","globalProperty","sortedSettings","injectedServicesSetting","otherSetttings","loadingUnremovableGlobalProperties","delete","messages","DEFAULT_LOCATION","tags","getLocationAttributeTypes","saveLocation","getLocation","editedLocation","settingLoading","isLocationLoading","locationAttributeType","setLocation","setShowValidationErrors","locationId","isLocationNameEmpty","isLocationNameDuplicated","isCountryEmpty","locationAttributeTypesGrouped","chunk","input","attribute","minOccurs","preferredHandlerClassname","handlerConfig","invalid","locationAttributeTypesGroup","isAllRequiredLocationAttributeTypesFilled","requiredLocationAttributeTypeUuid","preparedLocation","locationDefaultTags","uniq","PERSON_ID_LOOKUP_STRING","EMAIL_REGEX","PASSWORD_REGEX","USERNAME_REGEX","SETTING_ATTRIBUTE_TYPE_PREFIX","SETTING_TELEPHONE_NUMBER_ATRRIBUTE_TYPE","SETTING_EMAIL_ADDRESS_ATRRIBUTE_TYPE","DEFAULT_EDIT_USER_PASSWORD","FAMILY_NAME_FIELD","GIVEN_NAME_FIELD","PHONE_FIELD","EMAIL_FIELD","USERNAME_FIELD","LOCATION_FIELD","USER_ROLE_FIELD","PASSWORD_FIELD","CONFIRM_PASSWORD_FIELD","DEFAULT_USER_VALUES","email","username","userRole","password","confirmPassword","PersonDetails","userAccount","familyNameValue","isFamilyNameValid","familyNameError","givenNameValue","isGivenNameValid","givenNameError","phoneValue","isPhoneValid","phoneError","emailValue","isEmailValid","emailError","AuditInfo","audit","creator","dateCreated","changedBy","dateChanged","UserAccountDetails","roles","forcePassword","setForcePassword","usernameValue","isUserNameValid","userNameError","locationsValue","isLocationsValid","locationsError","userRoleValue","isUserRoleValid","userRoleError","passwordValue","isPasswordValid","passwordError","confirmPasswordValue","isConfirmPasswordValid","confirmPasswordError","autoComplete","hide","users","currentUser","locationHash","hash","positionPersonId","getRoles","getUsers","getUserByPersonId","saveUser","newPassword","Promise","all","deleteUser","role","user","userLoading","isNil","loadingSettings","personUuid","emailAddressAtributeTypeUuid","telephoneNumberAtributeTypeUuid","setUserAccount","setDirtyFields","setIsConfirmationModalOpen","locationUuidString","userProperties","locationUuid","fixedLocationUuidString","locationUuids","fieldValue","isFieldValid","isUsernameValid","isUsernameUnique","edit","auditInfo","validatedUserAccount","validateEmptyFields","isPasswordFieldDirty","personAttributes","String","DRUG_DOSING_UNITS_SETTING_KEY","DELETE_REGIMEN_MODAL","DELETE_DRUG_MODAL","FIELD_REQUIRED_ERROR_MESSAGE","UNIQUE_REGIMEN_NAME_ERROR_MESSAGE","CLOSED_MODAL_CONFIGURATION","open","DEFAULT_OPTION_CONFIGURATION","DEFAULT_DRUG_CONFIGURATION","drugDetails","abbreviation","doseUnits","dose","frequency","DEFAULT_MANAGE_REGIMEN_CONFIGURATION","drugs","INITIAL_REGIMEN_VALUE","regimenUuid","INITIAL_DRUG_VALUE","drugUuid","drugIdx","editedRegimens","regimenToDelete","drugToDelete","setRegimens","setEditedRegimens","setRegimenToDelete","setDrugToDelete","setConfirmationModal","manageRegimens","conceptDoseTypes","drugsList","frequencies","orderFrequency","drug","drugFrequency","useMemo","getValue","onChangeHandler","useCallback","clonedRegimens","extractedValue","onAddDrugHandler","onRemoveDrugHandler","isRegimenValid","isRegimenNameUnique","onRemoveRegimenHandler","orderSet","deletedOrderSet","deletedOrderSetMember","savedOrderSet","orderTypes","getOrderSet","custom","deleteOrderSet","saveOrderSet","deleteOrderSetMember","orderSetUuid","orderSetMemberUuid","getDrugsList","getFrequencies","getConcept","getOrderType","orderSetLoading","conceptDoseTypesLoading","drugsLoading","frequencyLoading","orderType","orderTypeLoading","isRegimensLoading","drugDosingUnitsConcept","drugOrderType","javaClassName","setIsAllSectionsExpanded","memoOrderSetList","orderSetMembers","orderTemplate","parsedOrderSetMember","regimenNameReceived","regimenIdxReceived","regimensReceived","clonedRegimenIdx","clonedRegimenName","otherRegimens","without","onAddRegimenHandler","newRegimens","regimensToSave","editedRegimen","getDrugs","foundConcept","drugList","orderTemplateType","operator","regimenToSave","onNoHandler","onYesHandler","allPossibleColumns","columnsConfiguration","setColumnsConfiguration","findPatientColumnsConfiguration","columnIdx","differenceWith","isEqual","onSwapPositionsHandler","clonedColumnsConfiguration","swappedColumnsPosition","addColumnHandler","removeColumnHandler","setAllPossibleColumns","routeConfig","path","component","isAppLoading","settingsSaved","settingUuid","str","charAt","toUpperCase","uniqWith","setIsModalOpen","onReturnHandler","onSaveHandler","markConfigurationAsInvalid","omittedEmptyColumnsConfiguration","breadcrumb","ManageRegimens","Location","UserAccount","Conditions","NotificationTemplates","requiredPrivilege","separator","showArrows","Breadcrumbs","routeBreadcrumbs","children","breadcrumbDef","labelId","urlParam","nameParam","nameParamVal","b1","b2","withBreadcrumbs","Header","ErrorBoundary","hasError","Unauthorized","Routes","renderComponent","route","authenticated","privileges","session","loginLocations","p","getAppConfig","appName","app","getApp","CONFIGURE_METADATA_APPS","APP_PREFIX","findPatientTableColumns","getAppsState","toast","configure","App","getSession","getApps","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","combineReducers","personStatus","customizeReducer","openmrs","openmrsReducers","form","reduxFormReducer","sagaMiddleware","createSagaMiddleware","defaultMiddlewares","thunkMiddleware","promiseMiddleware","composedMiddlewares","middlewares","compose","applyMiddleware","initialize","store","createStore","rootReducer","run","openmrsSagas","initStore","flatten","en","ReactDOM","StrictMode","locale","document","getElementById"],"mappings":"07jBAAaA,EAAW,YACXC,EAAmBD,iDCEnBE,EAAc,SAAAC,GAGzB,OAFeC,IAAYC,MAAMF,GACV,UACHH,GAAUM,Y,yBCFnBC,EAAU,SAAAC,GAAU,gBAAOA,EAAP,aAMpBC,EAAU,SAAAD,GAAU,gBAAOA,EAAP,eAMpBE,EAAU,SAAAF,GAAU,gBAAOA,EAAP,cCXpBG,EACM,0BADNA,EAEK,yBAFLA,EAGE,sBAGTC,EAA8B,CAClCC,QAAS,CACPC,UAAU,EACVC,SAAS,GAEXC,MAAO,GACPF,SAAU,GACVC,QAAS,CACPE,KAAM,GACNC,WAAY,IAEdC,aAAc,IAwFDC,EArFC,WAAmC,IAAlCC,EAAiC,uDAAzBT,EAAcU,EAAW,uCAChD,OAAQA,EAAOC,MACb,KAAKhB,EAAQI,GACX,OAAO,2BACFU,GADL,IAEER,QAAQ,2BACHQ,EAAMR,SADJ,IAELC,UAAU,MAGhB,KAAKP,EAAQI,GACX,OAAO,2BACFU,GADL,IAEER,QAAQ,2BACHQ,EAAMR,SADJ,IAELE,SAAS,MAGf,KAAKL,EAAQC,GACX,OAAO,2BACFU,GADL,IAEER,QAAQ,2BACHQ,EAAMR,SADJ,IAELC,UAAU,IAEZK,aAAcG,EAAOE,QAAQC,UAEjC,KAAKf,EAAQC,GACX,OAAO,2BACFU,GADL,IAEER,QAAQ,2BACHQ,EAAMR,SADJ,IAELE,SAAS,IAEXI,aAAcG,EAAOE,QAAQC,UAEjC,KAAKhB,EAAQE,GACX,OAAO,2BACFU,GADL,IAEER,QAAQ,2BACHQ,EAAMR,SADJ,IAELC,UAAU,IAEZE,MAAOM,EAAOI,KAAKC,EACnBb,SAAUQ,EAAOE,QAAQI,KAAKC,UAElC,KAAKpB,EAAQE,GACX,OAAO,2BACFU,GADL,IAEER,QAAQ,2BACHQ,EAAMR,SADJ,IAELE,SAAS,IAEXA,QAASO,EAAOE,QAAQI,OAE5B,KAAKjB,EACH,OAAO,eACFC,GAEP,QACE,OAAOS,I,uDCjFAV,EACE,uBADFA,EAEG,wBAFHA,EAGK,0BAHLA,EAIK,0BAGZC,EAAe,CACnBC,SAAS,EACTM,aAAc,KACdW,SAAU,GACVC,QAAS,KACTC,SAAS,EACTC,eAAgB,CAAEC,mBAAoB,KAAMC,OAAO,IAsDxCC,EAAc,WAAkB,IAAjBC,EAAgB,uDAAP,GAC7BC,EAAU,8CAA0CD,EAA1C,WAChB,MAAO,CACLd,KAAMZ,EACNa,QAASe,IAAMC,IAAIF,KAIVG,EAAoB,SAAAd,GAC/B,IAAMW,EAAU,8CAA0CX,EAA1C,WAChB,MAAO,CACLJ,KAAMZ,EACNa,QAASe,IAAMC,IAAIF,KAIVI,EAAgB,SAACC,GAA4C,IAAlCR,EAAiC,uDAAzB,GAAIS,EAAqB,uDAAP,GAC1DN,EAAU,oCACVV,EAAO,CACXe,WACAC,eAKF,OAHIT,IACFP,EAAI,MAAYO,GAEX,CACLZ,KAAMZ,EACNa,QAASe,IAAMM,KAAKP,EAAYV,KAIvBkB,EAAgB,SAAAf,GAC3B,IAAMO,EAAU,4CAAwCP,EAAQd,MAChE,MAAO,CACLM,KAAMZ,EACNa,QAASe,IAAMM,KAAKP,EAAYP,KASrBX,EA/FC,WAAmC,IAAlCC,EAAiC,uDAAzBT,EAAcU,EAAW,uCAChD,OAAQA,EAAOC,MACb,KAAKhB,EAAQI,GACb,KAAKJ,EAAQI,GACb,KAAKJ,EAAQI,GACb,KAAKJ,EAAQI,GACX,OAAO,2BACFU,GADL,IAEER,SAAS,EACTmB,SAAS,EACTb,aAAc,OAElB,KAAKT,EAAQC,GACb,KAAKD,EAAQC,GACb,KAAKD,EAAQC,GACb,KAAKD,EAAQC,GACX,OAAO,2BACFU,GADL,IAEER,SAAS,EACTmB,SAAS,EACTb,aAAcG,EAAOE,QAAQC,UAEjC,KAAKhB,EAAQE,GACX,OAAO,2BACFC,GADL,IAEEkB,SAAUR,EAAOE,QAAQI,KAAKC,UAElC,KAAKpB,EAAQE,GACX,IAAMkB,EAAUP,EAAOE,QAAQI,KAAKC,QAC9BI,IAAmBJ,GAAWA,EAAQkB,OAAS,EACrD,OAAO,2BACF1B,GADL,IAEER,SAAS,EACTM,aAAc,KACdc,eAAgB,CAAEC,mBAAoBZ,EAAOE,QAAQwB,OAAOC,IAAKd,MAAOF,GACxEF,QAASE,EAAiBJ,EAAQ,GAAKR,EAAMU,UAEjD,KAAKtB,EAAQE,GACb,KAAKF,EAAQE,GACX,OAAO,2BACFU,GADL,IAEER,SAAS,EACTM,aAAc,KACda,SAAS,IAEb,QACE,OAAOX,I,SCzDA6B,G,MAAc,eAEdC,EAAa,SAACC,EAAMC,GAAP,OACxB,IAAIC,KAAKC,eAAe,QAAS,CAC/BC,IAAK,UACLC,MAAO,QACPC,KAAM,YACLC,OAAON,IAECO,EAAgB,SAAAC,GAAM,OAAKA,EAASA,EAAOC,cAAcC,MAAM,KAAK,GAAK,M,kBCdzEpD,EACI,0BADJA,GAEQ,8BAFRA,GAGK,2BAHLA,GAIM,4BAGbC,GAAe,CACnBC,SAAS,EACTc,EAAG,GACHqC,UAAW,KACXC,WAAY,GACZ9C,aAAc,GACd+C,kBAAkB,GA6DPC,GAAgB,SAAAH,GAE3B,MAAO,CACLzC,KAAMZ,GACNa,QAASe,IAAMM,KAHD,oCAGkB,CAACuB,GAAiBJ,OAehDI,GAAmB,SAAAJ,GAAS,kCAC7BA,GAD6B,IAEhCK,kBAAmBL,EAAUK,mBAAqB,QAOrCjD,GAtFC,WAAmC,IAAlCC,EAAiC,uDAAzBT,GAAcU,EAAW,uCAChD,OAAQA,EAAOC,MACb,KAAKhB,EAAQI,GACb,KAAKJ,EAAQI,IACb,KAAKJ,EAAQI,IACX,OAAO,2BACFU,GADL,IAEER,SAAS,EACTqD,kBAAkB,IAEtB,KAAKxD,EAAQC,GACb,KAAKD,EAAQC,IACX,OAAO,2BACFC,IADL,IAEEO,aAAcG,EAAOE,QAAQC,UAEjC,KAAKhB,EAAQE,GACX,OAAO,2BACFC,IADL,IAEEoD,UAAW1C,EAAOE,QAAQI,MAAQN,EAAOE,QAAQI,KAAK,KAE1D,KAAKnB,EAAQE,IACX,OAAO,2BACFC,IADL,IAEEqD,WAAY3C,EAAOE,QAAQI,OAE/B,KAAKnB,EAAQE,IACX,OAAO,2BACFU,GADL,IAEER,SAAS,EACTqD,kBAAkB,IAEtB,KAAKvD,GACH,OAAO,eACFC,IAEP,QACE,OAAOS,ICvDAV,GACM,kBADNA,GAEQ,oBAGfC,GAAe,CACnB0D,sBAAuB,IAoBZC,GAAiB,SAACC,GAAD,MAAiC,CAC7DjD,KAAMZ,GACNe,KAAM,CACJ8C,iBAISC,GAAmB,iBAAO,CACrClD,KAAMZ,KAGOS,GA5BC,WAAmC,IAAlCC,EAAiC,uDAAzBT,GAAcU,EAAW,uCAChD,OAAQA,EAAOC,MACb,KAAKZ,GACH,OAAO,2BACFU,GADL,IAEEiD,sBAAuBjD,EAAMiD,sBAAsBI,OAAOpD,EAAOI,KAAK8C,eAE1E,KAAK7D,GACH,OAAO,eACFC,IAEP,QACE,OAAOS,ICvBAsD,GAAgB,SAChBC,GAAkB,W,SCDlBC,GAAoB,GAEpBC,GAAS,SAACC,EAAUC,GAAX,IAAwBC,EAAxB,uDAAmCJ,GAAnC,OAClBE,EAAWA,EAASG,MAAMF,EAAcC,GAAWD,EAAc,GAAKC,GAAY,ICEzEtE,GACM,0BADNA,GAEE,sBAFFA,GAGK,yBAHLA,GAIgB,oCAJhBA,GAKkB,sCAGzBC,GAAe,CACnBC,SAAS,EACTsE,SAAU,GACVC,QAAS,KACTC,qBAAsB,KACtBlE,aAAc,GACd6D,YAAa,EACbM,WAAY,EACZC,SAAS,EACTC,SAAS,EACT7D,EAAG,GACH8D,sBAAuB,IA8DZtF,GAAS,SAACwB,GAA4C,IAAzC+D,EAAwC,uDAAjC,EAAGC,EAA8B,uDAAtBd,GACpCvC,EAAU,wCAAoCX,GAAK,GAAzC,uBAA0D+D,EAAOC,EAAjE,kBAAgFA,EAAhF,2BAChB,MAAO,CACLpE,KAAMZ,GACNa,QAASe,IAAMC,IAAIF,GACnBZ,KAAM,CACJC,IACAqD,YAAaU,KAONE,GAAa,SAAAC,GACxB,IAAMvD,EAAU,sCAAkCuD,EAAlC,sBAHI,gKAGJ,KAChB,MAAO,CACLtE,KAAMZ,GACNa,QAASe,IAAMC,IAAIF,KAoBVwD,GAAQ,iBAAO,CAC1BvE,KAAMZ,KAGOS,GArGC,WAAmC,IAAlCC,EAAiC,uDAAzBT,GAAcU,EAAW,uCAChD,OAAQA,EAAOC,MACb,KAAKhB,EAAQI,IACX,OAAO,2BACFU,GADL,IAEEgE,qBAAsB,OAE1B,KAAK9E,EAAQI,IACX,OAAO,2BACFU,GADL,IAEER,SAAS,EACTc,EAAGL,EAAOI,KAAKC,IAEnB,KAAKjB,EAAQC,IACX,OAAO,2BACFC,IADL,IAEEO,aAAcG,EAAOE,QAAQC,UAEjC,KAAKhB,EAAQE,IACX,IAAMoF,EAAQzE,EAAOE,QAAQI,KAAKmE,MAC5BL,EAAOpE,EAAOI,KAAKsD,aAAe,EAClCG,EAAW7D,EAAOE,QAAQI,KAAKC,SAAW,GAChD,OAAIP,EAAOI,KAAKC,IAAMN,EAAMM,EACnB,2BACFf,IADL,IAEEuE,SAAmB,IAATO,EAAaP,EAAb,uBAA4B9D,EAAM8D,UAAlC,aAA+CA,IACzDI,QAASQ,KAAWA,EAAMC,MAAK,SAAAC,GAAI,MAAiB,SAAbA,EAAKC,OAC5CV,QAASO,KAAWA,EAAMC,MAAK,SAAAC,GAAI,MAAiB,SAAbA,EAAKC,OAC5CZ,WAAYhE,EAAOE,QAAQI,KAAK0D,WAChCN,YAAa1D,EAAOI,KAAKsD,cAGpB,eAAK3D,GAEhB,KAAKZ,EAAQE,IACX,OAAO,2BACFU,GADL,IAEE+D,QAAS9D,EAAOE,QAAQI,OAE5B,KAAKnB,EAAQE,IACX,OAAO,2BACFU,GADL,IAEEgE,qBAAsB/D,EAAOE,QAAQI,KAAKC,UAE9C,KAAKpB,EAAQE,IACX,OAAO,2BACFU,GADL,IAEEoE,sBAAuBnE,EAAOE,QAAQI,OAE1C,KAAKjB,GACH,OAAO,eACFC,IAEP,QACE,OAAOS,I,iBC/CP8E,G,4MACJ9E,MAAQ,CACN+E,aAAc,GACdrF,QAAS,KACTsF,aAAc,GACdC,UAAW,KACXC,QAAS,KACTC,QAAQ,G,EAGVC,YAAcC,IAAEC,UAAS,WACvB,EAAKC,mBACJ,K,EAEHC,gBAAkB,SAAA1E,GAChB,EAAK2E,SAAS,CACZV,aAAcjE,EACdkE,aAAclE,IAEhB,EAAKsE,e,EAGPM,gBAAkB,SAAAhG,GAChB,EAAK+F,SAAS,CACZ/F,a,EAIJiG,YAAc,WAEZ,OADe5G,IAAYC,MAAM,EAAK4G,MAAMC,SAAS/G,QACvC6G,a,EAgDhBJ,eAAiB,WACX,EAAKvF,MAAMgF,aAAatD,OAAS,GAAK,EAAK1B,MAAMgF,eAAiB,EAAKY,MAAMb,cAC/E,EAAKa,MAAML,eAAe,EAAKvF,MAAMgF,aAAc,EAAKY,MAAME,qB,EAIlEC,eAAiB,WAAO,IACdrG,EAAY,EAAKM,MAAjBN,QACFA,GACJ,EAAK8F,gBAAgB9F,EAAQsG,Q,EAIjCC,cAAgB,SAAAlB,GACd,EAAKS,gBAAgBT,GACrB,EAAKK,e,EAGPc,eAAiB,WAMf,OALqB,EAAKN,MAAlBnG,SACiB0G,KAAI,SAAAzG,GAAO,MAAK,CACvCoB,MAAOpB,EAAQA,QAAQE,KACvBoG,MAAOtG,EAAQ0G,a,EAKnBC,kBAAoB,SAAApB,GAClB,EAAKQ,SAAS,CACZR,e,EAIJqB,gBAAkB,SAAApB,GAChB,EAAKO,SAAS,CACZP,a,EAIJqB,eAAiB,SAAApB,GAAM,OAAI,WACzB,EAAKM,SAAS,CACZN,a,EAIJqB,OAAS,WACP,EAAKZ,MAAMa,QAAQC,KAAnB,sBAAuC,EAAKd,MAAMe,MAAMC,OAAOC,e,EAGjEC,KAAO,WACL,GAAI,EAAK9G,MAAMN,QAAS,CAAC,IAAD,EAEhBiD,EADc,EAAKgD,cACP,eAAqB,EAAKC,MAAMjD,WAAc,GAChEA,EAAUoE,OAAS,EAAK/G,MAAMmF,OAAS7B,GAAgBC,GACvDZ,EAAUkE,YAAc,EAAKjB,MAAMe,MAAMC,OAAOC,aAChD,UAAI,EAAK7G,MAAMN,eAAf,aAAI,EAAoBsH,YACtBrE,EAAUjD,QAAU,CAAEE,KAAM,GAAIqH,KAAM,GAAIC,UAAW,IACrDvE,EAAUK,kBAAoB,EAAKhD,MAAMN,QAAQsG,OAEjDrD,EAAUjD,QAAV,2BAA0BiD,EAAUjD,SAAW,IAA/C,IAAoDE,KAAM,EAAKI,MAAMN,QAAQoB,QAE/E6B,EAAUwE,UAAY5E,EAAc,EAAKvC,MAAMiF,WAAa,IAAImC,MAChEzE,EAAUuC,QAAW,EAAKlF,MAAMmF,OAA6C,GAApC5C,EAAc,EAAKvC,MAAMkF,SAClEvC,EAAU0E,QAAS,EACd1E,EAAU2E,mBACb3E,EAAU2E,iBAAmB,IAE1B3E,EAAU4E,YACb5E,EAAU4E,UAAY,CAAEL,UAAW,KAErC,EAAKtB,MAAM9C,cAAcH,K,uDAnH7B,WACE6E,KAAK5B,MAAMnB,QACX+C,KAAK5B,MAAMxE,kBAAkB,iCAC7B,IAAMuE,EAAc6B,KAAK7B,cACnBA,GACJ6B,KAAK5B,MAAM6B,aAAa9B,GAE1B,IAAMnB,EAAKgD,KAAK5B,MAAMe,MAAMC,OAAOC,YACnCW,KAAK5B,MAAMrB,WAAWC,K,gCAGxB,SAAmBkD,EAAuCC,EAAuCC,GAAiB,IAAD,EACnCJ,KAAK5B,MAAzEjD,EADuG,EACvGA,UAAWoB,EAD4F,EAC5FA,QAAS4C,EADmF,EACnFA,MAAO9D,EAD4E,EAC5EA,iBAAkBiD,EAD0D,EAC1DA,mBAC/CtB,EAAKmC,EAAMC,OAAOC,YACxB,GAAIa,EAAU/E,YAAcA,GAAeA,EAAW,CAAC,IAC7CjD,EAAwCiD,EAAxCjD,QAASqH,EAA+BpE,EAA/BoE,OAAQI,EAAuBxE,EAAvBwE,UAAWjC,EAAYvC,EAAZuC,QACpCsC,KAAK/B,SAAS,CACZ/F,QAASA,GAAW,CAClBsG,MAAOtG,EAAQuH,KACfnG,MAAOpB,EAAQE,MAEjBuF,OAAQ4B,IAAWzD,GACnB2B,UAAWkC,GAAa,IAAIC,KAAKD,GACjCjC,QAASA,GAAW,IAAIkC,KAAKlC,KAG7BwC,EAAU5B,qBAAuBA,GACnC0B,KAAK5B,MAAML,eAAe,GAAIO,GAE1B/B,GAAWA,IAAY2D,EAAU3D,UACrCyD,KAAK5B,MAAMxC,mBACXoE,KAAK5B,MAAM1C,eAAe,CACxB,CACE8C,MAAOjC,EAAQ8D,OAAOC,cAAc1B,QACpCxE,IAAI,GAAD,OAAKhD,EAAL,sBAAmC4F,GACtCuD,MAAO,MAITlF,IAAqB6E,EAAU7E,mBACjCmF,aAAaR,KAAK5B,MAAM7D,KAAKkG,cAAc,CAAEzD,GAAI,wBACjDgD,KAAK5B,MAAMa,QAAQC,KAAnB,sBAAuCc,KAAK5B,MAAMe,MAAMC,OAAOC,iB,oBA8EnE,WAAU,IACA9E,EAASyF,KAAK5B,MAAd7D,KACF4D,EAAc6B,KAAK7B,cACzB,OACE,uBAAKuC,UAAU,YAAf,UACE,8BACE,eAAC,IAAD,CAAkB1D,GAAMmB,EAAc,gCAAkC,sCAE1E,sBAAKuC,UAAU,QAAf,SAAwBV,KAAK5B,MAAMuC,QACnC,uBAAKD,UAAU,gBAAf,UACE,sBAAKA,UAAU,SAAf,SACE,sBAAKA,UAAU,cAAf,SACE,uBAAKA,UAAU,kBAAf,UACE,eAAC,IAAD,CACEE,QAASZ,KAAKtB,iBACdmC,cAAeb,KAAKvB,cACpBqC,SAAUd,KAAK9B,gBACfwC,UAAU,oBACVK,gBAAgB,iBAChBC,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,8BACtC1D,MAAO0G,KAAKxH,MAAMN,QAClB+I,WAAYjB,KAAKxH,MAAMgF,aACvB0D,QAASlB,KAAKzB,eACd4C,aAAchD,IAEf6B,KAAKxH,MAAMN,SAAW,uBAAMwI,UAAU,cAAhB,SAA+BnG,EAAKkG,cAAc,CAAEzD,GAAI,uCAIrF,uBAAK0D,UAAU,mBAAf,UACE,sBAAKA,UAAWV,KAAKxH,MAAMmF,OAAS,SAAW,kBAA/C,SACE,uBAAK+C,UAAU,kBAAf,UACE,eAAC,IAAD,CACEU,gBAAiB7G,EAAKkG,cAAc,CAAEzD,GAAI,8BAC1CqE,SAAUrB,KAAKxH,MAAMiF,UACrBiD,UAAU,eACVI,SAAUd,KAAKnB,kBACfyC,eAAa,EACbC,mBAAiB,EACjBC,kBAAgB,EAChBC,aAAa,SACbC,WAAYrH,IAEb2F,KAAKxH,MAAMiF,WAAa,uBAAMiD,UAAU,cAAhB,SAA+BnG,EAAKkG,cAAc,CAAEzD,GAAI,qCAGrF,sBAAK0D,UAAU,kBAAf,UACyB,IAAtBV,KAAKxH,MAAMmF,QACV,uBAAK+C,UAAU,kBAAf,UACE,eAAC,IAAD,CACEU,gBAAiB7G,EAAKkG,cAAc,CAAEzD,GAAI,4BAC1CqE,SAAUrB,KAAKxH,MAAMkF,QACrBgD,UAAU,eACVI,SAAUd,KAAKlB,gBACfwC,eAAa,EACbC,mBAAiB,EACjBC,kBAAgB,EAChBC,aAAa,SACbC,WAAYrH,IAEb2F,KAAKxH,MAAMiF,WAAa,uBAAMiD,UAAU,cAAhB,SAA+BnG,EAAKkG,cAAc,CAAEzD,GAAI,sCAKzF,+BACE,uBAAK0D,UAAU,SAAf,UACE,eAACiB,EAAA,EAAD,CAAWC,OAAK,EAACC,QAAM,EAAqBnB,UAAU,OAAtD,SACE,eAACoB,EAAA,EAAD,CAAQC,QAAS/B,KAAKjB,gBAAe,GAAO2B,UAAS,+BAA+C,IAAtBV,KAAKxH,MAAMmF,OAAkB,SAAW,IAAtH,SACE,gCAAOpD,EAAKkG,cAAc,CAAEzD,GAAI,2BAFR,iBAK5B,eAAC2E,EAAA,EAAD,CAAWC,OAAK,EAACC,QAAM,EAAuBnB,UAAU,OAAxD,SACE,eAACoB,EAAA,EAAD,CACEC,QAAS/B,KAAKjB,gBAAe,GAC7B2B,UAAS,+BAA+C,IAAtBV,KAAKxH,MAAMmF,OAAmB,SAAW,IAF7E,SAIE,gCAAOpD,EAAKkG,cAAc,CAAEzD,GAAI,6BALR,2BAWlC,uBAAK0D,UAAU,OAAf,UACE,sBAAKA,UAAU,WAAf,SACE,eAACoB,EAAA,EAAD,CAAQpB,UAAU,SAASqB,QAAS/B,KAAKhB,OAAzC,SACE,gCAAOzE,EAAKkG,cAAc,CAAEzD,GAAI,iCAGpC,sBAAK0D,UAAU,+CAAf,SACE,eAACoB,EAAA,EAAD,CAAQpB,UAAU,OAAOqB,QAAS/B,KAAKV,KAAM0C,UAAWhC,KAAKxH,MAAMN,QAAnE,SACE,eAAC,IAAD,CAAkB8E,GAAG,8B,GAnPXiF,IAAMC,WAsQxBC,GAAqB,CACzBpE,eR/M4B,SAACjF,EAAGsJ,GAChC,IAAM3I,EAAU,2DAAuD2I,GAAvD,OAA0EtJ,EAAI,MAAQA,EAAI,IAC1G,MAAO,CACLJ,KAAMZ,EACNa,QAASe,IAAMC,IAAIF,GACnBZ,KAAM,CACJC,OQ0MJmE,MRhMmB,iBAAO,CAC1BvE,KAAMZ,IQgMN8B,oBACAqG,aL9O0B,SAAA7H,GAC1B,IAAMqB,EAAU,0DAAsDrB,GACtE,MAAO,CACLM,KAAMZ,EACNa,QAASe,IAAMC,IAAIF,KK2OrBiC,kBACAE,oBACAmB,cACAzB,kBAMa+G,sBAxBS,SAAC,GAAD,MAAGnK,EAAH,EAAGA,QAASe,EAAZ,EAAYA,SAAUkC,EAAtB,EAAsBA,UAAWmH,EAAjC,EAAiCA,WAAjC,MAAmD,CACzErK,SAAUC,EAAQD,SAClB0I,MAAOzI,EAAQI,aACfgG,mBAAkB,UAAErF,EAASC,eAAX,aAAE,EAAkBI,MACtCiE,aAAcrF,EAAQC,MACtBgD,UAAWA,EAAUA,UACrBE,iBAAkBF,EAAUE,iBAC5BkB,QAAS+F,EAAW/F,WAiBkB4F,GAAzBE,CAA6CE,YAAWC,qBAAWlF,M,iCCtTnE,I,QAAA,s3BCCFmF,GAAqB,oBAErBC,GAAU,UACVC,GAAS,SAETC,GAAY,YACZC,GAAa,YACbC,GAAe,cACfC,GAAkB,iBAClBC,GAAoB,mBACpBC,GAAa,YAEbC,GAAc,aAGdC,GAAkC,mBAClCC,GAAiC,iBAKjCC,GAAoC,UAAMZ,GAAN,YAA4BC,GAA5B,YAAuCC,GAAvC,YAjB9B,MAiB8B,YAAwDC,GAAxD,YAAqEE,IAGzGQ,GAAc,CAAEC,EAAG,OAAQC,EAAG,UAE9BC,GAAuB,GCzBvBC,GAAe,SAAAC,GAC1B,OAAKA,EAEMC,MAAMC,QAAQF,GAChBA,EAAK,GAAL,SAAoBF,GACF,kBAATE,EACTA,EAAI,SAAaF,GAEjBE,EANAF,IAUEK,GAAmB,SAACC,EAAQrL,GACvC,IAAKqL,EACH,OAAON,GAET,IAAMO,EAAOD,EAAOE,YAAcF,EAAOE,WAAW9G,MAAK,SAAA+G,GAAC,OAAIA,EAAEC,cAAF,QAAyBC,gBAAkB1L,EAAK0L,iBAC9G,OAAQJ,GAAQA,EAAK1K,OAAUmK,I,SC6BpBY,GAA6B,SAAAC,GAAW,OAAIA,GA7BvC,IA6BkEA,GCzCvEC,GAAgB,SAAChI,EAASiI,EAAQjK,GAAU,IAC/C8F,EAAW9D,EAAX8D,OACAoE,EAAoCpE,EAApCoE,iBAAkBnE,EAAkBD,EAAlBC,cACpBoE,EAAkBZ,GAAiBzD,EAAQmE,GAC3CG,EAActE,EAAOmE,GAE3B,OAAIE,EACKF,IAAWrB,IACdyB,aAAsBP,GAA2BK,IAC/CL,GAA2BK,GAE7BA,EACKC,EACFH,IAAW5B,GAAYtI,EAAWC,EAAM,IAAIqF,KAAK+E,IAAgBA,GAEpD,OAAbrE,QAAa,IAAbA,OAAA,EAAAA,EAAgBkE,MAAhB,OAA2BC,QAA3B,IAA2BA,OAA3B,EAA2BA,EAAmBD,KFQxB,SAACT,EAAQrL,GACxC,IAAKqL,EACH,OAAON,GAET,IAAMoB,EAAad,EAAOe,aAAef,EAAOe,YAAY3H,MAAK,SAAAH,GAAE,OAAIA,EAAG+H,eAAH,QAA2BX,gBAAkB1L,EAAK0L,iBACzH,OAAQS,GAAcA,EAAWA,YAAepB,GEbkBuB,CAAkBzI,EAASiI,IAIlFS,GAA6B,SAAA1I,GACxC,IAAM8D,EAAS9D,EAAQ8D,QAAU9D,EACzB+D,EAA4DD,EAA5DC,cAAemE,EAA6CpE,EAA7CoE,iBAAkBS,EAA2B7E,EAA3B6E,OAAQ9M,EAAmBiI,EAAnBjI,KAAM+M,EAAa9E,EAAb8E,SAC/CC,EAAsC9E,EAAtC8E,UAAWC,EAA2B/E,EAA3B+E,WAAYC,EAAehF,EAAfgF,WAHoB,EAI6Bb,GAAoB,GAA5Fc,EAJ2C,EAI3CA,SAAUC,EAJiC,EAIjCA,SAAUC,EAJuB,EAIvBA,YAAaC,EAJU,EAIVA,cAAeC,EAJL,EAIKA,QAASC,EAJd,EAIcA,WACjE,OAAO,yBACLC,UAAWtJ,EAAQsJ,WAAazN,EAChCA,KAAMmE,EAAQnE,KACd+M,WACAC,YACAC,aACAC,aACAJ,SACAY,UAAazF,EAAOyF,UAAY,IAAIlG,KAAKS,EAAOyF,WAAa,KAC7DP,WACAC,WACAC,cACAC,gBACAC,UACAC,cFvB6B,SAAA7B,GAC/B,IAAME,EAAa,GAInB,OAHAF,GACEA,EAAOE,YACPF,EAAOE,WAAW8B,SAAQ,SAAA/B,GAAI,OAAKC,EAAWD,EAAKG,cAAL,SAA+BH,EAAK1K,OAASmK,MACtFQ,EEmBF+B,CAAkB3F,IFRS,SAAA0D,GAChC,IAAMe,EAAc,GAIpB,OAHAf,GACEA,EAAOe,aACPf,EAAOe,YAAYiB,SAAQ,SAAA/I,GAAE,OAAK8H,EAAY9H,EAAG+H,eAAH,SAA8B/H,EAAG6H,YAAcpB,MACxFqB,EEIFmB,CAAmB1J,KC/Cb2J,GAAqB,IAMrBC,GAAe,GACfC,GAAsB,QACtBC,GAAc,OACdC,GAAe,QCNfC,GAAa,SAACpO,EAAOH,EAASyE,GACzC,OAAIA,EAAa,EAEb,kCACGA,EADH,IACe,eAAC,IAAD,CAAkBO,GAAG,0BAG7B7E,EAAM+B,OAAS,EACjB,eAAC,IAAD,CAAkB8C,GAAG,sBAClBhF,GAA0B,IAAfyE,OAAhB,EACE,eAAC,IAAD,CAAkBO,GAAG,qB,iDCsDjBwJ,GAhDO,SAACpI,GAA+B,IAAD,EAC7C7D,EAAOkM,eAMPC,GAAiB,UAAAtI,EAAMuI,QAAQ,UAAd,eAAkBC,eAAgBC,OAEzD,OACE,eAAC,KAAD,CACEC,WAAY1I,EAAMlC,SAAShC,OAC3B6M,KAAM,kBAAM3I,EAAM4I,WAAW5I,EAAMjC,YAAc,IACjD8K,QAAS7I,EAAM1B,QACfwK,OACE,sBAAKxG,UAAU,UAAf,SACE,eAACyG,GAAA,EAAD,MANN,SAUE,gBAAC,KAAD,CAAOC,YAAU,EAACC,SAAO,EAACC,YAAU,EAAC5G,UAAU,QAA/C,UACE,iCACE,8BACG7C,IAAEc,IAAIP,EAAMuI,SAAS,SAACnC,EAAQ+C,GAAT,OACpB,8BAAab,EAAiBlC,EAAOhG,MAAQ,eAAC,IAAD,CAAkBxB,GAAE,sBAAiBwH,MAAzE+C,UAIf,iCACG1J,IAAEc,IAAIP,EAAMlC,UAAU,SAAC6H,EAAQwD,GAAT,OACrB,qBAAYxF,QAAS,kBA5BR,SAAAgC,GACf3F,EAAMoJ,gBACVC,OAAOpJ,SAASqJ,KAAOtJ,EAAMoJ,cAAczD,IA0BV4D,CAAe5D,IAA1C,SACGlG,IAAEc,IAAIP,EAAMuI,SAAS,SAAAnC,GACpB,IAAMoD,EAAclB,EAAiBlC,EAAOlL,MAAQkL,EAEpD,OACE,qBAAsB9D,UAAatC,EAAMoJ,cAAgB,oBAAiBK,EAA1E,SACGzJ,EAAMmG,cAAcR,EAAQ6D,EAAarN,IADnCqN,OALNL,cC9CRO,GAAoC,wCACpCC,GAA+B,CAAEvJ,MAAO,GAAIlF,MAAO,GAAI0O,SAAS,GAChEC,GAAkC,SAClCC,GAAyC,kBACzCC,GAAgB,CAC3B,CAAE3J,MAAO,aAAclF,MPNC,cOOxB,CAAEkF,MAAO,OAAQlF,MAAOoJ,IACxB,CAAElE,MAAO,MAAOlF,MPLC,QOON8O,GAAe,UACvBD,GADuB,CAE1B,CAAE3J,MAAO,SAAUlF,MAAOqJ,IAC1B,CAAEnE,MAAO,YAAalF,MAAOsJ,IAC7B,CAAEpE,MAAO2E,GAAiC7J,MAAO6J,MCS7CkF,G,4MACJ7P,MAAQ,CACNL,MAAO,GACP0E,KAAM,G,EAGRyL,iBAAmBzK,IAAEC,UAAS,WACxB,EAAKtF,MAAML,MAAM+B,QJ/Ba,GIgChC,EAAKkE,MAAM9G,OAAO,EAAKkB,MAAML,MAAO,EAAKK,MAAMqE,QAEhDqJ,I,EAOH5O,OAAS,WACH,EAAKkB,MAAML,MAAM+B,QJ1Ca,GI2ChC,EAAKkE,MAAM9G,OAAO,EAAKkB,MAAML,MAAO,EAAKK,MAAMqE,O,EAInD4B,cAAgB,SAAA8J,GACd,EAAKtK,SAAS,CACZ9F,MAAOoQ,EAAMC,OAAOlP,MACpBuD,KAAM,IAER,EAAKyL,oB,EAGPG,cAAgB,SAAAC,GACdA,EAAEC,iBACF,EAAKL,iBAAiBtJ,SACtB,EAAKf,SAAS,CACZpB,KAAM,IAER,EAAKvF,U,EAGP0P,WAAa,SAAAnK,GAAI,OACf,EAAKoB,SACH,CACEpB,QAEF,EAAKvF,S,EAGTkQ,cAAgB,SAAAzD,GAAM,gBAAO3M,EAAP,sBAAqC2M,EAAO3L,O,uDApClE,WACE4H,KAAK5B,MAAMnB,QACX+C,KAAK5B,MAAMxE,kBAAkBkO,M,oBAoC/B,WACE,OACE,uBAAKpH,UAAU,eAAf,UACE,8BACE,eAAC,IAAD,CAAkB1D,GAAG,wBAEvB,sBAAK0D,UAAU,QAAf,SAAwBV,KAAK5B,MAAMuC,QACnC,uBAAKD,UAAU,iBAAf,UACE,eAACkI,GAAA,EAAD,CAAMC,SAAU7I,KAAKyI,cAArB,SACE,gBAAC9G,EAAA,EAAD,CAAWjB,UAAU,iBAArB,UACE,sBAAKoI,IAAKC,GAAYC,IAAI,SAAStI,UAAU,gBAC7C,eAAC,KAAD,CACE1D,GAAG,iBACHgE,YAAahB,KAAK5B,MAAM7D,KAAKkG,cAAc,CACzCzD,GAAI,uCAEN1D,MAAO0G,KAAKxH,MAAML,MAClB2I,SAAUd,KAAKvB,cACfiC,UAAU,sBAIhB,uBAAKA,UAAU,gBAAf,UACE,sBAAKA,UAAU,cAAf,SACGV,KAAK5B,MAAMpG,QACV,eAACmP,GAAA,EAAD,CAAS8B,MAAM,OAAOC,KAAK,OAE3B3C,GAAWvG,KAAKxH,MAAML,MAAO6H,KAAK5B,MAAMpG,QAASgI,KAAK5B,MAAM3B,cAG/DuD,KAAK5B,MAAM3B,WAAa,GACvB,eAAC,GAAD,CACEkK,QAAS3G,KAAK5B,MAAM+K,aACpBjN,SAAU8D,KAAK5B,MAAM9B,SACrBiI,cAAeA,GACf7H,QAASsD,KAAK5B,MAAM1B,QACpBP,YAAa6D,KAAK5B,MAAMjC,YACxB6K,WAAYhH,KAAKgH,WACjBQ,cAAexH,KAAKwH,6B,GAxFVvF,IAAMC,WA6G1BC,GAAqB,CAAE7K,UAAQ2F,SAAOrD,qBAK7ByI,sBAhBS,SAAC,GAAD,IAAGC,EAAH,EAAGA,WAAwBpJ,EAA3B,EAAeD,SAAYC,QAA3B,MAA4C,CAClEoD,SAAUgG,EAAWhG,SACrBtE,QAASsK,EAAWtK,QACpB2I,MAAO2B,EAAWhK,aAClBoE,QAAS4F,EAAW5F,QACpBC,QAAS2F,EAAW3F,QACpBR,YAAamG,EAAWnG,YACxBM,WAAY6F,EAAW7F,WACvB0M,cAAqB,OAAPjQ,QAAO,IAAPA,OAAA,EAAAA,EAASI,OAAQ8P,KAAK5R,MAAM0B,EAAQI,OAAS8O,MAQrBjG,GAAzBE,CAA6CE,YAAW8F,KC3I1DgB,GACI,gBADJA,GAEC,aAFDA,GAGG,eAHHA,GAIG,eCAHvR,GACI,2BADJA,GAEG,0BAGVC,GAAe,CACnBC,SAAS,EACTsR,OAAQ,GACRhR,aAAc,GACdmE,WAAY,EACZ3D,EAAG,IAsDUP,GAnDC,WAAmC,IAAlCC,EAAiC,uDAAzBT,GAAcU,EAAW,uCAChD,OAAQA,EAAOC,MACb,KAAKhB,EAAQI,IACX,OAAO,2BACFU,GADL,IAEER,SAAS,EACTc,EAAGL,EAAOI,KAAKC,IAEnB,KAAKjB,EAAQC,IACX,OAAO,2BACFC,IADL,IAEEO,aAAcG,EAAOE,QAAQC,UAEjC,KAAKhB,EAAQE,IACX,IAAMwR,EAAS7Q,EAAOE,QAAQI,KAAKC,QACnC,OAAIP,EAAOI,KAAKC,IAAMN,EAAMM,EACnB,2BACFf,IADL,IAEEuR,SACA7M,WAAY6M,EAAOpP,SAGd,eACF1B,GAGT,KAAKV,GACH,OAAO,eACFC,IAEP,QACE,OAAOS,IC3BAsL,I,QAAmB,SAACC,EAAQrL,GACvC,IAAKqL,EACH,OAAON,GAET,IAAMO,EAAOD,EAAOE,YAAcF,EAAOE,WAAW9G,MAAK,SAAA+G,GAAC,OAAIA,EAAEzE,KAAK2E,gBAAkB1L,EAAK0L,iBAC5F,OAAQJ,GAAQA,EAAK1K,OAAUmK,KAGpBc,GAAgB,SAAClE,EAAQmE,EAAQjK,GAC5C,IAAMgP,EAAQlJ,EAAOmJ,YAAcnJ,EAAOmJ,WAAWtO,MAAM,KAC3D,OAAQsJ,GACN,KAAK5B,GACH,OAAOvC,GAAUA,EAAOyF,WAAaxL,EAAWC,EAAM,IAAIqF,KAAKS,EAAOyF,YACxE,KAAKjD,GACH,OAAOxC,GAAUA,EAAOoJ,WAAanP,EAAWC,EAAM,IAAIqF,KAAKS,EAAOoJ,YACxE,KAAKxG,GACH,OAAOsG,GAASA,EAAM,GACxB,KAAKrG,GACH,OAAOqG,IAAUA,EAAMrP,OAAS,EAAIqP,EAAM,GAAK9F,IACjD,KAAKf,GACH,OAAOrC,EAAOmJ,WAChB,KAAKxG,GACL,KAAKP,GACH,OAAOpC,IAAWA,EAAOqJ,mBAAqBrJ,EAAOsJ,kBACvD,KAAK7G,GACH,IAAMwB,EAAcR,GAAiBzD,EAAQ8C,IAC7C,OAAOyB,aAAsBP,GAA2BC,KAAiBA,EAE3E,KAAKvB,GACH,OAAOe,GAAiBzD,EAAQ+C,IAClC,KAAKT,GACH,OAAOtC,IAAWiD,GAAYjD,EAAO6E,SAAW7E,EAAO6E,QACzD,QACE,OAAOxB,GAAarD,GAAUA,EAAOmE,MC7BrCoF,G,4MACJpR,MAAQ,CACNL,MAAO,GACP0E,KAAM,G,EAGRyL,iBAAmBzK,IAAEC,UAAS,SAAA4K,GACxB,EAAKlQ,MAAML,MAAM+B,QR/Ba,GQgChC,EAAKkE,MAAM9G,OAAO,EAAKkB,MAAML,SAE9B+N,I,EAMH5O,OAAS,WACH,EAAKkB,MAAML,MAAM+B,QRzCa,GQ0ChC,EAAKkE,MAAM9G,OAAO,EAAKkB,MAAML,Q,EAIjCsG,cAAgB,SAAA8J,GACd,EAAKtK,SAAS,CACZ9F,MAAOoQ,EAAMC,OAAOlP,MACpBuD,KAAM,IAER,EAAKyL,oB,EAGPG,cAAgB,SAAAC,GACdA,EAAEC,iBACF,EAAKL,iBAAiBtJ,SACtB,EAAKf,SAAS,CACZpB,KAAM,IAER,EAAKvF,U,EAGP0P,WAAa,SAAAnK,GAAI,OACf,EAAKoB,SAAS,CACZpB,U,EAGJ2K,cAAgB,SAAAzD,GAAM,gBAAO3M,EAAP,sBAAqC2M,EAAO3L,KAA5C,sB,uDAhCtB,WACE4H,KAAK5B,MAAMnB,U,oBAiCb,WACE,OACE,uBAAKyD,UAAU,iBAAf,UACE,8BACE,eAAC,IAAD,CAAkB1D,GAAG,0BAEvB,sBAAK0D,UAAU,QAAf,SAAwBV,KAAK5B,MAAMuC,QACnC,uBAAKD,UAAU,iBAAf,UACE,eAACkI,GAAA,EAAD,CAAMC,SAAU7I,KAAKyI,cAArB,SACE,gBAAC9G,EAAA,EAAD,CAAWjB,UAAU,mBAArB,UACE,sBAAKoI,IAAKC,GAAYC,IAAI,SAAStI,UAAU,gBAC7C,eAAC,KAAD,CACE1D,GAAG,mBACHgE,YAAahB,KAAK5B,MAAM7D,KAAKkG,cAAc,CACzCzD,GAAI,yCAEN1D,MAAO0G,KAAKxH,MAAML,MAClB2I,SAAUd,KAAKvB,cACfiC,UAAU,sBAIhB,uBAAKA,UAAU,kBAAf,UACE,sBAAKA,UAAU,cAAf,SACGV,KAAK5B,MAAMpG,QACV,eAACmP,GAAA,EAAD,CAAS8B,MAAM,OAAOC,KAAK,OAE3B3C,GAAWvG,KAAKxH,MAAML,MAAO6H,KAAK5B,MAAMpG,QAASgI,KAAK5B,MAAM3B,cAG/DuD,KAAK5B,MAAM3B,WAAa,GACvB,eAAC,GAAD,CACEkK,QAAS3G,KAAK5B,MAAM+K,aAAajO,MAAM,KAEvCgB,SAAUD,GAAO+D,KAAK5B,MAAMyL,WAAY7J,KAAKxH,MAAMqE,MACnD0H,cAAeA,GACf7H,QAASsD,KAAK5B,MAAM3B,YAAcuD,KAAKxH,MAAMqE,KAAO,GAAKb,GACzDG,YAAa6D,KAAKxH,MAAMqE,KACxBmK,WAAYhH,KAAKgH,WACjBQ,cAAexH,KAAKwH,6B,GArFRvF,IAAMC,WA0G5BC,GAAqB,CAAE7K,OF9EP,SAAAwB,GACpB,IAAMW,EAAU,uCAAmCX,GAAK,IACxD,MAAO,CACLJ,KAAMZ,GACNa,QAASe,IAAMC,IAAIF,GACnBZ,KAAM,CACJC,OEwE+BmE,MFnEhB,iBAAO,CAC1BvE,KAAMZ,MEuEOuK,sBAhBS,SAAC,GAAD,IAAGyH,EAAH,EAAGA,UAAWC,EAAd,EAAcA,KAAd,MAA0B,CAChDF,WAAYC,EAAUR,OACtBtR,QAAS8R,EAAU9R,QACnB2I,MAAOmJ,EAAUxR,aACjBoE,QAASoN,EAAUpN,QACnBC,QAASmN,EAAUnN,QACnBR,YAAa2N,EAAU3N,YACvBM,WAAYqN,EAAUrN,WACtB0M,aAAeY,EAAKC,2BAA6BD,EAAKC,2BAA8B3G,MAQ9ClB,GAAzBE,CAA6CE,YAAWqH,K,sDCxIxD,OAA0B,qBCA1B,OAA0B,4B,qBCA5BK,GAAwB,wCCMxBnS,GACD,wBADCA,GAEW,oCAFXA,GAGK,8BAHLA,GAImB,2CAG1BC,GAAe,CACnBC,SAAS,EACTmB,SAAS,EACTP,QAAS,KACTsR,OAAQ,GACRlN,GAAI,KACJmN,uBAAwB,IA4CpBC,GAAkB,SAAA7N,GAAY,IAAD,EAC3B8N,EAAc,UAAG9N,EAAQ+N,iBAAX,aAAG,EAAmBC,QAAO,SAAAC,GAAQ,QAAMA,EAASC,oBAAsBD,EAASE,eACjGC,EAAa,OAAGN,QAAH,IAAGA,OAAH,EAAGA,EAAgB1L,KAAI,SAAA6L,GAAQ,MAAK,CACrDC,iBAAkBD,EAASC,iBAC3BG,gBAAiBJ,EAASE,YAAYpR,UAElCuR,EAAQ,2BACTtO,GADS,IAEZoO,kBAQF,OANKE,EAAS/E,WAGZ+E,EAASC,oBAAqB,EAC9BD,EAAS/E,UAAY+E,EAAS/E,UAAU7K,cAAcC,MAAM,KAAK,IAHjE2P,EAAS/E,UAAY,KAKhB+E,GAsDMtS,GA/GC,WAAmC,IAAD,MAAjCC,EAAiC,uDAAzBT,GAAcU,EAAW,uCAChD,OAAQA,EAAOC,MACb,KAAKhB,EAAQI,IACb,KAAKJ,EAAQI,IACb,KAAKJ,EAAQI,IACX,OAAO,2BACFU,GADL,IAEER,SAAS,IAEb,KAAKH,EAAQC,IACb,KAAKD,EAAQC,IACX,IAAM6I,EAAK,UAAGlI,EAAOE,QAAQoS,SAAShS,YAA3B,aAAG,EAA8B4H,MACxC/H,EAAO,OAAG+H,QAAH,IAAGA,OAAH,EAAGA,EAAO/H,QAErB,OADAA,GAAiB,QAAP,EAAAA,SAAA,mBAASsC,MAAM,YAAY,UAA3B,eAA+B8P,QAAQ,IAAK,MAAOpS,EACtD,2BACFb,IADL,IAEEoB,SAAS,EACTnB,SAAS,EACTkS,OAAUtR,EAAU,CAACA,GAAW,CAACqR,MAErC,KAAKrS,EAAQE,IACb,KAAKF,EAAQE,IAAb,IACUiB,EAASN,EAAOE,QAAhBI,KACR,OAAO,2BACFP,GADL,IAEEW,SAAS,EACTnB,SAAS,EACTgF,GAAIjE,IAER,KAAKnB,EAAQE,IACX,OAAO,2BACFU,GADL,IAEE2R,uBAAwB1R,EAAOE,QAAQI,KAAKC,QAC5ChB,SAAS,IAEb,QACE,OAAOQ,ICrDAV,GACI,wBADJA,GAEG,uBAFHA,GAGC,qBAHDA,GAIe,mCAGtBC,GAAe,CACnBC,SAAS,EACTsR,OAAQ,GACRhR,aAAc,GACdoE,SAAS,EACTC,SAAS,EACTR,YAAa,EACbM,WAAY,EACZ4D,OAAQ,KACR4K,oBAAqB,MAiEVC,GAAY,SAAAlO,GACvB,IAAMvD,EAAU,qCAAiCuD,EAAjC,sBAHG,kGAGH,KAChB,MAAO,CACLtE,KAAMZ,GACNa,QAASe,IAAMC,IAAIF,KAgBRlB,GAlFC,WAAmC,IAAlCC,EAAiC,uDAAzBT,GAAcU,EAAW,uCAChD,OAAQA,EAAOC,MACb,KAAKhB,EAAQI,IACX,OAAO,2BACFU,GADL,IAEER,SAAS,IAEb,KAAKN,EAAQI,IACX,OAAO,2BACFU,GADL,IAEEyS,oBAAqB,OAEzB,KAAKpT,EAAQC,IACX,OAAO,2BACFC,IADL,IAEEO,aAAcG,EAAOE,QAAQC,UAEjC,KAAKhB,EAAQE,IACX,IAAMoF,EAAQzE,EAAOE,QAAQI,KAAKmE,MAC5BL,EAAOpE,EAAOI,KAAKsD,aAAe,EAClCmN,EAAS7Q,EAAOE,QAAQI,KAAKC,SAAW,GAC9C,OAAO,2BACFjB,IADL,IAEEuR,OAAiB,IAATzM,EAAayM,EAAb,uBAA0B9Q,EAAM8Q,QAAhC,aAA2CA,IACnD5M,QAASQ,KAAWA,EAAMC,MAAK,SAAAC,GAAI,MAAiB,SAAbA,EAAKC,OAC5CV,QAASO,KAAWA,EAAMC,MAAK,SAAAC,GAAI,MAAiB,SAAbA,EAAKC,OAC5CZ,WAAYhE,EAAOE,QAAQI,KAAK0D,WAChCN,YAAa1D,EAAOI,KAAKsD,cAE7B,KAAKvE,EAAQE,IACX,OAAO,2BACFU,GADL,IAEE6H,OAAQ5H,EAAOE,QAAQI,OAE3B,KAAKnB,EAAQE,IACX,OAAO,2BACFU,GADL,IAEEyS,oBAAqBxS,EAAOE,QAAQI,KAAKC,UAE7C,KAAKlB,GACH,OAAO,eACFC,IAEP,QACE,OAAOS,I,oBClEA2S,GAAiB,SAAC5Q,EAAMiE,EAAO4M,EAAWC,GACrD,IAAIrK,EACFxC,GACAjE,EAAKkG,cAAc,CACjBzD,GAAI,0BAA4BoO,KAElCA,EASF,OARIC,IACFrK,EAAc,CACZA,EACAzG,EAAKkG,cAAc,CACjBzD,GAAI,qCAENsO,KAAK,MAEFtK,GAGIuK,GAAsB,SAACnN,EAAoB4C,GAAiB,IAC/DwK,EAAoFpN,EAApFoN,MAAOC,EAA6ErN,EAA7EqN,UAAWC,EAAkEtN,EAAlEsN,QAASpS,EAAyD8E,EAAzD9E,MAAOwH,EAAkD1C,EAAlD0C,SAAUvE,EAAwC6B,EAAxC7B,QAASoP,EAA+BvN,EAA/BuN,gBAAiBC,EAAcxN,EAAdwN,UACtEnM,EAAyB+L,EAAzB/L,KAAM4L,EAAmBG,EAAnBH,SAAU3S,EAAS8S,EAAT9S,KACxB,MAAO,CACL+G,OACAzC,GAAIyC,EACJuB,cACA1H,MAAgB,MAATA,EAAgBA,EAAQiD,EAAQkD,GACvCqB,SAAUA,GAAY+K,GAAiBtP,EAASkD,EAAMkM,GACtDN,WACA3K,UAAW,iBAAmBgL,GAAWD,EAAY,UAAY,IACjE/S,KAAMA,GAAQ,OACdkT,YAAaA,GAAaA,IAIjBE,GAAW,SAACvP,EAASoH,EAAMoI,EAAUzS,GAChDiD,EAAQoH,GAAQrK,EAChByS,EAASxP,IAGEsP,GAAmB,SAACtP,EAASoH,EAAMoI,GAAhB,OAA6B,SAAAxD,GAAK,OAChEuD,GAASvP,EAASoH,EAAMoI,EAAUxD,GAASA,EAAMC,OAASD,EAAMC,OAAOlP,MAAQiP,KC9BpEyD,GAAU,SAAC5N,GAA0B,IACxCwC,EAAoDxC,EAApDwC,QAASmD,EAA2C3F,EAA3C2F,OAAQqH,EAAmChN,EAAnCgN,UAAWQ,EAAwBxN,EAAxBwN,UAAW9K,EAAa1C,EAAb0C,SACzCmL,EAAiB,SAAA3S,GAAK,OAAI,SAAA4S,GAAG,OAAIpL,EAASxH,KAEhD,OACE,qCACGuE,IAAEc,IAAIiC,GAAW,IAAI,SAACuL,EAAQ5E,GAC7B,IAAMjO,OAAyBuO,IAAjBsE,EAAO7S,MAAsB6S,EAAO7S,MAAQ6S,EACpD3N,OAAyBqJ,IAAjBsE,EAAO3N,MAAsB2N,EAAO3N,MAAQ2N,EAC1D,OACE,eAACxK,EAAA,EAAD,CAAWC,OAAK,EAACC,QAAM,EAAyBnB,UAAU,OAA1D,SACE,eAACoB,EAAA,EAAD,yBACEC,QAASkK,EAAe3S,GACxBoH,UAAS,8BAAyBqD,EAAOqH,KAAe9R,EAAQ,SAAW,OACpEsS,GACLrE,IAAM3G,EAAQ1G,OAAS,GAAK,CAC1B0R,cALN,aAQGpN,MATL,iBAAuClF,UCX3C0S,G,4MACJlL,SAAW,SAAAxH,GAAK,OAAIwS,GAAS,EAAK1N,MAAM7B,QAAS,EAAK6B,MAAMoN,MAAM/L,KAAM,EAAKrB,MAAMuN,gBAAiBrS,I,EAEpG8S,OAAS,WAAO,IAAD,EAC8D,EAAKhO,MAAxE7D,EADK,EACLA,KAAMiR,EADD,EACCA,MAAOC,EADR,EACQA,UAAW/K,EADnB,EACmBA,UAAWnE,EAD9B,EAC8BA,QAASmP,EADvC,EACuCA,QAASE,EADhD,EACgDA,UACrDhL,EAAY4K,EAAZ5K,QACFyL,IAAa9P,EAAQiP,EAAM/L,MACjC,OACE,uBAAKiB,UAAS,UAAKA,GAAnB,UACE,eAAC,GAAD,CAAgBE,QAASA,EAASmD,OAAQxH,EAAS6O,UAAWI,EAAM/L,KAAMqB,SAAU,EAAKA,SAAU8K,UAAWA,IAC7GF,GAAWD,GACV,uBAAM/K,UAAU,oBAAhB,SACGnG,EAAKkG,cAAc,CAClBzD,GAAIqP,EAAWb,EAAMlT,cAAN,0BAAH,mC,YAbJ2J,IAAMC,WA6BbG,sBAPS,iBAAO,KAEJ,GAKZA,CAA6CE,YAAWyJ,KCnBxDzJ,oBAXf,SAAyBnE,GAA+B,IAC9C7D,EAAmC6D,EAAnC7D,KAAM8R,EAA6BjO,EAA7BiO,SAAUzT,EAAmBwF,EAAnBxF,QAAS4S,EAAUpN,EAAVoN,MACjC,OACE,uBAAM9K,UAAU,oBAAhB,SACGnG,EAAKkG,cAAc,CAClBzD,GAAIpE,IAAYyT,EAAWb,EAAMlT,cAAN,0BAAH,mC,qBCF1BgU,G,4MACJnL,WAAa,SAAC5E,EAAS6O,GACrB,QAAImB,GAA2BC,SAASpB,MAC7B7O,EAAQkQ,K,EAKrBL,OAAS,WAAO,IAAD,EACmE,EAAKhO,MAA7E7D,EADK,EACLA,KAAMiR,EADD,EACCA,MAAOC,EADR,EACQA,UAAWC,EADnB,EACmBA,QAAShL,EAD5B,EAC4BA,UAAWpH,EADvC,EACuCA,MAAOiD,EAD9C,EAC8CA,QAAS3D,EADvD,EACuDA,QAC5D6G,EAAsC+L,EAAtC/L,KAAM4L,EAAgCG,EAAhCH,SAAU3S,EAAsB8S,EAAtB9S,KAAM8F,EAAgBgN,EAAhBhN,MAAOkO,EAASlB,EAATkB,KAC/BL,IAAa/S,KAAWiD,EAAQiP,EAAM/L,MACtCuB,EAAcmK,GAAe5Q,EAAMiE,EAAOiB,EAAM4L,GAChDjN,EAAQmN,GAAoB,EAAKnN,MAAO4C,GAU9C,OARA5C,EAAK,SAAe,EAAK+C,WAAW5E,EAASkD,GAC7CrB,EAAM,eAAiB,EAAKA,MAAM,gBAAkBqB,EAEvC,WAAT/G,IAEF0F,EAAK,QAAc,SAInB,uBAAKsC,UAAS,UAAKA,EAAL,oBAAd,UACE,eAAC,KAAD,2BAAetC,GAAf,IAAsBsO,KAAMA,EAAMC,SAAU,KAAMrT,MAAO8E,EAAM9E,MAAOwH,SAAU1C,EAAM0C,YACrFuL,GAAY,uBAAM3L,UAAU,cAAhB,SAA+BM,IAC3C0K,GAAWD,GAAa,eAAC,GAAD,CAAiBY,SAAUA,EAAUb,MAAOA,EAAO5S,QAASA,Q,YA3BzEqJ,IAAMC,WAwCXG,sBAPS,iBAAO,KAEJ,GAKZA,CAA6CE,YAAW+J,KCzCjEM,G,4MACJC,SAAW,SAAAd,GACT,EAAK9N,SAAS,CACZyN,SAAS,IAEXK,K,EAGFe,iBAAmB,SAACC,EAAiB/L,GAAiB,IAC5CgM,EAAkB,EAAK5O,MAAvB4O,cACApM,EAAYmM,EAAZnM,QACFqM,EAAOD,GAAiBpM,EAC9B,GAAMqM,EACJ,OACE,uCAEI,yBAAQ3T,MAAM,GAAG0I,UAAQ,EAACX,UAAQ,EAAC6L,QAAM,EAAzC,SACGlM,IAGJiM,EAAKtO,KAAI,SAAAwN,GAAM,OACd,yBAAQ7S,MAAO6S,EAAO7S,OAAS6S,EAA/B,SACGA,EAAO3N,OAAS2N,GADnB,iBAAsDA,EAAO7S,OAAS6S,W,EAShFC,OAAS,WAAO,IAAD,EAC0D,EAAKhO,MAApEoN,EADK,EACLA,MAAOC,EADF,EACEA,UAAWC,EADb,EACaA,QAAShL,EADtB,EACsBA,UAAWpH,EADjC,EACiCA,MAAOiD,EADxC,EACwCA,QAAShC,EADjD,EACiDA,KACtDkF,EAA0B+L,EAA1B/L,KAAM4L,EAAoBG,EAApBH,SAAU7M,EAAUgN,EAAVhN,MAClB6N,IAAa/S,KAAWiD,EAAQiP,EAAM/L,MACtCuB,EAAcmK,GAAe5Q,EAAMiE,EAAOiB,EAAM4L,GAChDjN,EAAQmN,GAAoB,EAAKnN,MAAO4C,GACxCmM,EAAa,EAAK/O,MAAM,gBAAkBqB,EAEhD,OACE,uBAAKiB,UAAS,UAAKA,EAAL,oBAAd,UACE,eAAC,KAAD,2BACMtC,GADN,IAEEsC,UAAW,iBAAmBgL,GAAWD,EAAY,WAAa,MAASnS,GAAUiD,EAAQkD,GAAwB,GAAhB,eACrG/G,KAAK,SACL0U,cAAaD,EAJf,SAMG,EAAKL,iBAAiBtB,EAAOxK,MAE/BqL,GAAY,uBAAM3L,UAAU,cAAhB,SAA+BM,IAC3C0K,GAAWD,GAAa,eAAC,GAAD,CAAiBY,SAAUA,EAAUb,MAAOA,Q,YAjDxDvJ,IAAMC,WA8DZG,sBAPS,iBAAO,KAEJ,GAKZA,CAA6CE,YAAWqK,KC1ExD,wrBCAA,4jBCIF9U,GACa,0CADbA,GAEe,4CAGtBC,GAAe,CACnBC,SAAS,EACTqV,kBAAmB,GACnB/U,aAAc,IA0CDC,GAvCC,WAAmC,IAAlCC,EAAiC,uDAAzBT,GAAcU,EAAW,uCAChD,OAAQA,EAAOC,MACb,KAAKhB,EAAQI,IACX,OAAO,2BACFU,GADL,IAEER,SAAS,IAEb,KAAKH,EAAQC,IACX,OAAO,2BACFC,IADL,IAEEO,aAAcG,EAAOE,QAAQC,UAEjC,KAAKhB,EAAQE,IACX,OAAO,2BACFC,IADL,IAEEsV,kBAAmB5U,EAAOE,QAAQI,KAAKC,UAE3C,KAAKlB,GACH,OAAO,eACFC,IAEP,QACE,OAAOS,I,UCrBP8U,GAAoB,mBAEpBC,GAAwB,CAC5B9N,KAAM,mBACN4L,UAAU,EACV3S,KAAM,UAGF8U,GAAmB,CACvB/N,KAAM,cACN4L,UAAU,GAGCoC,GAAY,CAACF,GAAuBC,IAQ3CE,GAAgB,CACpBjD,iBAAkB,GAClBC,YAAa,KACbiD,iBAAkB,IASdC,G,4MACJpV,MAAQ,CACNqV,cAAe,GACfvD,UAAW,GACXqD,iBAAkB,I,EAGpB/P,YAAcC,IAAEC,UAAS,SAAA4K,GACvB,EAAKtK,MAAM9G,OAAO,EAAKkB,MAAMmV,oBAC5B,K,EAgBHG,YAAc,WAAO,IACXxD,EAAc,EAAK9R,MAAnB8R,UACRA,EAAUpL,KAAV,eAAoBwO,KACpB,EAAKzP,SAAS,CACZqM,e,EAIJyD,wBAA0B,kBACxB,EAAK3P,MAAMiP,kBACR9C,QAAO,SAAAE,GAAgB,OAAKA,EAAiBuD,WAC7CC,SAAQ,SAAAxD,GAAgB,MAAI,CAC3B,CACEnR,MAAOmR,EAAiBrS,KAAO,KAC/BoG,MAAOiM,EAAiByD,eAE1B,CACE5U,MAAOmR,EAAiBrS,KAAO,KAC/BoG,MAAOiM,EAAiB0D,oB,EAIhCC,eAAiB,SAAAC,GAAK,OAAI,WAAO,IACvB/D,EAAc,EAAK9R,MAAnB8R,UACJA,EAAUpQ,OAAS,GACrBoQ,EAAUgE,OAAOD,EAAO,GAE1B,EAAKpQ,SAAS,CACZqM,gB,EAIJiE,cAAgB,SAACF,EAAOjD,GAAR,OAAsB,SAAA7C,GAAK,OAAI,EAAKzH,SAASuN,EAAOjD,EAArB,CAAgC7C,EAAMC,OAAOlP,S,EAE5FkV,oBAAsB,SAACH,EAAO/U,EAAOgR,GACnCA,EAAU+D,GAAOV,iBAAmBrU,EACpC,EAAK2E,SAAS,CACZqM,YACAqD,iBAAkBrU,K,EAItBwH,SAAW,SAACuN,EAAOjD,GAAR,OAAsB,SAAA9R,GAAU,IACjCgR,EAAc,EAAK9R,MAAnB8R,UADgC,EAEH,EAAKlM,MAAlC7B,EAFgC,EAEhCA,QAASoP,EAFuB,EAEvBA,gBACbP,IAAckC,IAChB,EAAKkB,oBAAoBH,EAAO/U,EAAOgR,GACvC,EAAK1M,gBAEL0M,EAAU+D,GAAOjD,GAAa9R,EAC9B,EAAK2E,SAAS,CACZqM,eAGJ/N,EAAQ+N,UAAYA,EACpBqB,EAAgBpP,K,EAGlB2E,QAAU,SAAAmN,GAAK,OAAI,SAAA3F,GAAM,IACf4B,EAAc,EAAK9R,MAAnB8R,UACFmE,EAAcnE,EAAU+D,GAAOb,GAAiB/N,MAClDgP,IACF,EAAKD,oBAAoBH,EAAOI,EAAYjQ,MAAO8L,GACnD,EAAKlM,MAAM9G,OAAOmX,EAAYjQ,U,EAIlCkQ,eAAiB,SAAAL,GAAU,IAEnB5O,EADgB,EAAKjH,MAAnB8R,UACe+D,GAAOV,iBAQ9B,OANElO,GAAQA,EAAKvF,QAAU,EACnB,EAAKkE,MAAM9B,SAASqC,KAAI,SAAApC,GAAO,MAAK,CAClCjD,MAAOiD,EAAQnE,KACfoG,MAAOjC,EAAQ8D,OAAOzB,YAExB,I,EAIR4L,SAAW,SAACA,EAAU6D,GACpB,IAAMM,EAAyB,EAAKvQ,MAAM7D,KAAKkG,cAAc,CAC3DzD,GAAI,uCAEN,OACE,gBAAC2E,EAAA,EAAD,CAAWjB,UAAU,kCAArB,UACG+M,GAAUjB,SAASe,KAClB,eAAC,GAAD,2BACM,EAAKnP,OADX,IAEEoN,MAAO+B,GACPP,cAAe,EAAKe,0BACpBzU,MAAOkR,EAAS+C,GAAsB9N,MACtCqB,SAAU,EAAKyN,cAAcF,EAAOd,GAAsB9N,MAC1DmM,UAAW,QAGd6B,GAAUjB,SAASgB,KAClB,uBAAK9M,UAAS,4BAAd,UACE,eAAC,KAAD,CACEE,QAAS,EAAK8N,eAAeL,GAC7BxN,cAAe,EAAKC,SAASuN,EAAOf,IACpCxM,SAAU,EAAKA,SAASuN,EAAOb,GAAiB/N,MAChDiB,UAAU,yBACVK,gBAAgB,iBAChBC,YAAa2N,EACbrV,MAAOkR,EAASE,YAChBzJ,WAAYuJ,EAASmD,iBACrB/B,UAAWyC,EAAQ,IAAM,EAAK7V,MAAM8R,UAAUpQ,OAAS,EAAKkE,MAAMwN,UAAY,KAC9E1K,QAAS,EAAKA,QAAQmN,GACtBO,WAAS,OAEPpE,EAASE,eAAiBF,EAASmD,mBAAqB,uBAAMjN,UAAU,cAAhB,SAA+BiO,OAG/F,uBAAKjO,UAAU,mDAAf,UACE,sBAAKoI,IAAK+F,GAAM7F,IAAI,MAAMtI,UAAU,OAAOqB,QAAS,EAAK+L,cACzD,sBAAKhF,IAAKgG,GAAO9F,IAAI,SAASjH,QAAS,EAAKqM,eAAeC,Y,uDAlInE,WACErO,KAAK5B,MAAM2Q,uBACX/O,KAAK5B,MAAMnB,U,gCAGb,SAAmBiD,EAAsCC,EAAsCC,GAAiB,IACtG7D,EAAYyD,KAAK5B,MAAjB7B,QACJ2D,EAAU3D,UAAYA,GAAaA,GACrCyD,KAAK/B,SAAS,CACZqM,UAAW/N,EAAQ+N,WAAa/N,EAAQ+N,UAAUpQ,OAAS,EAAIqC,EAAQ+N,UAAY,CAAC,eAAKoD,S,oBA+H/F,WAAU,IAAD,OACP,OAAO,qCAAG7P,IAAEc,IAAIqB,KAAKxH,MAAM8R,WAAW,SAACE,EAAUjD,GAAX,OAAiB,EAAKiD,SAASA,EAAUjD,Y,GApJ3DtF,IAAMC,WA6JxBC,GAAqB,CACzB4M,qBDrKkC,WAElC,MAAO,CACLrW,KAAMZ,GACNa,QAASe,IAAMC,IAHD,iDCqKhBrC,UACA2F,UAMaoF,sBAdS,SAAC,GAAD,IAAGoI,EAAH,EAAGA,iBAAkBnI,EAArB,EAAqBA,WAArB,MAAuC,CAC7D+K,kBAAmB5C,EAAiB4C,kBACpC/Q,SAAUgG,EAAWhG,UAAY,MAYK6F,GAAzBE,CAA6CE,YAAWqL,KC1MjEoB,G,4MACJ5C,OAAS,WAAO,IAAD,EAC0D,EAAKhO,MAApE7D,EADK,EACLA,KAAMiR,EADD,EACCA,MAAOC,EADR,EACQA,UAAWC,EADnB,EACmBA,QAAShL,EAD5B,EAC4BA,UAAWpH,EADvC,EACuCA,MAAOiD,EAD9C,EAC8CA,QACnDkD,EAA0B+L,EAA1B/L,KAAM4L,EAAoBG,EAApBH,SAAU7M,EAAUgN,EAAVhN,MAClB6N,IAAa/S,KAAWiD,EAAQiP,EAAM/L,MACtCuB,EAAcmK,GAAe5Q,EAAMiE,EAAOiB,EAAM4L,GAChDjN,EAAK,2BACNmN,GAAoB,EAAKnN,MAAO4C,IAD1B,IAETI,gBAAiBJ,EACjBK,SAAmB,MAAT/H,EAAgBA,EAAQiD,EAAQkD,KAE5C,OACE,uBAAKiB,UAAS,UAAKA,EAAL,oBAAd,UACE,eAAC,IAAD,2BAAgBtC,GAAhB,IAAuBkD,eAAa,EAACC,mBAAiB,EAACC,kBAAgB,EAACC,aAAa,SAASC,WAAYrH,KACzGgS,GAAY,uBAAM3L,UAAU,cAAhB,SAA+BM,IAC3C0K,GAAWD,GAAa,eAAC,GAAD,CAAiBY,SAAUA,EAAUb,MAAOA,Q,YAfrDvJ,IAAMC,WA4BfG,sBAPS,iBAAO,KAEJ,GAKZA,CAA6CE,YAAWyM,KCzBjE1C,I,mNACI2C,SAAWhN,IAAMiN,Y,EAEzBC,gBAAkB,SAAAlO,GAChB,GAAIA,EAAW/G,OAAS,IAAMkV,aAAsBnO,GAClD,MAAO,sC,EAIXoO,eAAiB,SAAA/K,GAAW,OAAIA,GAAeA,EAAYgL,UAXpC,I,EAavBlD,OAAS,WAAO,IAAD,EAC0D,EAAKhO,MAApE7D,EADK,EACLA,KAAMiR,EADD,EACCA,MAAOC,EADR,EACQA,UAAWC,EADnB,EACmBA,QAAShL,EAD5B,EAC4BA,UAAWpH,EADvC,EACuCA,MAAOiD,EAD9C,EAC8CA,QACnDkD,EAA0B+L,EAA1B/L,KAAM4L,EAAoBG,EAApBH,SAAU7M,EAAUgN,EAAVhN,MAClByC,EAAaoD,GAA2B/K,GAASiD,EAAQiP,EAAM/L,OAAS,IACxEuB,EAAcmK,GAAe5Q,EAAMiE,EAAOiB,EAAM4L,GAChDjN,EAAQmN,GAAoB,EAAKnN,MAAO4C,GACxC1I,EAAe,EAAK6W,gBAAgBlO,GACpCkM,EAAa,EAAK/O,MAAM,gBAAkBqB,EAEhD,OACE,uBAAKiB,UAAS,UAAKA,EAAL,oBAAd,UACE,eAAC,KAAD,2BACMtC,GADN,IAEE9E,MAAO2H,EACPH,SAAU,SAAAwD,GAAW,OAAIlG,EAAM0C,SAAS,EAAKuO,eAAe/K,KAC5DiL,IAAK,EAAKN,SACVO,eAAa,EACbC,iBAAkB,CAAE/O,UAAWtC,EAAMsC,WACrCA,UAAW,KACX0M,cAAaD,KAEdlM,EAAW/G,OAAS,GAAK,uBAAMwG,UAAU,cAAhB,SAA+BM,KACtD0K,GAAWD,GAAcnT,IAC1B,eAAC,GAAD,CAAiB+T,SAAUpL,EAAW/G,OAAS,EAAGtB,QAASN,EAAckT,MAAOA,Q,YAlCtEvJ,IAAMC,YAgDXG,sBAPS,iBAAO,KAEJ,GAKZA,CAA6CE,YAAW+J,KCvDjEoD,GAAgBpD,GAmBTqD,GAAe,CAC1BC,QAAS5D,GACT6D,OAAQjD,GACRkD,OAAQxD,GACRyD,KAAMzD,GACN0D,MAAOC,GACPzV,KAAMwU,GACN1E,UAAWsD,IASEsC,OANf,SAAe9R,GACb,IAAM1F,EAAO0F,EAAMoN,MAAM9S,MA/BA,OAgCnByX,EAAiBR,GAAajX,IAASgX,GAC7C,OAAO,eAACS,EAAD,eAAoB/R,KCpChBtG,GACO,4BADPA,GAEG,wBAFHA,GAGmB,wCAHnBA,GAII,yBAGXC,GAA+B,CACnCqY,kBAAkB,EAClBC,UAAW,GACX/X,aAAc,GACdgY,uBAAwB,GACxBC,+BAA+B,EAC/BpX,SAAS,EACTqX,iBAAiB,EACjBnS,SAAU,MAsDCoS,GAAkB,SAAC3X,GAC9B,IAAMW,EAAU,sCAAoCX,EAAI,MAAQA,EAAI,IACpE,MAAO,CACLJ,KAAMZ,GACNa,QAASe,IAAMC,IAAIF,KAmBRlB,GA1EC,WAA8C,IAA7CC,EAA4C,uDAApCT,GAAcU,EAAsB,uCAC3D,OAAQA,EAAOC,MACb,KAAKhB,EAAQI,IACX,OAAO,2BACFU,GADL,IAEE4X,kBAAkB,IAEtB,KAAK1Y,EAAQI,IACX,OAAO,2BACFU,GADL,IAEEgY,iBAAiB,IAErB,KAAK9Y,EAAQI,IACX,OAAO,2BACFU,GADL,IAEE+X,+BAA+B,IAEnC,KAAK1Y,EAAQC,IACX,OAAO,2BACFU,GADL,IAEEF,aAAcG,EAAOE,QAAQC,UAEjC,KAAKhB,EAAQE,IACX,OAAO,2BACFU,GADL,IAEE4X,kBAAkB,EAClBC,UAAW5X,EAAOE,QAAQI,KAAKC,UAEnC,KAAKpB,EAAQE,IACX,OAAO,2BACFU,GADL,IAEEgY,iBAAiB,EACjBnS,SAAU5F,EAAOE,QAAQI,KAAKC,QAAQ,KAE1C,KAAKpB,EAAQE,IACX,OAAO,2BACFU,GADL,IAEE+X,+BAA+B,EAC/BD,uBAAwB7X,EAAOE,QAAQI,KAAKC,UAEhD,KAAKpB,EAAQE,IACX,OAAO,2BACFU,GADL,IAEEW,SAAS,IAEb,QACE,OAAOX,IChCAkY,GAA0B,YAE1BC,GAAuB,YACvBC,GAAmB,QACnBnE,GAAkB,YAClBF,GAA6B,CAAC,iBAAkB,mBAEhDsE,GAAb,4MACErY,MAAQ,CACNqV,cAAe,GACfiD,YAAa,IAHjB,EAqBEC,mBAAqB,WAAO,IAClBC,EAAmB,EAAK5S,MAAxB4S,gBACcA,EAAeC,OAASD,EAAeC,OAAOtS,KAAI,SAAA6M,GAAK,OAAIA,EAAM0F,gBAAc3G,QAAO,SAAA4G,GAAE,QAAMA,KAAM,IACxG3E,SAASkE,KACzB,EAAKtS,MAAMqS,mBAzBjB,EA6BEW,WAAa,SAAA5F,GAAU,IAAD,IACoBA,EAAhC0F,oBADY,MACG/K,GADH,EAEZkK,EAAc,EAAKjS,MAAnBiS,UAFY,EAGG7E,EAAjB5K,eAHc,MAGJ,GAHI,EAKpB,OAAIsQ,IAAiBR,IAA2BL,EACvCA,EAAU1R,KAAI,SAAA0S,GAAC,MAAK,CACzB/X,MAAO+X,EAAEjZ,KACToG,MAAO6S,EAAEzS,cAEN,UAAI,EAAKR,MAAM8S,UAAf,aAAI,EAA0BhX,UACnC0G,EAAU,EAAKxC,MAAM8S,IAGhBtQ,IA3CX,EA8CE0Q,aAAe,SAAA9F,GAAU,IACfwF,EAAmB,EAAK5S,MAAxB4S,eACFrK,EAAUqK,EAAerK,SAAWqK,EAAerK,QAAQlP,WACjE,MAAgB,MAAZkP,EACK,YACc,MAAZA,EACF,WACc,MAAZA,EACF,WACc,MAAZA,EACF,WAEU,YAAf6E,EAAM9S,KACD,YAEF,YA7DX,EAiEE6Y,cAAgB,SAAA/F,GAAU,IAElBlS,EADc,EAAK8E,MAAjB7B,QACciP,EAAM/L,MACtB+R,EAAwB,EAAKC,yBAAyBjG,GACtDkG,EAAQlG,EAAMkG,QAAN,OAAeF,QAAf,IAAeA,OAAf,EAAeA,EAAuB1W,QAChD2Q,EAAYD,EAAMH,WAAa/R,EAMnC,GAJIkS,EAAM9S,OAASkY,IAAsBtX,IACvCmS,GAAa2D,aAAsB/K,GAA2B/K,KAG5DoY,EAAO,CACT,IAAMC,EAAK,IAAIC,OAAOF,GAEtBjG,MADmBD,EAAMH,UAAYmG,EAAsBnG,YAC/B/R,KAAiBqY,EAAGE,KAAKvY,GAGvD,IAAImT,KAAoBjB,EAAM/L,MAAQ8M,GAA2BC,SAAShB,EAAM/L,QAEzD8M,GAA2BuF,OAAM,SAAA1G,GAAS,QAAM,EAAKhN,MAAM7B,QAAQ6O,MAGtF,OAAO,EAIX,OAAOK,GA3FX,EA8FEsG,gBAAkB,SAAAvG,GAEhB,QADoB,EAAKpN,MAAjB7B,QACSiP,EAAM/L,OAhG3B,EAmGEuS,SAAW,WAAyG,IAAxGf,EAAuG,uDAA9F,EAAK7S,MAAM4S,eAAeC,OAAQgB,EAA4D,uDAA3CpU,IAAE0M,OAAO0G,EAAQ,EAAKc,iBACtFlE,EAAgBhQ,IAAE0M,OAAO0G,EAAQ,EAAKM,eACtCT,EAAW,uBAAO,EAAKtY,MAAMsY,aAAlB,aAAkCmB,IACnD,EAAKhU,SAAS,CACZ4P,gBACAiD,gBAEF,IAAMoB,EAAuC,IAAzBrE,EAAc3T,OAC5BiY,EAAcrB,EAAY5W,OAAS,EAEzC,OADA,EAAKkE,MAAMgU,YAAYF,EAAaC,GAC7BD,GA7GX,EAgHEG,uBAAyB,SAAA3J,GAAM,IACrBuI,EAAW,EAAK7S,MAAM4S,eAAtBC,OACR,GAAc,QAAVvI,EAAE4J,IACJ,GAAI5J,EAAE6J,SACA,EAAKnU,MAAMoU,WAAa,GAC1B,EAAKpU,MAAMqU,QAAQ,EAAKrU,MAAMoU,WAAa,OAExC,CACL,IAAMxK,EAAU,EAAKgK,SAASf,EAAQA,GACtCvI,EAAEC,iBACEX,GACF,EAAK5J,MAAMqU,QAAQ,EAAKrU,MAAMoU,WAAa,KA3HrD,EAiIEf,yBAA2B,SAAAjG,GAAK,OAAI,EAAKpN,MAAM+L,uBAAuBhN,MAAK,SAAAzE,GAAI,OAAIA,EAAK+G,OAAS+L,EAAM/L,MAAQ/G,EAAKoC,WAjItH,uDAME,WACEkF,KAAK+Q,qBACL/Q,KAAKgS,aART,gCAWE,SAAmB9R,EAAiCC,EAAiCC,GAC/EF,EAAU8Q,iBAAmBhR,KAAK5B,MAAM4S,gBAC1ChR,KAAK+Q,qBAGH7Q,EAAU3D,UAAYyD,KAAK5B,MAAM7B,SACnCyD,KAAKgS,aAjBX,oBAmIE,WAAU,IAAD,SAC6BhS,KAAK5B,MAAjC4S,EADD,EACCA,eAAgBzU,EADjB,EACiBA,QADjB,EAEgCyD,KAAKxH,MAApCqV,EAFD,EAECA,cAAeiD,EAFhB,EAEgBA,YAEvB,OACE,uCACE,uBAAKpQ,UAAU,cAAf,UACE,uBAAKA,UAAU,aAAf,UACE,8BAAKsQ,EAAe0B,QACpB,6BAAI1B,EAAe2B,cAErB,eAAChR,EAAA,EAAD,CAAWjB,UAAU,4BAArB,SACG7C,IAAEc,IAAIqS,EAAeC,QAAQ,SAACzF,EAAOjE,GACpC,IAAMyF,EAAgB,EAAKoE,WAAW5F,GAChCoH,EAAkB,GAClBpB,EAAwB,EAAKC,yBAAyBjG,GAU5D,OARIjE,IAAMyJ,EAAeC,OAAO/W,OAAS,GAAMsR,EAAM/L,OAASgN,IAAqBlQ,EAAQkQ,OACzFmG,EAAgBhH,UAAY,EAAKyG,wBAG/Bb,IACFoB,EAAgBha,QAAU4Y,EAAsBqB,mBA/J5B,cAkKfrH,EAAM9S,KACX,oBAAGgI,UAAW8K,EAAMsH,OAAS,iDAA7B,SACGtH,EAAMhN,OADT,gBAA6F+I,IAI7F,wBAAC,GAAD,2BACM,EAAKnJ,OADX,IAEEoN,MAAOA,EACPC,YAAaoC,EAAc1Q,MAAK,SAAA4V,GAAC,OAAIA,EAAC,OAAavH,EAAM/L,QACzDiM,UAAWoF,EAAY3T,MAAK,SAAA4V,GAAC,OAAIA,EAAC,OAAavH,EAAM/L,QACrDiB,UAAW,EAAK4Q,aAAa9F,GAC7BwB,cAAeA,EACfsF,IAAG,gBAAW/K,GACd6F,cAAa5B,EAAM/L,MACfmT,WAjCoB5B,EAAevR,MAuChDO,KAAK5B,MAAM4U,YAAqC,IAAzBnF,EAAc3T,eAhL9C,GAA0B+H,IAAMC,WA0L1BC,GAAqB,CACzBsO,oBAMapO,sBAXS,SAAC,GAAD,MAAmB,CACzCgO,UADsB,EAAGhS,SACLgS,aAUkBlO,GAAzBE,CAA6CE,YAAWsO,K,qBCxNjEoC,G,4MACJza,MAAQ,G,EAIRwZ,SAAW,kBAAM,G,EAEjBlM,UAAY,SAAAvJ,GAAY,IACdhC,EAAS,EAAK6D,MAAd7D,KACR,GAAMgC,EAAQuJ,UACZ,OAAOxL,EAAWC,EAAM,IAAIqF,KAAKrD,EAAQuJ,YACpC,GAAMvJ,EAAQ2W,gBAAoB3W,EAAQ4W,gBAAiB,CAChE,IAAMC,IACF7W,EAAQ2W,gBAAkB3W,EAAQ2W,eAAiB,IAAM3Y,EAAKkG,cAAc,CAAEzD,GAAI,wCAChFqW,IACF9W,EAAQ4W,iBAAmB5W,EAAQ4W,gBAAkB,IAAM5Y,EAAKkG,cAAc,CAAEzD,GAAI,yCACxF,MAAO,CAACzC,EAAKkG,cAAc,CAAEzD,GAAI,4CAA8CoW,EAAUC,GAAW9I,OAAO+I,SAAShI,KAAK,O,EAI7HjN,SAAW,SAAC9B,EAAS6O,GACnB,IACU,EADJpO,EAAKT,EAAQ6O,GACnB,GAAMpO,EACJ,iBAAO,EAAKoB,MAAMiS,UAAUlT,MAAK,SAAAoW,GAAG,OAAIA,EAAInb,OAAS4E,YAArD,aAAO,EAAmD4B,S,EAI9D6L,iBAAmB,SAAA+I,GACjB,IAAM/I,EAAmB,EAAKrM,MAAMiP,kBAAkBlQ,MAAK,SAAAzE,GAAI,OAAI8a,EAAmBC,QAAQ/a,EAAKN,OAAS,KAC5G,OAAOqS,IAAqB+I,EAAmBE,SAAS,MAAQjJ,EAAiByD,cAAgBzD,EAAiB0D,gB,EAGpH7D,UAAY,SAAA/N,GAAO,OACjBA,EAAQ+N,WACR/N,EAAQ+N,UACLC,QAAO,SAAAC,GAAQ,QAAMA,EAASC,oBAAsBD,EAASE,eAC7D/L,KAAI,SAAA6L,GAAQ,MAAI,CAAC,EAAKC,iBAAiBD,EAASC,kBAAmBD,EAASE,YAAYlM,OAAO8M,KAAK,UACpGA,KAAK,O,EAEVqI,cAAgB,SAAAnI,GAAK,OACjBA,EAAMhN,MACJgN,EAAMhN,MACN,EAAKJ,MAAM7D,KAAKkG,cAAc,CAC5BzD,GAAI,0BAA4BwO,EAAM/L,KACtCmU,eAAgBpI,EAAM/L,Q,EAG9BoU,cAAgB,SAACtX,EAASiP,GACxB,IAAMsI,EAAMvX,EAAQiP,EAAM/L,MAC1B,GAAM+L,EAAM5K,QAAS,CACnB,IAAMuL,EAASX,EAAM5K,QAAQzD,MAAK,SAAA4W,GAAG,OAAIA,EAAIza,QAAUwa,GAAOC,IAAQD,KACtE,GAAM3H,EACJ,OAAOA,EAAO3N,OAAS2N,EAG3B,MAAmB,UAAfX,EAAM9S,MAAsBob,EACvBlP,aAAsBP,GAA2ByP,IAEnDA,G,EAGTE,SAAW,SAAAzX,GAAY,IACb0X,EAAU,EAAK7V,MAAf6V,MACFD,EAAW,GA0BjB,OAzBAC,EAAMlO,SAAQ,SAAAmO,GACZ,IAAI5a,EACE6a,EAAWD,EAAKjD,OAAO9T,MAAK,SAAAqO,GAAK,OAAIA,EAAM0F,eAAiBR,MAClE,GAAIwD,EAAKjD,OAAO9T,MAAK,SAAAqO,GAAK,OAAIiB,KAAoBjB,EAAM/L,MAAQ8M,GAA2BC,SAAShB,EAAM/L,SACxGnG,EAAQ,EAAKwM,UAAUvJ,QAClB,GAAI2X,EAAKjD,OAAO9T,MAAK,SAAAqO,GAAK,OAAIA,EAAM9S,OAASiY,MAClDrX,EAAQ,EAAKgR,UAAU/N,OAClB,KAAI4X,EAWT,OARAD,EAAKjD,OACF1G,QAAO,SAAAiB,GAAK,QAAMA,EAAM/L,QAAU,EAAKoU,cAActX,EAASiP,MAC9DzF,SAAQ,SAAAyF,GACPwI,EAAS9U,KAAK,CACZV,MAAO,EAAKmV,cAAcnI,GAC1BlS,MAAO,EAAKua,cAActX,EAASiP,QAGlCwI,EAVP1a,EAAQ,EAAK+E,SAAS9B,EAAS4X,EAAS1U,MAY1CuU,EAAS9U,KAAK,CACZV,MAAO0V,EAAK1V,MACZlF,aAGG0a,G,EAGTI,YAAc,SAAA5I,GAEZ,OACE,uBAAK9K,UAAU,mBAAf,UACE,sBAAKA,UAAU,6BAAf,SACE,wBAAMA,UAAU,cAAhB,UACG8K,EAAMhN,MALD,SASV,sBAAKkC,UAAU,WAAf,SACE,gCAAO8K,EAAMlS,YARjB,gBAAgDkS,EAAMhN,S,EAc1D0L,OAAS,SAAAA,GAAM,OAAIA,GAAUrM,IAAEc,IAAIuL,GAAQ,SAAAmK,GAAG,OAAI,eAACC,GAAA,EAAD,CAAOrL,MAAM,SAAb,SAAuBoL,GAAOA,EAAIrJ,QAAQ,kBAAmB,U,uDA1G/G,c,oBA4GA,WAAU,IAAD,OACDiG,EAASjR,KAAKgU,SAAShU,KAAK5B,MAAM7B,SAClCgY,EAAiBC,KAAKC,MAAMxD,EAAO/W,OAAS,GAC1CgQ,EAAWlK,KAAK5B,MAAhB8L,OACR,OACE,uCACE,uBAAKxJ,UAAU,cAAf,UACGV,KAAKkK,OAAOA,GACb,uBAAKxJ,UAAU,aAAf,UACE,8BACE,eAAC,IAAD,CAAkB1D,IAAKgD,KAAK5B,MAAMsW,YAAc,oBAAsB,mBAAqB,2BAE7F,6BACE,eAAC,IAAD,CAAkB1X,IAAKgD,KAAK5B,MAAMsW,YAAc,oBAAsB,mBAAqB,iCAG/F,uBAAKhU,UAAU,MAAf,UACE,sBAAKA,UAAU,WAAf,SAA2BuQ,EAAO5U,MAAM,EAAGkY,GAAgB5V,KAAI,SAAA6M,GAAK,OAAI,EAAK4I,YAAY5I,QACzF,sBAAK9K,UAAU,WAAf,SAA2BuQ,EAAO5U,MAAMkY,GAAgB5V,KAAI,SAAA6M,GAAK,OAAI,EAAK4I,YAAY5I,cAGzFxL,KAAK5B,MAAM4U,YAAYhT,KAAKgS,iB,GApIf/P,IAAMC,WAqJbG,sBAXS,SAAC,GAAD,IAAGoI,EAAH,EAAGA,iBAAkBpM,EAArB,EAAqBA,SAAUsW,EAA/B,EAA+BA,aAA/B,MAAmD,CACzEtH,kBAAmB5C,EAAiB4C,kBACpCgD,UAAWhS,EAASgS,UACpBnG,OAAQyK,EAAazK,UAGI,GAKZ7H,CAA6CE,YAAW0Q,K,iFCrJ1D2B,GAAoB,SAACxW,GAAoC,IAElEsC,EAMEtC,EANFsC,UAFiE,EAQ/DtC,EALFyW,OAAcC,EAHmD,EAGvD9X,GAHuD,IAGzC+X,OAAQC,OAHiC,MAGlB,GAHkB,IAQ/D5W,EAJF6W,KAAYC,EAJqD,EAIzDlY,GAJyD,IAI7C+X,OAAQI,OAJqC,MAIxB,GAJwB,EAKjEC,EAGEhX,EAHFgX,MACAC,EAEEjX,EAFFiX,KACAC,EACElX,EADFkX,OAGF,OACE,gBAACC,GAAA,EAAD,CAAO7U,UAAWA,EAAW4U,OAAQA,EAAQE,MAAM,EAAnD,UACE,gBAACC,GAAA,EAAD,WACE,sBAAK/U,UAAU,eAAf,SACE,oBAAGA,UAAU,yBAEf,eAAC,IAAD,CAAkB1D,GAAI8X,EAAUC,OAAM,2BAAOC,GAAP,IAAqBU,GAAI,+BAEjE,eAACC,GAAA,EAAD,UACE,eAAC,IAAD,CAAkB3Y,GAAIkY,EAAQH,OAAM,2BAAOI,GAAP,IAAmBO,GAAI,0BAAUE,QAAQ,QAE/E,gBAACC,GAAA,EAAD,CAAanV,UAAWoV,KAAG,CAAE,uBAAwBT,IAArD,UACGA,GACC,eAACvT,EAAA,EAAD,CAAQpB,UAAU,aAAaqB,QAASsT,EAAMjI,cAAY,oBAA1D,SACE,eAAC,IAAD,CAAkBpQ,GAAG,gBAGxBoY,GACC,eAACtT,EAAA,EAAD,CAAQpB,UAAU,kBAAkBqB,QAASqT,EAAOhI,cAAY,qBAAhE,SACE,eAAC,IAAD,CAAkBpQ,GAAE,UAAKqY,EAAO,aAAe,wBC5C5CU,GAF0B,SAAA3X,GAAK,OAAI,eAAC,GAAD,eAAuBA,K,UCC5D4X,GAAc,4BAEdC,GAAgB,CAAEhF,OAAQ,CAAC,KAC3BiF,GAAkBrY,IAAEsY,OAAOC,qBAAW,QAAQzX,KAAI,gBAAGc,EAAH,EAAGA,KAAH,MAAe,CAAEjB,MAAOiB,EAAMnG,MAAOmG,MACvF4W,GAA8B,CAAC,QAAS,OAAQ,OAAQ,gBACxDC,GAAsB,CACjC,CACEhd,MAAO,UACPkF,MAAO,WAET,CACElF,MAAO,OACPkF,MAAO,QAET,CACElF,MAAO,UACPkF,MAAO,YAGE+X,GAAqB,CAChC,CACEjd,MAAO,UACPkF,MAAO,WAET,CACElF,MAAO,QACPkF,MAAO,SAET,CACElF,MAAO,YACPkF,MAAO,cAGEgY,GAAqB,CAChCC,UAAWH,GAAoB,GAAGhd,MAClCod,iCArCkD,OAsClDC,8BArC+C,MAsC/CC,QAAS,CAAC,IACVC,8BAA8B,EAC9BC,+BAA+B,EAC/BC,cAAe,CAAC,IAChBC,gBAAiB,GACjBC,UAAW,CAAC,IACZC,UAAW,KACXC,cAAe,GACfC,mBAAoB,GACpBC,mCAAmC,GCL/BC,G,4MACJ9e,MAAQ,CACN0b,KAAM,EACN3X,QAAS,GACTgb,aAAc,GACdC,aAAc,CAAC,GACfre,SAAS,G,EAEXse,WAAa,EAAKrZ,MAAMsW,YAAc,YAAc,U,EACpDT,MAAQ,kBAAO,EAAK7V,MAAMsW,YAAc,EAAKtW,MAAMsZ,eAAiB,EAAKtZ,MAAMuZ,c,EAC/Epb,QAAU,kBAAO,EAAK6B,MAAMsW,YAAc,EAAKtW,MAAMiC,OAAS,EAAKjC,MAAM7B,S,EAmDzEqb,SAAW,kBAAO,EAAKC,SAAL,cAAuB,EAAKJ,YAA5B,kBAAsD,EAAKA,a,EAE7EhF,QAAU,SAAAyB,GACR,IAAM4D,EAAqBtD,KAAKuD,IAAI7D,EAAMM,KAAKuD,IAAIC,MAAMxD,KAAM,EAAKhc,MAAMgf,eAC1E,EAAKvZ,SAAS,CACZiW,OAEAsD,aAAc,aAAI5T,MAAMkU,EAAqB,IAAInZ,KAAI,SAACd,EAAG2U,GAAJ,OAAmBA,Q,EAI5EyF,aAAe,SAAA/D,GAEb,OAD2BM,KAAKuD,IAAIC,MAAMxD,KAAM,EAAKhc,MAAMgf,eACjCtD,KAKtB,aAAItQ,MAAMsQ,IAAOpC,OAAM,SAACjU,EAAG2U,GAAJ,uBAAmB,EAAKha,MAAM+e,aAAa/E,UAA3C,aAAmB,EAAqCxK,Y,EAOrFkQ,YAAc,SAAAhE,GAAI,OAAI,SAAAxL,GAChB,EAAKuP,aAAa/D,IACpB,EAAKzB,QAAQyB,K,EAIjBiE,SAAW,WAAO,IAAD,EACwB,EAAK3f,MAApC+e,EADO,EACPA,aAAcC,EADP,EACOA,aAChBY,EAAkB,EAAKnE,QAAQ/Z,SAAW,EAAK1B,MAAM0b,KAC3D,OACE,gBAACmE,GAAA,EAAD,WACGxa,IAAEc,IAAI,EAAKsV,SAAS,SAACjD,EAAgBzJ,GAAO,IAAD,EACpCS,EAAO,UAAGuP,EAAahQ,UAAhB,aAAG,EAAiBS,QAC3BsQ,EAAYd,EAAa/D,QAAQlM,IAAM,EACvCgR,EAAWhR,IAAM,EAAK/O,MAAM0b,KAC5BsE,EAAOxQ,EAAWuQ,EAAWE,GAAcC,GAAS,KAC1D,OACE,gBAACC,GAAA,EAAD,CACEhb,OAAQ4J,IAAM,EAAK/O,MAAM0b,KACzBnS,QAAS,EAAKmW,YAAY3Q,GAE1B7G,UAAWsH,GAAWsQ,EAAY,QAAU,GAJ9C,UAMGE,GAAQ,sBAAK1P,IAAK0P,EAAMxP,IAAI,OAAOtI,UAAU,cAC7CsQ,EAAexS,QAPlB,eAGe+I,OAQnB,eAACoR,GAAA,EAAD,CAAehb,OAAQya,EAAiBrW,QAAS,EAAKmW,YAAY,EAAKjE,QAAQ/Z,QAA/E,SACE,eAAC,IAAD,CAAkB8C,GAAE,yCADtB,eAAqG,EAAKiX,QAAQ/Z,a,EAOxH0e,SAAW,WAAO,IAAD,IACXC,EAAiB,GAErB,aAAI,EAAKza,MAAMnF,gBAAf,iBAAI,EAAqBC,eAAzB,aAAI,EAA8BI,MAAO,CAAC,IACvBwf,EAAa1P,KAAK5R,MAAM,EAAK4G,MAAMnF,SAASC,QAAQI,OAA7Dsd,QACRiC,EAAiBC,EAASna,KAAI,SAAAoa,GAAO,OAAIA,EAAO,QAGlD,OACE,gBAACnQ,GAAA,EAAD,CAAMlI,UAAU,cAAhB,UACG7C,IAAEc,IAAI,EAAKsV,SAAS,SAACjD,EAAgBzJ,GAAjB,OACnB,sBAAK7G,UAAS,uBAAkB6G,IAAM,EAAK/O,MAAM0b,KAAO,GAAK,UAA7D,SACE,eAAC,GAAD,CACE3X,QAAS,EAAK/D,MAAM+D,QACpBoP,gBAAiB,EAAKA,gBACtBqH,YAAa,EAAKA,YAAYzL,GAC9ByJ,eAAgBA,EAChB7G,uBAAwB,EAAK/L,MAAM+L,uBACnCiI,YAAa,EAAKA,YAAY7K,GAC9BkL,QAAS,EAAKA,QACdD,WAAYjL,EACZuR,SAAUD,KAVd,eAAsFtR,OAcxF,sBAAK7G,UAAS,uBAAkB,EAAKuT,QAAQ/Z,SAAW,EAAK1B,MAAM0b,KAAO,GAAK,UAA/E,SACE,eAAC,GAAD,CACE3X,QAAS,EAAK/D,MAAM+D,QACpBoP,gBAAiB,EAAKA,gBACtBqH,YAAa,EAAKA,YAAY,EAAKiB,QAAQ/Z,QAC3C+Z,MAAO,EAAKA,QACZS,YAAa,EAAKtW,MAAMsW,eAN5B,eAAwG,EAAKT,QAAQ/Z,a,EAa3H8e,YAAc,SAAAhR,GAAO,OAAI,SAAAU,GACnBV,GACF,EAAKyK,QAAQ,EAAKja,MAAM0b,KAAO,K,EAInC+E,YAAc,kBAAMpb,IAAEqb,QAAQrb,IAAEsb,OAAO,EAAK3gB,MAAM+e,cAAc,SAAArD,GAAI,OAAKA,EAAKlM,a,EAE9EoR,eAAiB,SAAA1Q,IACV,EAAKtK,MAAMpG,SAAW,EAAKihB,gBAC1B,EAAKpB,SACH,EAAKzZ,MAAMsW,aACb,EAAKtW,MAAMib,oBAAoB,EAAK7gB,MAAM+D,SAC1C,EAAK6B,MAAMkb,WAAW,EAAK9gB,MAAM+D,UAEjC,EAAK6B,MAAMmb,YAAY,EAAK/gB,MAAM+D,SAGhC,EAAK6B,MAAMsW,YACb,EAAKtW,MAAMob,eAAe,EAAKhhB,MAAM+D,SAErC,EAAK6B,MAAMqb,SAAS,EAAKjhB,MAAM+D,W,EAMvCyW,YAAc,SAAAR,GAAU,OAAI,SAAAxK,GAC1B,IAAM3H,EAAS,EAAKjC,MAAMsW,YAAc,YAAc,UAChDgF,EAAY,EAAKzF,QAAQ/Z,OAC/B,OACE,uBAAKwG,UAAU,eAAf,UACG8R,EAAa,EACZ,eAAC1Q,EAAA,EAAD,CAAQ9E,GAAE,UAAKqD,EAAL,oBAA+B0B,QAAS,kBAAM,EAAK0Q,QAAQD,EAAa,IAAlF,SACE,eAAC,IAAD,CAAkBxV,GAAG,+BAGvB,yBAEDwV,EAAakH,EACZ,eAAC5X,EAAA,EAAD,CACE9E,GAAE,UAAKqD,EAAL,gBACF0B,QAAS,EAAKiX,YAAYhR,GAC1BhG,UAAWgG,GAAWwK,GAAckH,EAAY,EAChDhZ,UAAU,OAJZ,SAME,eAAC,IAAD,CAAkB1D,GAAG,2BAGvB,eAAC8E,EAAA,EAAD,CACE9E,GAAE,UAAKqD,EAAL,mBACF0B,QAAS,EAAKqX,eACd1Y,UAAU,OACVsB,SAAU,EAAK5D,MAAMpG,UAAY,EAAKihB,cAJxC,SAME,eAAC,IAAD,CAAkBjc,GAAG,mC,EAO/B2O,gBAAkB,SAAApP,GAAO,OACvB,EAAK0B,SAAS,CACZ1B,QAAQ,eAAMA,M,EAGlB6V,YAAc,SAAA8B,GAAI,OAAI,SAAClM,EAAS0D,GAAa,IACnC6L,EAAiB,EAAK/e,MAAtB+e,aACRA,EAAarD,GAAQ,CACnBlM,UACA0D,WAEF,EAAKzN,SAAS,CACZsZ,mB,EAIJpe,QAAU,WAAO,IAAD,EACW,EAAKiF,MAAtBC,EADM,EACNA,SAAUrB,EADJ,EACIA,GAQlB,OACE,eAAC,GAAD,CACE0D,UAAU,yBACVmU,OAAQ,CAAE7X,GAAI,6CACdiY,KAAM,CAAEjY,GAAI,+CACZoY,MAZa,kBACd3N,OAAOpJ,SAASqJ,KAAO1K,EAAE,UACnB5F,EADmB,sBACW4F,GADX,OACgB,EAAKoB,MAAMsW,YAAc,oBAAsB,IACrFnd,IAAYoiB,aAAa,CACvBvf,IAAK/C,EAAYgH,EAAS/G,WAS9Bge,OAAQ,EAAK9c,MAAMW,W,uDAhPzB,WACE6G,KAAK5B,MAAMwb,4BACX5Z,KAAK5B,MAAMxE,kBAAkBigB,IAEzB7Z,KAAK6X,WACP7X,KAAK5B,MAAM0b,uBAAuB9Z,KAAK5B,MAAMe,MAAMC,OAAOpC,IACtDgD,KAAK5B,MAAMsW,YACb1U,KAAK5B,MAAM8M,UAAUlL,KAAK5B,MAAMe,MAAMC,OAAOpC,IAE7CgD,KAAK5B,MAAMrB,WAAWiD,KAAK5B,MAAMe,MAAMC,OAAOpC,O,gCAKpD,SAAmBkD,EAAyCC,EAAyCC,GAEjG,IlCvBqCyF,EAAWoF,EkCsBlD,GAAIjL,KAAK6X,SAEP,IADoB7X,KAAK5B,MAAMsW,YAAcxU,EAAUG,OAASH,EAAU3D,WACtDyD,KAAKzD,WAAeyD,KAAKzD,UAAW,CAAC,IAAD,EAChDA,EAAO,aACX+N,WAAW,UAAAtK,KAAKxH,MAAM+D,eAAX,eAAoB+N,YAAa,IACzCrF,GAA2BjF,KAAKzD,YAErCyD,KAAK/B,SAAS,CACZ1B,UACAgb,aAAc,GACdC,aAAc3Z,IAAEc,IAAIqB,KAAKiU,SAAS,SAACjD,EAAgBzJ,GAAjB,OAAuBA,YAEtD,GAAIrH,EAAU+K,sBAAwBjL,KAAK5B,MAAM6M,qBAAyD,MAAlCjL,KAAK5B,MAAM6M,oBAA6B,CACrH,IAAM1O,EAAO,2BACRyD,KAAKxH,MAAM+D,SADH,IAEX+N,WlCrCiCzE,EkCqCK7F,KAAK5B,MAAMe,MAAMC,OAAOpC,GlCrClBiO,EkCqCsBjL,KAAK5B,MAAM6M,oBlCpCrFA,EAAoBtM,KAAI,SAAAob,GAAiB,IAC/BC,EAAuCD,EAAvCC,QAASC,EAA8BF,EAA9BE,QAASxP,EAAqBsP,EAArBtP,iBACpByP,EAAYF,EAAQ5hB,OAASyN,EACnC,MAAO,CACL4E,iBAAkByP,EAAYzP,EAAiBrS,KAAO,KAAOqS,EAAiBrS,KAAO,KACrFsS,YAAa,CACXlM,MAAO0b,EAAYD,EAAQrb,QAAUob,EAAQpb,QAC7CtF,MAAO4gB,EAAYD,EAAQ7hB,KAAO4hB,EAAQ5hB,akC+B1C4H,KAAK/B,SAAS,CACZ1B,aAID2D,EAAU/G,SAAW6G,KAAK5B,MAAMjF,SACnC6G,KAAK/B,SAAS,CACZ9E,SAAS,M,oBAKf,WAAU,IACAgG,EAAUa,KAAK5B,MAAfe,MACR,OAAOA,GAASA,EAAMC,OAAOpC,K,oBAuM/B,WACE,GAAIgD,KAAK5B,MAAM+b,gBACb,OAAO,eAAChT,GAAA,EAAD,IAET,IAAMyQ,EAAW5X,KAAK4X,WACtB,OACE,sBAAKlX,UAAU,mBAAf,SACE,uCACGV,KAAKxH,MAAMW,SAAW6G,KAAK7G,UAC5B,8BACE,eAAC,IAAD,CAAkB6D,GAAE,UAAK4a,EAAL,cAEtB,sBAAKlX,UAAU,cAAf,SACE,eAAC,IAAD,CAAkB1D,GAAE,UAAK4a,EAAL,iBAEtB,gBAACwC,GAAA,EAAD,CAAK1Z,UAAU,OAAf,UACE,eAAC2Z,GAAA,EAAD,CAAKC,GAAI,EAAGC,GAAI,EAAG7Z,UAAU,YAA7B,SACGV,KAAKmY,aAER,eAACkC,GAAA,EAAD,CAAKC,GAAI,EAAGC,GAAI,EAAG7Z,UAAU,OAA7B,SACGV,KAAK4Y,yB,GArRW3W,IAAMC,WA6S/BC,GAAqB,CACzBsX,SrBzQsB,SAAAld,GACtB,IACMsO,EAAWT,GAAgB7N,GACjC,MAAO,CACL7D,KAAMZ,GACNa,QAASe,IAAMM,KAJD,sCAIkB6Q,KqBqQlC2O,erBjQ4B,SAAAnZ,GAC5B,IACMwK,EAAWT,GAAgB/J,GACjC,MAAO,CACL3H,KAAMZ,GACNa,QAASe,IAAMM,KAJD,wCAIkB6Q,KqB6PlC9N,cACAmO,aACAqO,YrB3PyB,SAAAhd,GACzB,IACMsO,EAAWT,GAAgB7N,GACjC,MAAO,CACL7D,KAAMZ,GACNa,QAASe,IAAM8gB,IAJD,sCAIiB3P,KqBuPjCyO,WrBnPwB,SAAAjZ,GACxB,IACMwK,EAAWT,GAAgB/J,GACjC,MAAO,CACL3H,KAAMZ,GACNa,QAASe,IAAM8gB,IAJD,wCAIiB3P,KqB+OjCwO,oBrB3OiC,SAAAhZ,GACjC,IACMwK,EAAWT,GAAgB/J,GACjC,MAAO,CACL3H,KAAMZ,GACNa,QAASe,IAAMM,KAJD,mEAIkBygB,KAAYC,UAAU7P,MqBuOxDiP,uBpBrQoC,SAAA9c,GACpC,IAAMvD,EAAU,4DAAwDuD,GACxE,MAAO,CACLtE,KAAMZ,GACNa,QAASe,IAAMC,IAAIF,KoBkQrBmgB,0BrBpOuC,iBAAO,CAC9ClhB,KAAMZ,GACNa,QAASe,IAAMC,IAAI,yDqBmOnBC,qBAMayI,sBA/BS,SAAC,GAAD,IAAGsS,EAAH,EAAGA,aAAcrS,EAAjB,EAAiBA,WAAYqY,EAA7B,EAA6BA,UAAW5Q,EAAxC,EAAwCA,KAAM9Q,EAA9C,EAA8CA,SAA9C,MAA8D,CACpFjB,QAAS2c,EAAa3c,QACtBmB,QAASwb,EAAaxb,QACtBP,QAAS+b,EAAa/b,QACtBoE,GAAI2X,EAAa3X,GACjBmN,uBAAwBwK,EAAaxK,uBACrC5N,QAAS+F,EAAW/F,QACpB8D,OAAQsa,EAAUta,OAClB4K,oBAAqB0P,EAAU1P,oBAC/B0M,aAAc5N,EAAK6Q,0BAA4BC,GAC/CnD,eAAgB3N,EAAK+Q,4BAA8BC,GACnDZ,gBAAiBpQ,EAAK/R,SAAW2c,EAAa3c,QAC9CiB,cAmBsCkJ,GAAzBE,CAA6CE,YAAWC,qBAAW8U,MCtWnE0D,GAFS,kBAAM,eAAC,GAAD,CAAkBtG,aAAa,KCE9CuG,GAFW,kBAAM,eAAC,GAAD,CAAkBvG,aAAW,KC8C9CwG,I,QAxCG,kBAChB,uBAAKxa,UAAU,YAAf,UACE,qBAAIA,UAAU,QAAd,SACE,eAAC,IAAD,CAAkB1D,GAAG,iBAEvB,uBAAK0D,UAAU,QAAf,UACE,eAAC,IAAD,CAAMya,GAAG,gBAAgBza,UAAU,OAAnC,SACE,uBAAKA,UAAU,eAAf,UACE,sBAAKA,UAAU,YAAf,SACE,sBAAKoI,IClBF,yoGDkBoBE,IAAI,WAE7B,sBAAKtI,UAAU,aAAf,SACE,eAAC,IAAD,CAAkB1D,GAAG,iCAI3B,eAAC,IAAD,CAAMme,GAAG,kBAAkBza,UAAU,OAArC,SACE,uBAAKA,UAAU,eAAf,UACE,sBAAKA,UAAU,YAAf,SACE,sBAAKoI,IE5BF,6sGF4BsBE,IAAI,WAE/B,sBAAKtI,UAAU,aAAf,SACE,eAAC,IAAD,CAAkB1D,GAAG,mCAI3B,eAAC,IAAD,CAAMme,GAAG,oBAAoBza,UAAU,OAAvC,SACE,uBAAKA,UAAU,eAAf,UACE,sBAAKA,UAAU,YAAf,SACE,sBAAKoI,IGtCF,ioFHsCwBE,IAAI,WAEjC,sBAAKtI,UAAU,aAAf,SACE,eAAC,IAAD,CAAkB1D,GAAG,6C,sBIf3BM,G,4MACJ9E,MAAQ,CACNmF,QAAQ,EACRyd,kBAAmB,M,EAGrB/jB,YAAc,2BAASD,EAAT,sBAAuC,EAAKgH,MAAMe,MAAMC,OAAOC,c,EA2B7EL,OAAS,WACP,EAAKZ,MAAMa,QAAQoc,U,EAGrBC,cAAgB,SAAAte,GAAE,OAAI,WACpB,EAAKoB,MAAMa,QAAQC,KAAnB,sBAAuC,EAAKd,MAAMe,MAAMC,OAAOC,YAA/D,gCAAkGrC,M,EAGpGue,qBAAuB,SAAApgB,GAAS,OAAI,WAClC,EAAK8C,SAAS,CACZmd,kBAAmBjgB,M,EAIvBqgB,sBAAwB,SAAArgB,GAAS,OAAI,WACnCA,EAAUoE,OAASpE,EAAUoE,SAAWzD,GAAgBC,GAAkBD,GAC1E,EAAKsC,MAAM9C,cAAcH,K,EAG3BsgB,mBAAqB,SAACtgB,EAAWoM,GAAO,IAIF,EAH5BhN,EAAS,EAAK6D,MAAd7D,KACFmhB,EAAgBvgB,EAAUC,WAAWD,EAAUC,WAAWlB,OAAS,GACnEqe,EAAWmD,EAAcnc,SAAWzD,GAC1C,GAAIyc,IAAa,EAAK/f,MAAMmF,OAC1B,OACE,gCACE,wCAAK+d,EAAcxjB,eAAnB,aAAK,EAAuBuH,OAC5B,8BAAKic,EAAc/b,WAAarF,EAAWC,EAAM,IAAIqF,KAAK8b,EAAc/b,cACxE,gCACE,oBAAGe,UAAU,0BAA0BqB,QAAS,EAAKuZ,cAAcI,EAActjB,QACjF,oBAAGsI,UAAU,4BAA4BqB,QAAS,EAAKwZ,qBAAqBpgB,KAC5E,yBAAQuF,UAAU,8BAA8BqB,QAAS,EAAKyZ,sBAAsBE,GAApF,mBAAwGnhB,EAAKkG,cAAc,CACzHzD,GAAI,mBADN,YAEMub,EAAWxc,GAAkBD,a,EAO7C6f,aAAe,WACb,EAAK1d,SAAS,CACZN,QAAS,EAAKnF,MAAMmF,U,EAIxBie,cAAgB,WAAO,IACbR,EAAsB,EAAK5iB,MAA3B4iB,kBACRA,EAAkBhgB,WAAW2K,SAAQ,SAAA5K,GACnCA,EAAU0E,QAAS,EACnB1E,EAAUuC,SAAU,IAAIkC,MAAO3E,iBAEjC,EAAKmD,MAAMyd,eAAeT,EAAkBhgB,YAC5C,EAAK6C,SAAS,CACZmd,kBAAmB,Q,EAIvBU,kBAAoB,kBAClB,gBAACvG,GAAA,EAAD,CAAOD,QAAM,EAACE,MAAM,EAApB,UACE,eAACC,GAAA,EAAD,CAAasG,aAAW,EAAxB,SACE,eAAC,IAAD,CAAkB/e,GAAG,wBAGvB,eAAC2Y,GAAA,EAAD,UACE,6BACE,eAAC,IAAD,CAAkB3Y,GAAG,sCAIzB,gBAAC6Y,GAAA,EAAD,WACE,yBAAQnV,UAAU,aAAaqB,QAAS,EAAKwZ,qBAAqB,MAAlE,SACE,eAAC,IAAD,CAAkBve,GAAG,oBAEvB,yBAAQ0D,UAAU,kBAAkBqB,QAAS,EAAK6Z,cAAlD,SACE,eAAC,IAAD,CAAkB5e,GAAG,4B,EAM7Bgf,qBAAuB,kBACrB,gBAAC,KAAD,CAAO5U,YAAU,EAACC,SAAO,EAACC,YAAU,EAAC5G,UAAU,QAA/C,UACE,iCACE,gCACE,8BACE,eAAC,IAAD,CAAkB1D,GAAG,2BAEvB,8BACE,eAAC,IAAD,CAAkBA,GAAG,2BAEvB,8BACE,eAAC,IAAD,CAAkBA,GAAG,8BAI3B,iCAAQ,EAAKoB,MAAMhD,WAAWuD,KAAI,SAACxD,EAAWoM,GAAZ,OAAkB,EAAKkU,mBAAmBtgB,EAAWoM,Y,EAI3FvP,QAAU,kBACR,sBAAK0I,UAAU,YAAf,SACE,eAACyG,GAAA,EAAD,O,uDA/HJ,WACE,IAAMnK,EAAKgD,KAAK5B,MAAMe,MAAMC,OAAOC,YACnCW,KAAK5B,MAAM6d,oBAAoBjf,GAC/BgD,KAAK5B,MAAMrB,WAAWC,K,gCAGxB,SAAmBkD,EAAuCC,EAAuCC,GAAiB,IAAD,EAClEJ,KAAK5B,MAA1C7B,EADuG,EACvGA,QAAS4C,EAD8F,EAC9FA,MAAO9D,EADuF,EACvFA,iBAClB2B,EAAKmC,EAAMC,OAAOC,YAClB9C,GAAWA,IAAY2D,EAAU3D,UACrCyD,KAAK5B,MAAMxC,mBACXoE,KAAK5B,MAAM1C,eAAe,CACxB,CACE8C,MAAOjC,EAAQ8D,OAAOC,cAAc1B,QACpCxE,IAAI,GAAD,OAAKhD,EAAL,sBAAmC4F,GACtCuD,MAAO,MAITlF,IAAqB6E,EAAU7E,mBACjC2E,KAAK5B,MAAM6d,oBAAoBjf,GAC/BwD,aAAaR,KAAK5B,MAAM7D,KAAKkG,cAAc,CAAEzD,GAAI,2B,oBA8GrD,WACE,IAAMkf,EAAW,2BACZlc,KAAK5B,OADO,IAEfiB,YAAaW,KAAK5B,MAAMe,MAAMC,OAAOC,YACrC8c,cAAe,UACf9kB,YAAa2I,KAAK3I,cAClB+kB,kBAAkB,IAEpB,OACE,uBAAK1b,UAAU,aAAf,UACE,eAAC,KAAD,2BAAYwb,GAAZ,aACE,eAAC,KAAD,CAAc7c,YAAa6c,EAAY7c,mBAEtCW,KAAKxH,MAAM4iB,mBAAqBpb,KAAK8b,oBACxC,8BACE,eAAC,IAAD,CAAkB9e,GAAI,uBAExB,uBAAK0D,UAAU,gBAAf,UACE,sBAAKA,UAAU,QAAf,SAAwBV,KAAK5B,MAAMuC,QACnC,sBAAID,UAAU,eAAd,UACE,qBAAIA,UAAU,WAAd,SACE,sBAAKA,UAAS,mBAAcV,KAAKxH,MAAMmF,QAAU,UAAYoE,QAAS/B,KAAK2b,aAA3E,SACE,eAAC,IAAD,CAAkB3e,GAAI,0BAG1B,qBAAI0D,UAAU,WAAd,SACE,sBAAKA,UAAS,oBAAeV,KAAKxH,MAAMmF,QAAU,UAAYoE,QAAS/B,KAAK2b,aAA5E,SACE,eAAC,IAAD,CAAkB3e,GAAI,+BAI3BgD,KAAK5B,MAAMpG,SAA4C,IAAjCgI,KAAK5B,MAAMhD,WAAWlB,OAAe8F,KAAKhI,UAAYgI,KAAKgc,0BAEpF,uBAAKtb,UAAU,OAAf,UACE,sBAAKA,UAAU,WAAf,SACE,oBAAGgH,KAAM1H,KAAK3I,cAAeqJ,UAAU,aAAvC,SACE,eAAC,IAAD,CAAkB1D,GAAI,sBAG1B,sBAAK0D,UAAU,+CAAf,SACE,eAAC,IAAD,CAAMya,GAAInb,KAAK5B,MAAMC,SAASge,SAAW,UAAW3b,UAAU,WAA9D,SACE,eAAC,IAAD,CAAkB1D,GAAI,oC,GApLZiF,IAAMC,WAsMxBC,GAAqB,CAAE7G,iBAAeugB,enD1Id,SAAAzgB,GAE5B,MAAO,CACL1C,KAAMZ,GACNa,QAASe,IAAMM,KAHD,oCAGL,OAEPoB,QAFO,IAEPA,OAFO,EAEPA,EAAYuD,KAAI,SAAAxD,GAAS,OAAII,GAAiBJ,SmDoIQ8gB,oBnD1JzB,SAAApW,GACjC,IAAMpM,EAAU,+DAA2DoM,GAC3E,MAAO,CACLnN,KAAMZ,GACNa,QAASe,IAAMC,IAAIF,KmDsJ0DiC,kBAAgBE,oBAAkBmB,eAKpGsF,sBAdS,SAAC,GAAD,IAAGlH,EAAH,EAAGA,UAAWmH,EAAd,EAAcA,WAAYqY,EAA1B,EAA0BA,UAA1B,MAA2C,CACjEha,MAAOxF,EAAU7C,aACjB8C,WAAYD,EAAUC,WACtBpD,QAASmD,EAAUnD,QACnBqD,iBAAkBF,EAAUE,iBAC5BkB,QAAS+F,EAAW/F,QACpB8D,OAAQsa,EAAUta,UAQoB8B,GAAzBE,CAA6CE,YAAWC,qBAAWlF,MCnOrEgf,I,OAAuC,gBACvCC,GAA6B,CAAC,UAC9BC,GAAc,CACzBC,WzCHkB,EyCIlBC,WAAY,GACZC,oBzCLkB,EyCMlBC,UzCNkB,EyCOlBC,ezCPkB,EyCQlBC,SzCRkB,GyCUPC,GAAgB,CAAEtd,KAAM,MACxBud,GAAmC,CAACD,ICbpCE,GAAY,SAAC3jB,GAAD,IAAQ4jB,EAAR,uDAAuB,GAAvB,OAAsC5jB,EAAQ8P,KAAK5R,MAAM8B,GAAS4jB,GCkB9EC,GAAoB,SAAAzU,GAAC,eAAM,OAACA,QAAD,IAACA,OAAD,EAACA,EAAGF,QAA8B,cAAnB,OAADE,QAAC,IAADA,GAAA,UAAAA,EAAGF,cAAH,eAAW9P,MAAsBgQ,EAAEF,OAAO4U,QAA1C,OAAoD1U,QAApD,IAAoDA,GAApD,UAAoDA,EAAGF,cAAvD,aAAoD,EAAWlP,MAASoP,GAEjH2U,GAAgB,SAAAC,GAC3B,GAAMA,EACJ,IAGE,OADA,IAAI1L,OAAO0L,IACJ,EACP,SACA,OAAO,EAGX,OAAO,GAGIC,GAAmB,SAAAzN,GAC9B,IAAMvI,EAAIuI,EAAS,GACb0N,EAAI1N,EAAS,IACnB,OAAU,IAANvI,GAAiB,KAANiW,EACN,0BACQ,IAANjW,GAAiB,KAANiW,EACb,0BACQ,IAANjW,GAAiB,KAANiW,EACb,0BAEF,2BAGIC,GAAqB,SAAAC,GAAK,kCAClCA,GADkC,IAErCC,OAAO,2BACFD,EAAMC,QADL,IAEJC,QAAS,UACTC,UAAW,UACXC,UAAW,eAIF3S,GAAiB,SAAC5Q,EAAMwjB,EAAe1S,GAClD,IAAIrK,EAAczG,EAAKkG,cAAc,CAAEzD,GAAI+gB,IAS3C,OARI1S,IACFrK,EAAc,CACZA,EACAzG,EAAKkG,cAAc,CACjBzD,GAAI,qBAENsO,KAAK,MAEFtK,GAGIgd,GAAe,SAAAzjB,GAAI,MAAI,CAClC,CACEiE,MAAOjE,EAAKkG,cAAc,CAAEzD,GAAI,eAChC1D,OAAO,GAET,CACEkF,MAAOjE,EAAKkG,cAAc,CAAEzD,GAAI,cAChC1D,OAAO,K,WCtEJ,SAAS2kB,GAAT,GAAiE,IAA5C1jB,EAA2C,EAA3CA,KAAMJ,EAAqC,EAArCA,OAAQ+jB,EAA6B,EAA7BA,WAAYC,EAAiB,EAAjBA,cACpD,OACE,uCACE,gBAACC,GAAA,EAAD,CAAO1d,UAAU,YAAjB,UACE,eAAC,IAAD,CAAkB1D,GAAG,wBACrB,uBACE0D,UAAU,qCACV2d,cAAY,OACZ3L,MAAOnY,EAAKkG,cAAc,CAAEzD,GAAI,oCAGpC,eAAC,GAAD,CAAS4D,QAASsd,EAAYna,OAAQ5J,EAAQiR,UAAU,YAAYtK,SAAUqd,EAAc,kB,uBCjBrFG,GAAgB,SAACC,EAAOC,EAAKC,GACxC,IAAMC,EAAYF,EAAMC,EACxB,GAAIC,GAAa,GAAKA,EAAYH,EAAMrkB,OAAQ,CAAC,IAAD,EACb,CAACqkB,EAAMG,GAAYH,EAAMC,IAAzDD,EAAMC,GADuC,KACjCD,EAAMG,GAD2B,KAGhD,OAAOH,GCCHI,GAAO,OAGAC,GAAqBC,cAAgB,SAAAzgB,GAIhD,IAIM0gB,EAAU,2BAAQ1gB,EAAM0gB,YAAd,IAA0BC,YAJtB,SAAArW,GAClBA,EAAEC,iBACFD,EAAEsW,qBAGJ,OAAO,eAAC,KAAWC,WAAZ,2BAA2B7gB,GAA3B,IAAkC0gB,WAAYA,QAG1CI,GAA0BC,cAAe,SAAA/gB,GAAK,OAAI,eAAC,KAAWghB,gBAAZ,eAAgChhB,OAElFihB,GAAiBC,aAAkB1S,MA8CjC2S,GA5Ca,SAAAnhB,GAM1B,OACE,eAACihB,GAAD,yBACEG,eAAa,EAEbC,KAAK,KACLC,UAVc,SAAC,GAA4B,IAA1BC,EAAyB,EAAzBA,SAAUC,EAAe,EAAfA,SACvBC,EAAWvB,GAAclgB,EAAM9E,MAAOqmB,EAAUC,EAAWD,GACjEvhB,EAAM0C,SAAS+e,IASbC,SAAU,EAEVC,oBAAqB,qBAAGC,KAAgBC,0BAEpC7hB,GATN,IAUE8hB,SAAO,EACPC,WAAY,CACVlB,WAAYL,GACZQ,gBAAiBF,IAEnBkB,mBAAmB,GACdhiB,EAAM+C,YAAc,CACvBkf,OAAO,2BACFjiB,EAAMiiB,QADL,IAEJC,oBAAqB,SAAAC,GAAI,kCACpBA,GADoB,IAEvB3hB,QAAS+f,MAEX6B,gBAAiB,SAAAD,GAAI,kCAChBA,GADgB,IAEnBE,aAlD+B,KAoDjCC,iBAAkB,SAAAH,GAAI,kCACjBA,GADiB,IAEpB3hB,QAAS+f,Y,UC5BNgC,I,QAlBM,SAACviB,GAAD,OACnB,sBAAK0C,SAAU1C,EAAM0C,SAAUJ,UAAU,gCAAzC,SACGtC,EAAMwC,QAAQjC,KAAI,SAAAwN,GAAM,OACvB,uBAAKzL,UAAU,uBAAf,UACE,wBACEhI,KAAK,QACLsE,GAAE,UAAKmP,EAAO7S,MAAZ,YAAqB8E,EAAMqB,MAC7BA,KAAMrB,EAAMqB,KACZnG,MAAO6S,EAAO7S,MACdoH,UAAU,eACV0c,QAAShf,EAAM9E,QAAU6S,EAAO7S,QAElC,wBAAOsnB,QAAO,UAAKzU,EAAO7S,MAAZ,YAAqB8E,EAAMqB,MAAzC,SAAkD0M,EAAO3N,UAThB2N,EAAO3N,cCI3CqiB,GAAkB,SAAmBC,GAAnB,mKAE3B,WACE,OACE,uBAAKpgB,UAAS,0BAAqBV,KAAK5B,MAAM2iB,kBAAoB,IAAlE,UACE,eAACD,EAAD,2BACM9gB,KAAK5B,OADX,IAEE4C,YAAahB,KAAK5B,MAAM4C,aAAe,GACvCqf,OAAQ,CACNW,KAAM,SAAAC,GAAQ,kCAAUA,GAAV,IAAoBC,OAAQ,cAG3ClhB,KAAK5B,MAAM+iB,iBAAmB,uBAAMzgB,UAAU,cAAhB,SAA+BV,KAAK5B,MAAM4C,aAAe,YAZrE,GACfiB,IAAMC,YAiBTkf,GAAuBP,GAAgBvU,MACvC+U,GAAwBR,GAAgBjU,MACxC0U,GAAgCT,GAAgBtB,IAEhDgC,IADkCV,GAAgBW,MACpBX,GAAgBF,KCrCpD,SAASc,GAAT,GAAyG,IAAtDlnB,EAAqD,EAArDA,KAAMJ,EAA+C,EAA/CA,OAAQgR,EAAuC,EAAvCA,eAAgBuW,EAAuB,EAAvBA,oBAChFC,EAA0CxnB,EAAOuc,iCACvD,OACE,uCACE,gBAAC0H,GAAA,EAAD,WACE,eAAC,IAAD,CAAkBphB,GAAG,sDACrB,uBACE0D,UAAU,qCACV2d,cAAY,OACZ3L,MAAOnY,EAAKkG,cAAc,CAAEzD,GAAI,kEAGpC,eAACokB,GAAD,CACEpgB,YAAamK,EAAe5Q,EAAM,kBAAkB,GACpD4mB,kBAAmBQ,EACnBroB,MAAOqoB,EACP7gB,SAAU4gB,EAAoB,mCjDpBnB,GiDqBXhpB,KAAK,SACLkpB,QAAQ,QACRC,IjDvBW,EiDwBXzU,cAAY,oDAMb,SAAS0U,GAAT,GAAwF,IAAtDvnB,EAAqD,EAArDA,KAAMJ,EAA+C,EAA/CA,OAAQgR,EAAuC,EAAvCA,eAAgBuW,EAAuB,EAAvBA,oBAC/DK,EAAyB5nB,EAAOwc,8BACtC,OACE,uCACE,gBAACyH,GAAA,EAAD,WACE,eAAC,IAAD,CAAkBphB,GAAG,qCACrB,uBACE0D,UAAU,qCACV2d,cAAY,OACZ3L,MAAOnY,EAAKkG,cAAc,CAAEzD,GAAI,iDAGpC,eAACokB,GAAD,CACEpgB,YAAamK,EAAe5Q,EAAM,qBAAqB,GACvD4mB,kBAAmBY,EACnBzoB,MAAOyoB,EACPjhB,SAAU4gB,EAAoB,gCjD9CnB,GiD+CXhpB,KAAK,SACLkpB,QAAQ,QACRC,IjDjDW,EiDkDXzU,cAAY,0CCjCL7K,oBAXf,SAAyBnE,GAA+B,IAC9C7D,EAA4B6D,EAA5B7D,KAAM3B,EAAsBwF,EAAtBxF,QAASyS,EAAajN,EAAbiN,SACvB,OACE,uBAAM3K,UAAU,oBAAoB0M,cAAY,aAAhD,SACG7S,EAAKkG,cAAc,CAClBzD,GAAIqO,EAAW,wBAA0BzS,SCV1C,SAASopB,GAAT,GAA4F,IAAhEznB,EAA+D,EAA/DA,KAAM0nB,EAAyD,EAAzDA,YAAaC,EAA4C,EAA5CA,aAA4C,IAA9BC,2BAA8B,SAChG,OACE,sBAAKzhB,UAAU,gEAAf,SACE,uBAAKA,UAAU,qBAAf,UACE,sBACEoI,IAAKgG,GACL4D,MAAOnY,EAAKkG,cAAc,CAAEzD,GAAI,qBAChCgM,IAAI,SACJtI,UAAU,cACVqB,QAASmgB,EACT9U,cAAY,eAEb+U,GACC,sBACErZ,IAAK+F,GACL6D,MAAOnY,EAAKkG,cAAc,CAAEzD,GAAI,qBAChCgM,IAAI,MACJtI,UAAU,gBACVqB,QAASkgB,EACT7U,cAAY,iBCZxB,IAAMgV,GAAqB,CAAE3iB,KAAM,GAAI4iB,aAAc,IAE9C,SAASC,GAAT,GAAwE,IAAhC/nB,EAA+B,EAA/BA,KAAMJ,EAAyB,EAAzBA,OAAQgkB,EAAiB,EAAjBA,cAC3D,OACE,uCACE,gBAACC,GAAA,EAAD,CAAO1d,UAAU,YAAjB,UACE,eAAC,IAAD,CAAkB1D,GAAG,2CACrB,uBACE0D,UAAU,qCACV2d,cAAY,OACZ3L,MAAOnY,EAAKkG,cAAc,CAAEzD,GAAI,uDAGpC,eAAC,GAAD,CACE4D,QAASod,GAAazjB,GACtBwJ,OAAQ5J,EACRiR,UAAU,+BACVtK,SAAUqd,EAAc,qCAMzB,SAASoE,GAAT,GAAsG,IAA7EhoB,EAA4E,EAA5EA,KAAMJ,EAAsE,EAAtEA,OAAQqoB,EAA8D,EAA9DA,qBAAsBC,EAAwC,EAAxCA,UAAWC,EAA6B,EAA7BA,WAAYvE,EAAiB,EAAjBA,cACnFpH,EAAgB5c,EAAO4c,eAAiB,GACxCH,EAAUzc,EAAOyc,SAAW,GAkB5B+L,EAAuB,SAAAnE,GAC3B,IAAMoE,EAAmB7L,EAAcyH,GAAK/e,KACxCmX,EAAQiM,MAAK,SAAA9J,GAAO,QAAMA,EAAQhC,eAAiBgC,EAAQhC,cAAcvK,SAASoW,MACpFH,EAAU,yBAA0B,wCAEpCA,EAAU,2BAA4B,wCAAwC,kBArBvD,SAAAjE,GACzB,IAAMoE,EAAmB7L,EAAcyH,GAAK/e,KAC5CsX,EAAczI,OAAOkQ,EAAK,GACG,IAAzBzH,EAAc7c,QAChB4oB,IAEF3E,EAAc,gBAAdA,CAA+BpH,GAE/BH,EAAQ7Q,SAAQ,SAAAgd,GACRA,EAAEhM,gBACNgM,EAAEhM,cAAgBgM,EAAEhM,cAAcxM,QAAO,SAAAyY,GAAE,OAAIA,IAAOJ,SAG1DzE,EAAc,UAAdA,CAAyBvH,GAQ6DqM,CAAmBzE,KAAMkE,IAI3GI,EAAkB,WACtB/L,EAAc7X,KAAKrB,IAAEqlB,MAAMd,KAC3BjE,EAAc,gBAAdA,CAA+BpH,IAG3BoM,EAAuB,SAAC5b,EAAG6D,GAAJ,OAAkB,SAAA1C,GAC7C,IAAMpP,EAAQ6jB,GAAkBzU,GAChC,GAAkB,SAAd0C,EAAsB,CAExB,IAAM3L,EAAOsX,EAAcxP,GAAG9H,KAC9BmX,EAAQ7Q,SAAQ,SAAAgd,GACRA,EAAEhM,eAAmBgM,EAAEhM,cAAc7c,SACzC6oB,EAAEhM,cAAgBgM,EAAEhM,cAAcpY,KAAI,SAAAqkB,GAAE,OAAKA,IAAOvjB,EAAOnG,EAAQ0pB,SAGvE7E,EAAc,UAAdA,CAAyBvH,GAE3BG,EAAcxP,GAAG6D,GAAa9R,EAC9B6kB,EAAc,gBAAdA,CAA+BpH,KAGjC,OACE,uCACE,gBAACqH,GAAA,EAAD,WACE,eAAC,IAAD,CAAkBphB,GAAG,4BACrB,uBACE0D,UAAU,qCACV2d,cAAY,OACZ3L,MAAOnY,EAAKkG,cAAc,CAAEzD,GAAI,yCAGlC+Z,GAAiB,IAAIpY,KAAI,SAACykB,EAAc7b,GACxC,IAAM8b,GAAeD,EAAa3jB,KAC5B6jB,GAAyBjG,GAAc+F,EAAaf,gBAAkBe,EAAaf,aACzF,OACE,uBAAgC3hB,UAAU,gBAA1C,UACE,uBAAKA,UAAU,yBAAf,UACE,eAAC0gB,GAAD,CACEpgB,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,gCACtCmkB,kBAAmBiC,EAAa3jB,KAChCnG,MAAO8pB,EAAa3jB,KACpBqB,SAAUqiB,EAAqB5b,EAAG,QAClC7G,UAAW8hB,GAAwBa,EAAc,UAAY,KAE9Db,GAAwBa,GAAe,eAAC,GAAD,CAAiBzqB,QAAQ,oCAEnE,uBAAK8H,UAAU,yBAAf,UACE,eAAC0gB,GAAD,CACEpgB,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,2BACtCmkB,kBAAmBiC,EAAaf,aAChC/oB,MAAO8pB,EAAaf,aACpBvhB,SAAUqiB,EAAqB5b,EAAG,gBAClC7G,UAAW8hB,GAAwBc,EAAwB,UAAY,KAExEd,GAAwBc,GAAyB,eAAC,GAAD,CAAiB1qB,QAAQ,2CAE7E,eAACopB,GAAD,CACEznB,KAAMA,EACN0nB,YAAaa,EACbZ,aAAc,kBAAMS,EAAqBpb,IACzC4a,oBAAqB5a,IAAMwP,EAAc7c,OAAS,MAzBtD,wBAA2BqN,UCxFrC,IAAMwV,GAAgB,CAAEtd,KAAM,GAAIsX,cAAe,IAE1C,SAASwM,GAAT,GAaH,IAZFhpB,EAYC,EAZDA,KACAJ,EAWC,EAXDA,OACAqpB,EAUC,EAVDA,oBACAC,EASC,EATDA,aACA7mB,EAQC,EARDA,sBACA4lB,EAOC,EAPDA,qBACAkB,EAMC,EANDA,wBAMC,IALDC,gBAKC,SAJDlB,EAIC,EAJDA,UACAC,EAGC,EAHDA,WACAvE,EAEC,EAFDA,cACAyF,EACC,EADDA,4BAEQhN,EAA2Bzc,EAA3Byc,QAASG,EAAkB5c,EAAlB4c,cAEX8M,EAAkB,SAACtc,EAAG6D,EAAW0Y,GAAf,OAAiC,SAAApb,GACvDkO,EAAQrP,GAAG6D,GAAa0Y,EAAgBpb,EAAE/J,KAAI,SAAAwN,GAAM,OAAIA,EAAO3N,SAAS2e,GAAkBzU,GAC1FyV,EAAc,UAAdA,CAAyBvH,KAarBmN,EAAkB,SAAAvF,GACtB,IAAMwF,EAAgBpN,EAAQ4H,GAAO5H,EAAQ4H,GAAK/e,KAAO,KACnDwkB,EAAkBD,EAAcpnB,EAAsBO,MAAK,SAAA4b,GAAO,OAAIA,EAAQiL,cAAgBA,KAAe,KAC7GC,GAAmBA,EAAcC,4BACrCzB,EAAU,yBAA0B,iCAEpCA,EAAU,2BAA4B,mCAAmC,kBAhBvD,SAAAjE,GAEpBoF,EAA4BJ,EAAoBjZ,QAAO,SAAA4Z,GAAE,OAAIA,EAAG1kB,OAASmX,EAAQ4H,GAAK/e,SACtFmX,EAAQtI,OAAOkQ,EAAK,GACG,IAAnB5H,EAAQ1c,QACVkqB,IAEFjG,EAAc,UAAdA,CAAyBvH,GASwDyN,CAAc7F,KAAMkE,IAIjG0B,EAAa,WACjBxN,EAAQ1X,KAAKrB,IAAEqlB,MAAMnG,KACrBoB,EAAc,UAAdA,CAAyBvH,IAG3B,OACE,uCACE,gBAACwH,GAAA,EAAD,WACE,eAAC,IAAD,CAAkBphB,GAAG,sBACrB,uBACE0D,UAAU,qCACV2d,cAAY,OACZ3L,MAAOnY,EAAKkG,cAAc,CAAEzD,GAAI,mCAGlC4Z,GAAW,IAAIjY,KAAI,SAACoa,EAASxR,GAC7B,IAAM8b,GAAetK,EAAQtZ,KACvB6kB,EAAmBZ,EAAwB9M,EAASmC,EAASxR,GAC7Dgd,GAAwBxL,EAAQhC,cAAc7c,OACpD,OACE,uBAA0BwG,UAAU,gBAApC,UACE,uBAAKA,UAAU,yBAAf,UACE,eAAC0gB,GAAD,CACEpgB,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,0BACtCmkB,kBAAmBpI,EAAQtZ,KAC3BnG,MAAOyf,EAAQtZ,KACfqB,SAAU+iB,EAAgBtc,EAAG,QAAQ,GACrCoc,WAAY5K,EAAQtZ,MAAQgkB,EAAajX,SAASuM,GAClDrY,UAAW8hB,IAAyBa,GAAeiB,GAAoB,UAAY,KAEpF9B,IACEa,EACC,eAAC,GAAD,CAAiBzqB,QAAQ,iCAEzB0rB,GAAoB,eAAC,GAAD,CAAiB1rB,QAAQ,sCAGnD,uBAAK8H,UAAU,8CAAf,UACE,eAAC4gB,GAAD,CACEtgB,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,4BACtCmkB,kBAAmBpI,EAAQhC,eAAiBgC,EAAQhC,cAAc7c,OAElEZ,MAAOyf,EAAQhC,eAAiBgC,EAAQhC,cAAcpY,KAAI,SAACqkB,EAAIxE,GAAL,MAAc,CAAEhgB,MAAOwkB,EAAI1pB,MAAOklB,MAC5F1d,SAAU+iB,EAAgBtc,EAAG,iBAAiB,GAC9C3G,SAAUmW,GAAiB,IAAIpY,KAAI,SAAAykB,GAAY,MAAK,CAClD5kB,MAAO4kB,EAAa3jB,KACpBnG,MAAO8pB,EAAa3jB,SAEtBiB,UAAW8hB,GAAwB+B,EAAuB,yBAA2B,iBACrFxjB,gBAAgB,iBAChBmf,SAAO,EACPsE,iBAAkB,kBAAM,GACxB9G,MAAOD,GACPtc,WAAYsiB,EAAajX,SAASuM,IAAY4K,IAE/CnB,GAAwB+B,GAAwB,eAAC,GAAD,CAAiB3rB,QAAQ,iDAE5E,eAACopB,GAAD,CACEznB,KAAMA,EACN0nB,YAAamC,EACblC,aAAc,kBAAM6B,EAAgBxc,IACpC4a,oBAAqB5a,IAAMqP,EAAQ1c,OAAS,MAzChD,kBAAqBqN,U,cCjEzBkd,GAAmBC,KAAQC,cAAchmB,KAAI,SAAAc,GAAI,MAAK,CAAEjB,MAAOiB,EAAMnG,MAAOmG,MAE3E,SAASmlB,GAAT,GAA2D,IAGhCnlB,EAHAlF,EAA+B,EAA/BA,KAAMJ,EAAyB,EAAzBA,OAAQgkB,EAAiB,EAAjBA,cACxCnH,EAAkB7c,EAAO6c,iBAAmB,GAOlD,OACE,uCACE,gBAACoH,GAAA,EAAD,CAAOhR,cAAY,uBAAnB,UACE,eAAC,IAAD,CAAkBpQ,GAAG,8BACrB,uBACE0D,UAAU,qCACV2d,cAAY,OACZ3L,MAAOnY,EAAKkG,cAAc,CAAEzD,GAAI,0CAGpC,eAACqkB,GAAD,CACErgB,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,8BACtCmkB,kBAAmBnK,GAAmBA,EAAgB9c,OAAS,EAC/DZ,MAAO0d,EAAgBrY,KAAI,SAAAkmB,GAAI,MAAK,CAAErmB,MAAOqmB,EAAKplB,KAAMnG,MAAOurB,EAAKplB,SACpEqB,UAnB0BrB,EAmBQ,kBAnBA,SAAAqlB,GAEtC3G,EAAc1e,EAAd0e,CAAoB2G,EAAgBnmB,KAAI,SAAAwN,GAAM,MAAK,CAAE1M,KAAM0M,EAAO7S,aAkB9DsH,QAAS6jB,GACT1jB,gBAAgB,iBAChBggB,iBAAiB,uBACjBb,SAAO,EACPxC,MAAOD,QC5BR,SAASsH,GAAT,GAA8D,IAAzCxqB,EAAwC,EAAxCA,KAAMJ,EAAkC,EAAlCA,OAAQyG,EAA0B,EAA1BA,QAASud,EAAiB,EAAjBA,cACzClH,EAAc9c,EAAd8c,UAEF+N,EAAoB,SAACzd,EAAG6D,EAAW6Z,GAAf,OAA4B,SAAAvc,GACpDuO,EAAU1P,GAAG6D,GAAa6Z,EAAWvc,EAAEpP,MAAQ6jB,GAAkBzU,GACjEyV,EAAc,YAAdA,CAA2BlH,KAWvBiO,EAAc,WAClBjO,EAAU/X,KAAK,CAAEimB,WAAW,IAC5BhH,EAAc,YAAdA,CAA2BlH,IAGvBmO,EAAe,SAAC5G,EAAKC,GAAN,OAAiB,WACpCH,GAAcrH,EAAWuH,EAAKC,GAC9BN,EAAc,YAAdA,CAA2BlH,KAG7B,OACE,uCACE,gBAACmH,GAAA,EAAD,WACE,eAAC,IAAD,CAAkBphB,GAAG,wBACrB,uBACE0D,UAAU,qCACV2d,cAAY,OACZ3L,MAAOnY,EAAKkG,cAAc,CAAEzD,GAAI,qCAGlCia,GAAa,IAAItY,KAAI,SAAC0mB,EAAU9d,GAAX,OACrB,uBAA2B7G,UAAU,gBAArC,UACE,uBAAKA,UAAU,iCAAf,UACE,uBACEA,UAAS,yCAA0C,IAAN6G,EAAU,WAAa,IACpEmL,MAAOnY,EAAKkG,cAAc,CAAEzD,GAAI,kBAChCqhB,cAAY,OACZtc,QAASqjB,EAAa7d,GAAI,KAE5B,uBACE7G,UAAS,2CAAsC6G,IAAM0P,EAAU/c,OAAS,EAAI,WAAa,IACzFwY,MAAOnY,EAAKkG,cAAc,CAAEzD,GAAI,oBAChCqhB,cAAY,OACZtc,QAASqjB,EAAa7d,EAAG,QAG7B,sBAAK7G,UAAU,mEAAf,SACE,gBAAC0d,GAAA,EAAD,WACE,eAAC,KAAD,CACEhB,QAASiI,EAASF,UAClBpjB,QAAS,kBAAMijB,EAAkBzd,EAAG,aAAa,EAAlCyd,EAA0CK,EAASF,YAClEzsB,KAAK,aAEP,gCACE,eAAC,IAAD,CAAkBsE,GAAG,oCAI3B,eAACqkB,GAAD,CACErgB,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,2BACtCmkB,kBAAmBkE,EAAS3sB,KAC5BY,MAAOsH,EAAQzD,MAAK,SAAA4W,GAAG,OAAIA,EAAIza,QAAU+rB,EAAS3sB,SAAS,KAC3DoI,SAAUkkB,EAAkBzd,EAAG,QAAQ,GACvC3G,QAASA,EAAQ2J,QAAO,SAAAwJ,GAAG,OAAKkD,EAAU9Z,MAAK,SAAAmoB,GAAE,OAAIA,EAAG5sB,OAASqb,EAAIza,YACrEynB,iBAAiB,SACjBhgB,gBAAgB,iBAChB2c,MAAOD,KAET,eAACuE,GAAD,CACEznB,KAAMA,EACN0nB,YAAaiD,EACbhD,aAAc,kBArED1D,EAqEsBjX,EApE3C0P,EAAU3I,OAAOkQ,EAAK,GACG,IAArBvH,EAAU/c,QACZgrB,SAEF/G,EAAc,YAAdA,CAA2BlH,GALN,IAAAuH,GAsEb2D,oBAAqB5a,IAAM0P,EAAU/c,OAAS,MAzClD,mBAAsBqN,UCvCvB,SAASge,GAAT,GAA2D,IAAtChrB,EAAqC,EAArCA,KAAMJ,EAA+B,EAA/BA,OAAQunB,EAAuB,EAAvBA,oBAChCxK,EAAc/c,EAAd+c,UACR,OACE,uCACE,gBAACkH,GAAA,EAAD,CAAO1d,UAAU,YAAjB,UACE,eAAC,IAAD,CAAkB1D,GAAG,wBACrB,uBACE0D,UAAU,qCACV2d,cAAY,OACZ3L,MAAOnY,EAAKkG,cAAc,CAAEzD,GAAI,oCAGpC,sBAAK0D,UAAU,iBAAf,SACE,eAAC0gB,GAAD,CACEpgB,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,wBACtCmkB,gBAA+B,OAAdjK,EACjB5d,MAAO4d,EACPpW,SAAU4gB,EAAoB,YxDtBpB,EAGG,KwDoBbhpB,KAAK,SACLkpB,QAAQ,QACRlhB,UAAU,aACVmhB,IxD1BU,EwD2BV9J,IxDxBa,IwDyBb3K,cAAY,wBC9BtB,IAAMoY,GAAW,WACXC,GAAa,aACNC,GAAiB,CAAC,iBAAkB,gBAAiB,cAAe,aAAc,WAAY,YAC9FC,GAAqB,CAChCC,eAAgBJ,GAChB9f,cAAe8f,GACf/f,YAAa+f,GACb5f,WAAY4f,GACZjgB,SAAUkgB,GACVjgB,SAAUigB,ICGL,SAASI,GAAT,GAAyD,IAAhCtrB,EAA+B,EAA/BA,KAAMJ,EAAyB,EAAzBA,OAAQgkB,EAAiB,EAAjBA,cACtChH,EAAgBhd,EAAOgd,eAAiB,GAExC2O,EAAkB,SAACC,EAAYC,EAAU5a,EAAW6Z,GAAlC,OAA+C,SAAAvc,GACrE,IAAMpP,EAAQ2rB,EAAWvc,EAAEpP,MAAQ6jB,GAAkBzU,GAChD0C,EAIH+L,EAAc4O,GAAY9U,OAAO+U,GAAU5a,GAAa9R,EAFxD6d,EAAc4O,GAAYE,YAAc3sB,EAI1C6kB,EAAc,gBAAdA,CAA+BhH,KAG3B+O,EAA2B,SAACH,EAAYC,GAAb,OAA0B,SAAAtd,GACzD,IAAMyd,EAAmBzd,EAAEpP,MAC3B6d,EAAc4O,GAAY9U,OAAO+U,GAAUxa,MAAQ2a,EACnDhP,EAAc4O,GAAY9U,OAAO+U,GAAUttB,KAAOitB,GAAmBQ,GACrEhI,EAAc,gBAAdA,CAA+BhH,KAiB3BiP,EAAkB,SAACL,EAAYvH,EAAKC,GAAlB,OAA6B,WAAO,IAAD,EACzDH,GAAa,UAACnH,EAAc4O,UAAf,aAAC,EAA2B9U,OAAQuN,EAAKC,GACtDN,EAAc,gBAAdA,CAA+BhH,KAW3BkP,EAAa,WACjBlP,EAAcjY,KAAKrB,IAAEyoB,UAAUrQ,KAC/BkI,EAAc,gBAAdA,CAA+BhH,IAG3BoP,EAAqB,SAACR,EAAYS,GACtC,IAAMC,GAAwBtP,EAAc4O,GAAY9U,QAAU,IAC/D1G,QAAO,SAACmc,EAAalI,GAAd,OAAsBA,IAAQgI,KACrC7nB,KAAI,SAAA+nB,GAAW,OAAIA,EAAYlb,SAClC,OAAOka,GAAenb,QAAO,SAAAmc,GAAW,OAAKD,EAAqBja,SAASka,MAAc/nB,KAAI,SAAAyM,GAAS,MAAK,CACzG5M,MAAO4M,EACP9R,MAAO8R,OAIX,OACE,uCACE,gBAACgT,GAAA,EAAD,CAAO1d,UAAU,OAAjB,UACE,eAAC,IAAD,CAAkB1D,GAAG,4BACrB,uBACE0D,UAAU,qCACV2d,cAAY,OACZ3L,MAAOnY,EAAKkG,cAAc,CAAEzD,GAAI,wCAGnCma,EAAcxY,KAAI,SAACgH,EAAS4B,GAC3B,IAlCgBwe,EAkCVY,EAAehhB,EAAQsL,QAAU,GAEvC,OADA0V,EAAaC,MAAK,SAACC,EAAKC,GAAN,OAAcD,EAAIE,cAAgB,EAAID,EAAIC,cAAgB,KAE1E,uBAA+BrmB,UAAU,UAAU0M,cAAY,UAA/D,UACE,sBAAK1M,UAAU,qDAAf,SACE,yBAAQA,UAAU,kBAAkBqB,SAvC1BgkB,EAuCiDxe,EAvCnC,WAClC4P,EAAc7I,OAAOyX,EAAY,GACJ,IAAzB5O,EAAcjd,QAChBmsB,IAEFlI,EAAc,gBAAdA,CAA+BhH,KAkCrB,SACE,eAAC,IAAD,CAAkBna,GAAG,yBAGzB,uBAAK0D,UAAU,gBAAf,UACE,sBAAKA,UAAU,gBACf,eAAC2gB,GAAD,CACErgB,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,sBACtCmkB,kBAAmBxb,EAAQsgB,YAC3B3sB,MAAOqM,EAAQsgB,aAAe,CAAE3sB,MAAOqM,EAAQsgB,YAAaznB,MAAOmH,EAAQsgB,aAC3EnlB,SAAUglB,EAAgBve,EAAG,KAAM,MAAM,GACzC3G,QAASsV,GACT6K,iBAAiB,SACjBhgB,gBAAgB,iBAChB2c,MAAOD,KAET,eAAC2D,GAAD,CACEpgB,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,sBACtCmkB,kBAAmBxb,EAAQsgB,YAC3B3sB,MAAOqM,EAAQsgB,YACfnlB,SAAUglB,EAAgBve,EAAG,KAAM,MAAM,GACzCwZ,iBAAiB,WAEnB,sBAAKrgB,UAAU,oBAEhBimB,EAAahoB,KAAI,SAAC+nB,EAAalJ,GAAO,IAC7B/d,EAAgBinB,EAAhBjnB,KAAM+L,EAAUkb,EAAVlb,MACd,OACE,uBAAoC9K,UAAU,gBAA9C,UACE,uBAAKA,UAAU,iCAAf,UACE,uBACEA,UAAS,yCAA0C,IAAN8c,EAAU,WAAa,IACpE9K,MAAOnY,EAAKkG,cAAc,CAAEzD,GAAI,kBAChCqhB,cAAY,OACZtc,QAASqkB,EAAgB7e,EAAGiW,GAAI,GAChCpQ,cAAY,cAEd,uBACE1M,UAAS,2CAAsC8c,IAAMmJ,EAAazsB,OAAS,EAAI,WAAa,IAC5FwY,MAAOnY,EAAKkG,cAAc,CAAEzD,GAAI,oBAChCqhB,cAAY,OACZtc,QAASqkB,EAAgB7e,EAAGiW,EAAG,GAC/BpQ,cAAY,mBAGhB,eAACiU,GAAD,CACErgB,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,2BACtCmkB,kBAAmB3V,EACnBlS,MAAOkS,EAAQ,CAAElS,MAAOkS,EAAOhN,MAAOgN,GAAU,KAChD1K,SAAUolB,EAAyB3e,EAAGiW,GACtC5c,QAAS2lB,EAAmBhf,EAAGiW,GAC/BuD,iBAAiB,SACjBhgB,gBAAgB,iBAChB2c,MAAOD,KAET,eAAC2D,GAAD,CACEpgB,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,0BACtCmkB,kBAAmB1hB,EACnBnG,MAAOmG,GAAQ,GACfqB,SAAUglB,EAAgBve,EAAGiW,EAAG,QAAQ,GACxCuD,iBAAiB,WAEnB,eAACiB,GAAD,CACEznB,KAAMA,EACN0nB,YAAa,kBA1HR,SAAA8D,GACrB5O,EAAc4O,GAAY9U,OAAO/R,KAAK,IACtCif,EAAc,gBAAdA,CAA+BhH,GAwHI6P,CAAezf,IAClC2a,aAAc,kBAtHN,SAAC6D,EAAYS,GACrC,IAAMvV,EAASkG,EAAc4O,GAAY9U,OACzCA,EAAO3C,OAAOkY,EAAgB,GACR,IAAlBvV,EAAO/W,QACT+W,EAAO/R,KAAK,IAEdif,EAAc,gBAAdA,CAA+BhH,GAgHK8P,CAAkB1f,EAAGiW,IACzC2E,oBAAqB3E,IAAMmJ,EAAazsB,OAAS,MAtCrD,uBAA0BqN,EAA1B,YAA+BiW,SA9BrC,uBAA0BjW,OA4E9B,sBAAK7G,UAAU,uCAAf,SACE,yBAAQA,UAAU,kBAAkBqB,QAASskB,EAA7C,SACE,eAAC,IAAD,CAAkBrpB,GAAG,mCC/JxB,SAASkqB,GAAT,GAA8D,IAAhC3sB,EAA+B,EAA/BA,KAAMJ,EAAyB,EAAzBA,OAAQgkB,EAAiB,EAAjBA,cACzC/G,EAAuBjd,EAAvBid,mBACR,OACE,uCACE,eAACgH,GAAA,EAAD,CAAO1d,UAAU,YAAjB,SACE,eAAC,IAAD,CAAkB1D,GAAG,mCAEvB,sBAAK0D,UAAU,iBAAf,SACE,eAAC0gB,GAAD,CACEpgB,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,iCACtCmkB,kBAAmB/J,EACnB9d,MAAO8d,EACPtW,SAAUqd,EAAc,sBACxBzd,UAAW2c,GAAcjG,GAAsB,WAAa,0BAO/D,SAAS+P,GAAT,GAAyE,IAAhC5sB,EAA+B,EAA/BA,KAAMJ,EAAyB,EAAzBA,OAAQgkB,EAAiB,EAAjBA,cAC5D,OACE,uCACE,gBAACC,GAAA,EAAD,CAAO1d,UAAU,OAAjB,UACE,eAAC,IAAD,CAAkB1D,GAAG,4CACrB,uBACE0D,UAAU,qCACV2d,cAAY,OACZ3L,MAAOnY,EAAKkG,cAAc,CAAEzD,GAAI,wDAGpC,eAAC,GAAD,CACE4D,QAASod,GAAazjB,GACtBwJ,OAAQ5J,EACRiR,UAAU,gCACVtK,SAAUqd,EAAc,sCCpCzB,SAASiJ,GAAT,GAAiF,IAAhC7sB,EAA+B,EAA/BA,KAAMJ,EAAyB,EAAzBA,OAAQgkB,EAAiB,EAAjBA,cACpE,OACE,uCACE,gBAACC,GAAA,EAAD,CAAO1d,UAAU,OAAjB,UACE,eAAC,IAAD,CAAkB1D,GAAG,oDACrB,uBACE0D,UAAU,qCACV2d,cAAY,OACZ3L,MAAOnY,EAAKkG,cAAc,CAAEzD,GAAI,gEAGpC,eAAC,GAAD,CACE4D,QAASod,GAAazjB,GACtBwJ,OAAQ5J,EACRiR,UAAU,oCACVtK,SAAUqd,EAAc,0CCtBzB,IAAMkJ,GAAc,kBAAM5f,OAAO6f,SAAS,CAAEC,IAAK,EAAGC,SAAU,YCyD/DC,GAAiB,IACjBC,GAAcD,MAEPE,GAAb,4MACEnvB,MAAQ,CACNovB,UAAW,GACXC,iBAAkB,CAAEzvB,KAAM,KAAMkB,MAAO,MACvCwuB,uBAAwB,GACxBC,8BAA+B,CAAE3vB,KAAM,KAAMkB,MAAO,MACpDmqB,aAAc,GACdjB,sBAAsB,EACtBwF,aAAa,EACbC,YAAa,CAAEjrB,GAAI,GAAI+X,OAAQ,IAC/BmT,UAAW,CAAElrB,GAAI,GAAI+X,OAAQ,IAC7BoT,eAAgB,KAChBC,cAAe,MAZnB,EAiCEC,kBAAoB,WAAO,IAAD,IACpBluB,EAAS8iB,GAAU,EAAK7e,MAAMjE,QAElC,IAAI,YAAKiE,MAAMlF,eAAX,eAAoBY,YAAa+f,GAAwB,CAE3D,IAAM1C,GADNhd,EAAS0D,IAAEyqB,SAASnuB,EAAQqc,KACCW,cAG7Bhd,EAAOgd,cAAgBtQ,OAAO0hB,KAAKpR,GAAexY,KAAI,SAAAsnB,GAAW,MAAK,CACpEA,cACAhV,OAAQkG,EAAc8O,OAGxB9rB,EAAOuc,iCAAmCvc,EAAOuc,iCAAmCgR,GACpFvtB,EAAOwc,8BAAgCxc,EAAOwc,8BAAgC8Q,GAE9E,EAAKxpB,SAAS,CACZ2pB,UAAWztB,EACX0tB,iBAAkB,EAAKzpB,MAAMlF,QAC7BuqB,aAAc5lB,IAAEqlB,MAAM/oB,EAAOyc,SAC7B4L,sBAAsB,SAEf,YAAKpkB,MAAMlF,eAAX,eAAoBY,YAAawiB,IAC1C,EAAKre,SAAS,CACZ6pB,uBAAwB3tB,EACxB4tB,8BAA+B,EAAK3pB,MAAMlF,WA1DlD,EA+DEsvB,eAAiB,WACf,IAAMruB,EAAS0D,IAAEyoB,UAAU,EAAK9tB,MAAMovB,WAwCtC,OAtCAztB,EAAOgd,cAAkBhd,EAAOgd,cAC5Bhd,EAAOgd,cAAcsR,QAAO,SAAC9pB,EAAK+pB,GAUhC,OATMA,EAAIzC,cACRtnB,EAAI+pB,EAAIzC,cAAgByC,EAAIzX,QAAU,IAAItS,KAAI,SAAC6M,EAAOjE,GAEpD,OADAiE,EAAMub,aAAexf,EAAI,EAClB8O,GAA4BoS,QAAO,SAACC,EAAKpW,GAE9C,OADAoW,EAAIpW,GAAO9G,EAAM8G,GACVoW,IACN,QAGA/pB,IACN,IACH,GAEExE,EAAOuc,mCACXvc,EAAOuc,iCAAmCvc,EAAOuc,iCAAmCgR,IAEhFvtB,EAAOwc,gCACXxc,EAAOwc,8BAAgCxc,EAAOwc,8BAAgC8Q,IAG1EttB,EAAO4c,gBACX5c,EAAO4c,cAAgB5c,EAAO4c,cAAcxM,QAAO,SAAAyY,GAAE,QAAMA,EAAGvjB,SAE1DtF,EAAOyc,UACXzc,EAAOyc,QAAUzc,EAAOyc,QAAQrM,QAAO,SAAAoe,GAAE,QAAMA,EAAGlpB,QAClDtF,EAAOyc,QAAQ7Q,SAAQ,SAAA4iB,GACrBA,EAAGlpB,KAAOkpB,EAAGlpB,KAAKmpB,OAClBD,EAAG5R,cAAkB4R,EAAG5R,cAAgB4R,EAAG5R,cAAcxM,QAAO,SAAAse,GAAG,QAAMA,KAAO,OAG9E1uB,EAAO6c,kBACX7c,EAAO6c,gBAAkB7c,EAAO6c,gBAAgBzM,QAAO,SAAAue,GAAE,QAAMA,EAAGrpB,SAE9DtF,EAAO8c,YACX9c,EAAO8c,UAAY9c,EAAO8c,UAAU1M,QAAO,SAAA+a,GAAE,QAAMA,EAAG5sB,SAEjDyB,GAxGX,EA2GEgkB,cAAgB,SAAA1e,GAAI,OAAI,SAAAiJ,GAAM,IACpBkf,EAAc,EAAKpvB,MAAnBovB,UACRA,EAAUnoB,GAAQ0d,GAAkBzU,GACpC,EAAKzK,SAAS,CACZ2pB,gBA/GN,EAmHEhE,4BAA8B,SAAAkE,GAAsB,OAAI,EAAK7pB,SAAS,CAAE6pB,4BAnH1E,EAqHEpG,oBAAsB,SAACjiB,EAAMoiB,EAAM9J,GAAb,OAAsB,SAAArP,GAAM,IACxCkf,EAAc,EAAKpvB,MAAnBovB,UACFmB,EAAsB5L,GAAkBzU,GACxCpP,EAAUyvB,EAAsBC,OAAOC,SAASF,E9DhLvC,I8DgLqElH,G9DlLpE,E8DmLhB,GAAImH,OAAOE,UAAU5vB,GAAQ,CAC3B,GAAa,OAARuoB,GAAgBvoB,EAAQuoB,GAAiB,OAAR9J,GAAgBze,EAAQye,EAAM,OACpE6P,EAAUnoB,GAAQnG,EAClB,EAAK2E,SAAS,CACZ2pB,iBA7HR,EAkIEuB,OAAS,WACP1hB,OAAOpJ,SAASqJ,KAAOvQ,GAnI3B,EAsIE8hB,YAAc,WAAO,IAAD,EACiB,EAAKzgB,MAAMovB,UAAtC7Q,EADU,EACVA,cAAeH,EADL,EACKA,QACvB,OACGG,EAAc8L,MAAK,SAAAO,GAAY,OAAKA,EAAa3jB,OAAS4d,GAAc+F,EAAaf,gBAAkBe,EAAaf,kBACpHzL,EAAQiM,MAAK,SAAA9J,GAAO,OAAKA,EAAQtZ,OAASsZ,EAAQhC,cAAc7c,YAChE0c,EAAQiM,MAAK,SAAC9J,EAASyF,GAAV,OAAkB,EAAKkF,wBAAwB9M,EAASmC,EAASyF,OA3IrF,EA+IElf,KAAO,WAAO,IAAD,EACyE,EAAK9G,MAAjFsvB,EADG,EACHA,uBAAwBD,EADrB,EACqBA,iBAAkBE,EADvC,EACuCA,8BAClD,GAAI,EAAK9O,cAAe,CACtB,IAAM9e,EAAS,EAAKquB,iBACdY,EAAahgB,KAAKsR,UAAUvgB,IAClC,OAAI0tB,QAAJ,IAAIA,OAAJ,EAAIA,EAAkBzvB,OACpByvB,EAAiBvuB,MAAQ8vB,EACzB,EAAKhrB,MAAMnE,cAAc4tB,IAEzB,EAAKzpB,MAAMvE,cAAcggB,GAAwBuP,IAEnD,OAAIrB,QAAJ,IAAIA,OAAJ,EAAIA,EAA+B3vB,QACjC2vB,EAA8BzuB,MAAQ8P,KAAKsR,UAAUoN,GACrD,EAAK1pB,MAAMnE,cAAc8tB,SAG3B,EAAK9pB,SAAS,CACZ+pB,aAAa,EACbC,YAAa,CAAEjrB,GAAI,0BACnBkrB,UAAW,CAAElrB,GAAI,wCACjBmrB,eAAgB,WACd,EAAKzF,aACL2E,MAEFe,cAAe,KACf5F,sBAAsB,KAxK9B,EA6KEkB,wBAA0B,SAAC9M,EAASmC,EAASyF,GAAnB,QACtBzF,EAAQtZ,OAAS,EAAKjH,MAAMirB,aAAajX,SAASuM,MAAcnC,EAAQzZ,MAAK,SAACksB,EAAG7L,GAAJ,OAAUgB,IAAQhB,GAAK6L,EAAE5pB,OAASsZ,EAAQtZ,SA9K7H,EAgLE6pB,MAAQ,kBACN,eAAC,GAAD,CACEzU,OAAQ,EAAKrc,MAAMyvB,YACnBhT,KAAM,EAAKzc,MAAM0vB,UACjB9S,MAAO,EAAK5c,MAAM2vB,eAClB9S,KAAM,EAAK7c,MAAM4vB,cACjB9S,OAAQ,EAAK9c,MAAMwvB,eAtLzB,EA0LEvF,UAAY,SAACwF,EAAaC,GAA4D,IAAjDC,EAAgD,uDAA/B,KAAMC,EAAyB,uDAAT,KAC1E,EAAKnqB,SAAS,CACZ+pB,aAAa,EACbC,YAAa,CAAEjrB,GAAIirB,GACnBC,UAAW,CAAElrB,GAAIkrB,GACjBC,eAAgB,WACRA,GACJA,IAEF,EAAKzF,cAEP0F,mBArMN,EAyME1F,WAAa,kBAAM,EAAKzkB,SAAS,CAAE+pB,aAAa,KAzMlD,uDAeE,WACEhoB,KAAK5B,MAAMxE,kBAAkBigB,IAC7B7Z,KAAK5B,MAAMxE,kBAAkB0iB,IAC7Btc,KAAK5B,MAAMmrB,6BAlBf,gCAqBE,SAAmBrpB,EAAsCC,EAAsCC,GAAiB,IAAD,EAC3DJ,KAAK5B,MAA/C7D,EADqG,EACrGA,KAAMJ,EAD+F,EAC/FA,OAAQnC,EADuF,EACvFA,QAASmB,EAD8E,EAC9EA,QAASwH,EADqE,EACrEA,MACpCT,EAAU/F,SAAWA,GACvB6F,KAAKqoB,qBAEFnoB,EAAU/G,SAAWA,EACxBqH,aAAajG,EAAKkG,cAAc,CAAEzD,GAAI,uBAC7BkD,EAAUS,QAAUX,KAAK5B,MAAMuC,OAAU3I,GAClDwxB,aAAW7oB,KA7BjB,oBA2ME,WAAU,IAAD,EAC+GX,KAAK5B,MAAnH7D,EADD,EACCA,KAAMkvB,EADP,EACOA,SAAUC,EADjB,EACiBA,WAAY1xB,EAD7B,EAC6BA,QAAS4E,EADtC,EACsCA,sBAAuBshB,EAD7D,EAC6DA,WAAYjH,EADzE,EACyEA,UAAW0S,EADpF,EACoFA,uBADpF,EAE2E3pB,KAAKxH,MAA/EovB,EAFD,EAECA,UAAWE,EAFZ,EAEYA,uBAAwBrE,EAFpC,EAEoCA,aAAcjB,EAFlD,EAEkDA,qBACzD,OACE,uBAAK9hB,UAAU,aAAf,UACGV,KAAKspB,QACN,8BACE,eAAC,IAAD,CAAkBtsB,GAAG,sBAEvB,sBAAK0D,UAAU,QAAf,SAAwB+oB,IACxB,sBAAK/oB,UAAU,gBAAf,SACGgpB,GAAe1xB,IAAY4vB,EAC1B,eAACzgB,GAAA,EAAD,IAEA,uCACE,sBAAKzG,UAAU,UAAU0M,cAAY,mBAArC,SACE,eAAC6Q,GAAD,CAAW1jB,KAAMA,EAAM2jB,WAAYA,EAAY/jB,OAAQytB,EAAWzJ,cAAene,KAAKme,kBAExF,uBAAKzd,UAAU,kBAAf,UACE,sBAAKA,UAAU,UAAU0M,cAAY,iDAArC,SACE,eAACqU,GAAD,CACElnB,KAAMA,EACNJ,OAAQytB,EACRzc,eAAgBA,GAChBuW,oBAAqB1hB,KAAK0hB,wBAG9B,sBAAKhhB,UAAU,UAAU0M,cAAY,gCAArC,SACE,eAAC0U,GAAD,CACEvnB,KAAMA,EACNJ,OAAQytB,EACRzc,eAAgBA,GAChBuW,oBAAqB1hB,KAAK0hB,2BAIhC,sBAAKhhB,UAAU,UAAU0M,cAAY,uBAArC,SACE,eAACmV,GAAD,CACEhoB,KAAMA,EACNJ,OAAQytB,EACRpF,qBAAsBA,EACtBC,UAAWziB,KAAKyiB,UAChBC,WAAY1iB,KAAK0iB,WACjBvE,cAAene,KAAKme,kBAGxB,sBAAKzd,UAAU,UAAU0M,cAAY,iBAArC,SACE,eAAC,GAAD,CACE7S,KAAMA,EACNJ,OAAQytB,EACRpE,oBAAqBsE,EACrBrE,aAAcA,EACd7mB,sBAAuBA,EACvB4lB,qBAAsBA,EACtBkB,wBAAyB1jB,KAAK0jB,wBAC9BC,UAAWgG,EACXlH,UAAWziB,KAAKyiB,UAChBC,WAAY1iB,KAAK0iB,WACjBvE,cAAene,KAAKme,cACpByF,4BAA6B5jB,KAAK4jB,gCAGtC,sBAAKljB,UAAU,UAAU0M,cAAY,sCAArC,SACE,eAACkV,GAAD,CAA8B/nB,KAAMA,EAAMJ,OAAQytB,EAAWzJ,cAAene,KAAKme,kBAEnF,sBAAKzd,UAAU,UAAU0M,cAAY,yBAArC,SACE,eAACwX,GAAD,CAAiBrqB,KAAMA,EAAMJ,OAAQytB,EAAWzJ,cAAene,KAAKme,kBAEtE,sBAAKzd,UAAU,UAAU0M,cAAY,mBAArC,SACE,eAAC2X,GAAD,CAAWxqB,KAAMA,EAAMJ,OAAQytB,EAAWhnB,QAASqW,EAAWkH,cAAene,KAAKme,kBAEpF,sBAAKzd,UAAU,UAAU0M,cAAY,uCAArC,SACE,eAAC+Z,GAAD,CAA+B5sB,KAAMA,EAAMJ,OAAQytB,EAAWzJ,cAAene,KAAKme,kBAEpF,sBAAKzd,UAAU,UAAU0M,cAAY,+CAArC,SACE,eAACga,GAAD,CAAuC7sB,KAAMA,EAAMJ,OAAQytB,EAAWzJ,cAAene,KAAKme,kBAE5F,sBAAKzd,UAAU,UAAU0M,cAAY,4BAArC,SACE,eAAC8Z,GAAD,CAAoB3sB,KAAMA,EAAMJ,OAAQytB,EAAWzJ,cAAene,KAAKme,kBAEzE,sBAAKzd,UAAU,UAAU0M,cAAY,mBAArC,SACE,eAACmY,GAAD,CAAWhrB,KAAMA,EAAMJ,OAAQytB,EAAWlG,oBAAqB1hB,KAAK0hB,wBAEtE,sBAAKhhB,UAAU,UAAU0M,cAAY,uBAArC,SACE,eAACyY,GAAD,CAAetrB,KAAMA,EAAMJ,OAAQytB,EAAWzJ,cAAene,KAAKme,kBAEpE,uBAAKzd,UAAU,YAAf,UACE,sBAAKA,UAAU,WAAf,SACE,eAACoB,EAAA,EAAD,CAAQpB,UAAU,SAASqB,QAAS/B,KAAKmpB,OAAQ/b,cAAY,eAA7D,SACE,eAAC,IAAD,CAAkBpQ,GAAG,sBAGzB,sBAAK0D,UAAU,+CAAf,SACE,eAACoB,EAAA,EAAD,CAAQpB,UAAU,OAAOqB,QAAS/B,KAAKV,KAAM0C,SAAUhK,EAASoV,cAAY,aAA5E,SACE,eAAC,IAAD,CAAkBpQ,GAAG,mCAzSzC,GAA+BiF,IAAMC,WAmU/BC,GAAqB,CAAEvI,oBAAmBK,gBAAeJ,gBAAe0vB,yBrE3QtC,WAEtC,MAAO,CACL7wB,KAAMZ,GACNa,QAASe,IAAMC,IAHE,4CqE+QN0I,sBAnBS,SAAC,GAAD,cAAG0H,EAAH,EAAGA,KAAM9Q,EAAT,EAASA,SAAUqJ,EAAnB,EAAmBA,WAAnB,MAAqC,CAC3D4b,WAAU,iBAAEnU,QAAF,IAAEA,OAAF,EAAEA,EAAM6f,qBAAR,QAAyBtT,GACnCW,UAAS,iBAAElN,QAAF,IAAEA,OAAF,EAAEA,EAAM8f,oBAAR,QAAwBtT,GACjCoT,uBAAsB,iBAAE5f,QAAF,IAAEA,OAAF,EAAEA,EAAM+f,iCAAR,SACtBL,SAAU1f,EAAKzR,aACfoxB,WAAY3f,EAAK/R,QACjB2I,MAAOoJ,EAAKzR,aACZN,QAASiB,EAASjB,QAClBmB,QAASF,EAASE,QAClBgB,QAAQ,UAAAlB,EAASC,eAAT,eAAkBI,SAAlB,UAA2BL,EAASC,eAApC,aAA2B,EAAkBI,OACrDJ,QAASD,EAASC,QAClB0D,sBAAuB0F,EAAW1F,yBAQIuF,GAAzBE,CAA6CE,YAAWC,qBAAWmlB,MChYrE7vB,I,QACM,yBAGbC,GAAe,CACnBgyB,WAAY,IA8BCxxB,GA3BC,WAAmC,IAAlCC,EAAiC,uDAAzBT,GAAcU,EAAW,uCAChD,OAAQA,EAAOC,MACb,KAAKhB,EAAQI,IACb,KAAKD,EAAQC,IACX,OAAO,eACFU,GAEP,KAAKZ,EAAQE,IACX,OAAO,2BACFU,GADL,IAEEuxB,WAAYtxB,EAAOE,QAAQI,KAAKC,UAEpC,QACE,OAAOR,ICoBPwxB,G,4MACJxxB,MAAQ,CACNovB,UAAW,GACXE,uBAAwB,GACxBmC,4BAA6B,GAC7BlC,8BAA+B,CAAE3vB,KAAM,KAAMkB,MAAO,MACpD0uB,aAAa,EACbC,YAAa,CAAEjrB,GAAI,GAAI+X,OAAQ,IAC/BmT,UAAW,CAAElrB,GAAI,GAAI+X,OAAQ,IAC7BoT,eAAgB,KAChBC,cAAe,M,EAuBjBC,kBAAoB,WAAO,IAAD,IACpBluB,EAAS8iB,GAAU,EAAK7e,MAAMjE,QAC7BA,GAA4B,IAAlBA,EAAOD,SACpBC,EAAS0D,IAAEyoB,UAAUtJ,MAEnB,YAAK5e,MAAMlF,eAAX,eAAoBY,YAAawiB,GACnC,EAAKre,SAAS,CACZ6pB,uBAAwB3tB,EACxB4tB,8BAA+B,EAAK3pB,MAAMlF,QAC1C+wB,4BAA6BpsB,IAAEqlB,MAAM/oB,MAE9B,YAAKiE,MAAMlF,eAAX,eAAoBY,YAAa+f,IAC1C,EAAK5b,SAAS,CAAE2pB,UAAWztB,K,EAI/BquB,eAAiB,WACf,IAAIruB,EAAS0D,IAAEyoB,UAAU,EAAK9tB,MAAMsvB,wBAQpC,OANM3tB,IACJA,EAASA,EAAOoQ,QAAO,SAAAwO,GAAO,QAAMA,EAAQtZ,SACrCsG,SAAQ,SAAAgT,GACbA,EAAQmR,OAAWnR,EAAQmR,OAASnR,EAAQmR,OAAO3f,QAAO,SAAA4f,GAAK,QAAMA,EAAMzN,cAAc,MAGtFviB,G,EAGTgkB,cAAgB,SAAA5V,GACd,IAAIpO,EAAS0D,IAAEyoB,UAAU,EAAK9tB,MAAMsvB,wBACpC3tB,EAASgjB,GAAkB5U,GAC3B,EAAKtK,SAAS,CAAE6pB,uBAAwB3tB,K,EAG1CgvB,OAAS,WACP1hB,OAAOpJ,SAASqJ,KAAOvQ,G,EAGzBizB,yBAA2B,SAAAC,GAAe,IAAD,EACO,EAAK7xB,MAA3CovB,EAD+B,EAC/BA,UAAWE,EADoB,EACpBA,uBACnB,OAASF,GACLA,EAAUhR,SACVgR,EAAUhR,QAAQzZ,MAAK,SAAAyZ,GAAO,OAAIA,EAAQnX,OAASqoB,EAAuBuC,GAAY5qB,QACtFmoB,EAAUhR,QAAQzZ,MAAK,SAAAyZ,GAAO,OAAIA,EAAQnX,OAASqoB,EAAuBuC,GAAY5qB,QACtF,M,EAGNH,KAAO,WAAO,IACJyoB,EAAkC,EAAKvvB,MAAvCuvB,8BACF5tB,EAAS,EAAKquB,iBACdY,EAAahgB,KAAKsR,UAAUvgB,GAC9B4tB,GAAiCA,EAA8B3vB,MACjE2vB,EAA8BzuB,MAAQ8vB,EACtC,EAAKhrB,MAAMnE,cAAc8tB,IAEzB,EAAK3pB,MAAMvE,cAAcyiB,GAAsC8M,I,EAInEkB,OAAS,WACP,IAAMC,IAAe,EAAK/xB,MAAMovB,aAAe,EAAKpvB,MAAMovB,UAAUhR,SAAW,EAAKpe,MAAMovB,UAAUhR,QAAQ1c,OACtGswB,IAAsB,EAAKhyB,MAAMsvB,wBAA0B,EAAKtvB,MAAMsvB,uBAAuB5tB,OACnG,EAAK+D,SAAS,CACZ+pB,aAAa,EACbC,YAAa,CAAEjrB,GAAI,wCACnBkrB,UAAW,EAAKuC,yBACZ,CAAEztB,GAAI,2DACN,CAAEA,GAAI,6DAA8D+X,OAAQ,CAAEwV,aAAYC,sBAC9FrC,eAAgB,WACd,EAAK7oB,OACL,EAAKojB,cAEP0F,cAAe,EAAK1F,c,EAIxBgI,oBAAsB,SAAAL,GAAe,IAC3BvC,EAA2B,EAAKtvB,MAAhCsvB,uBACRA,EAAuBxZ,OAAO+b,EAAY,GACJ,IAAlCvC,EAAuB5tB,QACzB,EAAKywB,mBAEP,EAAKxM,cAAc2J,I,EAGrB8C,sBAAwB,SAAAP,GAAe,IAC7BvC,EAA2B,EAAKtvB,MAAhCsvB,uBACF9D,EAAgB8D,GAA4BA,EAAuBuC,GAAcvC,EAAuBuC,GAAY5qB,KAAO,KAC3HukB,EACJ,EAAK/lB,SAAS,CACZ+pB,aAAa,EACbC,YAAa,CAAEjrB,GAAI,qDACnBkrB,UAAW,CAAElrB,GAAI,kDAAmD+X,OAAQ,CAAEiP,gBAC9EmE,eAAgB,WACd,EAAKuC,oBAAoBL,GACzB,EAAK3H,cAEP0F,cAAe,EAAK1F,aAGtB,EAAKgI,oBAAoBL,I,EAI7BM,iBAAmB,WAAO,IAChB7C,EAA2B,EAAKtvB,MAAhCsvB,uBACRA,EAAuB5oB,KAAKrB,IAAEyoB,UAAUvJ,KACxC,EAAKoB,cAAc2J,I,EAGrB+C,+BAAiC,SAAAX,GAC/B,IAAIvN,EAAsB,EAU1B,OATAuN,EAAOY,UAAU/kB,SAAQ,SAAAokB,GACnB,EAAK/rB,MAAM2sB,iBAAiBve,SAAS2d,EAAMzN,aAC7CyN,EAAMxN,oBAAsBA,EAC5BA,EAAsB,GAEtBwN,EAAMxN,oBAAsB,EAE9BA,GAA4C,KAEvCuN,EAAOY,W,EAGhBjS,eAAiB,SAAAwR,GAAe,IAAD,EACiB,EAAK7xB,MAA3CovB,EADqB,EACrBA,UAAWE,EADU,EACVA,uBACbkD,EAAoBlD,EACtBA,EAAuBvd,QAAO,SAACwO,EAASyF,GAAV,OAAkBA,IAAQ6L,KAAY1rB,KAAI,SAAAoa,GAAO,OAAIA,EAAQtZ,QAC3F,GACJ,OAASmoB,GAAeA,EAAUhR,QAC9BgR,EAAUhR,QACPrM,QAAO,SAAAwO,GAAO,OAAKiS,EAAgBxe,SAASuM,EAAQtZ,SACpDd,KAAI,SAAAoa,GAAO,MAAK,CAAEva,MAAOua,EAAQtZ,KAAMnG,MAAOyf,EAAQtZ,SACzD,I,EAGNwrB,gBAAkB,SAAAZ,GAAU,OAAI,SAAA9hB,GAAU,IAAD,EACO,EAAK/P,MAA3CovB,EAD+B,EAC/BA,UAAWE,EADoB,EACpBA,uBACb9D,EAAczb,EAAMjP,MACpBsd,IAAYgR,KAAeA,EAAUhR,SAAWgR,EAAUhR,QAAQzZ,MAAK,SAAAwrB,GAAE,OAAIA,EAAGlpB,OAASukB,KACzFjL,EAAU,CACdtZ,KAAMukB,EACNkH,aAAgBtU,GAAaA,EAAQG,cAAgBH,EAAQG,cAAc7c,OhE1N7D,EgE2NdgwB,OAAQ,CAAC1N,KAGPsL,GACAA,EAAuBuC,IACvBvC,EAAuBuC,GAAYH,QACrCpC,EAAuBuC,GAAYH,OAAOrH,MAAK,SAAAsH,GAAK,QAAMA,EAAMzN,cAEhE,EAAKze,SAAS,CACZ+pB,aAAa,EACbC,YAAa,CAAEjrB,GAAI,+CACnBkrB,UAAW,CAAElrB,GAAI,6CACjBmrB,eAAgB,WACdL,EAAuBuC,GAActR,EACrC,EAAKoF,cAAc2J,GACnB,EAAKpF,cAEP0F,cAAe,EAAK1F,cAGtBoF,EAAuBuC,GAActR,EACrC,EAAKoF,cAAc2J,M,EAIvBqD,SAAW,SAACd,EAAYe,GAAkB,IAChCtD,EAA2B,EAAKtvB,MAAhCsvB,uBACRA,EAAuBuC,GAAYH,OAAO5b,OAAO8c,EAAe,EAAG,EAAG5O,IACtE,EAAK2B,cAAc2J,I,EAGrBuD,YAAc,SAAChB,EAAYiB,GAAc,IAC/BxD,EAA2B,EAAKtvB,MAAhCsvB,uBACJoC,EAASpC,EAAuBuC,GAAYH,OAChDA,EAAO5b,OAAOgd,EAAU,GACF,IAAlBpB,EAAOhwB,QACTgwB,EAAOhrB,KAAK,IAEdgrB,EAAS,EAAKW,+BAA+BX,GAC7C,EAAK/L,cAAc2J,I,EAGrByD,iBAAmB,SAAAlB,GAAe,IAAD,EACU,EAAKjsB,MAAtC2rB,EADuB,EACvBA,WAAYgB,EADW,EACXA,iBACpB,OAAI,EAAKS,qBAAqBnB,IAAiBU,EACtChB,EACJxf,QAAO,SAAAkhB,GAAS,OAAKV,EAAiBve,SAASif,EAAU7sB,YACzDD,KAAI,SAAA8sB,GAAS,MAAK,CAAEjtB,MAAOitB,EAAU7sB,QAAStF,MAAOmyB,EAAU7sB,YAE7DmrB,EAAWprB,KAAI,SAAA8sB,GAAS,MAAK,CAAEjtB,MAAOitB,EAAU7sB,QAAStF,MAAOmyB,EAAU7sB,a,EAGnF8sB,kBAAoB,SAACrB,EAAYiB,GAAb,OAA0B,SAAA/iB,GAAU,IAC9Cuf,EAA2B,EAAKtvB,MAAhCsvB,uBACAiD,EAAqB,EAAK3sB,MAA1B2sB,iBACFrO,EAAanU,EAAMjP,MACrBmjB,EAAa,EACXsO,GAAoBA,EAAiBve,SAASkQ,IAClDoL,EAAuBuC,GAAYH,OAAOnkB,SAAQ,SAACokB,EAAO3L,GACpDuM,EAAiBve,SAAS2d,EAAMzN,aAAe8B,EAAM8M,IACvD7O,GAA0B,MAIhCqL,EAAuBuC,GAAYH,OAAOoB,GAA1C,2BACKxD,EAAuBuC,GAAYH,OAAOoB,IAD/C,IAEE5O,aACAD,eAEFqL,EAAuBuC,GAAYH,OAAS,EAAKW,+BAA+B/C,EAAuBuC,GAAYH,QACnH,EAAK/L,cAAc2J,K,EAGrB6D,eAAiB,SAACtB,EAAYiB,EAAU7rB,GAAvB,OAAgC,SAAAiJ,GAAM,IAC7Cof,EAA2B,EAAKtvB,MAAhCsvB,uBACRA,EAAuBuC,GAAYH,OAAOoB,GAAU7rB,GAAQwpB,SAASvgB,EAAEF,OAAOlP,MAAO,IACrF,EAAK6kB,cAAc2J,K,EAGrB8D,iBAAmB,SAACvB,EAAY5N,GAC9B,IAAM7F,EAAU,EAAKwT,yBAAyBC,GAC9C,OAASzT,GAAaA,EAAQG,eAAmBH,EAAQG,cAAc0F,EAAa,GAAK7F,EAAQG,cAAc0F,EAAa,GAAK,I,EAGnIoP,qBAAuB,SAAAxB,GAAe,IAC5BvC,EAA2B,EAAKtvB,MAAhCsvB,uBAD2B,EAEA,EAAK1pB,MAAhC7D,EAF2B,EAE3BA,KAAMwwB,EAFqB,EAErBA,iBACRnU,EAAU,EAAKwT,yBAAyBC,GACxCyB,IACFhE,KACAA,EAAuBuC,MACvBvC,EAAuBuC,GAAYH,UACnCa,GACFjD,EAAuBuC,GAAYH,OAAO3f,QAAO,SAAA4f,GAAK,OAAIY,EAAiBve,SAAS2d,EAAMzN,eAAaxiB,OACzG,QACI0c,KACAA,EAAQG,eACVH,EAAQG,cAAcpY,KAAI,SAACykB,EAAc7b,GAAf,OACxB,uBAEE7G,UAAW6G,EAAIukB,EAAkB,kCAAoC,uBACrEpZ,MAAOnY,EAAKkG,cAAc,CAAEzD,GAAI,wCAHlC,SAKGomB,GALH,uBACuBiH,EADvB,YACqC9iB,Q,EAU3CkjB,uBAAyB,WAAO,IAAD,EACiB,EAAKjyB,MAA3CovB,EADqB,EACrBA,UAAWE,EADU,EACVA,uBACnB,QAASA,KAA4BF,KAAeA,EAAUhR,SAAWkR,EAAuB5tB,SAAW0tB,EAAUhR,QAAQ1c,Q,EAG/HsxB,qBAAuB,SAAAnB,GAAe,IAC5BvC,EAA2B,EAAKtvB,MAAhCsvB,uBACAiD,EAAqB,EAAK3sB,MAA1B2sB,iBACR,QAASjD,GACLA,EAAuBuC,IACvBvC,EAAuBuC,GAAYH,QACnCpC,EAAuBuC,GAAYa,cACnCH,IACAjD,EAAuBuC,GAAYa,eACjCpD,EAAuBuC,GAAYH,OAAO3f,QAAO,SAAA4f,GAAK,OAAIY,EAAiBve,SAAS2d,EAAMzN,eAAaxiB,Q,EAI/G6xB,QAAU,kBAAM,EAAKvzB,MAAMsvB,uBAAuBhW,OAAM,SAACiH,EAASyF,GAAV,OAAkB,EAAKgN,qBAAqBhN,O,EAEpGkE,WAAa,kBAAM,EAAKzkB,SAAS,CAAE+pB,aAAa,K,EAEhDgE,cAAgB,WAAO,IAAD,EACuC,EAAK5tB,MAAxD7D,EADY,EACZA,KAAMwwB,EADM,EACNA,iBAAkBpB,EADZ,EACYA,uBAC1BqC,EAAgB,EAAKxzB,MAAMsvB,wBAA0B,GAC3D,OACE,uCACGkE,EAAcrtB,KAAI,SAACoa,EAASxR,GAC3B,IAAM2iB,EAASnR,EAAQmR,QAAU,GAC3B+B,EAAa,EAAKzzB,MAAMyxB,4BAA4Bzd,SAASuM,KAAa4Q,EAChF,OACE,uBAA0BjpB,UAAU,UAApC,UACE,sBAAKA,UAAU,qDAAf,SACE,yBAAQA,UAAU,kBAAkBqB,QAAS,kBAAM,EAAK6oB,sBAAsBrjB,IAA9E,SACE,eAAC,IAAD,CAAkBvK,GAAG,sCAGzB,uBAAK0D,UAAU,SAAf,UACE,uBAAKA,UAAU,gBAAf,UACE,sBAAKA,UAAU,mCAAf,SACE,eAAC2gB,GAAD,CACErgB,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,mCACtCmkB,kBAAmBpI,EAAQtZ,KAC3BnG,MAAOyf,EAAQtZ,MAAQ,CAAEnG,MAAOyf,EAAQtZ,KAAMjB,MAAOua,EAAQtZ,MAC7DqB,SAAU,EAAKmqB,gBAAgB1jB,GAC/B3G,QAAS,EAAKiY,eAAetR,GAC7BwZ,iBAAiB,SACjBhgB,gBAAgB,iBAChB2c,MAAOD,GACPtc,WAAY8qB,MAGhB,uBAAKvrB,UAAU,yDAAf,UACG,EAAKmrB,qBAAqBtkB,IACzB,EAAKikB,qBAAqBjkB,IAC1B,uBAAM7G,UAAU,mBAAhB,SACE,eAAC,IAAD,CAAkB1D,GAAG,6DAK7B,sBAAK0D,UAAU,oBAEhBwpB,EAAOvrB,KAAI,SAACwrB,EAAO3M,GAAO,IACjBf,EAAgE0N,EAAhE1N,WAAYC,EAAoDyN,EAApDzN,WAAYE,EAAwCuN,EAAxCvN,UAAWC,EAA6BsN,EAA7BtN,eAAgBC,EAAaqN,EAAbrN,SAC3D,OACE,uBAAoCpc,UAAU,SAA9C,UACE,uBAAKA,UAAU,gBAAf,UACE,uBAAKA,UAAU,mCAAf,UACE,eAAC2gB,GAAD,CACErgB,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,qCACtCmkB,kBAAmBzE,EACnBpjB,MAAOojB,EAAa,CAAEpjB,MAAOojB,EAAYle,MAAOke,GAAe,KAC/D5b,SAAU,EAAK4qB,kBAAkBnkB,EAAGiW,GACpC5c,QAAS,EAAK2qB,iBAAiBhkB,GAC/BwZ,iBAAiB,SACjBhgB,gBAAgB,iBAChB2c,MAAOD,GACPtc,WAAY8qB,IAEd,eAAC7K,GAAD,CACE1oB,KAAK,SACLsI,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,0CACtCmkB,iBAAe,EACf7nB,MAAOujB,GAAkB,EACzB/b,SAAU,EAAK6qB,eAAepkB,EAAGiW,EAAG,kBACpCuD,iBAAiB,SACjBc,IhE/ZN,EgEgaM8B,SAAUsI,SAGXlB,GAAoBA,EAAiBve,SAASkQ,IAC/C,uBAAKhc,UAAU,mCAAf,UACE,eAAC0gB,GAAD,CACEpgB,YAAW,UAAKyb,GAAL,OAAkBliB,EAAKkG,cAAc,CAC9CzD,GAAIugB,GAAiBd,KADZ,YAELliB,EAAKkG,cAAc,CAAEzD,GAAI,uCAC/BmkB,iBAAe,EACf7nB,MAAO,EAAKsyB,iBAAiBrkB,EAAGkV,GAChCsE,iBAAiB,SACjB/e,UAAQ,IAEV,eAACof,GAAD,CACE1oB,KAAK,SACLsI,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,qCACtCmkB,iBAAe,EACf7nB,MAAOsjB,GAAa,EACpB9b,SAAU,EAAK6qB,eAAepkB,EAAGiW,EAAG,aACpCuD,iBAAiB,SACjBc,IhErbR,EgEsbQ8B,SAAUsI,IAEZ,eAAC7K,GAAD,CACE1oB,KAAK,SACLsI,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,oCACtCmkB,iBAAe,EACf7nB,MAAOwjB,GAAY,EACnBhc,SAAU,EAAK6qB,eAAepkB,EAAGiW,EAAG,YACpCuD,iBAAiB,SACjBc,IhE/bR,EgEgcQ8B,SAAUsI,WAKhBA,GACA,eAACjK,GAAD,CAAkBznB,KAAMA,EAAM0nB,YAAa,kBAAM,EAAKkJ,SAAS5jB,EAAGiW,IAAI0E,aAAc,kBAAM,EAAKmJ,YAAY9jB,EAAGiW,QA5DlH,uBAA0BjW,EAA1B,YAA+BiW,SAnCrC,kBAAqBjW,OAuGzB,sBAAK7G,UAAU,uCAAf,SACE,yBAAQA,UAAU,kBAAkBqB,QAAS,EAAK4oB,iBAAkB3oB,SAAU,EAAKyoB,yBAAnF,SACE,eAAC,IAAD,CAAkBztB,GAAG,oD,EAO/BkvB,wBAA0B,kBACxB,eAAC,GAAD,CACErX,OAAQ,EAAKrc,MAAMyvB,YACnBhT,KAAM,EAAKzc,MAAM0vB,UACjB9S,MAAO,EAAK5c,MAAM2vB,eAClB9S,KAAM,EAAK7c,MAAM4vB,cACjB9S,OAAQ,EAAK9c,MAAMwvB,e,uDAravB,WACEhoB,KAAK5B,MAAMxE,kBAAkBigB,IAC7B7Z,KAAK5B,MAAMxE,kBAAkB0iB,IAC7Btc,KAAK5B,MAAM+tB,gBACXnsB,KAAKqoB,sB,gCAGP,SAAmBnoB,EAAmDC,EAAmDC,GAAiB,IAAD,EACrFJ,KAAK5B,MAA/C7D,EAD+H,EAC/HA,KAAMJ,EADyH,EACzHA,OAAQnC,EADiH,EACjHA,QAASmB,EADwG,EACxGA,QAASwH,EAD+F,EAC/FA,MACpCT,EAAU/F,SAAWA,GACvB6F,KAAKqoB,qBAEFnoB,EAAU/G,SAAWA,GACxBqH,aAAajG,EAAKkG,cAAc,CAAEzD,GAAI,oCACtCgD,KAAK5B,MAAMxE,kBAAkB0iB,KACpBpc,EAAUS,QAAUX,KAAK5B,MAAMuC,OAAU3I,GAClDwxB,aAAW7oB,K,oBAyZf,WAAU,IAAD,EAC2CX,KAAK5B,MAA/CqrB,EADD,EACCA,SAAUC,EADX,EACWA,WAAY1xB,EADvB,EACuBA,QAASmC,EADhC,EACgCA,OACvC,OACE,uBAAKuG,UAAU,2BAAf,UACGV,KAAKksB,0BACN,8BACE,eAAC,IAAD,CAAkBlvB,GAAG,mCAEvB,sBAAK0D,UAAU,QAAf,SAAwB+oB,IACxB,sBAAK/oB,UAAU,gBAAf,SACGgpB,GAAe1xB,IAAYmC,EAC1B,eAACgN,GAAA,EAAD,IAEA,uCACE,sBAAKzG,UAAU,UAAf,SAA0BV,KAAKgsB,kBAC/B,uBAAKtrB,UAAU,YAAf,UACE,sBAAKA,UAAU,WAAf,SACE,eAACoB,EAAA,EAAD,CAAQpB,UAAU,SAASqB,QAAS/B,KAAKmpB,OAAzC,SACE,eAAC,IAAD,CAAkBnsB,GAAG,sBAGzB,sBAAK0D,UAAU,+CAAf,SACE,eAACoB,EAAA,EAAD,CAAQpB,UAAU,OAAOqB,QAAS/B,KAAKsqB,OAAQtoB,SAAUhK,IAAYgI,KAAK+rB,UAA1E,SACE,eAAC,IAAD,CAAkB/uB,GAAG,mC,GA7cJiF,IAAMC,WAserCC,GAAqB,CAAEvI,oBAAmBK,gBAAeJ,gBAAesyB,cDtfjD,WAC3B,IACMC,EAAO,UADG,cACH,YACPC,EAAY,UAAMD,EAAN,cAClB,MAAO,CACL1zB,KAAMZ,GACNa,QAASe,IAAMC,IAAI0yB,MCqfRhqB,sBAlBS,SAAC,GAAD,YAAG0H,EAAH,EAAGA,KAAM9Q,EAAT,EAASA,SAAUkxB,EAAnB,EAAmBA,MAAnB,MAAgC,CACtDY,iBAAgB,iBAAEhhB,QAAF,IAAEA,OAAF,EAAEA,EAAMuiB,2BAAR,QAA+B/P,GAC/CoN,uBAAsB,iBAAE5f,QAAF,IAAEA,OAAF,EAAEA,EAAM+f,iCAAR,SACtBL,SAAU1f,EAAKzR,aACfoxB,WAAY3f,EAAK/R,QACjB2I,MAAOoJ,EAAKzR,aACZN,QAASiB,EAASjB,QAClBmB,QAASF,EAASE,QAClBgB,QAAQ,UAAAlB,EAASC,eAAT,eAAkBI,SAAlB,UAA2BL,EAASC,eAApC,aAA2B,EAAkBI,OACrDJ,QAASD,EAASC,QAClB6wB,WAAYI,EAAMJ,cAQoB5nB,GAAzBE,CAA6CE,YAAWC,qBAAWwnB,MCvhBrEuC,I,QAA6B,CAAC,SAAU,SAAU,SAAU,SAAU,SAAU,SAAU,WAC1FC,GAA4B,mBCI5B10B,GACO,+BADPA,GAEY,oCAFZA,GAGQ,gCAGfC,GAAe,CACnB00B,YAAa,GACbtwB,YlEXiB,EkEYjBuwB,aAAa,EACbjwB,WlEdkB,EkEelBkwB,oBAAoB,EACpBC,wBAAyB,GACzBt0B,aAAc,KACdu0B,sBAAsB,GA2EXC,GAAiB,WAE5B,MAAO,CACLp0B,KAAMZ,GACNa,QAASe,IAAMC,IAHE,kCAwBNpB,GAjGC,WAAmC,IAAlCC,EAAiC,uDAAzBT,GAAcU,EAAW,uCAChD,OAAQA,EAAOC,MACb,KAAKhB,EAAQI,IACb,KAAKJ,EAAQI,IACX,OAAO,2BACFU,GADL,IAEEm0B,oBAAoB,IAExB,KAAK90B,EAAQC,IACb,KAAKD,EAAQC,IACX,OAAO,eACFU,GAEP,KAAKZ,EAAQE,IACX,OAAO,2BACFU,GADL,IAEEm0B,oBAAoB,EACpBC,wBAA2Bn0B,EAAOE,QAAQI,KAAKg0B,QAAUt0B,EAAOE,QAAQI,KAAKg0B,QAAQpuB,KAAI,SAAAouB,GAAO,OAAIA,EAAQA,WAAW,KAE3H,KAAKn1B,EAAQE,IACX,IAAMiB,EAASN,EAAOE,QAAQI,KAAKg0B,QAAUt0B,EAAOE,QAAQI,KAAKg0B,QAAQpuB,KAAI,SAAAouB,GAAO,OAAIA,EAAQA,WAAW,GACrG5wB,EAAc1D,EAAOE,QAAQI,KAAKi0B,WACxC,OAAO,2BACFx0B,GADL,IAEEi0B,YlE5CW,IkE4CEtwB,EAAsBpD,EAAtB,uBAAiCP,EAAMi0B,aAAvC,aAAuD1zB,IACpE2zB,YAAaj0B,EAAOE,QAAQI,KAAKk0B,SACjC9wB,cACAM,WAAYhE,EAAOE,QAAQI,KAAK0D,WAChCkwB,oBAAoB,IAExB,KAAKj1B,EAAQI,IACX,OAAO,2BACFU,GADL,IAEEi0B,YAAa,GACbtwB,YlEtDW,EkEuDXuwB,aAAa,EACbjwB,WlEzDY,EkE0DZkwB,oBAAoB,EACpBO,qBAAqB,EACrBL,sBAAsB,IAE1B,KAAKh1B,EAAQC,IACX,OAAO,2BACFU,GADL,IAEEF,aAAcG,EAAOE,QAAQoS,SAAShS,OAE1C,KAAKnB,EAAQE,IACX,OAAO,2BACFU,GADL,IAEE00B,qBAAqB,EACrBP,oBAAoB,EACpBr0B,aAAc,KACdu0B,sBAAsB,IAE1B,QACE,OAAOr0B,I,iDCvEE,SAAS20B,GAAT,GAA8E,IAA1DC,EAAyD,EAAzDA,gBAAiBC,EAAwC,EAAxCA,qBAAsBC,EAAkB,EAAlBA,eAAkB,EAClDrrB,IAAMsrB,UAAS,GADmC,oBACnFC,EADmF,KACrEC,EADqE,OAElDxrB,IAAMsrB,SAAS,MAFmC,oBAEnFG,EAFmF,KAErEC,EAFqE,OAGlD1rB,IAAMsrB,SAAS,MAHmC,oBAGnFK,EAHmF,KAGrEC,EAHqE,KAO1F,OACE,uCACE,eAAC,KAAD,CACEC,OAAQV,EACRW,UAAU,EACVC,eAAgB,SAAAC,GACdN,EAAgBM,EAAK9wB,KAAKmW,UAC1Bua,EAAgB,MAChBJ,GAAgB,GAChBH,EAAeW,EAAK9wB,KAAKmW,WAE3B4a,eAAgB,SAAAD,GACdN,EAAgB,MAChBE,EAAgBI,EAAK9wB,KAAKmW,UAC1Bma,GAAgB,GAChBH,EAAe,OAEjBa,YAAa,kBAAMV,GAAgB,IACnCW,YAAa,kBAAMX,GAAgB,IAhBrC,SAkBG,gBAAGY,EAAH,EAAGA,aAAcC,EAAjB,EAAiBA,cAAjB,OACC,mCACE,iDAASD,EAAa,CAAE3tB,UAAW8sB,EAAe,2BAA6B,cAA/E,cACE,sCAAWc,MACX,sBAAK5tB,UAAU,uBAAf,SACE,eAAC,IAAD,CAAkB1D,GAAIqwB,MAExB,eAACvrB,EAAA,EAAD,UACE,eAAC,IAAD,CAAkB9E,GAAG,uCAM/B,sBAAK0D,UAAU,cAAf,YApC0BgtB,KAAkBE,IAsCxC,uCACE,sBAAKltB,UAAS,mBAAgBgtB,EAAe,gBAAkB,iBAA/D,SACE,eAAC,IAAD,CACE1wB,GAAE,mBAAgB0wB,EAAe,eAAiB,gBAClD3Y,OAAQ,CAAEwZ,EAAG,sCAAIxe,EAAJ,yBAAIA,EAAJ,uBAAa,6BAAIA,UAGlC,oBAAGrP,UAAU,gBAAb,SAAgCgtB,EAAeA,EAAajuB,KAAOmuB,EAAaK,KAAKxuB,e,ICrB3F+uB,G,4MACJh2B,MAAQ,CACNwvB,aAAa,EACbC,YAAa,CAAEjrB,GAAI,GAAI+X,OAAQ,IAC/BmT,UAAW,CAAElrB,GAAI,GAAI+X,OAAQ,IAC7BoT,eAAgB,KAChBC,cAAe,KACfoF,cAAc,EACdE,aAAc,KACdE,aAAc,KACda,wBAAwB,EACxB5xB,KAAM,EACN6xB,gCAAgC,G,EAmBlCvF,OAAS,WACP1hB,OAAOpJ,SAASqJ,KAAOvQ,G,EAGzBw3B,SAAW,WAAO,IAAD,EACkC,EAAKn2B,MAA9Ck1B,EADO,EACPA,aAAce,EADP,EACOA,uBACtB,EAAKxwB,SAAS,CACZ+pB,aAAa,EACbC,YAAa,CAAEjrB,GAAG,2CAAD,OAA6CyxB,EAA7C,iBACjBvG,UAAW,CAAElrB,GAAG,2CAAD,OAA6CyxB,EAA7C,eACftG,eAAgB,WACd,EAAK/pB,MAAMwwB,gBAAgBlB,EAAce,GACzC,EAAK/L,cAEP0F,cAAe,EAAK1F,c,EAIxBA,WAAa,kBAAM,EAAKzkB,SAAS,CAAE+pB,aAAa,K,EAEhD6G,6BAA+B,SAAAtmB,GAAK,OAAI,EAAKtK,SAAS,CAAEwwB,uBAAwBlmB,EAAMC,OAAOlP,QAAU+M,M,EAEvGW,WAAa,SAAAnK,GAAI,OAAI,EAAKoB,SAAS,CAAEpB,SAAQ,kBAAM,EAAKuB,MAAM0wB,mBAAmB,EAAKt2B,MAAMqE,U,EAE5F0H,cAAgB,SAACR,EAAQS,GAAT,OAAoBT,EAAOwoB,GAA2B9Y,QAAQjP,K,EAE9EuqB,2BAA6B,kBAAMC,KAAY,EAAK5wB,MAAMwuB,wBAAyB,KAAMJ,K,EAEzFyC,oBAAsB,kBAAO,EAAKz2B,MAAMk2B,+BAAiC,EAAKK,6BAA+B,EAAK3wB,MAAM0uB,kB,EAExHoC,kBAAoB,kBAClB,eAAC,GAAD,CACEra,OAAQ,EAAKrc,MAAMyvB,YACnBhT,KAAM,EAAKzc,MAAM0vB,UACjB9S,MAAO,EAAK5c,MAAM2vB,eAClB9S,KAAM,EAAK7c,MAAM4vB,cACjB9S,OAAQ,EAAK9c,MAAMwvB,e,EAIvBmH,aAAe,kBACb,uCACE,6BACE,eAAC,IAAD,CAAkBnyB,GAAG,kCAAkC+X,OAAQ,CAAEwZ,EAAG,sCAAIxe,EAAJ,yBAAIA,EAAJ,uBAAa,6BAAIA,UAEvF,oBAAGrP,UAAU,WAAb,SACE,eAAC,IAAD,CAAkB1D,GAAG,sCAEvB,oBAAG0K,KAAI,UAAKvQ,EAAL,wDAAqEi4B,UAAQ,EAAC1uB,UAAU,OAA/F,SACE,eAAC,IAAD,CAAkB1D,GAAG,yCAEvB,oBAAG0K,KAAI,UAAKvQ,EAAL,wDAAqEi4B,UAAQ,EAAC1uB,UAAU,OAA/F,SACE,eAAC,IAAD,CAAkB1D,GAAG,6C,EAK3BqyB,iCAAmC,kBACjC,uBAAKvuB,SAAU,EAAK+tB,6BAA8BnuB,UAAU,OAA5D,UACE,uBAAKA,UAAU,uBAAf,UACE,wBAAOhI,KAAK,QAAQsE,GAAG,kBAAkB1D,MAAOgN,GAAc7G,KAAK,uBAAuBiB,UAAU,eAAe4uB,gBAAc,IACjI,wBAAO1O,QAAQ,kBAAf,SACE,eAAC,IAAD,CAAkB5jB,GAAG,kEAGzB,uBAAK0D,UAAU,uBAAf,UACE,wBAAOhI,KAAK,QAAQsE,GAAG,iBAAiB1D,MAAO+M,GAAa5G,KAAK,uBAAuBiB,UAAU,iBAClG,wBAAOkgB,QAAQ,iBAAf,SACE,eAAC,IAAD,CAAkB5jB,GAAG,qE,EAM7BuyB,aAAe,kBACb,uBAAK7uB,UAAU,wBAAf,UACE,uBAAKA,UAAU,gBAAf,UACG,EAAKtC,MAAMyuB,sBACV,sBAAKnsB,UAAU,UAAf,SACE,eAACyG,GAAA,EAAD,MAGJ,eAACrF,EAAA,EAAD,CAAQC,QAAS,EAAK4sB,SAAU3sB,SAAU,EAAK5D,MAAMyuB,uBAAyB,EAAKr0B,MAAMk1B,aAAchtB,UAAU,aAAjH,SACE,eAAC,IAAD,CAAkB1D,GAAG,mCAGzB,oBAAG0D,UAAU,0BAAb,SAAwC,EAAKtC,MAAMoxB,kB,EAIvDC,eAAiB,SAAAztB,GAAQ,OACvB,eAACF,EAAA,EAAD,CAAQC,QAAS,EAAKktB,oBAAqBjtB,SAAUA,IAAa,EAAK5D,MAAM3B,WAAYiE,UAAU,SAAnG,SACE,eAAC,IAAD,CAAkB1D,GAAG,mC,EAIzB0yB,kBAAoB,WAAO,IACjB7yB,EAAS,EAAKrE,MAAdqE,KADgB,EAEmE,EAAKuB,MAAxF3B,EAFgB,EAEhBA,WAAYkzB,EAFI,EAEJA,mBAAoB9C,EAFhB,EAEgBA,qBAAsBJ,EAFtC,EAEsCA,YAAaC,EAFnD,EAEmDA,YACrEkD,EAA2BnzB,EpEpKjB,EoEqKVozB,EAAiBF,KAAwBC,GAA4B/C,GAE3E,OACE,uBAAKnsB,UAAU,wBAAf,UACE,uBAAKA,UAAU,gBAAf,UACE,8BACE,eAAC,IAAD,CAAkB1D,GAAG,8BAEtB,EAAKyyB,eAAeI,MAEtBA,EACC,sBAAKnvB,UAAU,UAAf,SACE,eAACyG,GAAA,EAAD,MAEAyoB,EACF,eAAC,GAAD,CACEjpB,QAAS4lB,GACTrwB,SAAUuwB,EACVloB,cAAe,EAAKA,cACpB7H,QAASgwB,EACTvwB,YAAaU,EACbmK,WAAY,EAAKA,aAGnB,oBAAGtG,UAAU,qBAAb,SACE,eAAC,IAAD,CAAkB1D,GAAG,8C,uDA7I/B,WACEgD,KAAK5B,MAAM0wB,mBAAmB9uB,KAAKxH,MAAMqE,Q,gCAG3C,SAAmBqD,EAAwCC,EAAwCC,GAAiB,IAAD,SAC3CJ,KAAK5B,MAAnE7D,EADyG,EACzGA,KAAMoG,EADmG,EACnGA,MAAOusB,EAD4F,EAC5FA,oBAAqBN,EADuE,EACvEA,yBACrC1sB,EAAUgtB,qBAAuBA,GACpC1sB,aAAajG,EAAKkG,cAAc,CAAEzD,GAAI,gCACtCgD,KAAK/B,SAAS,CAAEpB,KpEzDF,EoEyDc6xB,gCAAgC,IAAS,kBAAM,EAAKtwB,MAAM0wB,mBAAmB,EAAKt2B,MAAMqE,UAC3GqD,EAAU0sB,0BAA4BA,EAC/C5sB,KAAK/B,SAAS,CAAEywB,gCAAgC,GAAQ1uB,KAAK+uB,4BACpD7uB,EAAUS,QAAUA,GAC7B6oB,aAAW7oB,K,oBAwIf,WAAU,IAAD,SAC0BX,KAAK5B,MAA9BqrB,EADD,EACCA,SAAUC,EADX,EACWA,WAClB,OACE,uBAAK1sB,GAAG,eAAR,UACGgD,KAAKkvB,oBACN,8BACE,eAAC,IAAD,CAAkBlyB,GAAG,wBAEvB,sBAAK0D,UAAU,QAAf,SAAwB+oB,IACxB,sBAAK/oB,UAAU,gBAAf,SACGgpB,EACC,sBAAKhpB,UAAU,UAAf,SACE,eAACyG,GAAA,EAAD,MAGF,uBAAKzG,UAAU,UAAf,UACE,8BACE,eAAC,IAAD,CAAkB1D,GAAG,+BAEtBgD,KAAKmvB,eACN,eAAC,GAAD,CACE/B,gBHzNwB,YG0NxBC,qBAAqB,mCACrBC,eAAgB,SAAAI,GAAY,OAAI,EAAKzvB,SAAS,CAAEyvB,oBAEjD1tB,KAAKqvB,mCACLrvB,KAAKuvB,eACLvvB,KAAK0vB,gC,GA9LMztB,IAAMC,WAqN1BC,GAAqB,CAAE2sB,mBFvKK,WAA4D,IAA3DjyB,EAA0D,uDlEhFzE,EkEgFoCqM,EAAqC,uDAAtBlN,GAC/DvC,EAAa,+BACnB,MAAO,CACLf,KAAMZ,GACNa,QAASe,IAAMC,IAAIF,EAAY,CAC7B2F,OAAQ,CACNvC,KAAMA,EAAO,EACbizB,KAAM5mB,OEgKmC4jB,kBAAgB8B,gBFlJlC,SAACX,EAAYQ,GAC1C,IACM5jB,EAAW,IAAIklB,SAKrB,OAJAllB,EAASmlB,OAAO,OAAQ/B,GACxBpjB,EAASmlB,OAAO,YD3Ge,KC4G/BnlB,EAASmlB,OAAO,2BAA4B,SAC5CnlB,EAASmlB,OAAO,YAAhB,UAAgCvB,IACzB,CACL/1B,KAAMZ,GACNa,QAASe,IAAMM,KARE,sCAQe6Q,EAAU,CACxColB,QAAS,CACP,eAAgB,4BE4IT5tB,sBAnBS,SAAC,GAAD,IAAG0H,EAAH,EAAGA,KAAM0iB,EAAT,EAASA,YAAT,MAA4B,CAClDhD,SAAU1f,EAAKzR,aACfoxB,WAAY3f,EAAK/R,QACjB2I,MAAOoJ,EAAKzR,aACZq3B,mBAAoBlD,EAAYE,mBAChCE,qBAAsBJ,EAAYI,qBAClCK,oBAAqBT,EAAYS,oBACjCT,YAAaA,EAAYA,YACzBC,YAAaD,EAAYC,YACzBjwB,WAAYgwB,EAAYhwB,WACxB+yB,YAAa/C,EAAYn0B,aACzBs0B,wBAAyBH,EAAYG,2BAQCzqB,GAAzBE,CAA6CE,YAAWC,qBAAWgsB,M,wCC5PrE0B,GAA+B,oCAC/BC,GAAgC,sBAChC1L,GAAmBC,KAAQ0L,cAAczxB,KAAI,SAAA0xB,GAAI,MAAK,CAAE7xB,MAAOkmB,KAAQ4L,QAAQD,GAAO/2B,MAAO+2B,MAC7FE,GAAmC,CAAEC,aAAc,IACnDhE,GAA4B,mBCWlC,SAASiE,GAAiBryB,GAAgC,IACvD7D,EAAyC6D,EAAzC7D,KAAMm2B,EAAmCtyB,EAAnCsyB,UAAWpb,EAAwBlX,EAAxBkX,OAAQF,EAAgBhX,EAAhBgX,MAAOC,EAASjX,EAATiX,KADsB,EAE9BkY,mBAAS,MAFqB,oBAEvDoD,EAFuD,KAE7CC,EAF6C,KAG9D,OACE,gBAACrb,GAAA,EAAD,CAAOD,OAAQA,EAAQE,MAAM,EAA7B,UACE,eAACC,GAAA,EAAD,UACE,eAAC,IAAD,CAAkBzY,GAAG,wCAEvB,eAAC2Y,GAAA,EAAD,UACE,eAAC0L,GAAD,CACErgB,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,kDACtCmkB,kBAAmBwP,EACnBr3B,MAAOmrB,GAAiBtnB,MAAK,SAAA4W,GAAG,OAAIA,EAAIza,QAAUq3B,MAAa,KAC/D7vB,SAAU,SAAA+jB,GAAI,OAAI+L,EAAY/L,EAAKvrB,QACnCsH,QAAS6jB,GAAiBla,QAAO,SAAAsa,GAAI,OAAI6L,EAAUlkB,SAASqY,EAAKvrB,UACjEynB,iBAAiB,SACjBhgB,gBAAgB,iBAChB2c,MAAOD,OAGX,gBAAC5H,GAAA,EAAD,WACE,eAAC/T,EAAA,EAAD,CACEpB,UAAU,aACVqB,QAAS,WACPsT,IACAub,EAAY,OAJhB,SAOE,eAAC,IAAD,CAAkB5zB,GAAG,oBAEvB,eAAC8E,EAAA,EAAD,CACEpB,UAAU,kBACVqB,QAAS,WACPqT,EAAMub,GACNC,EAAY,OAJhB,SAOE,eAAC,IAAD,CAAkB5zB,GAAG,4C,YCjDlB6zB,GAAc,SAAC,GAAD,IAAGt2B,EAAH,EAAGA,KAAMjB,EAAT,EAASA,MAAOw3B,EAAhB,EAAgBA,cAAehwB,EAA/B,EAA+BA,SAA/B,OACzB,uBAAKJ,UAAU,uBAAf,UACE,sBAAKoI,IAAKC,GAAYC,IAAI,SAAStI,UAAU,gBAC7C,eAAC,KAAD,CAAOpH,MAAOA,EAAOwH,SAAUA,EAAUE,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI8zB,IAAkBpwB,UAAU,qBCHlGqwB,I,QAAe,SAAC,GAAD,IAAGx2B,EAAH,EAAGA,KAAMjB,EAAT,EAASA,MAAOsH,EAAhB,EAAgBA,QAASkwB,EAAzB,EAAyBA,cAAehwB,EAAxC,EAAwCA,SAAxC,OAC1B,eAAC,KAAD,CACEE,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI8zB,IACtCx3B,MAAOA,EACPwH,SAAUA,EACVF,QAASA,EACTG,gBAAgB,gBAChBL,UAAU,gBACVgd,MAAOD,OCwBLuT,I,QAA8B,CAAExyB,MAAO2H,GAAc7M,MAAO,OAC5D23B,GAAgC,UA0BzBC,GAAb,4MACE14B,MAAQ,CACN24B,yBAAyB,EACzBC,wBAAyB,CAAEp0B,GAAImJ,IAC/BkrB,sBAAuB,CAAEr0B,GAAImJ,IAC7BmrB,2BAA4B,KAC5BC,0BAA2B,KAC3B/D,cAAc,EACdE,aAAc,KACdE,aAAc,KACd4D,aAAc,GACdC,yBAA0B,GAC1BC,2BAA4B,GAC5BC,uBAAwB,KACxBC,iBAAkB,GAClBC,wBAAwB,EACxBC,kBAAmB3rB,GACnB4rB,oBAAqB,KACrBrmB,SAAS,GAlBb,EA0CEsmB,iBAAmB,WACjB,EAAK5zB,MAAMxE,kBAAkBs2B,IAC7B,EAAK9xB,MAAM0uB,iBACX,EAAK1uB,MAAMqS,mBA7Cf,EAgDEwhB,2BAA6B,SAAC/xB,EAAW9B,GAAZ,OAC3B8B,EAAUlI,UAAYoG,EAAMpG,WAAaoG,EAAMhF,iBAAmBgF,EAAMhF,eAAeE,OAjD3F,EAmDE44B,oBAAsB,WAAO,IAAD,MAC1B,IACE,YAAK9zB,MAAMlF,eAAX,eAAoBY,YAAao2B,IACjC,EAAK9xB,MAAMhF,eAAeC,mBAAmBmT,SAAS0jB,IACtD,CACA,IAAIsB,EACA,EAAKpzB,MAAMhF,gBAAkB,EAAKgF,MAAMhF,eAAeE,MAAQ2jB,GAAU,EAAK7e,MAAMjE,QAAUo2B,GAClGiB,EAAiBA,GAAkBA,EAAahB,aAAegB,EAAahB,aAAe,GAC3F,IAAMkB,EAA6B7qB,OAAO0hB,KAAKiJ,GAAc5K,OACvDuL,EAAe,GACrBtrB,OAAO0hB,KAAKiJ,GAAczrB,SAAQ,SAAA4qB,GAChC9pB,OAAO0hB,KAAKiJ,EAAab,IAAW5qB,SAAQ,SAAAuM,GAC1C6f,EAAa7f,GAAb,uCACK,EAAK8f,iBAAiBV,IACtBS,EAAa7f,IAFlB,mBAGGqe,EAAWa,EAAab,GAAUre,WAIzC,EAAKrU,SACH,CACEuzB,aAAcW,EACdV,yBAA0B5zB,IAAEyoB,UAAU6L,GACtCT,6BACAC,uBAAwB,EAAKvzB,MAAMlF,QACnCwS,SAAS,IAEX,WACE,EAAKtN,MAAMxE,kBAAkBigB,IAC7B,EAAKzb,MAAMxE,kBAAkBu2B,YAGxB,YAAK/xB,MAAMlF,eAAX,eAAoBY,YAAa+f,GAC1C,EAAKwY,6BACI,YAAKj0B,MAAMlF,eAAX,eAAoBY,YAAaq2B,IAC1C,EAAKlyB,UAAS,SAAAzF,GAAK,MAAK,CACtBo5B,iBAAoB,EAAKxzB,MAAMjE,OAC3B,EAAKiE,MAAMjE,OACRe,MArH0B,KAsH1ByD,KAAI,SAAAgyB,GAAQ,OAAIA,EAAS/H,UACzBre,QAAO,SAAAomB,GAAQ,OAAKn4B,EAAMk5B,2BAA2BllB,SAASmkB,MACjE,QA5FZ,EAiGE2B,+BAAiC,WAAO,IAAD,EACgB,EAAK95B,MAAlDg5B,EAD6B,EAC7BA,aAAcE,EADe,EACfA,2BAChBa,EAAwB,GAC1B3uB,MAAMC,QAAQ,EAAKzF,MAAMquB,eAC3B,EAAKruB,MAAMquB,YAAY1mB,SAAQ,SAAAysB,GAAO,OACpCA,EAAQzsB,SAAQ,SAAA0sB,GACRA,IAAiBF,EAAsB/lB,SAASimB,IAAiBC,MAAMD,IAC3EF,EAAsBrzB,KAAKuzB,SAIjCF,EACGhoB,QAAO,SAAAkoB,GAAY,OAAKjB,EAAaiB,MACrC1sB,SAAQ,SAAA0sB,GAAY,OAAKjB,EAAaiB,GAAgB,EAAKL,iBAAiBV,MAC/E,EAAKzzB,SAAS,CAAEuzB,eAAcC,yBAA0B5zB,IAAEyoB,UAAUkL,OA/G1E,EAmHEa,0BAA4B,WAAO,IAAD,EACqB,EAAK75B,MAAlDg5B,EADwB,EACxBA,aAAcE,EADU,EACVA,2BAChBiB,EAAwB,GACxBx4B,EAAS8iB,GAAU,EAAK7e,MAAMjE,QACpCA,EAAOyc,QAAQ7Q,SACb,SAAAgT,GAAO,QAAMA,EAAQtZ,OAASkzB,EAAsBnmB,SAASuM,EAAQtZ,OAASkzB,EAAsBzzB,KAAK6Z,EAAQtZ,SAEnHtF,EAAO4c,cAAchR,SACnB,SAAAqd,GAAY,QACRA,EAAa3jB,OAASkzB,EAAsBnmB,SAAS4W,EAAa3jB,OAASkzB,EAAsBzzB,KAAKkkB,EAAa3jB,SAEzHtF,EAAO6c,gBAAgBjR,SACrB,SAAA4qB,GAAQ,QAAMA,EAASlxB,OAASkzB,EAAsBnmB,SAASmkB,EAASlxB,OAASkzB,EAAsBzzB,KAAKyxB,EAASlxB,SAEvHoH,OAAO0hB,KAAKpuB,EAAOgd,eAAepR,SAAQ,SAAAuM,GAAG,OAC3CnY,EAAOgd,cAAc7E,GAAKvM,SACxB,SAAA0sB,GAAY,QACRA,EAAahzB,OAASkzB,EAAsBnmB,SAASimB,EAAahzB,OAASkzB,EAAsBzzB,KAAKuzB,EAAahzB,YAG3HkzB,EACGpoB,QAAO,SAAAqoB,GAAW,OAAKpB,EAAaoB,MACpC7sB,SAAQ,SAAA6sB,GAAW,OAAKpB,EAAaoB,GAAe,EAAKR,iBAAiBV,MAC7E,EAAKzzB,SAAS,CAAEuzB,eAAcC,yBAA0B5zB,IAAEyoB,UAAUkL,MA1IxE,EA6IEqB,6BAA+B,WAAO,IAAD,EACkB,EAAKr6B,MAAlDg5B,EAD2B,EAC3BA,aAAcE,EADa,EACbA,2BACdrhB,EAAc,EAAKjS,MAAnBiS,UACJzM,MAAMC,QAAQwM,KAChBA,EACG9F,QAAO,SAAAlM,GAAQ,QAAMA,EAASO,UAAY4yB,EAAanzB,EAASO,YAChEmH,SAAQ,SAAA1H,GAAQ,OAAKmzB,EAAanzB,EAASO,SAAW,EAAKwzB,iBAAiBV,MAC/E,EAAKzzB,SAAS,CAAEuzB,eAAcC,yBAA0B5zB,IAAEyoB,UAAUkL,OApJ1E,EAwJEY,iBAAmB,SAAA1B,GACjB,IAAMkC,EAAc,GAEpB,OADAlC,EAAU3qB,SAAQ,SAAA4qB,GAAQ,OAAKiC,EAAYjC,GAAYxqB,MAChDysB,GA3JX,EA8JEE,+BAAiC,SAAAtB,GAO/B,OAN4B3qB,OAAO0hB,KAAKiJ,GACrC5K,OACA6B,QAAO,SAACC,EAAKpW,GAEZ,OADAoW,EAAIpW,GAAOkf,EAAalf,GACjBoW,IACN,KApKT,EAwKEvK,cAAgB,SAACyU,EAAajC,GAAd,OAA2B,SAAAjoB,GAAM,IACvC8oB,EAAiB,EAAKh5B,MAAtBg5B,aACRA,EAAaoB,GAAajC,GAAYxT,GAAkBzU,GACxD,EAAKzK,SAAS,CACZuzB,eACA9lB,SAAS,MA7Kf,EAiLEpM,KAAO,WAAO,IAAD,EACkE,EAAK9G,MAA1Em5B,EADG,EACHA,uBAAwBH,EADrB,EACqBA,aAAcE,EADnC,EACmCA,2BACxCqB,EAAexC,GACrBmB,EAA2B3rB,SAAQ,SAAA4qB,GAAQ,OAAKoC,EAAavC,aAAaG,GAAY,MACtF9pB,OAAO0hB,KAAKiJ,GAAczrB,SAAQ,SAAA6sB,GAAW,OAC3C/rB,OAAO0hB,KAAKiJ,EAAaoB,IAAc7sB,SACrC,SAAA4qB,GAAQ,OAAKoC,EAAavC,aAAaG,GAAUiC,GAAepB,EAAaoB,GAAajC,SAG9F,IAAMqC,EAAmB5pB,KAAKsR,UAAUqY,GACpCpB,GAA0BA,EAAuBv5B,MACnDu5B,EAAuBr4B,MAAQ05B,EAC/B,EAAK50B,MAAMnE,cAAc03B,IAEzB,EAAKvzB,MAAMvE,cAAcq2B,GAA8B8C,GAEzD,EAAKC,cAjMT,EAoMEA,WAAa,kBAAM,EAAKh1B,SAAS,CAAEyvB,aAAc,KAAME,aAAc,QApMvE,EAsMEsF,SAAW,WACT,EAAKj1B,SAAS,CACZkzB,yBAAyB,EACzBC,wBAAyB,CAAEp0B,GAAI,sCAC/Bq0B,sBAAuB,CAAEr0B,GAAI,oCAC7Bs0B,2BAA4B,EAAKnI,OACjCoI,0BAA2B,EAAK4B,0BA5MtC,EAgNEhK,OAAS,WACP1hB,OAAOpJ,SAASqJ,KAAOvQ,GAjN3B,EAoNEi8B,iBAAmB,WAAO,IAAD,EAC0D,EAAK56B,MAA9Eo5B,EADe,EACfA,iBAAkBF,EADH,EACGA,2BAA4BG,EAD/B,EAC+BA,uBACtD,OACE,eAACpB,GAAD,CACEl2B,KAAM,EAAK6D,MAAM7D,KACjBm2B,UAAWkB,EAAiBrnB,QAAO,SAAAomB,GAAQ,OAAKe,EAA2BllB,SAASmkB,MACpFrb,OAAQuc,EACRzc,MAAO,SAAAub,GAAQ,OAAI,EAAK0C,YAAY1C,IACpCtb,KAAM,kBAAM,EAAKpX,SAAS,CAAE4zB,wBAAwB,QA5N5D,EAiOE3C,kBAAoB,kBAClB,eAAC,GAAD,CACEra,OAAQ,EAAKrc,MAAM44B,wBACnBnc,KAAM,EAAKzc,MAAM64B,sBACjBjc,MAAO,EAAK5c,MAAM84B,2BAClBjc,KAAM,EAAK7c,MAAM+4B,0BACjBjc,OAAQ,EAAK9c,MAAM24B,2BAvOzB,EA2OEgC,uBAAyB,kBAAM,EAAKl1B,SAAS,CAAEkzB,yBAAyB,KA3O1E,EA6OEhC,aAAe,kBACb,6BACE,eAAC,IAAD,CAAkBnyB,GAAG,sCAAsC+X,OAAQ,CAAEwZ,EAAG,sCAAIxe,EAAJ,yBAAIA,EAAJ,uBAAa,6BAAIA,WA/O/F,EAmPEwf,aAAe,kBACb,sBAAK7uB,UAAU,wBAAf,SACE,eAACoB,EAAA,EAAD,CAAQC,QAAS,EAAK4sB,SAAU3sB,UAAW,EAAKxJ,MAAMk1B,aAAchtB,UAAU,aAA9E,SACE,eAAC,IAAD,CAAkB1D,GAAG,uCAtP7B,EA2PE2xB,SAAW,WAAO,IACRjB,EAAiB,EAAKl1B,MAAtBk1B,aACR,EAAKzvB,SAAS,CACZkzB,yBAAyB,EACzBC,wBAAyB,CAAEp0B,GAAI,sCAC/Bq0B,sBAAuB,CAAEr0B,GAAI,oCAC7Bs0B,2BAA4B,WAC1B,EAAKgC,sBAAsB5F,GAC3B,EAAKyF,0BAEP5B,0BAA2B,EAAK4B,0BArQtC,EAyQEG,sBAAwB,SAAAC,GAAoB,IAClC/B,EAAiB,EAAKh5B,MAAtBg5B,aACRgC,KAAKh8B,MAAM+7B,EAAiB,CAC1BE,UJrU2B,IIsU3B5e,QAAQ,EACR6e,SAAU,SAAAC,GACNA,GACEA,EAAsB56B,MACxB46B,EAAsB56B,KAAKgN,SAAQ,SAAA6tB,GAAQ,IACxB1W,EAAuC0W,EAAhDC,QAA0BC,EADM,aACgBF,EADhB,aAExCpC,EAAatU,GAAgB4W,KAEjC,IAAMpC,EAA+BiC,EAAsB96B,KAAKoY,OAC5D0iB,EAAsB96B,KAAKoY,OAAO1G,QAAO,SAAAiB,GAAK,OAAIA,IAAUylB,MAC5D,GACJ,EAAKhzB,UAAS,SAAAzF,GAAK,MAAK,CACtBg5B,eACAE,2BAA4B9tB,MAAMmwB,KAAK,IAAIC,IAAJ,uBAAYx7B,EAAMk5B,4BAAlB,aAAiDA,MACxFhmB,SAAS,UA3RnB,EAiSE+jB,eAAiB,kBACf,eAAC3tB,EAAA,EAAD,CAAQC,QAAS,EAAKkyB,uBAAwBjyB,UAAW,EAAK5D,MAAMjE,OAAQuG,UAAU,SAAtF,SACE,eAAC,IAAD,CAAkB1D,GAAG,uCAnS3B,EAuSEi3B,uBAAyB,WACnB,EAAKz7B,MAAMkT,QACb,EAAKzN,SAAS,CACZkzB,yBAAyB,EACzBC,wBAAyB,CAAEp0B,GAAI,wCAC/Bq0B,sBAAuB,CAAEr0B,GAAI,sCAC7Bs0B,2BAA4B,WAC1B,EAAK4C,uBACL,EAAKf,0BAEP5B,0BAA2B,EAAK4B,yBAGlC,EAAKe,wBApTX,EAwTEA,qBAAuB,WAAO,IAAD,EACsC,EAAK17B,MAA9Di5B,EADmB,EACnBA,yBAA0BC,EADP,EACOA,2BAC5ByC,EAAU,GAChBttB,OAAO0hB,KAAK,EAAKuK,+BAA+BrB,IAA2B1rB,SAAQ,SAAA6sB,GAAW,OAC5FuB,EAAQj1B,KAAR,aACE20B,QAASjB,GACNnB,EAAyBmB,QAGhC5D,KAAYmF,EAAD,CAAWlD,IAAX,oBAA6CS,IAA6BlF,KAjUzF,EAoUE4H,QAAU,WAAO,IACP75B,EAAS,EAAK6D,MAAd7D,KADM,EAEiE,EAAK/B,MAA5Ek5B,EAFM,EAENA,2BAA4BI,EAFtB,EAEsBA,kBAAmBC,EAFzC,EAEyCA,oBACvD,OACE,uBAAKrxB,UAAU,cAAf,UACE,eAAC,GAAD,CACEnG,KAAMA,EACNjB,MAAOw4B,EACPhB,cAAc,sCACdhwB,SAAU,SAAAuzB,GAAM,OAAI,EAAKp2B,SAAS,CAAE6zB,kBAAmB3U,GAAkBkX,QAE3E,eAAC,GAAD,CACE95B,KAAMA,EACNjB,MAAOmrB,GAAiBtnB,MAAK,SAAA4W,GAAG,OAAIA,EAAIza,QAAUy4B,MAAwB,KAC1EnxB,QAAO,CAAGowB,IAAH,oBAAmCvM,GAAiBla,QAAO,SAAAsa,GAAI,OAAI6M,EAA2BllB,SAASqY,EAAKvrB,YACnHw3B,cAAc,wCACdhwB,SAAU,SAAA+jB,GAAI,OAAI,EAAK5mB,SAAS,CAAE8zB,oBAAqBlN,EAAKvrB,eApVtE,EA0VEg7B,kBAAoB,kBAClB,eAACxyB,EAAA,EAAD,CAAQC,QAAS,EAAKwyB,cAAevyB,SzEzZrB,IyEyZ+B6E,OAAO0hB,KAAK,EAAK/vB,MAAMg5B,cAAct3B,OAAiBwG,UAAU,cAA/G,SACE,eAAC,IAAD,CAAkB1D,GAAG,yCA5V3B,EAgWEw3B,oBAAsB,SAAAhwB,GACpB,IAAMiwB,EAAiBhQ,GAAiBtnB,MAAK,SAAA4W,GAAG,OAAIA,EAAIza,QAAUkL,KAClE,QAASiwB,KAAoBA,EAAej2B,OAASi2B,EAAej2B,OAlWxE,EAqWE+1B,cAAgB,kBAAM,EAAKt2B,SAAS,CAAE4zB,wBAAwB,KArWhE,EAuWEwB,YAAc,SAAA1C,GAAa,IACjBe,EAA+B,EAAKl5B,MAApCk5B,2BACRA,EAA2BgD,QAAQ/D,GACnC,EAAK1yB,SAAS,CAAEyzB,6BAA4BG,wBAAwB,KA1WxE,EA6WE8C,qBAAuB,WAAO,IAAD,EACiC,EAAKn8B,MAAzDk5B,EADmB,EACnBA,2BAA4BK,EADT,EACSA,oBACpC,OAAOL,EAA2BnnB,QAAO,SAAAomB,GAAQ,OAAOoB,GAAsBpB,IAAaoB,MA/W/F,EAkXE6C,kBAAoB,WAAO,IAAD,EACoB,EAAKp8B,MAAzCg5B,EADgB,EAChBA,aAAcM,EADE,EACFA,kBACtB,OAAOjrB,OAAO0hB,KAAK,EAAKuK,+BAA+BtB,IAAejnB,QACpE,SAAAqoB,GAAW,OACTA,EAAYxuB,cAAcoI,SAASslB,EAAkB1tB,gBACrDyC,OAAO0hB,KAAKiJ,EAAaoB,IAAc/P,MAAK,SAAA8N,GAAQ,OAClDa,EAAaoB,GAAajC,GAAUvsB,cAAcoI,SAASslB,EAAkB1tB,sBAxXvF,EA6XEsrB,kBAAoB,WAAO,IACjBn1B,EAAS,EAAK6D,MAAd7D,KACAi3B,EAAiB,EAAKh5B,MAAtBg5B,aACR,OACE,uBAAK9wB,UAAU,wBAAf,UACE,sBAAKA,UAAU,gBAAf,SAAgC,EAAK+uB,mBACpC,EAAK2E,UACL,EAAKE,oBACLztB,OAAO0hB,KAAKiJ,GAAct3B,OACzB,gBAAC,KAAD,CAAOkN,YAAU,EAACC,SAAO,EAACC,YAAU,EAAC5G,UAAU,QAA/C,UACE,iCACE,gCACE,8BACE,eAAC,IAAD,CAAkB1D,GAAG,2CADf,MAGP,EAAK23B,uBAAuBh2B,KAAI,SAAA6F,GAAM,OACrC,8BAAkB,EAAKgwB,oBAAoBhwB,IAAlCA,WAIf,iCACG,EAAKowB,oBAAoBj2B,KAAI,SAACi0B,EAAarrB,GAAd,OAC5B,gCACE,qBAAI7G,UAAU,OAAd,SAAsBkyB,IACrB,EAAK+B,uBAAuBh2B,KAAI,SAACgyB,EAAUnT,GAAX,OAC/B,8BACE,eAAC,KAAD,CACElkB,MAAOk4B,EAAaoB,GAAajC,GACjC7vB,SAAU,EAAKqd,cAAcyU,EAAajC,GAC1CjwB,UAAU,oBACVM,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,0CAL1C,UAAY2zB,GAAZ,OAAuBnT,SAH3B,UAAYoV,GAAZ,OAA0BrrB,YAiBhC,oBAAG7G,UAAU,aAAb,SACE,eAAC,IAAD,CAAkB1D,GAAG,sCArajC,uDAqBE,WACEgD,KAAKgyB,qBAtBT,gCAyBE,SAAmB9xB,EAA4CC,EAA4CC,GAAiB,IAAD,EAC/CJ,KAAK5B,MAAvE7D,EADiH,EACjHA,KAAMJ,EAD2G,EAC3GA,OAAQsyB,EADmG,EACnGA,YAAapc,EADsF,EACtFA,UAAWrY,EAD2E,EAC3EA,QAASmB,EADkE,EAClEA,QAASwH,EADyD,EACzDA,MAC5DT,EAAU/F,SAAWA,GAAU6F,KAAKiyB,2BAA2B/xB,EAAWF,KAAK5B,OACjF4B,KAAKkyB,sBACIhyB,EAAUusB,cAAgBA,EACnCzsB,KAAKsyB,iCACIpyB,EAAUmQ,YAAcA,GACjCrQ,KAAK6yB,gCAEF3yB,EAAU/G,SAAWA,GACxBqH,aAAajG,EAAKkG,cAAc,CAAEzD,GAAI,kCACtCgD,KAAKgyB,oBACI9xB,EAAUS,QAAUX,KAAK5B,MAAMuC,OAAU3I,GAClDwxB,aAAW7oB,KAtCjB,oBA4aE,WAAU,IAAD,SACyEX,KAAK5B,MAA7EqrB,EADD,EACCA,SAAUC,EADX,EACWA,WAAY1xB,EADvB,EACuBA,QAAS20B,EADhC,EACgCA,mBAAoBvc,EADpD,EACoDA,iBAC3D,OACE,uBAAK1P,UAAU,mBAAf,UACGV,KAAKkvB,oBACLlvB,KAAKozB,mBACN,8BACE,eAAC,IAAD,CAAkBp2B,GAAG,4BAEvB,sBAAK0D,UAAU,QAAf,SAAwB+oB,IACxB,sBAAK/oB,UAAU,gBAAf,SACGgpB,GAAc1xB,GAAW20B,GAAsBvc,EAC9C,eAACjJ,GAAA,EAAD,IAEA,uCACE,uBAAKzG,UAAU,UAAf,UACE,8BACE,eAAC,IAAD,CAAkB1D,GAAG,mCAEtBgD,KAAKmvB,eACN,eAAC,GAAD,CACE/B,gBJzfsB,OI0ftBC,qBAAqB,uCACrBC,eAAgB,SAAAI,GAAY,OAAI,EAAKzvB,SAAS,CAAEyvB,oBAEjD1tB,KAAKuvB,eACLvvB,KAAK0vB,uBAER,uBAAKhvB,UAAU,YAAf,UACE,sBAAKA,UAAU,WAAf,SACE,eAACoB,EAAA,EAAD,CAAQpB,UAAU,SAASqB,QAAS/B,KAAKkzB,SAAzC,SACE,eAAC,IAAD,CAAkBl2B,GAAG,sBAGzB,sBAAK0D,UAAU,+CAAf,SACE,eAACoB,EAAA,EAAD,CAAQpB,UAAU,OAAOqB,QAAS/B,KAAKV,KAAM0C,SAAUhK,EAAvD,SACE,eAAC,IAAD,CAAkBgF,GAAG,mCAhdzC,GAAqCiF,IAAMC,WA2erCC,GAAqB,CAAEvI,oBAAmBkzB,kBAAgBjzB,gBAAeI,gBAAewW,oBAK/EpO,sBApBS,SAAC,GAAD,QAAG0H,EAAH,EAAGA,KAAM9Q,EAAT,EAASA,SAAUwzB,EAAnB,EAAmBA,YAAapuB,EAAhC,EAAgCA,SAAhC,MAAgD,CACtEorB,SAAU1f,EAAKzR,aACfoxB,WAAY3f,EAAK/R,QACjB2I,MAAOoJ,EAAKzR,aACZN,QAASiB,EAASjB,QAClBmB,QAASF,EAASE,QAClBgB,QAAQ,UAAAlB,EAASC,eAAT,eAAkBI,SAAlB,UAA2BL,EAASC,eAApC,aAA2B,EAAkBI,OACrDJ,QAASD,EAASC,QAClBE,eAAgBH,EAASG,eACzBuzB,mBAAoBF,EAAYE,mBAChCF,YAAaA,EAAYG,wBACzBvc,UAAWhS,EAASgS,UACpBD,iBAAkB/R,EAAS+R,oBAQWjO,GAAzBE,CAA6CE,YAAWC,qBAAW0uB,MC7iBrEp5B,GACQ,6BADRA,GAEc,mCAGrBC,GAAe,CACnBC,SAAS,EACT68B,aAAc,GACdC,mBAAoB,GACpBx8B,aAAc,MAkCHy8B,GAAkB,iBAAO,CACpCr8B,KAAMZ,GACNa,QAASe,IAAMC,IAAI,6BAGRq7B,GAAwB,iBAAO,CAC1Ct8B,KAAMZ,GACNa,QAASe,IAAMC,IAAI,mCAGNpB,GAzCC,WAAmC,IAAlCC,EAAiC,uDAAzBT,GAAcU,EAAW,uCAChD,OAAQA,EAAOC,MACb,KAAKhB,EAAQI,IACb,KAAKJ,EAAQI,IACX,OAAO,2BACFU,GADL,IAEER,SAAS,IAEb,KAAKH,EAAQC,IACb,KAAKD,EAAQC,IACX,OAAO,2BACFU,GADL,IAEEF,aAAcG,EAAOE,QAAQC,UAEjC,KAAKhB,EAAQE,IACX,OAAO,2BACFU,GADL,IAEER,SAAS,EACT68B,aAAgBp8B,EAAOE,QAAQI,MAAUN,EAAOE,QAAQI,KAAKk8B,QAAUx8B,EAAOE,QAAQI,KAAKk8B,QAAU,KAEzG,KAAKr9B,EAAQE,IACX,OAAO,2BACFU,GADL,IAEER,SAAS,EACT88B,mBAAsBr8B,EAAOE,QAAQI,KAAON,EAAOE,QAAQI,KAAO,KAEtE,QACE,OAAOP,I,QCtCE,SAAS08B,GAAT,GAOX,IANFC,EAMC,EANDA,gBAMC,IALDC,+BAKC,MALyBD,EAKzB,EAJDE,EAIC,EAJDA,cAIC,IAHDC,mBAGC,aAFDC,gBAEC,MAFU,KAEV,MADDC,yBACC,WAC2BjI,oBAAS,GADpC,oBACMjY,EADN,KACcmgB,EADd,KAEKC,EAA2BC,mBAC3BC,EAAgBD,mBACtBE,qBAAU,WACRH,EAAyBI,QAAUN,EACnCI,EAAcE,QAAUxgB,KAE1B,IAAMygB,EAA2BP,IAAsBE,EAAyBI,QAC1EE,EAAgB1gB,IAAWsgB,EAAcE,SAC1CE,GAAiBD,GAA4BzgB,IAAWkgB,GAC3DC,EAAUD,GAEZ,IAAMS,EAAaD,EAAgB1gB,EAASygB,EAA2BP,EAAoBlgB,EAC3F,OACE,uBAAK5U,UAAU,qBAAf,UACE,uBAAKA,UAAU,4BAAf,UACE,sBAAKA,UAAU,2BAAf,SAA2Cu1B,EAAad,EAAkBC,IAC1E,uBAAK10B,UAAU,qBAAf,UACG40B,KAAiBC,GAChB,eAACzzB,EAAA,EAAD,CAAQpB,UAAU,cAAcqB,QAASwzB,EAAUnoB,cAAY,gCAA/D,SACE,oBAAG1M,UAAU,kBAGjB,eAACoB,EAAA,EAAD,CAAQpB,UAAU,cAAcqB,QAAS,kBAAM0zB,GAAWQ,IAAa7oB,cAAY,0BAAnF,SACE,oBAAG1M,UAAS,aAAQu1B,EAAa,qBAAuB,8BAI7DA,GAAc,sBAAKv1B,UAAU,0BAAf,SAA0C20B,O,cClClDa,I,gBAAS,SAAC,GAAD,IACpBl5B,EADoB,EACpBA,GACAzC,EAFoB,EAEpBA,KACAuG,EAHoB,EAGpBA,SACAq1B,EAJoB,EAIpBA,qBACAC,EALoB,EAKpBA,uBACAC,EANoB,EAMpBA,mBANoB,IAOpBjZ,eAPoB,aAQpBpb,gBARoB,gBAUpB,uBAAKtB,UAAU,kCAAf,UACE,wBAAOkgB,QAAS5jB,EAAhB,SACE,eAAC,IAAD,CAAkBA,GAAIq5B,MAExB,eAAC,KAAD,CACEr5B,GAAIA,EACJ8D,SAAUA,EACViB,QAASjB,EACTkB,SAAUA,EACVob,QAASA,EACTkZ,gBAAiB/7B,EAAKkG,cAAc,CAAEzD,GAAIm5B,IAC1CI,kBAAmBh8B,EAAKkG,cAAc,CAAEzD,GAAIo5B,W,QCxBnC,SAASI,KACtB,OAAO,wB,qBCGIC,I,gBAAa,SAAC,GAAD,QACxB37B,cADwB,MACfsL,GADe,MAExBpF,mBAFwB,MAEV,KAFU,MAGxBmgB,uBAHwB,aAIxBuV,eAJwB,SAKxBp9B,EALwB,EAKxBA,MACAwH,EANwB,EAMxBA,SANwB,OAQxB,uBAAKJ,UAAU,kBAAf,UACE,eAAC,KAAD,CACE5F,OAAQA,EACRkG,YAAaA,EACb01B,QAASA,EACTp9B,MAAOA,EACPwH,SAAUA,EACVJ,UAAU,0BAETygB,GAAmB,uBAAMzgB,UAAU,cAAhB,SAA+BM,GAAemF,U,oBCtB3DwwB,I,QAAmC,0BACnCC,GAAqC,UACrCC,GAA4B,gBAAMD,GAAqC,IACvEE,GAAmC,OACnCC,GAAoB,MACpBC,GAAqB,OACrBC,GAA+C,mCAC/CC,GAA2C,+BAC3CC,GAAmC,4BACnCC,GAAkC,2BAClCC,GAA8C,oCAC9CC,GAA4C,kCAC5CC,GAAkC,kCAClCC,GAA+B,wCAC/BC,IAA6B,sBACvCX,GAAmC,IADI,gBAEvCC,GAAoB,IAFmB,gBAGvCC,GAAqB,IAHkB,gBAIvCC,IAA+C,GAJR,gBAKvCC,IAA2C,GALJ,gBAMvCC,IAAmC,GANI,gBAOvCC,IAAkC,GAPK,0CAQhB,GARgB,2CASf,GATe,gBAUvCC,GAA8C,MAVP,gBAWvCC,GAA4C,MAXL,gBAYvCC,GAAkC,MAZK,gBAavCC,GAA+B,C/E3Bd,I+EcsB,ICqCpCE,G,4MACJl/B,MAAQ,CACNm/B,0BAA2B,GAC3BC,uBAAuB,EACvBzG,yBAAyB,G,EAsB3B9I,kBAAoB,WAClB,IAAIluB,EAAS8iB,GAAU,EAAK7e,MAAMjE,QAClCA,EAAWA,EhF/EK,GgF+EUA,EhF/EV,GgF+EyB0D,IAAEyoB,UAAUuQ,IACrD,IAAMc,EAA4B,GAClC9wB,OAAO0hB,KAAKpuB,GAAQ4L,SAAQ,SAAA8xB,GAC1B,IAAMC,EAAgBD,EAAoB19B,EAAO09B,GAAqB,KAClEC,IACFA,EAAa,KAAqCD,EAC9CC,EAAcC,eAAeV,MAC/BS,EAAa,kCAAgDE,KAC3DF,EAAa,kCACb1xB,KAGA0xB,EAAcC,eAAeT,MAC/BQ,EAAa,gCAA8CE,KACzDF,EAAa,gCACb1xB,KAGA0xB,EAAcC,eAAeR,MAC/BO,EAAcP,IAAmCS,KAAOF,EAAcP,IAAkCnxB,KAGvG0xB,EAAcC,eAAeP,KAC7B5zB,MAAMC,QAAQi0B,EAAcN,MAC5BM,EAAcN,IAA8Bt9B,SAE7C49B,EAAcN,IAAgC,ChFzGpC,IgF2GZG,EAA0Bz4B,KAAK44B,OAGnC,EAAK75B,SAAS,CAAE05B,+B,EAGlBM,eAAiB,kBAAM,EAAK75B,MAAMpG,SAAW,EAAKQ,MAAMm/B,0BAA0B9U,MAAK,SAAAiV,GAAa,OAAKA,EAAcr4B,S,EAEvH6qB,OAAS,kBAAM,EAAKrsB,SAAS,CAAEkzB,yBAAyB,K,EAExD7xB,KAAO,WAAO,IACJpG,EAAY,EAAKkF,MAAjBlF,QACAy+B,EAA8B,EAAKn/B,MAAnCm/B,0BACF5E,EAAe,CAAC,IACtB4E,EAA0B5xB,SAAQ,SAAA+xB,GAAkB,IAC1Cr4B,EAAgCq4B,EAAhCr4B,KAASy4B,EADgC,aACTJ,EADS,UAE7CE,KAAOG,SAASD,EAAkB,qCACpCA,EAAkB,kCAAgDA,EAAkB,kCAElFp9B,OAAOsL,KAEP4xB,KAAOG,SAASD,EAAkB,mCACpCA,EAAkB,gCAA8CA,EAAkB,gCAEhFp9B,OAAOsL,KAEP4xB,KAAOG,SAASD,EAAmBX,OACrCW,EAAmBX,IAAmCW,EAAmBX,IAAiCz8B,OACxGsL,KAGJ2sB,EhF1Ic,GgF0IKtzB,GAAQy4B,KAE7B,IAAMlF,EAAmB5pB,KAAKsR,UAAUqY,GACpC75B,GAAWA,EAAQd,MACrBc,EAAQI,MAAQ05B,EAChB,EAAK50B,MAAMnE,cAAcf,IAEzB,EAAKkF,MAAMvE,cAAc88B,GAAkC3D,I,EAI/D7J,OAAS,WACP1hB,OAAOpJ,SAASqJ,KAAOvQ,G,EAGzBurB,WAAa,kBAAM,EAAKzkB,SAAS,CAAEkzB,yBAAyB,K,EAE5DjC,kBAAoB,kBAClB,eAAC,GAAD,CACEra,OAAQ,CAAE7X,GAAI,sDACdiY,KAAM,CAAEjY,GAAI,oDACZoY,MAAO,WACL,EAAK9V,OACL,EAAKojB,cAEPrN,KAAM,EAAKqN,WACXpN,OAAQ,EAAK9c,MAAM24B,2B,EAIvBrwB,SAAW,SAACs3B,EAAkBC,GAAnB,IAAiCpT,EAAjC,+DAAsD,SAAA1c,GAAU,IACjEovB,EAA8B,EAAKn/B,MAAnCm/B,0BACFG,EAAgBH,EAA0BS,GAC1C9+B,EAAQ2rB,EAAW1c,EAAMjP,MAAQ6jB,GAAkB5U,GACpDuvB,GACHH,EAA0Bz4B,KAA1B,gBAAkC43B,GAAmCgB,EAAa,OAEpFA,EAAcO,GAAgB/+B,EAC9B,EAAK2E,SAAS,CAAE05B,gC,EAGlBW,iBAAmB,SAAAh/B,GAAK,MAAK,CAAEkF,MAAOlF,EAAOA,U,EAE7Ci/B,YAAc,SAAAH,GAAqB,IAAD,EACD,EAAKh6B,MAA5B7D,EADwB,EACxBA,KAAMs6B,EADkB,EAClBA,aAERiD,EADgC,EAAKt/B,MAAnCm/B,0BACwCS,GAC1CI,EAAqB3D,EAAal2B,KAAI,SAAA85B,GAAQ,MAAK,CAAEj6B,MAAOi6B,EAASh5B,KAAMnG,MAAOm/B,EAASh5B,SAC3Fi5B,GAAe,OAACZ,QAAD,IAACA,OAAD,EAACA,EAAa,KAAwB,EAAKQ,iBAAiBR,EAAa,KAAuB,KAC/Ga,KAAiC,OAACb,QAAD,IAACA,OAAD,EAACA,EAAa,8BAC/Cc,KAAyB,OAACd,QAAD,IAACA,OAAD,EAACA,EAAa,0BAC7C,OACE,uCACE,uBAAKp3B,UAAU,OAAf,UACE,eAAC0d,GAAA,EAAD,UACE,eAAC,IAAD,CAAkBphB,GAAG,4CAEvB,uBAAK0D,UAAU,gBAAf,UACE,sBAAKA,UAAU,aAAf,SACE,eAAC2gB,GAAD,CACErgB,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,uCACtCmkB,kBAAmBuX,EACnBp/B,MAAOo/B,EACP53B,SAAU,EAAKA,SAASs3B,EAAkBrB,IAAmB,GAC7Dn2B,QAAS43B,EACTzX,iBAAiB,SACjBhgB,gBAAgB,iBAChB2c,MAAOD,OAGX,uBAAK/c,UAAU,aAAf,UACE,eAAC,GAAD,CACE1D,GAAE,uCAAkCo7B,GACpC79B,KAAMA,EACN87B,mBAAmB,6CACnBjZ,QAASub,EACTxC,qBAAqB,mBACrBC,uBAAuB,oBACvBt1B,SAAU,EAAKA,SAASs3B,EAAkBlB,MAE5C,eAAC,GAAD,CACEl6B,GAAE,oCAA+Bo7B,GACjC79B,KAAMA,EACN87B,mBAAmB,iDACnBjZ,QAASwb,EACTzC,qBAAqB,mBACrBC,uBAAuB,oBACvBt1B,SAAU,EAAKA,SAASs3B,EAAkBhB,eAKlD,eAAC,GAAD,Q,EAKNyB,aAAe,SAAAT,GAAqB,IAAD,EACI,EAAKh6B,MAAlC7D,EADyB,EACzBA,KAAMu6B,EADmB,EACnBA,mBAERgD,EADgC,EAAKt/B,MAAnCm/B,0BACwCS,GAC1CU,EAA2BhE,EAAmBn2B,KAAI,SAAA85B,GAAQ,MAAK,CAAEj6B,MAAOi6B,EAASh5B,KAAMnG,MAAOm/B,EAASh5B,SACvGs5B,GAAqB,OAACjB,QAAD,IAACA,OAAD,EAACA,EAAa,MAAyB,EAAKQ,iBAAiBR,EAAa,MAAwB,KACvHkB,KAAqC,OAAClB,QAAD,IAACA,OAAD,EAACA,EAAa,kCACnDmB,KAA0B,OAACnB,QAAD,IAACA,OAAD,EAACA,EAAa,2BAC9C,OACE,uCACE,uBAAKp3B,UAAU,OAAf,UACE,eAAC0d,GAAA,EAAD,UACE,eAAC,IAAD,CAAkBphB,GAAG,6CAEvB,uBAAK0D,UAAU,gBAAf,UACE,sBAAKA,UAAU,aAAf,SACE,eAAC2gB,GAAD,CACErgB,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,uCACtCmkB,kBAAmB4X,EACnBz/B,MAAOy/B,EACPj4B,SAAU,EAAKA,SAASs3B,EAAkBpB,IAAoB,GAC9Dp2B,QAASk4B,EACT/X,iBAAiB,SACjBhgB,gBAAgB,iBAChB2c,MAAOD,OAGX,uBAAK/c,UAAU,aAAf,UACE,eAAC,GAAD,CACE1D,GAAE,wCAAmCo7B,GACrC79B,KAAMA,EACN87B,mBAAmB,6CACnBjZ,QAAS4b,EACT7C,qBAAqB,mBACrBC,uBAAuB,oBACvBt1B,SAAU,EAAKA,SAASs3B,EAAkBnB,MAE5C,eAAC,GAAD,CACEj6B,GAAE,qCAAgCo7B,GAClC79B,KAAMA,EACN87B,mBAAmB,iDACnBjZ,QAAS6b,EACT9C,qBAAqB,mBACrBC,uBAAuB,oBACvBt1B,SAAU,EAAKA,SAASs3B,EAAkBjB,eAKlD,eAAC,GAAD,Q,EAKN+B,qCAAuC,SAAAd,GAAqB,IAClD79B,EAAS,EAAK6D,MAAd7D,KAEFu9B,EADgC,EAAKt/B,MAAnCm/B,0BACwCS,GAC1Ce,GAA8B,OAACrB,QAAD,IAACA,OAAD,EAACA,EAAa,mCAC9CA,EAAa,kCACb,KACEsB,GAA4B,OAACtB,QAAD,IAACA,OAAD,EAACA,EAAa,iCAC5CA,EAAa,gCACb,KACEuB,GAAmB,OAACvB,QAAD,IAACA,OAAD,EAACA,EAAgBP,KAAmCO,EAAcP,IAAmC,KAC9H,OACE,uBAAK72B,UAAU,qBAAf,UACE,uBAAKA,UAAU,aAAf,UACE,eAAC0d,GAAA,EAAD,UACE,eAAC,IAAD,CAAkBphB,GAAG,gEAEvB,uBAAK0D,UAAU,gBAAf,UACE,eAAC,GAAD,CACEM,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,6DACtCmkB,kBAAmBgY,EACnB7/B,MAAO6/B,EACPr4B,SAAU,EAAKA,SAASs3B,EAAkBf,MAE5C,eAAC,GAAD,CACEr2B,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,2DACtCmkB,kBAAmBiY,EACnB9/B,MAAO8/B,EACPt4B,SAAU,EAAKA,SAASs3B,EAAkBd,YAIhD,uBAAK52B,UAAU,aAAf,UACE,eAAC0d,GAAA,EAAD,UACE,eAAC,IAAD,CAAkBphB,GAAG,sDAEvB,eAAC,GAAD,CACEgE,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,0DACtCmkB,kBAAmBkY,EACnB//B,MAAO+/B,EACPv4B,SAAU,EAAKA,SAASs3B,EAAkBb,a,EAOpD+B,sBAAwB,SAAClB,EAAkBmB,GAAnB,OAAmC,SAAAhxB,GAAU,IAC3DovB,EAA8B,EAAKn/B,MAAnCm/B,0BACF5O,EAAsB5L,GAAkB5U,GACxCjP,EAAUyvB,EAAsBC,OAAOC,SAASF,EhFjVvC,IAFC,EgFoVZC,OAAOE,UAAU5vB,IAAUA,GhFpVf,IgFqVdq+B,EAA0BS,GAAkBZ,IAA8B+B,GAAejgC,EACzF,EAAK2E,SAAS,CAAE05B,iC,EAIpB6B,iBAAmB,SAAApB,GAAqB,IAC9BT,EAA8B,EAAKn/B,MAAnCm/B,0BACRA,EAA0BS,GAAkBZ,IAA8Bt4B,KhF5V1D,GgF6VhB,EAAKjB,SAAS,CAAE05B,+B,EAGlB8B,oBAAsB,SAACrB,EAAkBmB,GAAiB,IAChD5B,EAA8B,EAAKn/B,MAAnCm/B,0BACFG,EAAgBH,EAA0BS,GAChDN,EAAcN,IAA8BlpB,OAAOirB,EhFlWpC,GgFmWVzB,EAAcN,IAA8Bt9B,QAC/C49B,EAAcN,IAA8Bt4B,KhFrW9B,GgFuWhB,EAAKjB,SAAS,CAAE05B,+B,EAGlB+B,cAAgB,SAAAtB,GAAqB,IAC3B79B,EAAS,EAAK6D,MAAd7D,KAEFu9B,EADgC,EAAKt/B,MAAnCm/B,0BACwCS,GAC1CuB,GAAkB,OAAC7B,QAAD,IAACA,OAAD,EAACA,EAAgBN,KAAgCM,EAAcN,IAAgC,ChF9WvG,GgF+WhB,OACE,uBAAK92B,UAAU,OAAf,UACE,eAAC0d,GAAA,EAAD,UACE,eAAC,IAAD,CAAkBphB,GAAG,oDAEtB28B,EAAeh7B,KAAI,SAACi7B,EAAUryB,GAAX,OAClB,uBAAK7G,UAAU,qBAAf,UACE,eAAC0gB,GAAD,CACEpgB,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,wDACtCmkB,iBAAe,EACf7nB,MAAOsgC,EACP94B,SAAU,EAAKw4B,sBAAsBlB,EAAkB7wB,GACvD7O,KAAK,SACLkpB,QAAQ,QACRC,IhF7XM,IgF+XR,eAACG,GAAD,CACEznB,KAAMA,EACN0nB,YAAa,kBAAM,EAAKuX,iBAAiBpB,IACzClW,aAAc,kBAAM,EAAKuX,oBAAoBrB,EAAkB7wB,IAC/D4a,oBAAqB5a,IAAMoyB,EAAez/B,OAAS,MAdvD,UAA4C49B,EAA5C,YAA6DM,EAA7D,qBAA0F7wB,W,EAsBlGue,gBAAkB,SAAAsS,GAAgB,OAAI,SAAA7vB,GAAU,IACtCovB,EAA8B,EAAKn/B,MAAnCm/B,0BACcA,EAA0BS,GACnC,KAAqC7vB,EAAMjP,MACxD,EAAK2E,SAAS,CAAE05B,gC,EAGlBkC,2BAA6B,WAAO,IAC1BlC,EAA8B,EAAKn/B,MAAnCm/B,0BACRA,EAA0Bz4B,KAAKrB,IAAEyoB,UAAUmR,KAC3C,EAAKx5B,SAAS,CAAE05B,+B,EAGlBmC,2BAA6B,SAAA1B,GAAqB,IACxCT,EAA8B,EAAKn/B,MAAnCm/B,0BACRA,EAA0BrpB,OAAO8pB,EhFzZlB,GgF0Zf,EAAKn6B,SAAS,CAAE05B,+B,EAGlBoC,qBAAuB,SAACjC,EAAeM,GAAsB,IACnD79B,EAAS,EAAK6D,MAAd7D,KADkD,EAEG,EAAK/B,MAA1Do/B,EAFkD,EAElDA,sBAAuBD,EAF2B,EAE3BA,0BACzBE,EAAoBC,EAAa,KACjCkC,EAAgCnC,IAAsBjB,GACtDqD,EAAiB/jB,GAAgB3L,QACrC,SAAA5E,GAAO,OAAKgyB,EAA0Bh5B,KAAI,SAAAm5B,GAAa,OAAIA,EAAcr4B,QAAM+M,SAAS7G,EAAQrM,UAE5F67B,EAAkB6E,EACtB,eAAC5b,GAAA,EAAD,UACE,eAAC,IAAD,CAAkBphB,GAAG,+CAGvB,uBAAK0D,UAAU,SAAf,UACE,eAAC2gB,GAAD,CACErgB,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,sCACtCmkB,kBAAmB0W,EACnBv+B,QAASu+B,GAAqB3hB,GAAgB/Y,MAAK,SAAA8oB,GAAW,OAAIA,EAAY3sB,QAAUu+B,KACxF/2B,SAAU,EAAKglB,gBAAgBsS,GAC/Bx3B,QAASq5B,EACTlZ,iBAAmB8W,EAAgC,GAAZ,UACvC92B,gBAAgB,iBAChB2c,MAAOD,MAEPoa,GAAqB,eAAC,GAAD,CAAiBj/B,QAAQ,6BAG9Cw8B,EAA0B4E,EAC9B7E,EAEA,eAAC/T,GAAD,CACEpgB,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,sCACtCmkB,kBAAmB0W,EACnBv+B,MAASu+B,GAAwC,GACjD9W,iBAAiB,SACjB4C,UAAQ,IAGN0R,EAAgB,CACpB,EAAKkD,YAAYH,GACjB,EAAKS,aAAaT,GAClB,EAAKc,qCAAqCd,GAC1C,EAAKsB,cAActB,IAErB,OACE,eAAC,GAAD,CAEEjD,gBAAiBA,EACjBC,wBAAyBA,EACzBC,cAAeA,EACfC,aAAc0E,EACdzE,SAAU,kBAAM,EAAKuE,2BAA2B1B,IAChD5C,kBAAmBoC,GAPrB,wBACwBQ,K,EAW5B8B,0BAA4B,WAAO,IACzBtC,EAA0B,EAAKp/B,MAA/Bo/B,sBACR,OACE,eAAC91B,EAAA,EAAD,CAAQC,QAAS,kBAAM,EAAK9D,UAAS,SAAAzF,GAAK,MAAK,CAAEo/B,uBAAwBp/B,EAAMo/B,2BAA2Bl3B,UAAU,SAApH,SACE,eAAC,IAAD,CAAkB1D,GAAE,2CAAsC46B,EAAwB,WAAa,e,uDAjarG,WACE53B,KAAK5B,MAAMxE,kBAAkB+8B,IAC7B32B,KAAK5B,MAAM42B,wBACXh1B,KAAK5B,MAAM22B,oB,gCAGb,SAAmB70B,GAAuD,IAAD,EACrBF,KAAK5B,MAA/C7D,EAD+D,EAC/DA,KAAMJ,EADyD,EACzDA,OAAQnC,EADiD,EACjDA,QAASmB,EADwC,EACxCA,QAASwH,EAD+B,EAC/BA,MACpCT,EAAU/F,SAAWA,GACvB6F,KAAKqoB,qBAEFnoB,EAAU/G,SAAWA,GACxBqH,aAAajG,EAAKkG,cAAc,CAAEzD,GAAI,uCACtCgD,KAAK/B,SAAS,CAAE25B,uBAAuB,KAC9B13B,EAAUS,QAAUX,KAAK5B,MAAMuC,OAAU3I,GAClDwxB,aAAW7oB,K,oBAuZf,WAAU,IAAD,SACmCX,KAAK5B,MAAvCqrB,EADD,EACCA,SAAUC,EADX,EACWA,WAAY1xB,EADvB,EACuBA,QACtB2/B,EAA8B33B,KAAKxH,MAAnCm/B,0BACR,OACE,uBAAKj3B,UAAU,6BAAf,UACGV,KAAKkvB,oBACN,8BACE,eAAC,IAAD,CAAkBlyB,GAAG,sCAEvB,sBAAK0D,UAAU,QAAf,SAAwB+oB,IACxB,sBAAK/oB,UAAU,gBAAf,SACGgpB,GAAc1xB,EACb,eAACmP,GAAA,EAAD,IAEA,uCACE,uBAAKzG,UAAU,UAAf,UACE,uBAAKA,UAAU,gBAAf,UACE,8BACE,eAAC,IAAD,CAAkB1D,GAAG,kDAEtBgD,KAAKk6B,+BAEPvC,EAA0Bh5B,KAAI,SAACm5B,EAAetZ,GAAhB,OAAwB,EAAKub,qBAAqBjC,EAAetZ,MAChG,sBAAK9d,UAAU,uCAAf,SACE,eAACoB,EAAA,EAAD,CAAQpB,UAAU,kBAAkBqB,QAAS/B,KAAK65B,2BAAlD,SACE,eAAC,IAAD,CAAkB78B,GAAG,0DAI3B,uBAAK0D,UAAU,YAAf,UACE,sBAAKA,UAAU,WAAf,SACE,eAACoB,EAAA,EAAD,CAAQpB,UAAU,SAASqB,QAAS/B,KAAKmpB,OAAzC,SACE,eAAC,IAAD,CAAkBnsB,GAAG,sBAGzB,sBAAK0D,UAAU,+CAAf,SACE,eAACoB,EAAA,EAAD,CAAQpB,UAAU,OAAOqB,QAAS/B,KAAKsqB,OAAQtoB,SAAUhC,KAAKi4B,iBAA9D,SACE,eAAC,IAAD,CAAkBj7B,GAAG,mC,GAldDiF,IAAMC,WA2exCC,GAAqB,CAAEvI,oBAAmBC,gBAAeI,gBAAe+6B,yBAAuBD,oBAKtF1yB,sBAlBS,SAAC,GAAD,QAAG0H,EAAH,EAAGA,KAAM9Q,EAAT,EAASA,SAAUw/B,EAAnB,EAAmBA,SAAnB,MAAmC,CACzDhP,SAAU1f,EAAKzR,aACfoxB,WAAY3f,EAAK/R,QACjB2I,MAAOoJ,EAAKzR,aACZN,QAASiB,EAASjB,QAClBmB,QAASF,EAASE,QAClBgB,QAAQ,UAAAlB,EAASC,eAAT,eAAkBI,SAAlB,UAA2BL,EAASC,eAApC,aAA2B,EAAkBI,OACrDJ,QAASD,EAASC,QAClBE,eAAgBH,EAASG,eACzBy7B,aAAc4D,EAAS5D,aACvBC,mBAAoB2D,EAAS3D,sBAQS3yB,GAAzBE,CAA6CE,YAAWC,qBAAWk1B,MCjiBrE5/B,GAC+B,oDAGtCC,GAAe,CACnBC,SAAS,EACTmB,SAAS,EACTb,aAAc,KACd6hC,kCAAmC,IAoCtB5hC,GAjCC,WAAmC,IAAlCC,EAAiC,uDAAzBT,GAAcU,EAAW,uCAChD,OAAQA,EAAOC,MACb,KAAKhB,EAAQI,IACX,OAAO,2BACFU,GADL,IAEER,SAAS,EACTmB,SAAS,EACTb,aAAc,OAElB,KAAKT,EAAQC,IACX,OAAO,2BACFU,GADL,IAEER,SAAS,EACTmB,SAAS,EACTb,aAAcG,EAAOE,QAAQC,UAEjC,KAAKhB,EAAQE,IACX,OAAO,2BACFC,IADL,IAEEC,SAAS,EACTmB,SAAS,EACTghC,kCAAmC1hC,EAAOE,QAAQI,OAEtD,QACE,OAAOP,ICrCA4hC,I,QAA2C,kCAC3CC,GAAuC,mBACvCC,GAAgCF,iDAChCG,GAA8B,WAC9BC,GAAqC,cACrCC,GAA+B,QAE/BC,GAAsB,oBAEtBC,GAAwC,IACxCC,GAAwB,MACxBC,GAA0B,QAC1BC,IAAwB,sBAAMF,GAAwBz0B,IAA9B,gBAA6C00B,GAA0B10B,IAAvE,ICR/B40B,I,QAAkCla,GAAgBW,OAE3CwZ,GAA0B,SAAC,GAAD,IACrC1hC,EADqC,EACrCA,MACA0H,EAFqC,EAErCA,YACAmgB,EAHqC,EAGrCA,gBAHqC,IAIrC8Z,eAJqC,WAI3BpzB,EAJ2B,MAKrCqzB,eALqC,WAK3BrzB,EAL2B,MAMrCszB,mBANqC,aAOrCz6B,iBAPqC,MAOzByF,GAPyB,EAQrCrF,EARqC,EAQrCA,SARqC,OAUrC,eAAC,GAAD,CACExH,MAAOA,EACPwH,SAAUA,EACVE,YAAaA,EACbmgB,gBAAiBA,EACjB8Z,QAASA,EACTC,QAASA,EACTx6B,UAAS,wCAAmCy6B,EAAc,YAAch1B,GAA/D,YAA+EzF,M,UCH/E06B,I,gCAAoCva,IAdf,SAAC,GAAD,IAAGvnB,EAAH,EAAGA,MAAH,IAAU+hC,mBAAV,SAA+Br6B,EAA/B,EAA+BA,YAAaF,EAA5C,EAA4CA,SAA5C,OAChC,eAAC,gBAAD,CACExH,MAAOA,EACPsH,QAAS,CACP06B,KAAM,WACN5d,MAAO,UACP2d,cACAr6B,eAEFu6B,YAAY,EACZz6B,SAAU,SAAC06B,EAAQziC,EAAMO,GAAf,OAAyBwH,EAASxH,UCuC1Co+B,G,4MACJl/B,MAAQ,CACNijC,sBAAuB,GACvBC,2BAA4B,GAC5B9D,uBAAuB,EACvBzG,yBAAyB,EACzBwK,4BAA6B,GAC7BvK,wBAAyB,CAAEp0B,GAAImJ,IAC/BkrB,sBAAuB,CAAEr0B,GAAImJ,IAC7BmrB,2BAA4B,KAC5BC,0BAA2B,KAC3BqK,2BAA4B,IAAI5H,IAChC6H,8BAA8B,EAC9BC,mBAAmB,G,EAqDrB7D,eAAiB,kBACf,EAAK75B,MAAMpG,SACX,EAAKQ,MAAMijC,sBACRlxB,QAAO,SAAAwxB,GAAQ,OAAIA,EAAQ,WAAkC1B,MAC7DxX,MAAK,SAAAkZ,GACJ,IAAMC,EAAoB,IAAIpqB,OAAO8oB,IAC/BuB,EAAeF,EAAQ,SAC7B,OAAQE,IAAiBD,EAAkBnqB,KAAKoqB,O,EAGtD3R,OAAS,kBACP,EAAKrsB,SAAS,CACZkzB,yBAAyB,EACzBC,wBAAyB,CAAEp0B,GAAI,0CAC/Bq0B,sBAAuB,CAAEr0B,GAAI,wCAC7Bs0B,2BAA4B,WAC1B,EAAKhyB,OACL,EAAKojB,cAEP6O,0BAA2B,EAAK7O,c,EAGpCpjB,KAAO,WACL,IAAMm8B,EAAwB59B,IAAEyoB,UAAU,EAAK9tB,MAAMijC,uBACrDA,EAAsB11B,SACpB,SAAAg2B,GAAQ,OAAKA,EAAQ,SAAgC3B,GAA2C2B,EAAQ,YAE1G,IAAML,EAA6B79B,IAAEyoB,UAAU,EAAK9tB,MAAMkjC,4BAC1DA,EAA2B31B,SACzB,SAAAg2B,GAAQ,OAAKA,EAAQ,SAAgC3B,GAA2C2B,EAAQ,YAE1G,IAAMG,EAAmBT,EAAsBt+B,MAC7C,SAAA4+B,GAAQ,OAAIA,EAAQ,WAAkCzB,MAExD4B,EAAgB,MAAiCA,EAAgB,MAA+BzT,QAC9F,SAAC0T,EAAaC,EAAgBC,GAA9B,OACEF,EACAC,EAAc,IACdzB,GACAyB,EAAc,OACbC,IAAYH,EAAgB,MAA+BhiC,OrFhKjD,EqFgKgEiM,GHzJxC,OG0JrCA,IAEuBu1B,EAA2BnxB,QAClD,SAAA+xB,GAAa,OACVb,EAAsBt+B,MAAK,SAAA4+B,GAAQ,OAAIA,EAAQ,OAAkCO,EAAa,WAElFv2B,SAAQ,SAAAg2B,GAAQ,OAAI,EAAK39B,MAAMm+B,cAAcR,MAC9DN,EAAsB11B,SAAQ,SAAAg2B,GACxBA,GAAYA,EAAS3jC,MAAQ,EAAKI,MAAMojC,2BAA2BY,IAAIT,EAAQ,MACjF,EAAK39B,MAAMnE,cAAc8hC,GAChBA,IAAaA,EAAS3jC,MAC/B,EAAKgG,MAAMvE,cACTkiC,EAAQ,SACRA,EAAQ,MACRA,EAAQ,gBAId,EAAK99B,SAAS,CAAE69B,mBAAmB,K,EAGrCxG,YAAc,SAAAmH,GAAgB,IAAD,EACoC,EAAKjkC,MAA5DijC,EADmB,EACnBA,sBAAuBE,EADJ,EACIA,4BACzBe,EAAqBjB,EAAsBgB,GAAtB,SACrBE,EAAyBvC,GAA2CsC,EAC1E,OAAQA,GAAuBA,IAAuBf,EAA4BnvB,SAASmwB,EAAuBv4B,gB,EAGpH+kB,OAAS,WACP1hB,OAAOpJ,SAASqJ,KAAOvQ,G,EAGzBurB,WAAa,kBAAM,EAAKzkB,SAAS,CAAEkzB,yBAAyB,K,EAE5DjC,kBAAoB,kBAClB,eAAC,GAAD,CACEra,OAAQ,EAAKrc,MAAM44B,wBACnBnc,KAAM,EAAKzc,MAAM64B,sBACjBjc,MAAO,EAAK5c,MAAM84B,2BAClBjc,KAAM,EAAK7c,MAAM+4B,0BACjBjc,OAAQ,EAAK9c,MAAM24B,2B,EAIvBrwB,SAAW,SAAC27B,EAAapE,GAAd,OAA+B,SAAA9vB,GAAU,IAAD,IACa,EAAK/P,MAA3DijC,EADyC,EACzCA,sBAAuBG,EADkB,EAClBA,2BACzBG,EAAWN,EAAsBgB,GACjCnjC,EAAQ6jB,GAAkB5U,GAChCwzB,EAAS1D,GAAgB/+B,EACzB,IAAMsjC,EAAY,OAAGnB,QAAH,IAAGA,GAAH,UAAGA,EAAwBgB,UAA3B,aAAG,OACrBb,EAA2BiB,IAAID,GAC/B,EAAK3+B,SAAS,CAAEw9B,wBAAuBG,iC,EAGzC7hC,YAAc,SAACgiC,EAAUU,GAAX,OACZ,sBAAK/7B,UAAU,OAAf,SACE,eAAC,GAAD,CACEpH,MAAOyiC,EAAQ,YACfj7B,SAAU,EAAKA,SAAS27B,EAAajC,IACrCx5B,YAAa,EAAK5C,MAAM7D,KAAKkG,cAAc,CAAEzD,GAAI,+CACjDmkB,gBAAiB4a,EAAQ,iB,EAK/BhsB,KAAO,SAACgsB,EAAUU,GAAX,OACL,sBAAK/7B,UAAU,OAAf,SACE,eAAC06B,GAAD,CACE9hC,MAAOyiC,EAAQ,MACfV,aAAW,EACXr6B,YAAa,EAAK5C,MAAM7D,KAAKkG,cAAc,CAAEzD,GAAI,wCACjDmkB,kBAAmB4a,EAAQ,MAC3Bj7B,SAAU,EAAKA,SAAS27B,EAAahC,S,EAK3CqC,eAAiB,WAAO,IACdrB,EAA0B,EAAKjjC,MAA/BijC,sBACRA,EAAsBv8B,KAAK,IAC3B,EAAKjB,SAAS,CAAEw9B,2B,EAGlBsB,iBAAmB,SAAAN,GACjB,EAAKx+B,SAAS,CACZkzB,yBAAyB,EACzBC,wBAAyB,CAAEp0B,GAAI,oDAC/Bq0B,sBAAuB,CACrBr0B,GAAI,iDACJ+X,OAAQ,CAAEknB,aAAc,EAAKzjC,MAAMijC,sBAAsBgB,GAAjC,WAE1BnL,2BAA4B,WAC1B,EAAK0L,eAAeP,GACpB,EAAK/Z,cAEP6O,0BAA2B,EAAK7O,c,EAIpCsa,eAAiB,SAAAP,GAAgB,IACvBhB,EAA0B,EAAKjjC,MAA/BijC,sBACRA,EAAsBntB,OAAOmuB,ErFtQd,GqFuQf,EAAKx+B,SAAS,CAAEw9B,2B,EAGlBwB,qBAAuB,SAAClB,EAAUU,GAAmC,IAAtBz6B,EAAqB,wDAC1DzH,EAAS,EAAK6D,MAAd7D,KACF0hC,EAAeF,EAAQ,SACvBmB,GAAuBjB,EACvBD,EAAoB,IAAIpqB,OAAO8oB,IAC/ByC,GAAyBnB,EAAkBnqB,KAAKoqB,GACtD,OACE,uCACE,uBAAKv7B,UAAU,SAAf,UACE,eAAC0gB,GAAD,CACEpgB,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,4DACtCmkB,iBAAkB+b,EAClB5jC,MAAS2iC,GAA8B,GACvCn7B,SAAU,EAAKA,SAAS27B,EAAalC,IACrC75B,UAAYsB,IAAak7B,IAAuBC,EAAqC,GAAZ,UACzEn7B,SAAUA,KAEVA,IACCk7B,EACC,eAAC,GAAD,CAAiBtkC,QAAQ,0BAEzBukC,GAAyB,eAAC,GAAD,CAAiBvkC,QAAQ,kEAGxD,eAACwlB,GAAA,EAAD,CAAO1d,UAAU,+BAAjB,SACE,uBACEA,UAAU,qCACV2d,cAAY,OACZ3L,MAAOnY,EAAKkG,cAAc,CAAEzD,GAAI,sE,EAO1CogC,mBAAqB,WAAO,IAClB3B,EAA0B,EAAKjjC,MAA/BijC,sBACiBA,EAAsBt+B,MAC7C,SAAA4+B,GAAQ,OAAIA,EAAQ,WAAkC1B,MAExC,MAA+Bn7B,KAAKrB,IAAEqlB,MAAM4X,KAC5D,EAAK78B,SAAS,CAAEw9B,2B,EAGlB4B,sBAAwB,SAAAC,GAAuB,IACrC7B,EAA0B,EAAKjjC,MAA/BijC,sBACFS,EAAmBT,EAAsBt+B,MAC7C,SAAA4+B,GAAQ,OAAIA,EAAQ,WAAkC1B,MAExD6B,EAAgB,MAA+B5tB,OAAOgvB,ErF3TvC,GqF4TVpB,EAAgB,MAA+BhiC,QAClDgiC,EAAgB,MAA+Bh9B,KAAKrB,IAAEqlB,MAAM4X,KAE9D,EAAK78B,SAAS,CAAEw9B,2B,EAGlB8B,gCAAkC,SAACD,EAAoBjF,GAArB,OAAsC,SAAA9vB,GAAU,IAAD,EACjB,EAAK/P,MAA3DijC,EADuE,EACvEA,sBAAuBG,EADgD,EAChDA,2BACzBM,EAAmBT,EAAsBt+B,MAC7C,SAAA4+B,GAAQ,OAAIA,EAAQ,WAAkC1B,MAExD6B,EAAgB,MAA+BoB,GAAoBjF,GAAgBlb,GAAkB5U,GACrG,IAAMq0B,EAAY,OAAGV,QAAH,IAAGA,OAAH,EAAGA,EAAgB,KACrCN,EAA2BiB,IAAID,GAC/B,EAAK3+B,SAAS,CAAEw9B,wBAAuBG,iC,EAGzC4B,qBAAuB,SAAAzB,GAAa,IAC1BxhC,EAAS,EAAK6D,MAAd7D,KACF2hC,EAAmBH,EAAQ,MACjC,OACE,sBAAKr7B,UAAU,OAAf,gBACGw7B,QADH,IACGA,OADH,EACGA,EAAkBv9B,KAAI,SAAC8+B,EAASC,GAC/B,IAAMprB,EAAMmrB,EAAO,IACbnkC,EAAQmkC,EAAO,MACrB,OACE,uBAAK/8B,UAAU,qBAAf,UACE,eAAC0gB,GAAD,CACEpgB,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,+CACtCmkB,kBAAmB7O,EACnBhZ,MAAOgZ,EACPxR,SAAU,EAAKy8B,gCAAgCG,EAAY9C,IAC3D7Z,iBAAiB,WAEnB,eAACK,GAAD,CACEpgB,YAAazG,EAAKkG,cAAc,CAAEzD,GAAI,iDACtCmkB,kBAAmB7nB,EACnBA,MAAOA,EACPwH,SAAU,EAAKy8B,gCAAgCG,EAAY7C,IAC3D9Z,iBAAiB,WAEnB,eAACiB,GAAD,CACEznB,KAAMA,EACN0nB,YAAa,kBAAM,EAAKmb,sBACxBlb,aAAc,kBAAM,EAAKmb,sBAAsBK,IAC/Cvb,oBAAqBub,IAAexB,EAAiBhiC,OAAS,MAnBlE,0BAA4DwjC,U,EA4BtE3B,SAAW,SAACA,EAAUU,GAAiB,IAC7BliC,EAAS,EAAK6D,MAAd7D,KAD4B,EAE0B,EAAK/B,MAA3Do/B,EAF4B,EAE5BA,sBAAuB8D,EAFK,EAELA,2BACzBO,EAAeF,EAAQ,SACvBa,EAAeb,EAAQ,KACvB4B,EAAqB1B,IAAiB5B,GACtCuD,EAAkBlC,EAA2BlvB,SAASuvB,GACtD5G,EAAkBwI,EACtB,gBAACvf,GAAA,EAAD,WACE,eAAC,IAAD,CAAkBphB,GAAG,iDACrB,uBACE0D,UAAU,qCACV2d,cAAY,OACZ3L,MAAOnY,EAAKkG,cAAc,CAAEzD,GAAI,wDAGlC4gC,EACF,eAACxf,GAAA,EAAD,UAAQ6d,IAER,EAAKgB,qBAAqBlB,EAAUU,GAEhCrH,EACJuI,GAAsBC,EAAkBzI,EAAkB,EAAK8H,qBAAqBlB,EAAUU,GAAa,GACvGpH,EAAgBsI,EAClB,EAAKH,qBAAqBzB,GAC1B,CAAC,EAAKhiC,YAAYgiC,EAAUU,GAAc,EAAK1sB,KAAKgsB,EAAUU,IAClE,OACE,eAAC,GAAD,CAEEtH,gBAAiBA,EACjBC,wBAAyBA,EACzBC,cAAeA,EACfC,YAAa,EAAKA,YAAYmH,KAAiBkB,EAC/CpI,SAAU,kBAAM,EAAKwH,iBAAiBN,IACtCjH,kBAAmBoC,GAPrB,mBACmB6E,EADnB,YACkCG,K,EAWtC1C,0BAA4B,WAAO,IACzBtC,EAA0B,EAAKp/B,MAA/Bo/B,sBACR,OACE,eAAC91B,EAAA,EAAD,CAAQC,QAAS,kBAAM,EAAK9D,UAAS,SAAAzF,GAAK,MAAK,CAAEo/B,uBAAwBp/B,EAAMo/B,2BAA2Bl3B,UAAU,SAApH,SACE,eAAC,IAAD,CAAkB1D,GAAE,uCAAkC46B,EAAwB,WAAa,e,uDAvVjG,WACE53B,KAAK5B,MAAMy/B,yC,gCAGb,SAAmB39B,GAAuD,IAAD,SACaF,KAAK5B,MAAjF7D,EAD+D,EAC/DA,KAAMtB,EADyD,EACzDA,SAAUjB,EAD+C,EAC/CA,QAASmB,EADsC,EACtCA,QAASswB,EAD6B,EAC7BA,SAAUkS,EADmB,EACnBA,4BACpD,GAAIz7B,EAAUy7B,8BAAgCA,EAC5C37B,KAAK/B,SAAS,CAAE09B,4BAA6BA,EAA4Bh9B,KAAI,SAAAm/B,GAAc,OAAIA,EAAe15B,mBAAkB,kBAC9H,EAAKhG,MAAM7E,YAAY6gC,YAEpB,GAAIl6B,EAAUjH,WAAaA,EAAU,CAC1C,IAAM8kC,EAAiB,GACjBC,EAA0B/kC,EAASkE,MAAK,SAAAjE,GAAO,OAAIA,EAAO,WAAkCohC,MAC5F4B,EAAmB8B,EAAuB,MAA+B9iC,MH5E1C,KG4E6EyD,KAAI,SAAA8+B,GAAO,iCAC1H7C,GAAwB6C,EAAQviC,MAAMy/B,IrFrF3B,IqFoF+G,eAE1HE,GAA0B4C,EAAQviC,MAAMy/B,IrFrF9B,IqFmFgH,KAI7HqD,EAAuB,MAAiC9B,EACxD6B,EAAe7+B,KAAK8+B,GACpB,IAAMC,EAAiBhlC,EAASsR,QAAO,SAAArR,GAAO,OAAIA,IAAY8kC,KAC9DD,EAAe7+B,KAAf,MAAA6+B,EAAc,aAASE,IACvBF,EAAeh4B,SACb,SAAA7M,GAAO,OACJA,EAAO,SAAgCA,EAAO,SAA8B8R,QAC3EovB,GACAj0B,OAGNnG,KAAK/B,SAAS,CACZw9B,sBAAuBsC,EACvBrC,2BAA4B79B,IAAEqlB,MAAM6a,GACpClC,8BAA8B,KAG7B37B,EAAU/G,SAAWA,GAAW6G,KAAKxH,MAAMsjC,oBAAsB97B,KAAKxH,MAAMqjC,8BAC/Er7B,aAAajG,EAAKkG,cAAc,CAAEzD,GAAI,mCACtCgD,KAAK/B,SACH,CACE25B,uBAAuB,EACvBgE,2BAA4B,IAAI5H,IAChC8H,mBAAmB,EACnBD,8BAA8B,IAEhC,kBAAM,EAAKz9B,MAAM7E,YAAY6gC,QAEtBl6B,EAAUupB,WAAazpB,KAAK5B,MAAMqrB,UAAazxB,GACxDwxB,aAAWC,K,oBA8Sf,WAAU,IAAD,SACuEzpB,KAAK5B,MAA3EqrB,EADD,EACCA,SAAUC,EADX,EACWA,WAAYwU,EADvB,EACuBA,mCAAoClmC,EAD3D,EAC2DA,QAC1DyjC,EAA0Bz7B,KAAKxH,MAA/BijC,sBACR,OACE,uBAAK/6B,UAAU,yBAAf,UACGV,KAAKkvB,oBACN,8BACE,eAAC,IAAD,CAAkBlyB,GAAG,kCAEvB,sBAAK0D,UAAU,QAAf,SAAwB+oB,IACxB,sBAAK/oB,UAAU,gBAAf,SACGgpB,GAAcwU,GAAsClmC,EACnD,eAACmP,GAAA,EAAD,IAEA,uCACE,uBAAKzG,UAAU,UAAf,UACE,sBAAKA,UAAU,gBAAf,SAAgCV,KAAKk6B,8BACpCuB,EAAsB98B,KAAI,SAACo9B,EAAUvd,GAAX,OAAmB,EAAKud,SAASA,EAAUvd,MACtE,sBAAK9d,UAAU,uCAAf,SACE,eAACoB,EAAA,EAAD,CAAQpB,UAAU,kBAAkBqB,QAAS/B,KAAK88B,eAAlD,SACE,eAAC,IAAD,CAAkB9/B,GAAG,uDAI3B,uBAAK0D,UAAU,YAAf,UACE,sBAAKA,UAAU,WAAf,SACE,eAACoB,EAAA,EAAD,CAAQpB,UAAU,SAASqB,QAAS/B,KAAKmpB,OAAzC,SACE,eAAC,IAAD,CAAkBnsB,GAAG,sBAGzB,sBAAK0D,UAAU,+CAAf,SACE,eAACoB,EAAA,EAAD,CAAQpB,UAAU,OAAOqB,QAAS/B,KAAKsqB,OAAQtoB,SAAUhC,KAAKi4B,iBAA9D,SACE,eAAC,IAAD,CAAkBj7B,GAAG,mC,GA5YDiF,IAAMC,WAuaxCC,GAAqB,CACzB5I,cACAM,gBACAI,gBACAsiC,clGtX2B,SAAArjC,GAAO,MAAK,CACvCR,KAAMZ,EACNa,QAASe,IAAMykC,OAAN,4CAAkDjlC,EAAQd,SkGqXnE48B,yBACAD,mBACA8I,qCJ5bkD,iBAAO,CACzDnlC,KAAMZ,GACNa,QAASe,IAAMC,IAAI,sDIgcN0I,sBA5BS,SAAC,GAAD,QAAG0H,EAAH,EAAGA,KAAM9Q,EAAT,EAASA,SAAUw/B,EAAnB,EAAmBA,SAAU2F,EAA7B,EAA6BA,SAA7B,MAA6C,CACnE3U,SAAU1f,EAAKzR,aACfoxB,WAAY3f,EAAK/R,QACjBA,QAASiB,EAASjB,QAClBmB,QAASF,EAASE,QAClBgB,QAAQ,UAAAlB,EAASC,eAAT,eAAkBI,SAAlB,UAA2BL,EAASC,eAApC,aAA2B,EAAkBI,OACrDJ,QAASD,EAASC,QAClBD,SAAUA,EAASA,SACnBG,eAAgBH,EAASG,eACzBy7B,aAAc4D,EAAS5D,aACvBC,mBAAoB2D,EAAS3D,mBAC7BoJ,mCAAoCE,EAASpmC,QAC7C2jC,4BAA6ByC,EAASjE,qCAgBAh4B,GAAzBE,CAA6CE,YAAWC,qBAAWk1B,MCperE2G,I,QAA8B,CACzC5+B,KAAM,GACN1F,YAAa,GACbwL,SAAU,GACVC,SAAU,GACVC,YAAa,GACbC,cAAe,GACfC,QAAS,GACTC,WAAY,GACZ04B,KAAM,GACNr6B,WAAY,KCiVR9B,GAAqB,CAAEo8B,0B5D7QY,iBAAO,CAC9C7lC,KAAMZ,GACNa,QAASe,IAAMC,IAAI,sD4D2QmC8W,mBAAiB+tB,a5DxQ7C,SAACngC,GAAD,MAA0B,CACpD3F,KAAMZ,GACNa,QAASe,IAAMM,KAAN,sCAA0CqE,EAASjG,KAAO,IAAMiG,EAASjG,KAAO,IAAMiG,K4DsQVogC,Y5DlR5D,SAACzhC,GAAD,MAAiB,CAC1CtE,KAAMZ,GACNa,QAASe,IAAMC,IAAN,iDAAoDqD,EAApD,c4DgRyFpD,qBAKrFyI,sBAjBS,SAAC,GAAD,QACtBhE,SAAYkS,EADU,EACVA,8BAA+BD,EADrB,EACqBA,uBAAwBD,EAD7C,EAC6CA,UAAWlX,EADxD,EACwDA,QAASqX,EADjE,EACiEA,gBAA2BkuB,EAD5F,EACkFrgC,SADlF,IAEtBpF,SAAqB0lC,EAFC,EAEV3mC,QAAyBkB,EAFf,EAEeA,QAFf,MAGT,CACb0lC,kBAAmBruB,GAAiCC,GAAmBmuB,EACvEruB,uBAAwBA,EAAuB/F,QAAO,SAAAs0B,GAAqB,OAAKA,EAAsB7wB,WACtGqC,YACAlX,UACAulC,iBACA3L,aAAY,OAAE75B,QAAF,IAAEA,OAAF,EAAEA,EAASI,SAQe6I,GAAzBE,CAA6CE,YAAWC,sBA7S/C,SAACpE,GAA2B,IAAD,EACjBmvB,mBAAS8Q,IADQ,oBAC1ChgC,EAD0C,KAChCygC,EADgC,OAEOvR,oBAAS,GAFhB,oBAE1C/K,EAF0C,KAEpBuc,EAFoB,KAIvCt+B,EACNrC,EADF7D,KAAQkG,cAEFu+B,EAAe5gC,EAAMe,MAAMC,OAA3B4/B,WAERnJ,qBAAU,WACRz3B,EAAMmgC,4BACNngC,EAAMqS,kBACNrS,EAAMxE,kBD/D2C,uCCgE7ColC,GACF5gC,EAAMqgC,YAAYO,KAGnB,IAEHnJ,qBAAU,WACJz3B,EAAMsgC,gBACRI,EAAY1gC,EAAMsgC,kBAEnB,CAACtgC,EAAMsgC,iBAEV,IAAMxL,EAAW,WACfzrB,OAAOpJ,SAASqJ,KAAhB,UAA0BvQ,EAA1B,oDA2BF0+B,qBAAU,WACJz3B,EAAMjF,SACR+5B,MAED,CAAC90B,EAAMjF,UAEV,IAAMglB,EAAgB,SAAC1e,GAAD,OAAkB,SAAC8I,GAAD,OAAwBu2B,EAAY,2BAAKzgC,GAAN,mBAAiBoB,EAAO0d,GAAkB5U,QAgB/G02B,GAAuB5gC,EAASoB,KAEhCy/B,EAA2B9gC,EAAMiS,UACpC9F,QAAO,SAAAgJ,GAAG,OAAIA,EAAInb,OAASiG,EAASjG,QACpCuG,KAAI,SAAA4U,GAAG,OAAIA,EAAI3U,QAAQwF,iBACvBoI,SAASnO,EAASoB,KAAK2E,eAEpB+6B,GAAkB9gC,EAASsH,QAE3By5B,EAAsEC,gBAAMjhC,EAAMkS,uBD5InE,GC8IfgvB,EAAQ,SAACT,GAAmD,IAAD,EAzBjCzmC,EA0BxBka,EAAG,2BAAuBusB,EAAsBzmC,MAChD4I,EAAc69B,EAAsBp/B,KACpCnG,EAAK,UAAG+E,EAAS4F,WAAW9G,MAAK,SAAAoiC,GAAS,OAAIV,EAAsBzmC,OAASmnC,EAAUp7B,cAAc/L,eAAhG,aAAG,EAAoGkB,MAE5GmS,EDpJyB,ICmJZozB,EAAsBW,YACRlmC,EAC3BwH,GA/BwB1I,EA+BUymC,EAAsBzmC,KA/Bf,SAACmQ,GAChD,IAAItE,EAAa5F,EAAS4F,WACpBs7B,EAAYt7B,EAAW9G,MAAK,SAAAoiC,GAAS,OAAIA,EAAUp7B,cAAc/L,OAASA,KAC1EkB,EAAQ6jB,GAAkB5U,GAE5Bg3B,EACFA,EAAUjmC,MAAQA,EAElB2K,EAAU,uBAAO5F,EAAS4F,YAAhB,CAA4B,CAAEE,cAAe,CAAE/L,QAAQkB,WAGnEwlC,EAAY,2BAAKzgC,GAAN,IAAgB4F,kBAsB3B,OAAQ46B,EAAsBY,2BAC5B,IDpJoC,wECqJlC,IAAM7+B,EAA0Bi+B,EAAsBa,cACnDxkC,MDxJsC,KCyJtCyD,KAAI,SAAArF,GAAK,MAAK,CAAEkF,MAAOlF,EAAOA,YACjC,OACE,uBAAKoH,UAAU,kBAAf,UACE,eAAC2gB,GAAD,CAEErgB,YAAaA,EACbmgB,kBAAmB7nB,EACnBA,MAAOsH,EAAQzD,MAAK,SAAAgP,GAAM,OAAIA,EAAO7S,QAAUA,KAC/CwH,SAAU,SAACqL,GAAD,OAAqBrL,EAASqL,EAAO7S,QAC/CsH,QAASA,EACTmgB,iBAAkBjL,KAAG,SAAU,CAAE6pB,QAASnd,GAAwB/W,IAClE1K,gBAAgB,iBAChB2c,MAAOD,IARFnL,GAUNkQ,GAAwB/W,GAAa,eAAC,GAAD,CAAiB7S,QAAQ,6BAGrE,IDzK0C,mEC0KxC,OACE,eAAC2oB,GAAD,CAEE9hB,KAAM6S,EACNxR,SAAUA,EACVF,QAAS,CACP,CAAEtH,MAAO+M,GAAa7H,MAAOiC,EAAc,CAAEzD,GAAI,iBACjD,CAAE1D,MAAOgN,GAAc9H,MAAOiC,EAAc,CAAEzD,GAAI,mBAEpD1D,MAAK,OAAEA,QAAF,IAAEA,OAAF,EAAEA,EAAO7B,WACduJ,YAAaA,EACbmgB,iBAAe,GATV7O,GAYX,IDtLoC,gECuLlC,OACE,uBAAK5R,UAAU,kBAAf,UACE,eAAC,GAAD,CAEEA,UAAWoV,KAAG0M,GAAwB/W,GACtCzK,YAAaA,EACbmgB,kBAAmB7nB,EACnBA,MAAOA,EACPwH,SAAUA,EACVq6B,aAAW,GANN7oB,GAQNkQ,GAAwB/W,GAAa,eAAC,GAAD,CAAiB7S,QAAQ,6BAGrE,QACE,OACE,uBAAK8H,UAAU,kBAAf,UACE,eAAC0gB,GAAD,CAEE1gB,UAAWoV,KAAG,CAAE6pB,QAASnd,GAAwB/W,IACjDzK,YAAaA,EACbmgB,kBAAmB7nB,EACnBA,MAAOA,EACPwH,SAAUA,GALLwR,GAONkQ,GAAwB/W,GAAa,eAAC,GAAD,CAAiB7S,QAAQ,+BAMzE,OACE,uBAAKoE,GAAG,WAAR,UACE,8BACE,eAAC,IAAD,CAAkBA,GAAE,6BAAwBgiC,EAAa,OAAS,SAA9C,cAEtB,sBAAKt+B,UAAU,gBAAf,SACGtC,EAAMwgC,kBACL,sBAAKl+B,UAAU,UAAf,SACE,eAACyG,GAAA,EAAD,MAGF,uCACE,uBAAKzG,UAAU,UAAf,UACE,uBAAKA,UAAU,gBAAf,UACE,uBAAKA,UAAU,kBAAf,UACE,eAAC0gB,GAAD,CAEEpgB,YAAaP,EAAc,CAAEzD,GAAI,4BACjCmkB,kBAAmB9iB,EAASoB,KAC5BnG,MAAO+E,EAASoB,KAChBqB,SAAUqd,EAAc,QACxBzd,UAAWoV,KAAG,CAAE6pB,QAASnd,IAAyByc,GAAuBC,KACzE9xB,cAAY,qBANR,qBAQLoV,IACEyc,EACC,eAAC,GAAD,CAAiBrmC,QAAQ,0BAEzBsmC,GAA4B,eAAC,GAAD,CAAiBtmC,QAAQ,gCAG3D,eAACwoB,GAAD,CAEEpgB,YAAaP,EAAc,CAAEzD,GAAI,mCACjCmkB,kBAAmB9iB,EAAStE,YAC5BT,MAAO+E,EAAStE,YAChB+G,SAAUqd,EAAc,eACxB/Q,cAAY,4BALR,+BAQR,uBAAK1M,UAAU,gBAAf,UACE,eAAC0gB,GAAD,CAEEpgB,YAAaP,EAAc,CAAEzD,GAAI,gCACjCmkB,kBAAmB9iB,EAASkH,SAC5BjM,MAAO+E,EAASkH,SAChBzE,SAAUqd,EAAc,YACxB/Q,cAAY,yBALR,yBAON,eAACgU,GAAD,CAEEpgB,YAAaP,EAAc,CAAEzD,GAAI,gCACjCmkB,kBAAmB9iB,EAASmH,SAC5BlM,MAAO+E,EAASmH,SAChB1E,SAAUqd,EAAc,YACxB/Q,cAAY,yBALR,4BAQR,uBAAK1M,UAAU,gBAAf,UACE,eAAC0gB,GAAD,CAEEpgB,YAAaP,EAAc,CAAEzD,GAAI,mCACjCmkB,kBAAmB9iB,EAASoH,YAC5BnM,MAAO+E,EAASoH,YAChB3E,SAAUqd,EAAc,eACxB/Q,cAAY,4BALR,4BAON,eAACgU,GAAD,CAEEpgB,YAAaP,EAAc,CAAEzD,GAAI,qCACjCmkB,kBAAmB9iB,EAASqH,cAC5BpM,MAAO+E,EAASqH,cAChB5E,SAAUqd,EAAc,iBACxB/Q,cAAY,8BALR,iCAQR,uBAAK1M,UAAU,gBAAf,UACE,eAAC0gB,GAAD,CAEEpgB,YAAaP,EAAc,CAAEzD,GAAI,kCACjCmkB,kBAAmB9iB,EAASuH,WAC5BtM,MAAO+E,EAASuH,WAChB9E,SAAUqd,EAAc,cACxB/Q,cAAY,2BALR,2BAON,uBAAK1M,UAAU,kBAAf,UACE,eAAC0gB,GAAD,CAEEpgB,YAAaP,EAAc,CAAEzD,GAAI,+BACjCmkB,kBAAmB9iB,EAASsH,QAC5BrM,MAAO+E,EAASsH,QAChB7E,SAAUqd,EAAc,WACxBzd,UAAWoV,KAAG,CAAE6pB,QAASnd,GAAwB2c,IACjD/xB,cAAY,wBANR,wBAQLoV,GAAwB2c,GAAkB,eAAC,GAAD,CAAiBvmC,QAAQ,gCAnF1E,OAsFGwmC,QAtFH,IAsFGA,OAtFH,EAsFGA,EAA+BzgC,KAAI,SAACihC,EAA6BphB,GAA9B,OAClC,sBAAK9d,UAAU,gBAAf,SACGk/B,EAA4BjhC,KAAI,SAAAkgC,GAAqB,OAAIS,EAAMT,OADlE,qCAAkErgB,UAKtE,uBAAK9d,UAAU,YAAf,UACE,sBAAKA,UAAU,WAAf,SACE,eAACoB,EAAA,EAAD,CAAQpB,UAAU,SAASqB,QAASmxB,EAAU9lB,cAAY,eAA1D,SACE,eAAC,IAAD,CAAkBpQ,GAAG,sBAGzB,sBAAK0D,UAAU,+CAAf,SACE,eAACoB,EAAA,EAAD,CAAQpB,UAAU,OAAOqB,QApPxB,WACb,IAGM89B,EAHiCzhC,EAAMkS,uBAAuB/F,QAClE,SAAAs0B,GAAqB,ODxFQ,ICwFJA,EAAsBW,aAEgC1tB,OAAM,gBAASguB,EAAT,EAAG1nC,KAAH,OACrFiG,EAAS4F,WAAW9G,MAAK,gBAAGgH,EAAH,EAAGA,cAAe7K,EAAlB,EAAkBA,MAAlB,OAA8BwmC,IAAsC37B,EAAc/L,MAAQkB,QAGrH,GAAI2lC,GAAuBC,GAA4BC,IAAmBU,EACxEd,GAAwB,GACxB1X,SACK,CACL,IAAM0Y,EAAmBzZ,oBAAUjoB,GAC7B2hC,EAAsB5hC,EAAM20B,aAAe3pB,KAAK5R,MAAM4G,EAAM20B,cAAgB,GAElFgN,EAAiB97B,WAAa87B,EAAiB97B,WAC5CsG,QAAO,SAAAg1B,GAAS,MAAwB,KAApBA,EAAUjmC,SAC9BqF,KAAI,kBAA+B,CAAEwF,cAAjC,EAAGA,cAA6C7K,MAAhD,EAAkBA,UACzBymC,EAAiBzB,KAAO2B,eAAK,GAAD,oBAAKF,EAAiBzB,MAAtB,aAA+B0B,KAE3D5hC,EAAMogC,aAAauB,KAgOiC3yB,cAAY,aAAtD,SACE,eAAC,IAAD,CAAkBpQ,GAAG,oCC7U1BkjC,GAA0B,YAC1BC,GAAc,2JACdC,GAAiB,wCACjBC,GAAiB,+BACjBC,GAAgC,2BAChCC,GAAuC,UAAMD,GAAN,wBACvCE,GAAoC,UAAMF,GAAN,qBAEpCG,GAA6B,SAE7BC,GAAoB,aACpBC,GAAmB,YACnBC,GAAc,QACdC,GAAc,QACdC,GAAiB,WACjBC,GAAiB,YACjBC,GAAkB,WAClBC,GAAiB,WACjBC,GAAyB,kBACzBC,GAAsB,CACjC77B,WAAY,CAAEhM,MAAO,GAAI0O,SAAS,EAAMrH,MAAO,IAC/CyE,UAAW,CAAE9L,MAAO,GAAI0O,SAAS,EAAMrH,MAAO,IAC9CqP,MAAO,CAAE1W,MAAO,GAAI0O,SAAS,EAAMrH,MAAO,IAC1CygC,MAAO,CAAE9nC,MAAO,GAAI0O,SAAS,EAAMrH,MAAO,IAC1C0gC,SAAU,CAAE/nC,MAAO,GAAI0O,SAAS,EAAMrH,MAAO,IAC7C0P,UAAW,CAAE/W,MAAO,GAAI0O,SAAS,EAAMrH,MAAO,IAC9C2gC,SAAU,CAAEhoC,MAAO,KAAM0O,SAAS,EAAMrH,MAAO,IAC/C4gC,SAAU,CAAEjoC,MAAO,GAAI0O,SAAS,EAAMrH,MAAO,IAC7C6gC,gBAAiB,CAAEloC,MAAO,GAAI0O,SAAS,EAAMrH,MAAO,KC+CvC8gC,GAhEO,SAAC,GAAD,IACZhhC,EADY,EACpBlG,KAAQkG,cACR0d,EAFoB,EAEpBA,cAFoB,IAGpBujB,YAHoB,IAIlBp8B,WAAqBq8B,EAJH,EAIJroC,MAAiCsoC,EAJ7B,EAIoB55B,QAAmC65B,EAJvD,EAIgDlhC,MAJhD,IAKlByE,UAAoB08B,EALF,EAKLxoC,MAAgCyoC,EAL3B,EAKkB/5B,QAAkCg6B,EALpD,EAK6CrhC,MAL7C,IAMlBqP,MAAgBiyB,EANE,EAMT3oC,MAA4B4oC,EANnB,EAMUl6B,QAA8Bm6B,EANxC,EAMiCxhC,MANjC,IAOlBygC,MAAgBgB,EAPE,EAOT9oC,MAA4B+oC,EAPnB,EAOUr6B,QAA8Bs6B,EAPxC,EAOiC3hC,MAPjC,OAUpB,uCACE,eAACyd,GAAA,EAAD,CAAO1d,UAAU,OAAjB,SACE,eAAC,IAAD,CAAkB1D,GAAG,kCAAkC4Y,QAAQ,WAEjE,uBAAKlV,UAAU,UAAf,UACE,uBAAKA,UAAU,SAAf,UACE,eAAC0gB,GAAD,CACEpgB,YAAaP,EAAc,CAAEzD,GAAG,6BAAD,OAA+B0jC,MAC9Dvf,kBAAmBwgB,EACnBroC,MAAOqoC,EACP7gC,SAAUqd,EAAcuiB,IACxBhoC,KAAK,OACLgI,UAAWoV,KAAG,CAAE6pB,SAAUiC,OAE1BA,GAAqB,eAAC,GAAD,CAAiBhpC,QAASipC,OAEnD,uBAAKnhC,UAAU,SAAf,UACE,eAAC0gB,GAAD,CACEpgB,YAAaP,EAAc,CAAEzD,GAAG,6BAAD,OAA+B2jC,MAC9Dxf,kBAAmB2gB,EACnBxoC,MAAOwoC,EACPhhC,SAAUqd,EAAcwiB,IACxBjoC,KAAK,OACLgI,UAAWoV,KAAG,CAAE6pB,SAAUoC,OAE1BA,GAAoB,eAAC,GAAD,CAAiBnpC,QAASopC,OAElD,uBAAKthC,UAAU,yBAAf,UACE,eAAC,KAAD,CACEM,YAAaP,EAAc,CAAEzD,GAAG,6BAAD,OAA+B4jC,MAC9D9/B,SAAUqd,EAAcyiB,IACxBtnC,MAAO2oC,EACPzyB,eAAa,EACbC,iBAAkB,CAAE/O,UAAWoV,KAAG,eAAgB,CAAE6pB,SAAUuC,KAC9DxpC,KAAK,UAEJupC,GAAc,uBAAMvhC,UAAU,cAAhB,SAA+BD,EAAc,CAAEzD,GAAG,6BAAD,OAA+B4jC,SAC/FsB,GAAgB,eAAC,GAAD,CAAiBtpC,QAASupC,OAE9C,uBAAKzhC,UAAU,SAAf,UACE,eAAC0gB,GAAD,CACEpgB,YAAaP,EAAc,CAAEzD,GAAG,6BAAD,OAA+B6jC,MAC9D1f,kBAAmBihB,EACnB9oC,MAAO8oC,EACPthC,SAAUqd,EAAc0iB,IACxBnoC,KAAK,OACLgI,UAAWoV,KAAG,CAAE6pB,SAAU0C,OAE1BA,GAAgB,eAAC,GAAD,CAAiBzpC,QAAS0pC,cC3BrCC,GA9BG,SAAC,GAAiC,IAAD,IAA9BhoC,EAA8B,EAA9BA,KAAMioC,EAAwB,EAAxBA,MACnBloC,EAAa,SAACE,GAAD,OAAkBw9B,KAAOx9B,GAAMM,OFNX,0BEQvC,OACE,uCACE,eAACsjB,GAAA,EAAD,CAAO1d,UAAU,OAAjB,SACE,eAAC,IAAD,CAAkB1D,GAAG,8BAA8B4Y,QAAQ,WAE7D,oBAAGlV,UAAU,OAAO0M,cAAY,uBAAhC,SACG7S,EAAKkG,cACJ,CAAEzD,GAAI,iCACN,CACEylC,QAAO,OAAED,QAAF,IAAEA,GAAF,UAAEA,EAAOC,eAAT,aAAE,EAAgB7jC,QACzBpE,KAAMF,EAAU,OAACkoC,QAAD,IAACA,OAAD,EAACA,EAAOE,iBAI9B,oBAAGhiC,UAAU,OAAO0M,cAAY,uBAAhC,SACG7S,EAAKkG,cACJ,CAAEzD,GAAI,mCACN,CACE2lC,UAAS,OAAEH,QAAF,IAAEA,GAAF,UAAEA,EAAOG,iBAAT,aAAE,EAAkB/jC,QAC7BpE,KAAMF,EAAU,OAACkoC,QAAD,IAACA,OAAD,EAACA,EAAOI,qBCkFrBC,GAlGY,SAAC,GAgBX,IAfPpiC,EAeM,EAfdlG,KAAQkG,cACR0d,EAcc,EAddA,cACArN,EAac,EAbdA,YACAgyB,EAYc,EAZdA,MACAzyB,EAWc,EAXdA,UACA0yB,EAUc,EAVdA,cACAC,EASc,EATdA,iBACAnrB,EAQc,EARdA,OAQc,IAPd6pB,YAOc,IANZL,SAAmB4B,EAMP,EANA3pC,MAA+B4pC,EAM/B,EANsBl7B,QAAiCm7B,EAMvD,EANgDxiC,MAMhD,IALZ0P,UAAoB+yB,EAKR,EALC9pC,MAAgC+pC,EAKjC,EALwBr7B,QAAkCs7B,EAK1D,EALmD3iC,MAKnD,IAJZ2gC,SAAmBiC,EAIP,EAJAjqC,MAA+BkqC,EAI/B,EAJsBx7B,QAAiCy7B,EAIvD,EAJgD9iC,MAIhD,IAHZ4gC,SAAmBmC,EAGP,EAHApqC,MAA+BqqC,EAG/B,EAHsB37B,QAAiC47B,EAGvD,EAHgDjjC,MAGhD,IAFZ6gC,gBAA0BqC,EAEd,EAFOvqC,MAAsCwqC,EAE7C,EAFoC97B,QAAwC+7B,EAE5E,EAFqEpjC,MAG7EyQ,EAAa,SAACxQ,GAAD,OAA+BA,EAAQjC,KAAI,SAAAwN,GAAM,MAAK,CAAE3N,MAAO2N,EAAOvN,QAAStF,MAAO6S,EAAO/T,UAEhH,OACE,uCACE,eAACgmB,GAAA,EAAD,CAAO1d,UAAU,OAAjB,SACE,eAAC,IAAD,CAAkB1D,GAAG,uCAAuC4Y,QAAQ,WAEtE,uBAAKlV,UAAU,UAAf,UACE,uBAAKA,UAAU,SAAf,UACE,eAAC0gB,GAAD,CACEpgB,YAAaP,EAAc,CAAEzD,GAAG,kCAAD,OAAoC8jC,MACnE3f,kBAAmB8hB,EACnB3pC,MAAO2pC,EACPniC,SAAUqd,EAAc2iB,IACxBpoC,KAAK,OACLgI,UAAWoV,KAAG,CAAE6pB,SAAUuD,OAE1BA,GAAmB,eAAC,GAAD,CAAiBtqC,QAASuqC,OAEjD,uBAAKziC,UAAU,SAAf,UACE,eAAC2gB,GAAD,CACErgB,YAAaP,EAAc,CAAEzD,GAAG,kCAAD,OAAoC+jC,MACnE5f,kBAAmBiiB,EAAelpC,OAClCZ,MAAO8pC,EACPxiC,QAASwQ,EAAWf,GACpBvP,SAAUqd,EAAc4iB,IACxB7gB,SAAO,EACPa,iBAAkBjL,KAAG,CAAE6pB,SAAU0D,IACjCtiC,gBAAgB,uBAChB2c,MAAOD,GACP/kB,KAAK,UAEL2qC,GAAoB,eAAC,GAAD,CAAiBzqC,QAAS0qC,OAElD,uBAAK5iC,UAAU,SAAf,UACE,eAAC2gB,GAAD,CACErgB,YAAaP,EAAc,CAAEzD,GAAG,kCAAD,OAAoCgkC,MACnE7f,kBAAmBoiB,EACnBjqC,MAAOiqC,EACP3iC,QAASwQ,EAAW0xB,GACpBhiC,SAAUqd,EAAc6iB,IACxBjgB,iBAAkBjL,KAAG,CAAE6pB,SAAU6D,IACjCziC,gBAAgB,iBAChB2c,MAAOD,GACP/kB,KAAK,UAEL8qC,GAAmB,eAAC,GAAD,CAAiB5qC,QAAS6qC,OAEjD,uBAAK/iC,UAAU,SAAf,UACE,eAAC0gB,GAAD,CACE1gB,UAAWoV,KAAG,CAAE6pB,SAAUgE,IAC1B3iC,YAAaP,EAAc,CAAEzD,GAAG,kCAAD,OAAoCikC,MACnE9f,kBAAmBuiB,EACnBpqC,MAAOoqC,EACP5iC,SAAUqd,EAAc8iB,IACxBvoC,KAAK,WACLsrC,aAAa,SAEbL,GAAmB,eAAC,GAAD,CAAiB/qC,QAASgrC,OAEjD,uBAAKljC,UAAU,SAAf,UACE,eAAC0gB,GAAD,CACE1gB,UAAWoV,KAAG,CAAE6pB,SAAUmE,IAC1B9iC,YAAaP,EAAc,CAAEzD,GAAG,kCAAD,OAAoCkkC,MACnE/f,kBAAmB0iB,EACnBvqC,MAAOuqC,EACP/iC,SAAUqd,EAAc+iB,IACxBxoC,KAAK,WACLsrC,aAAa,SAEbF,GAA0B,eAAC,GAAD,CAAiBlrC,QAASmrC,UAG1D,gBAAC3lB,GAAA,EAAD,CAAO1d,UAAWoV,KAAG,wBAAyB,CAAEmuB,KAAMpsB,IAAW/G,EAAY3T,MAAK,SAAAqO,GAAK,OAAIA,IAAUy1B,QAArG,UACE,eAAC,KAAD,CAAOvoC,KAAK,WAAWqJ,QAAS,kBAAMihC,GAAkBD,IAAgB3lB,QAAS2lB,IACjF,eAAC,IAAD,CAAkB/lC,GAAG,qDAAqD4Y,QAAQ,gBC3G7E9d,GACA,kBADAA,GAEE,oBAGTC,GAAe,CACnBC,SAAS,EACT8qC,MAAO,GACPxqC,aAAc,IAsCDC,GAnCC,WAAmC,IAAlCC,EAAiC,uDAAzBT,GAAcU,EAAW,uCAChD,OAAQA,EAAOC,MACb,KAAKhB,EAAQI,IACX,OAAO,2BACFU,GADL,IAEER,SAAS,IAEb,KAAKH,EAAQC,IACX,OAAO,2BACFC,IADL,IAEEO,aAAcG,EAAOE,QAAQC,UAEjC,KAAKhB,EAAQE,IACX,OAAO,2BACFC,IADL,IAEE+qC,MAAOrqC,EAAOE,QAAQI,KAAKC,UAE/B,KAAKlB,GACH,OAAO,eACFC,IAEP,QACE,OAAOS,ICjCAV,GACD,gBADCA,GAEA,iBAFAA,GAGA,iBAHAA,GAIE,mBAGTC,GAAe,CACnBC,SAAS,EACTksC,MAAO,GACPC,YAAa,GACb7rC,aAAc,GACda,SAAS,GAkEIZ,GA/DC,WAAmC,IAAlCC,EAAiC,uDAAzBT,GAAcU,EAAW,uCAChD,OAAQA,EAAOC,MACb,KAAKhB,EAAQI,IACb,KAAKJ,EAAQI,IACX,OAAO,2BACFU,GADL,IAEER,SAAS,IAEb,KAAKH,EAAQC,IACb,KAAKD,EAAQC,IACX,OAAO,2BACFU,GADL,IAEEF,aAAcG,EAAOE,QAAQC,QAC7BZ,SAAS,IAEb,KAAKJ,EAAQE,IAAyB,IAAD,eACbW,EAAOE,QAAQI,KAAKC,QADP,GAC5BmrC,EAD4B,KAEnC,OAAO,2BACF3rC,GADL,IAEE2rC,cACAnsC,SAAS,IAGb,KAAKJ,EAAQE,IACX,OAAO,2BACFU,GADL,IAEE0rC,MAAOzrC,EAAOE,QAAQI,KAAKC,QAC3BhB,SAAS,IAEb,KAAKJ,EAAQE,IACb,KAAKF,EAAQE,IACX,OAAO,2BACFU,GADL,IAEEW,SAAS,IAEb,QACE,OAAOX,ICGP4rC,I,QAAe38B,OAAOpJ,SAASgmC,MAC/BC,GAAmBF,GAAa3wB,QAAQysB,IACxC/6B,IAAiC,IAAtBm/B,GAA0BF,GAAa/nC,MAAMioC,GAAmBpE,GAAwBhmC,QAAU,KAwS7GiI,GAAqB,CACzBsO,mBACA8zB,SF7TsB,iBAAO,CAC7B7rC,KAAMZ,GACNa,QAASe,IAAMC,IAAI,8BE4TnB6qC,SD5SsB,iBAAO,CAC7B9rC,KAAMZ,GACNa,QAASe,IAAMC,IAAI,8BC2SnB8qC,kBDxS+B,SAACt/B,GAAD,MAAuB,CACtDzM,KAAMZ,GACNa,QAASe,IAAMC,IAAN,uDAA0DwL,EAA1D,cCuST5L,cACA2R,aACAw5B,SDtSsB,SAAC3rC,EAAUX,EAAcusC,GAAzB,MAAmD,CACzEjsC,KAAMZ,GACNa,QAASisC,QAAQC,IAAI,CACnBnrC,IAAMM,KAAN,mCAAuC5B,GAAc,IAAMW,GAC3D4rC,GAAejrC,IAAMM,KAAN,uCAA2C5B,GAAQ,CAAEusC,oBCmStEG,WD/RwB,SAAC1sC,GAAD,MAAmB,CAC3CM,KAAMZ,GACNa,QAASe,IAAMykC,OAAN,mCAAyC/lC,EAAzC,mBCmSIiK,sBA1BS,SAAC,GAAD,IAAG0iC,EAAH,EAAGA,KAAM1mC,EAAT,EAASA,SAAU2mC,EAAnB,EAAmBA,KAAM/rC,EAAzB,EAAyBA,SAAU0hB,EAAnC,EAAmCA,UAAnC,MAA4D,CAClFsqB,YAAc9/B,GAA0B+/B,gBAAMvqB,EAAUta,QAA/B2kC,EAAKhtC,QAC9BqY,UAAWhS,EAASgS,UACpByyB,MAAOiC,EAAKjC,MACZoB,MAAOc,EAAKd,MACZC,YAAaa,EAAKb,YAClBlrC,SAAUA,EAASA,SACnBksC,gBAAiBlsC,EAASjB,QAC1BqI,OAAQsa,EAAUta,OAClBlH,QAAS6rC,EAAK7rC,WAiBwBgJ,GAAzBE,CAA6CE,YAAWC,sBApTnD,SAACpE,GAA2B,IAAD,MAE3C7D,EAkBE6D,EAlBF7D,KACA0qC,EAiBE7mC,EAjBF6mC,YACA50B,EAgBEjS,EAhBFiS,UACAyyB,EAeE1kC,EAfF0kC,MACAoB,EAcE9lC,EAdF8lC,MACAC,EAaE/lC,EAbF+lC,YACAlrC,EAYEmF,EAZFnF,SACAksC,EAWE/mC,EAXF+mC,gBACA9kC,EAUEjC,EAVFiC,OACAlH,EASEiF,EATFjF,QACAsX,EAQErS,EARFqS,gBACA8zB,EAOEnmC,EAPFmmC,SACAC,EAMEpmC,EANFomC,SACAC,EAKErmC,EALFqmC,kBACAlrC,EAIE6E,EAJF7E,YACA2R,EAGE9M,EAHF8M,UACAw5B,EAEEtmC,EAFFsmC,SACAI,EACE1mC,EADF0mC,WAGIM,EAAU,OAAGjB,QAAH,IAAGA,GAAH,UAAGA,EAAa9jC,cAAhB,aAAG,EAAqBjI,KAClCitC,EAA4B,OAAGpsC,QAAH,IAAGA,GAAH,UAAGA,EAAUkE,MAAK,SAAAjE,GAAO,OAAIA,EAAQY,WAAa0mC,aAAlD,aAAG,EAAsFlnC,MACrHgsC,EAA+B,OAAGrsC,QAAH,IAAGA,GAAH,UAAGA,EAAUkE,MAAK,SAAAjE,GAAO,OAAIA,EAAQY,WAAaymC,aAAlD,aAAG,EAAyFjnC,MAxBpF,EA0BPi0B,mBAAuB4T,IA1BhB,oBA0BtCO,EA1BsC,KA0BzB6D,EA1ByB,OA2BPhY,mBAAmB,IA3BZ,oBA2BtCzc,EA3BsC,KA2BzB00B,EA3ByB,OA4BHjY,oBAAS,GA5BN,oBA4BtCwV,EA5BsC,KA4BvBC,EA5BuB,OA6BiBzV,oBAAS,GA7B1B,oBA6BtC4D,EA7BsC,KA6BbsU,EA7Ba,KA+B7C5P,qBAAU,WACR18B,GAAW+5B,MACV,CAAC/5B,IAEJ08B,qBAAU,WACRplB,IACA8zB,IACAC,IACAjrC,EAAY+mC,IACZn7B,IAAYs/B,EAAkBt/B,MAE7B,IAEH0wB,qBAAU,WACRuP,GAAcl6B,EAAUk6B,KACvB,CAACA,EAAYl6B,IAEhB2qB,qBAAU,WACR,GAAIx1B,EAAQ,CAAC,IAAD,MAINA,EAFFC,cAAiBgF,EAFT,EAESA,WAAYF,EAFrB,EAEqBA,UAC7BnB,EACE5D,EADF4D,WAGAo9B,EAGE8C,EAHF9C,SACAyB,EAEEqB,EAFFrB,MACgC4C,EAC9BvB,EADFwB,eAAkBC,aAEbtE,EAVG,aAUSwB,EAVT,MAWOtkC,EAAuB8iC,EAAhC1iC,QAAsBtF,EAAUgoC,EAAhBlpC,KAElBytC,EAAuB,OAAGH,QAAH,IAAGA,OAAH,EAAGA,EAAoB16B,QAAQ,QAAS,IAC/D86B,EAAkBD,EACpBA,EAAwB3qC,MAAM,KAAKyD,KAAI,SAAAinC,GAAY,OAAIv1B,EAAUlT,MAAK,gBAAG/E,EAAH,EAAGA,KAAH,OAAcwtC,IAAiBxtC,QACrG,GAEJmtC,EAAe,CACbjgC,WAAW,2BAAMo8B,EAAYp8B,YAAnB,IAA+BhM,MAAOgM,IAChDF,UAAU,2BAAMs8B,EAAYt8B,WAAnB,IAA8B9L,MAAO8L,IAC9C4K,MAAM,2BACD0xB,EAAY1xB,OADZ,IAEH1W,MAAK,UAAE2K,EAAW9G,MAAK,qBAAGgH,cAAkC/L,OAASktC,YAAhE,aAAE,EAAgGhsC,QAEzG8nC,MAAM,2BACDM,EAAYN,OADZ,IAEH9nC,MAAK,UAAE2K,EAAW9G,MAAK,qBAAGgH,cAAkC/L,OAASitC,YAAhE,aAAE,EAA6F/rC,QAEtG+nC,SAAS,2BAAMK,EAAYL,UAAnB,IAA6B/nC,MAAO+nC,IAC5ChxB,UAAU,2BAAMqxB,EAAYrxB,WAAnB,IAA8B/W,MAAOwsC,EAAcnnC,KAAI,SAAAwN,GAAM,MAAK,CAAE3N,MAAO2N,EAAOvN,QAAStF,MAAO6S,EAAO/T,WAClHkpC,SAAS,2BAAMI,EAAYJ,UAAnB,IAA6BhoC,MAAO,CAAEkF,QAAOlF,WACrDioC,SAAS,2BAAMG,EAAYH,UAAnB,IAA6BjoC,MAAOmnC,KAC5Ce,gBAAgB,2BAAME,EAAYF,iBAAnB,IAAoCloC,MAAOmnC,OAE5DuC,GAAiB,MAGlB,CAAC3iC,EAAQ8jC,IAEZ,IAiBMhmB,EAAgB,SAAC1e,GAAD,OAAkB,SAAC8I,GACvC,IAAMw9B,EAAa5oB,GAAkB5U,IAAUpC,GAE3C6/B,GAAe,EACf1tC,EAAe,GAEnB,OAAQmH,GACN,KAAKmhC,GACExxB,aAAsB22B,KACzBC,GAAe,EACf1tC,EAAe,sCAEjB,MACF,KAAKuoC,GACEV,GAAYtuB,KAAKk0B,KACpBC,GAAe,EACf1tC,EAAe,6BAEjB,MACF,KAAKwoC,GACH,IAAMmF,EAAkBF,GAAc1F,GAAexuB,KAAKk0B,GAEpDG,EADahC,EAAM35B,QAAO,qBAAGnS,OAAoB+rC,EAAY/rC,QAC/B0Z,OAAM,qBAAGlT,QAAsBwF,gBAAkB2hC,EAAW3hC,iBAC3F6hC,EAGOC,IACVF,GAAe,EACf1tC,EAAe,4BAJf0tC,GAAe,EACf1tC,EAAe,4BAKjB,MACF,KAAK2oC,GACqB8E,GAAc3F,GAAevuB,KAAKk0B,KAExDC,GAAe,EACf1tC,EAAe,gCAEjB+H,IAAW0iC,GAAiBC,GAAiB,GAC7C,MACF,KAAK9B,GACCQ,EAAYH,SAASjoC,QAAUysC,IACjCC,GAAe,EACf1tC,EAAe,gCAIrBitC,EAAe,2BAAK7D,GAAN,mBAAoBjiC,EAApB,YAAC,eAA+BiiC,EAAYjiC,IAA5C,IAAmDnG,MAAOysC,EAAY/9B,QAASg+B,EAAcrlC,MAAOrI,OAClHktC,EAAevF,eAAK,GAAD,oBAAKnvB,GAAL,CAAkBrR,QAGjCyzB,EAAW,kBAAOzrB,OAAOpJ,SAASqJ,KAAhB,UAA0BvQ,EAA1B,qDAoExB,OACE,uBAAK6F,GAAG,eAAe0D,UAAWoV,KAAG,CAAEqwB,KAAMhhC,KAA7C,UAbA,eAAC,GAAD,CACE0P,OAAQ,CAAE7X,GAAI,sDACdiY,KAAM,CAAEjY,GAAI,oDACZoY,MAAO,WACL0vB,EAAU,OAACX,QAAD,IAACA,OAAD,EAACA,EAAa/rC,MACxBqtC,GAA2B,IAE7BpwB,KAAM,kBAAMowB,GAA2B,IACvCnwB,OAAQ6b,IAOR,eAAC,IAAD,CAAkBn0B,GAAE,sBAAkBmI,GAAmB,OAAR,OAAkByQ,QAAQ,OAC1EqvB,GAAeE,EACd,sBAAKzkC,UAAU,UAAf,SACE,eAACyG,GAAA,EAAD,MAGF,uCACGhC,IACC,sBAAKzE,UAAU,sBAAf,SACE,eAACoB,EAAA,EAAD,CAAQpB,UAAU,SAASqB,QA3BtB,kBAAM0jC,GAA2B,IA2BQr4B,cAAY,gBAA1D,SACE,eAAC,IAAD,CAAkBpQ,GAAG,wCAI3B,gBAAC4L,GAAA,EAAD,CAAMlI,UAAWoV,KAAG,CAAEmuB,KAAMgB,IAA5B,UACE,sBAAKvkC,UAAU,iBAAf,SACE,eAAC,GAAD,CAAenG,KAAMA,EAAM4jB,cAAeA,EAAeujB,YAAaA,MAEvEv8B,IACC,sBAAKzE,UAAU,gBAAf,SACE,eAAC,GAAD,CAAWnG,KAAMA,EAAMioC,MAAK,OAAE2B,QAAF,IAAEA,OAAF,EAAEA,EAAaiC,cAG/C,sBAAK1lC,UAAU,eAAf,SACE,eAAC,GAAD,CACEnG,KAAMA,EACN4jB,cAAeA,EACfujB,YAAaA,EACb5wB,YAAaA,EACbT,UAAWA,EACXyyB,MAAOA,EACPE,iBAAkBA,EAClBD,cAAeA,EACflrB,SAAUxX,MAGd,uBAAKK,UAAU,oBAAf,UACE,sBAAKA,UAAU,WAAf,SACE,eAACoB,EAAA,EAAD,CAAQpB,UAAU,SAASqB,QAASmxB,EAAU9lB,cAAY,eAA1D,SACE,eAAC,IAAD,CAAkBpQ,GAAG,sBAGzB,sBAAK0D,UAAU,+CAAf,SACE,eAACoB,EAAA,EAAD,CAAQpB,UAAU,OAAOqB,QAhHxB,WAIb,GAzE0B,WAC1B,IAAMskC,EAAqCxoC,IAAEyoB,UAAUob,GAEvD76B,OAAO0hB,KAAK8d,GAAsBtgC,SAAQ,SAAAqF,GAAc,IAAD,EAC/CI,EAAQ66B,EAAqBj7B,GAEjCI,EAAMxD,WACJwD,EAAMlS,OAAU8R,IAAc21B,KAAmBv1B,EAAMlS,MAAMY,QAAYkR,IAAc41B,MAAmB,UAACx1B,EAAMlS,aAAP,aAAC,EAAaA,UAE1HkS,EAAMxD,SAAU,EAChBwD,EAAM7K,MAAQ,4BAIlB4kC,EAAec,GAwDfC,GACoBz/B,OAAOkO,OAAO2sB,GAAa5vB,OAAM,gBAAGxY,EAAH,EAAGA,MAAO0O,EAAV,EAAUA,QAAV,QAA8B,OAAL1O,QAAK,IAALA,OAAA,EAAAA,EAAOY,UAAP,OAAiBZ,QAAjB,IAAiBA,OAAjB,EAAiBA,EAAOA,SAAU0O,KAE/F,CAAC,IAAD,IACTu+B,EAAuBz1B,EAAY3T,MAAK,SAAAqO,GAAK,OAAIA,IAAUy1B,MAC3DuF,EAAmB,GACzBlB,GACEkB,EAAiBtnC,KAAK,CACpBiF,cAAemhC,EACfhsC,MAAOooC,EAAY1xB,MAAM1W,QAE7B+rC,GACEmB,EAAiBtnC,KAAK,CACpBiF,cAAekhC,EACf/rC,MAAOooC,EAAYN,MAAM9nC,QAG7BorC,EAAS,yBAELrD,SAAUK,EAAYL,SAAS/nC,QAC1B+G,GAAUkmC,GAAwB,CAAEhF,SAAUG,EAAYH,SAASjoC,QAHpE,IAIJqsC,eAAgB,CACd5C,cAAe0D,OAAO1D,GACtB6C,aAAY,OAAElE,QAAF,IAAEA,OAAF,EAAEA,EAAarxB,UAAU/W,MAAMqF,KAAI,qBAAGrF,SAAmBgS,KAAK,MAE5Ew3B,MAAO,CACL,CACE1qC,KAAI,OAAEspC,QAAF,IAAEA,GAAF,UAAEA,EAAaJ,SAAShoC,aAAxB,aAAE,EAA6BA,MACnCmG,KAAI,OAAEiiC,QAAF,IAAEA,GAAF,UAAEA,EAAaJ,SAAShoC,aAAxB,aAAE,EAA6BkF,QAGvC6B,OAAQ,CACN6E,ONnPgB,IMoPhBjB,WAAYuiC,EACZj9B,MAAO,CACL,CACEnE,UAAWs8B,EAAYt8B,UAAU9L,MACjCgM,WAAYo8B,EAAYp8B,WAAWhM,WApBrC,OAyBN6qC,QAzBM,IAyBNA,OAzBM,EAyBNA,EAAa/rC,KACbiI,GAAUkmC,GAAwB7E,EAAYH,SAASjoC,YAGzDkwB,aAAWjvB,EAAKkG,cAAc,CAAEzD,GAAI,kCAiEgBoQ,cAAY,aAAtD,SACE,eAAC,IAAD,CAAkBpQ,GAAG,qCC5U1B0pC,GAAgC,mCAKhCC,GAAuB,qBACvBC,GAAoB,kBAWpBC,GAA+B,wBAC/BC,GAAoC,yCACpCC,GAA6B,CAAEC,MAAM,EAAOtuC,KAAMiuC,IAClDM,GAA+B,CAAEzoC,MAAO,GAAIlF,MAAO,GAAI0O,SAAS,GAChEk/B,GAA6B,CACxCC,YAAY,2BAAMF,IAAP,IAAqCG,aAAc,KAC9DC,UAAWJ,GACXK,KAAM,IACNC,UAAWN,IAEAO,GAAuC,CAClDxjB,YAAa,GACb5rB,KAAM,GACN4P,SAAS,EACTy/B,MAAO,CAACP,KAEGQ,GAAwB,CACnCC,YAAa,GACbtd,WAAY,MAEDud,GAAkB,2BAC1BF,IAD0B,IAE7BG,SAAU,GACVC,QAAS,OC/BLhwC,GACU,+BADVA,GAEiB,sCAFjBA,GAGmB,wCAHnBA,GAIgB,qCAJhBA,GAKoB,yCAGpBC,GAAqC,CACzC+gB,SAAU,CAAC0uB,IACXO,eAAgB,GAChBC,gBAAiBN,GACjBO,aAAcL,GACd1Y,kBAAmB6X,IAwCNxuC,GArCC,WAA8C,IAA7CC,EAA4C,uDAApCT,GAAcU,EAAsB,uCAC3D,OAAQA,EAAOC,MACb,KAAKZ,GACH,OAAO,2BACFU,GADL,IAEEsgB,SAAUrgB,EAAOM,OAGrB,KAAKjB,GACH,OAAO,2BACFU,GADL,IAEEuvC,eAAgBtvC,EAAOM,OAG3B,KAAKjB,GACH,OAAO,2BACFU,GADL,IAEEwvC,gBAAiBvvC,EAAOM,OAG5B,KAAKjB,GACH,OAAO,2BACFU,GADL,IAEEyvC,aAAcxvC,EAAOM,OAGzB,KAAKjB,GACH,OAAO,2BACFU,GADL,IAEE02B,kBAAmBz2B,EAAOM,OAG9B,QACE,OAAOP,IAMA0vC,GAAc,SAACpvB,GAAD,MAA2B,CACpDpgB,KAAMZ,GACNiB,KAAM+f,IAGKqvB,GAAoB,SAACJ,GAAD,MAA6B,CAC5DrvC,KAAMZ,GACNiB,KAAMgvC,IAGKK,GAAqB,SAACJ,GAAD,MAAwC,CACxEtvC,KAAMZ,GACNiB,KAAMivC,IAGKK,GAAkB,SAACJ,GAAD,MAAkC,CAC/DvvC,KAAMZ,GACNiB,KAAMkvC,IAGKK,GAAuB,SAACxQ,GAAD,MAAwC,CAC1Ep/B,KAAMZ,GACNiB,KAAM++B,IC4FF31B,GAAqB,CACzB+lC,eACAC,qBACAE,mBACAC,yBAMajmC,sBAvBS,SAAC,GAAD,QACtBkmC,eAAkBzvB,EADI,EACJA,SAAUivB,EADN,EACMA,eACRS,EAFE,EAEtBtwC,QAAWA,QAFW,MAKjB,CACLuwC,UANsB,EAGtBhB,MAASgB,UAITC,YAPsB,EAItBC,eAAkBD,YAIlBF,mBACA1vB,WACAivB,oBAasC5lC,GAAzBE,CAA6CE,aAxJxC,SAAC,GAeF,IAdjBhI,EAcgB,EAdhBA,KACAkuC,EAagB,EAbhBA,UACAC,EAYgB,EAZhBA,YACAF,EAWgB,EAXhBA,iBACA1vB,EAUgB,EAVhBA,SACAivB,EASgB,EAThBA,eACAJ,EAQgB,EARhBA,YACAtd,EAOgB,EAPhBA,WAOgB,IANhBue,KAAQzB,EAMQ,EANRA,YAAaE,EAML,EANKA,UAAWC,EAMhB,EANgBA,KAAiBuB,EAMjC,EANsBtB,UAAgCM,EAMtD,EANgDzvC,KAChE0vC,EAKgB,EALhBA,QACAI,EAIgB,EAJhBA,YACAC,EAGgB,EAHhBA,kBACAG,EAEgB,EAFhBA,qBACAD,EACgB,EADhBA,gBAEQ5nC,EAAkBlG,EAAlBkG,cACF2Q,EAAa03B,mBACjB,kBAAM,eAACloC,EAAD,uDAAgD,GAAhD,OAAuDA,EAAQjC,KAAI,SAAAwN,GAAM,MAAK,CAAE3N,MAAK,OAAE2N,QAAF,IAAEA,OAAF,EAAEA,EAAQvN,QAAStF,MAAK,OAAE6S,QAAF,IAAEA,OAAF,EAAEA,EAAQ/T,YAC7H,IAEI2wC,EAAW,SAACzvC,GAAD,OAA+BA,EAAMkF,MAAQlF,EAAQ,MAChE0vC,EAAmCC,uBACvC,SAAC5e,EAAYsd,EAAaloC,EAAMqoC,GAAhC,OAA4C,SAAAv/B,GAC1C,IAAM2gC,EAAiB5iB,oBAAUxN,GAC3BqwB,EAAiBhsB,GAAkB5U,GAIzC,GAFA2gC,EAAe7e,GAAf,MAAkCyd,GAASroC,GAAQ0pC,EFvD7B,gBEyDlB1pC,EAAuB,CAAC,IAClB2nC,EAAiBqB,EAAUtrC,MAAK,qBAAG/E,OAAoB+wC,EAAe7vC,SAAtE8tC,aACR8B,EAAe7e,GAAf,MAAkCyd,GAASroC,GAAM2nC,aAAjD,OAAgEA,QAAhE,IAAgEA,IAAgBjhC,GF5DpE,SE+DV1G,IACFypC,EAAe7e,GAAf,MAAkCyd,GAASroC,GAAMuI,UAAYmhC,GAG/DjB,EAAYgB,GACZvB,GAAeQ,EAAkBlI,eAAK,GAAD,oBAAK8H,GAAL,CAAqBJ,SAE5D,CAAC7uB,EAAUovB,EAAaC,EAAmBJ,EAAgBU,IAGvDW,EAAmBH,uBAAY,WACnC,IAAMC,EAAiB5iB,oBAAUxN,GACjCowB,EAAe7e,GAAf,MAAkCnrB,KAAKgoC,IACvCgB,EAAYgB,KACX,CAAC7e,EAAYvR,EAAUovB,IAEpBmB,EAAsBJ,uBAAY,WACtCZ,EAAgB,CAAEV,cAAatd,aAAYwd,WAAUC,YACrDQ,EAAqB,CAAEtB,MAAM,EAAMtuC,KAAMkuC,OACxC,CAACyB,EAAiBV,EAAatd,EAAYwd,EAAUC,EAASQ,IAEjE,OACE,uBAAuC5nC,UAAU,qBAAjD,UACE,uBAAKA,UAAU,yBAAyB0M,cAAY,iBAApD,UACE,eAACiU,GAAD,CACErgB,YAAaP,EAAc,CAAEzD,GAAI,4BACjCmkB,kBAAmB4nB,EAAS5B,GAC5B7tC,MAAOyvC,EAAS5B,GAChBrmC,SAAUkoC,EAAgB3e,EAAYsd,EAAa,cAAeG,GAClElnC,QAASwQ,EAAWq3B,GACpB1nB,iBAAkBjL,KAAG,CAAE6pB,SAAUwH,EAAYn/B,UAC7CjH,gBAAgB,iBAChB2c,MAAOD,MAEP0pB,EAAYn/B,SAAW,eAAC,GAAD,CAAiBpP,QAASiuC,QAErD,sBAAKnmC,UAAU,kBAAf,SACE,eAAC0gB,GAAD,CACEpgB,YAAaP,EAAc,CAAEzD,GAAI,oCACjCmkB,kBAAmBgmB,EAAYC,aAC/B9tC,MAAO6tC,EAAYC,aACnBplC,UAAQ,EACRoL,cAAY,wBAGhB,uBAAK1M,UAAU,kBAAkB0M,cAAY,kBAA7C,UACE,eAACiU,GAAD,CACErgB,YAAaP,EAAc,CAAEzD,GAAI,gCACjCmkB,kBAAmB4nB,EAAS1B,GAC5B/tC,MAAOyvC,EAAS1B,GAChBvmC,SAAUkoC,EAAgB3e,EAAYsd,EAAa,YAAaG,GAChElnC,QAASwQ,EAAU,OAACo3B,QAAD,IAACA,OAAD,EAACA,EAAkBnwC,YACtC0oB,iBAAkBjL,KAAG,CAAE6pB,SAAU0H,EAAUr/B,UAC3CjH,gBAAgB,iBAChB2c,MAAOD,MAEP4pB,EAAUr/B,SAAW,eAAC,GAAD,CAAiBpP,QAASiuC,QAEnD,uBAAKnmC,UAAU,kBAAf,UACE,eAAC0gB,GAAD,CACEpgB,YAAaP,EAAc,CAAEzD,GAAI,iCACjCmkB,kBAAmBmmB,EACnBhuC,MAAOguC,EACPxmC,SAAUkoC,EAAgB3e,EAAYsd,EAAa,OAAQG,GAC3DpvC,KAAK,SACLkpB,QAAQ,QACRC,IAAK,EACLnhB,UAAWoV,KAAG,CAAE6pB,SAAU3W,OAAOse,KACjCl6B,cAAY,eAEZ4b,OAAOse,IAAS,eAAC,GAAD,CAAiB1uC,QAASiuC,QAE9C,uBAAKnmC,UAAU,kBAAkB0M,cAAY,kBAA7C,UACE,eAACiU,GAAD,CACErgB,YAAaP,EAAc,CAAEzD,GAAI,6BACjCmkB,kBAAmB4nB,EAASF,GAC5BvvC,MAAOyvC,EAASF,GAChB/nC,SAAUkoC,EAAgB3e,EAAYsd,EAAa,YAAaG,GAChElnC,QAASwQ,EAAWs3B,GACpB3nB,iBAAkBjL,KAAG,CAAE6pB,SAAUkJ,EAAc7gC,UAC/CjH,gBAAgB,iBAChB2c,MAAOD,MAEPorB,EAAc7gC,SAAW,eAAC,GAAD,CAAiBpP,QAASiuC,QAEvD,eAAC7kB,GAAD,CACEznB,KAAMA,EACN0nB,YAAamnB,EACblnB,aAAcmnB,EACdlnB,oBAAqB2lB,IAAYhvB,EAASuR,GAAT,MAA4BnwB,OAAS,MAnE1E,UAAaytC,EAAb,YAA4BG,QCqB1B3lC,GAAqB,CACzB+lC,eACAC,qBACAC,sBACAE,yBAMajmC,sBAfS,SAAC,GAAD,QAAGkmC,eAAH,MAAuD,CAC7EzvB,SADsB,EAAqBA,SAE3CivB,eAFsB,EAA+BA,kBAef5lC,GAAzBE,CAA6CE,aA7F5C,SAAC,GAWK,IAVZ9B,EAUW,EAVnBlG,KAAQkG,cAUW,IATnBsY,QAAWiL,EASQ,EATRA,YAAayjB,EASL,EATKA,MAAaE,EASlB,EATYvvC,KAA4BkxC,EASxC,EAT+BthC,QAAyB1P,EASxD,EATwDA,aAC3EwgB,EAQmB,EARnBA,SACAivB,EAOmB,EAPnBA,eACA1d,EAMmB,EANnBA,WACAuN,EAKmB,EALnBA,sBACA0Q,EAImB,EAJnBA,qBACAJ,EAGmB,EAHnBA,YACAC,EAEmB,EAFnBA,kBACAC,EACmB,EADnBA,mBAEA,IAAKX,EAAMvtC,OAAQ,CACjB,IAAMgvC,EAAiB5iB,oBAAUxN,GACjCowB,EAAe7e,GAAf,MAAkCnrB,KAAKgoC,IACvCgB,EAAYgB,GAGd,IAAMF,EAAmCC,uBACvC,SAAC5e,EAAYsd,GAAb,OAA6B,SAAAp/B,GAC3B,IAAM2gC,EAAiB5iB,oBAAUxN,GAC3BqwB,EAAiBhsB,GAAkB5U,GACnCghC,EAAsBL,EAAep3B,OAAM,qBAAGkS,YAA8B5f,gBAAkB+kC,EAAe/kC,iBAEnH8kC,EAAe7e,GAAf,YAA2C8e,EAC3CD,EAAe7e,GAAYriB,UAAYmhC,EACvCD,EAAe7e,GAAY/xB,aAAe6N,GAErCgjC,EAEOI,IACVL,EAAe7e,GAAYriB,SAAU,EACrCkhC,EAAe7e,GAAY/xB,aAAewuC,IAH1CoC,EAAe7e,GAAY/xB,aAAeuuC,GAM5CqB,EAAYgB,GACZvB,GAAeQ,EAAkBlI,eAAK,GAAD,oBAAK8H,GAAL,CAAqBJ,SAE5D,CAAC7uB,EAAUovB,EAAaC,EAAmBJ,IAGvCyB,EAAyBP,uBAAY,WACzCb,EAAmB,CAAET,cAAatd,eAClCie,EAAqB,CAAEtB,MAAM,EAAMtuC,KAAMiuC,OACxC,CAACgB,EAAatd,EAAY+d,EAAoBE,IAE3CnT,EAAkB,eAACnzB,EAAD,+DACtB,uBAAKtB,UAAU,kBAAf,UACE,eAAC0gB,GAAD,CACEpgB,YAAaP,EAAc,CAAEzD,GAAI,+BACjCmkB,kBAAmB6C,EACnB1qB,MAAO0qB,EACPljB,SAAUkoC,EAAgB3e,EAAYsd,GACtCjnC,UAAWoV,KAAG,CAAE6pB,SAAU2J,IAC1BtnC,SAAUA,EACVoL,cAAY,wBAEZk8B,GAAkB,eAAC,GAAD,CAAiB1wC,QAASN,QAI5C+8B,EAAgBoS,EAAM9oC,KAAI,SAACiqC,EAAMd,GAAP,OAC9B,eAAC,GAAD,CAAsCc,KAAMA,EAAMd,QAASA,EAASH,YAAaA,EAAatd,WAAYA,GAA1G,UAAcue,EAAKxwC,KAAnB,YAA2B0vC,OAG7B,OACE,eAAC,GAAD,CAEE3S,gBAAiBA,IACjBC,wBAAyBD,GAAgB,GACzCE,cAAeA,EACfC,aAAa,EACbC,SAAUiU,EACVhU,kBAAmBoC,GAPrB,UACU+P,EADV,YACyBtd,QC5FvBvyB,GACW,0BADXA,GAEY,2BAFZA,GAGc,6BAHdA,GAIqB,oCAGrBC,GAA+B,CACnCC,SAAS,EACTyxC,SAAU,GACVtwC,QAAS,CACPuwC,iBAAiB,EACjBC,uBAAuB,EACvBC,eAAe,IAsEJrxC,GAlEC,WAA8C,IAA7CC,EAA4C,uDAApCT,GAAcU,EAAsB,uCAC3D,OAAQA,EAAOC,MACb,KAAKhB,EAAQI,IACX,OAAO,2BACFU,GADL,IAEER,SAAS,IAEb,KAAKN,EAAQI,IACX,OAAO,2BACFU,GADL,IAEEW,QAAQ,2BACHX,EAAMW,SADJ,IAELywC,eAAe,MAGrB,KAAKlyC,EAAQI,IACX,OAAO,2BACFU,GADL,IAEEW,QAAQ,2BACHX,EAAMW,SADJ,IAELuwC,iBAAiB,MAGvB,KAAKhyC,EAAQI,IACX,OAAO,2BACFU,GADL,IAEEW,QAAQ,2BACHX,EAAMW,SADJ,IAELwwC,uBAAuB,MAG7B,KAAK/xC,EAAQE,IACX,OAAO,2BACFU,GADL,IAEER,SAAS,EACTyxC,SAAUhxC,EAAOE,QAAQI,KAAKC,UAElC,KAAKpB,EAAQE,IACX,OAAO,2BACFU,GADL,IAEEW,QAAQ,2BACHX,EAAMW,SADJ,IAELywC,eAAe,MAGrB,KAAKhyC,EAAQE,IACX,OAAO,2BACFU,GADL,IAEEW,QAAQ,2BACHX,EAAMW,SADJ,IAELuwC,iBAAiB,MAGvB,KAAK9xC,EAAQE,IACX,OAAO,2BACFU,GADL,IAEEW,QAAQ,2BACHX,EAAMW,SADJ,IAELwwC,uBAAuB,MAG7B,QACE,OAAOnxC,IC/EPV,GACY,uBAGZC,GAA4B,CAChCC,SAAS,EACTywC,UAAW,IAqBElwC,GAlBC,WAA8C,IAA7CC,EAA4C,uDAApCT,GAAcU,EAAsB,uCAC3D,OAAQA,EAAOC,MACb,KAAKhB,EAAQI,IACX,OAAO,2BACFU,GADL,IAEER,SAAS,IAEb,KAAKJ,EAAQE,IACX,OAAO,2BACFU,GADL,IAEER,SAAS,EACTywC,UAAWhwC,EAAOE,QAAQI,KAAKC,UAEnC,QACE,OAAOR,ICvBPV,GACmB,wCAGnBC,GAAqC,CACzCC,SAAS,EACT0wC,YAAa,IAqBAnwC,GAlBC,WAA8C,IAA7CC,EAA4C,uDAApCT,GAAcU,EAAsB,uCAC3D,OAAQA,EAAOC,MACb,KAAKhB,EAAQI,IACX,OAAO,2BACFU,GADL,IAEER,SAAS,IAEb,KAAKJ,EAAQE,IACX,OAAO,2BACFU,GADL,IAEER,SAAS,EACT0wC,YAAajwC,EAAOE,QAAQI,KAAKC,UAErC,QACE,OAAOR,ICvBPV,GACY,4BAGZC,GAAgC,CACpCC,SAAS,EACT6xC,WAAY,IAqBCtxC,GAlBC,WAA8C,IAA7CC,EAA4C,uDAApCT,GAAcU,EAAsB,uCAC3D,OAAQA,EAAOC,MACb,KAAKhB,EAAQI,IACX,OAAO,2BACFU,GADL,IAEER,SAAS,IAEb,KAAKJ,EAAQE,IACX,OAAO,2BACFU,GADL,IAEER,SAAS,EACT6xC,WAAYpxC,EAAOE,QAAQI,KAAKC,UAEpC,QACE,OAAOR,ICgaP2J,I,QAAqB,CACzB2nC,YJnWyB,SAACC,GAAD,MAAsB,CAC/CrxC,KAAMZ,GACNa,QAASe,IAAMC,IAAN,yCAA4CowC,EAAM,kBAAcA,EAAd,KAA0B,WIkWrFC,eJ/V4B,SAAC5xC,GAAD,MAAmB,CAC/CM,KAAMZ,GACNa,QAASe,IAAMykC,OAAN,uCAA6C/lC,MI8VtD6xC,aJ3V0B,SAACR,EAA4BrxC,GAA7B,MAAgD,CAC1EM,KAAMZ,GACNa,QAASe,IAAMM,KAAN,uCAA2C5B,GAAQA,GAAQqxC,KI0VpES,qBJvVkC,SAACC,EAAsBC,GAAvB,MAAuD,CACzF1xC,KAAMZ,GACNa,QAASe,IAAMykC,OAAN,uCAA6CgM,EAA7C,2BAA4EC,MIsVrFC,aH/Z0B,SAACN,GAAD,MAAsB,CAChDrxC,KAAMZ,GACNa,QAASe,IAAMC,IAAN,qCAAwCowC,EAAM,kBAAcA,EAAd,KAA0B,WG8ZjFO,eFha4B,SAACP,GAAD,MAAsB,CAClDrxC,KAAMZ,GACNa,QAASe,IAAMC,IAAN,+CAAkDowC,EAAM,kBAAcA,EAAd,KAA0B,WE+Z3FQ,WrH9VwB,SAACnyC,EAAc2xC,GAAf,MAAoC,CAC5DrxC,KAAMZ,EACNa,QAASe,IAAMC,IAAN,sCAAyCvB,EAAzC,cAAmD2xC,EAAM,kBAAcA,EAAd,KAA0B,WqH6V5FxwC,cACAixC,aDna0B,SAACT,GAAD,MAAsB,CAChDrxC,KAAMZ,GACNa,QAASe,IAAMC,IAAN,0CAA6CowC,EAAM,kBAAcA,EAAd,KAA0B,WCkatF7B,eACAC,qBACAC,sBACAC,mBACAC,0BAMajmC,sBAvDS,SAAC,GAUV,IAAD,IATZkmC,eAAkBzvB,EASN,EATMA,SAAUivB,EAShB,EATgBA,eAAgBC,EAShC,EATgCA,gBAAiBC,EASjD,EATiDA,aAAc/Y,EAS/D,EAT+DA,kBAS/D,IARZua,SAAqBgB,EAQT,EARAzyC,QAA0ByxC,EAQ1B,EAR0BA,SAAUtwC,EAQpC,EARoCA,QAE1BuxC,EAMV,EAPZxyC,QACEF,QAAWE,QAMD,IAJZuvC,MAAkBkD,EAIN,EAJH3yC,QAAuBywC,EAIpB,EAJoBA,UACLmC,EAGf,EAHZjC,eAAkB3wC,QAGN,IAFZ6yC,UAAsBC,EAEV,EAFC9yC,QAA2B6xC,EAE5B,EAF4BA,WAE5B,IADZ5wC,SACY,IADAA,gBACA,MADW,GACX,EADwBkhB,EACxB,EADeniB,QAU3B,MAAO,CACL+yC,kBATwB,CACxBN,EACAC,EACAC,EACAC,EACAE,EACA3wB,GACA0I,MAAK,SAAAvpB,GAAK,OAAIA,KAGd0xC,uBAAwB/xC,EAASkE,MAAK,qBAAGrD,WAA4B4sC,MACrEvsB,kBACAsvB,WACAhB,YACAtvC,UACA8xC,cAAepB,EAAW1sC,MAAK,oBAAG+tC,cAAH,MRlbY,gCQkbZ,MAAmB/kC,GAAnB,MAC/B2S,WACAivB,iBACAC,kBACAC,eACA/Y,uBAwBoC/sB,GAAzBE,CAA6CE,aAtY9B,SAAC,GA4BH,IA3BlB9B,EA2BiB,EA3BzBlG,KAAQkG,cACRsqC,EA0ByB,EA1BzBA,kBACA5wB,EAyByB,EAzBzBA,gBACAsvB,EAwByB,EAxBzBA,SACAhB,EAuByB,EAvBzBA,UACAuC,EAsByB,EAtBzBA,uBACAC,EAqByB,EArBzBA,cAqByB,IApBzB9xC,QAAWuwC,EAoBc,EApBdA,gBAAiBC,EAoBH,EApBGA,sBAAuBC,EAoB1B,EApB0BA,cACnD9wB,EAmByB,EAnBzBA,SACAivB,EAkByB,EAlBzBA,eACAC,EAiByB,EAjBzBA,gBACAC,EAgByB,EAhBzBA,aACA/Y,EAeyB,EAfzBA,kBACA4a,EAcyB,EAdzBA,YACAE,EAayB,EAbzBA,eACAC,EAYyB,EAZzBA,aACAC,EAWyB,EAXzBA,qBACA3wC,EAUyB,EAVzBA,YACA8wC,EASyB,EATzBA,aACAC,EAQyB,EARzBA,eACAC,EAOyB,EAPzBA,WACAC,EAMyB,EANzBA,aACAtC,EAKyB,EALzBA,YACAC,EAIyB,EAJzBA,kBACAC,EAGyB,EAHzBA,mBACAC,EAEyB,EAFzBA,gBACAC,EACyB,EADzBA,qBACyB,EACiC/a,oBAAS,GAD1C,oBAClBqK,EADkB,KACKuT,EADL,KAEnBjY,EAAW+V,uBAAY,kBAAOxhC,OAAOpJ,SAASqJ,KRzFvB,qDQyFgD,IACvE0jC,EAAmBtC,mBACvB,kBACEW,EAAS9qC,KAAI,SAAAoa,GAAY,IACfna,EAAgDma,EAAhDna,QAASysC,EAAuCtyB,EAAvCsyB,gBA4BjB,MAAO,CACLrnB,YAAaplB,EACboJ,SAAS,EACT5P,KA/BsD2gB,EAAtB3gB,KAgChCqvC,MA/B4B4D,EAAgB9gC,QAAO,qBAAGyD,WACfrP,KAAI,YAAwC,IAArC2sC,EAAoC,EAApCA,cAAqBzD,EAAe,EAArBzvC,KACvDmzC,EAAuBniC,KAAK5R,MAAM8zC,GAChC1C,EAAqC2C,EAArC3C,KAAMvB,EAA+BkE,EAA/BlE,UAAWC,EAAoBiE,EAApBjE,KAAMC,EAAcgE,EAAdhE,UAE/B,MAAO,CACLnvC,KAAMyvC,EACNV,YAAa,CACX3oC,MAAOoqC,EAAKhqC,QACZtF,MAAOsvC,EAAKxwC,KACZgvC,aAAcwB,EAAKxB,aACnBp/B,SAAS,GAEXq/B,UAAW,CACT7oC,MAAO6oC,EAAUzoC,QACjBtF,MAAO+tC,EAAUjvC,KACjB4P,SAAS,GAEXs/B,OACAC,UAAW,CACT/oC,MAAO+oC,EAAU3oC,QACjBtF,MAAOiuC,EAAUnvC,KACjB4P,SAAS,aAYnB,CAACyhC,IAGH5T,qBAAU,WACRt8B,EAAYmtC,IACZoD,ER1I8B,gCQ2I9BU,ER5I+B,2BQ6I/BH,ER1I+B,qCQ2I/BC,ER5IoC,kBQ6InC,CAACD,EAAcC,EAAgBR,EAAaU,EAAcjxC,IAE7Ds8B,qBAAU,YACP1b,IAAD,OAAoB6wB,QAApB,IAAoBA,OAApB,EAAoBA,EAAwB1xC,QAASixC,EAAWS,EAAuB1xC,MR9I3D,qBQ+I3B,CAAC6gB,EAAD,OAAkB6wB,QAAlB,IAAkBA,OAAlB,EAAkBA,EAAwB1xC,MAAOixC,IAEpD1U,qBAAU,WACR4T,EAASvvC,QAAUguC,EAAYkD,KAC9B,CAAC3B,EAAU2B,EAAkBlD,IAEhCrS,qBAAU,WACR6T,GAAmBlpC,aAAaC,EAAc,CAAEzD,GAAI,qCACnD,CAAC0sC,EAAiBjpC,IAErBo1B,qBAAU,WACR8T,GAAyBnpC,aAAaC,EAAc,CAAEzD,GAAI,kCACzD,CAAC2sC,EAAuBlpC,IAE3Bo1B,qBAAU,WACR+T,GAAiB1W,MAChB,CAAC0W,EAAe1W,IAEnB,IAAMqW,EAAsBN,uBAC1B,SAACuC,EAAqBC,GAAtB,IAA0CC,EAA1C,uDAA6D5yB,EAA7D,OACE4yB,EAAiB55B,OAAM,WAAkBuY,GAAlB,IAAGrG,EAAH,EAAGA,YAAH,OACrBqG,IAAeohB,GAAqBznB,IAAgBwnB,OAExD,CAAC1yB,IAGG0wB,EAAyBP,uBAC7B,YAAoD,IAAjDtB,EAAgD,EAAhDA,YAAatd,EAAmC,EAAnCA,WACR6e,EAAiB5iB,oBAAUxN,GACjCowB,EAAe56B,OAAO+b,EAAY,GAE7B6e,EAAehvC,QAClBgvC,EAAehqC,KAAKsoC,IAGtB0B,EAAenjC,SAAQ,WAAqC4lC,GAAsB,IAA3CC,EAA0C,EAAvD5nB,YAClB6nB,EAAgB/yB,EAASvO,QAAO,WAAWiU,GAAX,IAAGpmB,EAAH,EAAGA,KAAH,OAAoBuvC,EAAcvvC,IAASuvC,EAAcnpB,IAAQ6L,KAEnGkf,EAAoBqC,EAAmBD,EAAkBE,KAC3D3C,EAAeyC,GAAkB3jC,SAAU,EAC3CkhC,EAAeyC,GAAkBrzC,aAAe6N,OAIpD+hC,EAAYgB,GAERvB,IACFQ,EAAkB2D,kBAAQ/D,EAAgBJ,IAC1CqC,EAAerC,MAGnB,CAAC7uB,EAAUovB,EAAaqB,EAAqBpB,EAAmBJ,EAAgBiC,IAG5EX,EAAsBJ,uBAC1B,YAAoE,IAAjEtB,EAAgE,EAAhEA,YAAatd,EAAmD,EAAnDA,WAAYwd,EAAuC,EAAvCA,SAAUC,EAA6B,EAA7BA,QAC9BoB,EAAiB5iB,oBAAUxN,GACjCowB,EAAe7e,GAAf,MAAkC/b,OAAOw5B,EAAS,GAClDH,GAAeQ,EAAkBlI,eAAK,GAAD,oBAAK8H,GAAL,CAAqBJ,MAErDuB,EAAe7e,GAAf,MAAkCnwB,QACrCgvC,EAAe7e,GAAf,MAAkCnrB,KAAKgoC,IAGzCgB,EAAYgB,GACZrB,GAAYqC,EAAqBvC,EAAaE,KAEhD,CAAC/uB,EAAUqvB,EAAmBJ,EAAgBG,EAAagC,IAGvD6B,EAAsB9C,uBAAY,WACtC,IAAMC,EAAiB5iB,oBAAUxN,GACjCowB,EAAehqC,KAAKsoC,IACpBU,EAAYgB,KACX,CAACpwB,EAAUovB,IAER5B,EAAsB2C,uBAAY,WACtC,IAAMC,EAAiB5iB,oBAAUxN,GAC7BG,GAAc,EAuClB,OArCAiwB,EAAenjC,SAAQ,SAACgT,EAASsR,GAAgB,IACvCrG,EAAgCjL,EAAhCiL,YAAayjB,EAAmB1uB,EAAnB0uB,MAAOz/B,EAAY+Q,EAAZ/Q,QAE5BkhC,EAAe7e,GAAY/xB,aAAe6N,GAC1C+iC,EAAe7e,GAAYriB,SAAU,EAEhCgc,IAAiBhc,GAAYuhC,EAAoBvlB,EAAaqG,MACjE6e,EAAe7e,GAAYriB,SAAU,EACrCiR,GAAc,EACdiwB,EAAe7e,GAAY/xB,aAAgB0rB,EAA6C8iB,GAA/BD,IAG3DY,EAAM1hC,SAAQ,SAAC6iC,EAAMd,GAAa,IACxBT,EAA4CuB,EAA5CvB,UAAWF,EAAiCyB,EAAjCzB,YAAaI,EAAoBqB,EAApBrB,UAAWD,EAASsB,EAATtB,KAEtCte,OAAOse,KACVruB,GAAc,GAGXouB,EAAU/tC,QACb4vC,EAAe7e,GAAf,MAAkCyd,GAAST,UAAUr/B,SAAU,EAC/DiR,GAAc,GAGXkuB,EAAY7tC,QACf4vC,EAAe7e,GAAf,MAAkCyd,GAASX,YAAYn/B,SAAU,EACjEiR,GAAc,GAGXsuB,EAAUjuC,QACb4vC,EAAe7e,GAAf,MAAkCyd,GAASP,UAAUv/B,SAAU,EAC/DiR,GAAc,SAKpBivB,EAAYgB,GACLjwB,IACN,CAACswB,EAAqBzwB,EAAUovB,IAE7B5d,EAAS2e,uBAAY,WAGzB,IAFoB3C,IAGlB,OAAO9c,aAAW/oB,EAAc,CAAEzD,GAAI,qCAGxC,IAAMgvC,EAAclzB,EAASvO,QAAO,qBAAGnS,QACjC6zC,EAAiBlE,EAAeppC,KAAI,SAAAutC,GAAa,OAAIpzB,EAAS3b,MAAK,gBAAG/E,EAAH,EAAGA,KAAH,OAAc8zC,IAAkB9zC,QAAOyD,OAAOmwC,GAEjHG,EAAW,SAACpzB,GAAD,OACfA,EAAQ0uB,MAAM9oC,KAAI,SAAAiqC,GAAS,IACjBzB,EAA4CyB,EAA5CzB,YAAaE,EAA+BuB,EAA/BvB,UAAWC,EAAoBsB,EAApBtB,KAAMC,EAAcqB,EAAdrB,UAChC6E,EAAe3D,EAAUtrC,MAAK,SAAAkvC,GAAQ,OAAIA,EAASj0C,OAASwwC,EAAKzB,YAAY7tC,SAC7EgyC,EAAgB,CACpB1C,KAAM,CACJhqC,QAASuoC,EAAY3oC,MACrBpG,KAAM+uC,EAAY7tC,MAClB8tC,aAAcD,EAAYC,cAE5BC,UAAW,CACTzoC,QAASyoC,EAAU7oC,MACnBpG,KAAMivC,EAAU/tC,OAElBguC,OACAC,UAAW,CACT3oC,QAAS2oC,EAAU/oC,MACnBpG,KAAMmvC,EAAUjuC,QAIpB,MAAO,CACLuxC,UAAWI,EACXK,cAAeliC,KAAKsR,UAAU4wB,GAC9BgB,kBRpT8B,sBQqT9Bp0C,QAASk0C,EAAal0C,QAAQE,UAWpC6zC,EAAe/xC,QAAU+xC,EAAelmC,SAAQ,SAAAgT,GAAO,OAAIkxB,EAPrC,SAAClxB,GAAD,MAAwB,CAC5CwzB,SR5SsB,MQ6StB9sC,KAAMsZ,EAAQiL,YACdjqB,YRhTqC,6BQiTrCsxC,gBAAiBc,EAASpzB,IAG4CyzB,CAAczzB,GAAf,OAAyBA,QAAzB,IAAyBA,OAAzB,EAAyBA,EAAS3gB,WACxG,CAACqwC,EAAWV,EAAgBtnC,EAAewqC,EAAenyB,EAAUmxB,EAAc3D,IAE/EmG,EAAcxD,uBAAY,kBAAMX,EAAqBvB,MAA6B,CAACuB,IACnFoE,EAAezD,uBAAY,WAC/B,OAAQ/Z,EAAkBx2B,MACxB,KAAKiuC,GACH6C,EAAuBxB,GACvBI,EAAmBV,IACnB,MACF,KAAKd,GACHyC,EAAoBpB,GACpBI,EAAgBT,IAGpBU,EAAqBvB,MACpB,CACD7X,EAAkBx2B,KAClBuvC,EACAD,EACAqB,EACAG,EACAlB,EACAD,EACAD,IAGF,OACE,uBAAKprC,GAAG,kBAAR,UACE,eAAC,GAAD,CACE6X,OAAQ,CAAE7X,GAAG,kBAAD,OAAoBkyB,EAAkBx2B,KAAtC,YACZuc,KAAM,CAAEjY,GAAG,kBAAD,OAAoBkyB,EAAkBx2B,KAAtC,UACV0c,MAAOs3B,EACPr3B,KAAMo3B,EACNn3B,OAAQ4Z,EAAkB8X,OAE5B,uBAAKtmC,UAAU,QAAf,UACE,eAAC,IAAD,CAAkB1D,GAAG,uBAAuB4Y,QAAQ,QAClDm1B,GACA,eAACjpC,EAAA,EAAD,CACEC,QAAS,kBAAMopC,GAA0BvT,IACzCl3B,UAAU,SACV0M,cAAY,2BAHd,SAKE,eAAC,IAAD,CAAkBpQ,GAAE,uCAAkC46B,EAAwB,WAAa,iBAIhGmT,EACC,sBAAKrqC,UAAU,UAAU0M,cAAY,UAArC,SACE,eAACjG,GAAA,EAAD,MAGF,uCACE,uBAAKzG,UAAU,UAAf,UACGoY,EAASna,KAAI,SAACoa,EAASsR,GAAV,OACZ,eAAC,GAAD,CAEEtR,QAASA,EACTsR,WAAYA,EACZuN,sBAAuBA,GAJzB,UACU7e,EAAQ3gB,KADlB,YAC0BiyB,OAM5B,sBAAK3pB,UAAU,uCAAf,SACE,eAACoB,EAAA,EAAD,CAAQpB,UAAU,kBAAkBqB,QAASgqC,EAAqB3+B,cAAY,sBAA9E,SACE,eAAC,IAAD,CAAkBpQ,GAAG,wCAI3B,uBAAK0D,UAAU,YAAf,UACE,sBAAKA,UAAU,WAAf,SACE,eAACoB,EAAA,EAAD,CAAQpB,UAAU,SAASqB,QAASmxB,EAAU9lB,cAAY,eAA1D,SACE,eAAC,IAAD,CAAkBpQ,GAAG,sBAGzB,sBAAK0D,UAAU,+CAAf,SACE,eAACoB,EAAA,EAAD,CAAQpB,UAAU,OAAOqB,QAASuoB,EAAQld,cAAY,aAAtD,SACE,eAAC,IAAD,CAAkBpQ,GAAG,iCC3Y/BlF,GACsB,iDADtBA,GAEuB,kDAGvBC,GAA2C,CAC/C40C,mBAAoB,GACpBC,qBAAsBxkC,IAoBT7P,GAjBC,WAA8C,IAA7CC,EAA4C,uDAApCT,GAAcU,EAAsB,uCAC3D,OAAQA,EAAOC,MACb,KAAKZ,GACH,OAAO,2BACFU,GADL,IAEEm0C,mBAAoBl0C,EAAOM,OAE/B,KAAKjB,GACH,OAAO,2BACFU,GADL,IAEEo0C,qBAAsBn0C,EAAOM,OAEjC,QACE,OAAOP,IAUAq0C,GAA0B,SAAC9zC,GAAD,MAAmC,CACxEL,KAAMZ,GACNiB,SC0FIoJ,GAAqB,CACzB0qC,4BAMaxqC,sBAZS,SAAC,GAAD,QAAGyqC,gCAAH,MAAgG,CACtHH,mBADsB,EAAsCA,mBAE5DC,qBAFsB,EAA0DA,wBAY1CzqC,GAAzBE,CAA6CE,aA7GnC,SAAC,GAOF,IANtBhI,EAMqB,EANrBA,KACAoyC,EAKqB,EALrBA,mBACAC,EAIqB,EAJrBA,qBACApoC,EAGqB,EAHrBA,OACAuoC,EAEqB,EAFrBA,UACAF,EACqB,EADrBA,wBAEQpsC,EAAkBlG,EAAlBkG,cACFmH,EAAcpD,EAAOlL,MAAQkL,EAAS,KACtC4M,EAAa63B,uBAAY,kBAAM+D,yBAAeL,EAAoBC,EAAsBK,aAAU,CACtGN,EACAC,IAGIM,EAAyB,SAACzuB,GAC9B,IAAM0uB,EAA6B7mB,oBAAUsmB,GACvCQ,EAAyB9uB,GAAc6uB,EAA4BJ,EAAWtuB,GAEpFouB,EAAwBO,IAGpBpE,EAAkBC,uBACtB,SAAC1gC,GACC,IAAM4kC,EAA6B7mB,oBAAUsmB,GACvCzD,EAAiBhsB,GAAkB5U,GAEzC4kC,EAA2BJ,GAAa5D,EACxCgE,EAA2BJ,GAAW/kC,SAAU,EAEhD6kC,EAAwBM,KAE1B,CAACJ,EAAWH,EAAsBC,IAG9BQ,EAAmBpE,uBAAY,WACnC,IAAMkE,EAA6B7mB,oBAAUsmB,GAE7CO,EAA2BjuC,KAAK6I,IAEhC8kC,EAAwBM,KACvB,CAACP,EAAsBC,IAEpBS,EAAsBrE,uBAAY,WACtC,IAAMkE,EAA6B7mB,oBAAUsmB,GAE7CO,EAA2B7+B,OAAOy+B,EAAW,GAExCI,EAA2BjzC,QAC9BizC,EAA2BjuC,KAAK6I,IAGlC8kC,EAAwBM,KACvB,CAACJ,EAAWH,EAAsBC,IAErC,OACE,uCACE,uBAAKnsC,UAAU,2BAA2B0M,cAAY,YAAtD,UACE,uBAAK1M,UAAU,iCAAf,UACE,uBACEA,UAAWoV,KAAG,iCAAkC,CAAE9T,UAAW+qC,IAC7Dr6B,MAAOjS,EAAc,CAAEzD,GAAI,kBAC3BqhB,cAAY,OACZtc,QAAS,kBAAMmrC,GAAwB,IACvC9/B,cAAY,iBAEd,uBACE1M,UAAWoV,KAAG,mCAAoC,CAAE9T,SAAU+qC,IAAcH,EAAqB1yC,OAAS,IAC1GwY,MAAOjS,EAAc,CAAEzD,GAAI,oBAC3BqhB,cAAY,OACZtc,QAAS,kBAAMmrC,EAAuB,IACtC9/B,cAAY,sBAGhB,eAACiU,GAAD,CACErgB,YAAaP,EAAc,CAAEzD,GAAI,+CACjCmkB,kBAAmBvZ,EACnBtO,MAAOsO,EACP9G,SAAUkoC,EACVpoC,QAASwQ,IACT2P,iBAAkBjL,KAAG,CAAE6pB,SAAU/3B,IAAgBpD,EAAOwD,UACxDjH,gBAAgB,iBAChB2c,MAAOD,GACPrQ,cAAY,iBAEd,eAAC4U,GAAD,CACEznB,KAAMA,EACN0nB,YAAaorB,EACbnrB,aAAcorB,EACdnrB,oBAAqB4qB,IAAcH,EAAqB1yC,OAAS,QAGnE0N,IAAgBpD,EAAOwD,SAAW,eAAC,GAAD,CAAiBpP,QAAS,qECoE9DuJ,I,QAAqB,CACzBorC,sBF3JmC,SAACx0C,GAAD,MAAmC,CACtEL,KAAMZ,GACNiB,SE0JA8zC,2BACAjzC,oBACAC,gBACAI,kBC7KWuzC,GAAc,CACzB,CACEC,KAAM,wCACNC,UDgLWrrC,mBA7BS,SAAC,GAAD,YACtB0H,KAAiB4jC,EADK,EACd31C,QAAuB4iB,EADT,EACSA,yBACIgyB,EAFb,EAEtBE,gCAAmCF,qBAFb,IAGtB3zC,SACW20C,EAJW,EAIpBz0C,QACyBC,EALL,EAKpBA,eAAkBE,MAClBJ,EANoB,EAMpBA,QANoB,MAQT,CACby0C,eACAC,gBACAhzB,2BACAgyB,uBACAxzC,iBACAy0C,YAAW,iBAAE30C,QAAF,IAAEA,OAAF,EAAEA,EAASd,YAAX,QAAmB+N,GAC9B4sB,aAAY,iBAAE75B,QAAF,IAAEA,OAAF,EAAEA,EAASI,aAAX,QAAoB6M,MAcMhE,GAAzBE,CAA6CE,aAzJpB,SAAC,GAcK,IAbpC9B,EAamC,EAb3ClG,KAAQkG,cACRktC,EAY2C,EAZ3CA,aACA/yB,EAW2C,EAX3CA,yBACAgyB,EAU2C,EAV3CA,qBACAxzC,EAS2C,EAT3CA,eACAy0C,EAQ2C,EAR3CA,YACA9a,EAO2C,EAP3CA,aACA6a,EAM2C,EAN3CA,cACAL,EAK2C,EAL3CA,sBACAV,EAI2C,EAJ3CA,wBACAjzC,EAG2C,EAH3CA,kBACAC,EAE2C,EAF3CA,cACAI,EAC2C,EAD3CA,cAEA47B,qBAAU,WACRj8B,EAAkBkO,MACjB,CAAClO,IACJi8B,qBAAU,WACR9C,GAAgB8Z,EAAwBzjC,KAAK5R,MAAMu7B,MAClD,CAAC8Z,EAAyB9Z,IAC7B8C,qBAAU,WACR+X,GAAiBptC,aAAaC,EAAc,CAAEzD,GAAI,0DACjD,CAACyD,EAAemtC,IACnB/X,qBAAU,WACR,GAAIjb,EAA0B,CAC5B,IAAMjU,EAAO,aAAOwB,IAEpByS,EAAyBjc,KAAI,qBAAGsS,OACvBlL,SAAQ,YAA0B,IAAjBqF,EAAgB,EAAtB3L,KAChB,GAAI2L,EAAW,CACb,IAIM3L,EAJmC2L,EAAUJ,QACjD/C,IACA,SAAA6lC,GAAG,OAAIA,EAAIC,OAAO,GAAGC,cAAgBF,EAAIx+B,UAAU,MAEPtE,QAAQ9C,GAAwC,SAE9FvB,EAAQzH,KAAK,CAAEV,MAAOiB,EAAMnG,MAAO8R,WAKzCmiC,EAAsBU,mBAAStnC,EAASsmC,eAEzC,CAACryB,EAA0B2yB,IA9Ba,MAgCLhgB,oBAAS,GAhCJ,oBAgCpCvF,EAhCoC,KAgCvBkmB,EAhCuB,KAiCrCC,EAAkBlF,uBAAY,kBAAOxhC,OAAOpJ,SAASqJ,KvG1F9B,qDuG0FuD,IAC9E0mC,EAAgBnF,uBAAY,kBAAMiF,GAAe,KAAO,IACxDG,EAA6BpF,uBAAY,WAC7C,IAAMkE,EAA6B7mB,oBAAUsmB,GAE7CO,EAA2B,GAAGnlC,SAAU,EAExCwhB,aAAW/oB,EAAc,CAAEzD,GAAI,2DAC/B6vC,EAAwBM,GACxBe,GAAe,KACd,CAACtB,EAAsBnsC,EAAeosC,IACnCJ,EAAcxD,uBAAY,kBAAMiF,GAAe,KAAQ,IACvDxB,EAAezD,uBAAY,WAC/B,IAAMqF,EAAmC1B,EAAqBriC,QAAO,qBAAGjR,SAExE,IAAKg1C,EAAiCp0C,OACpC,OAAOm0C,IAGT,IAAMl0C,EAASm0C,EAAiC3vC,KAAI,SAAA6F,GAAM,MAAK,CAAEhG,MAAOgG,EAAOhG,MAAOlF,MAAOkL,EAAOlL,UAC9F8vB,EAAahgB,KAAKsR,UAAUvgB,GAE9Bf,EACFa,EAAc,CAAE7B,KAAMy1C,EAAav0C,MAAO8vB,IAE1CvvB,EAAciO,GAAmCshB,GAGnD8kB,GAAe,KACd,CAACtB,EAAsB/yC,EAAeT,EAAgBy0C,EAAa5zC,EAAeo0C,IAErF,OACE,uBAAKrxC,GAAG,qCAAqCoQ,cAAY,kCAAzD,UACE,eAAC,GAAD,CACEyH,OAAQ,CAAE7X,GAAI,gDACdiY,KAAM,CAAEjY,GAAI,8CACZoY,MAAOs3B,EACPr3B,KAAMo3B,EACNn3B,OAAQ0S,IAEV,sBAAKtnB,UAAU,QAAf,SACE,eAAC,IAAD,CAAkB1D,GAAG,wCAAwC4Y,QAAQ,SAEtE+3B,EACC,sBAAKjtC,UAAU,UAAU0M,cAAY,UAArC,SACE,eAACjG,GAAA,EAAD,MAGF,uCACE,uBAAKzG,UAAU,UAAf,UACE,sBAAKA,UAAU,QAAf,SACE,eAAC,IAAD,CAAkB1D,GAAG,mDAAmD4Y,QAAQ,SAElF,sBAAKlV,UAAU,UAAf,SACGksC,EAAqBjuC,KAAI,SAAC6F,EAAQga,GAAT,OACxB,eAAC,GAAD,CAA0Cha,OAAQA,EAAQuoC,UAAWvuB,GAArE,UAAmBha,EAAOlL,MAA1B,YAAmCklB,YAIzC,uBAAK9d,UAAU,YAAf,UACE,sBAAKA,UAAU,WAAf,SACE,eAACoB,EAAA,EAAD,CAAQpB,UAAU,SAASqB,QAASosC,EAAiB/gC,cAAY,eAAjE,SACE,eAAC,IAAD,CAAkBpQ,GAAG,sBAGzB,sBAAK0D,UAAU,+CAAf,SACE,eAACoB,EAAA,EAAD,CAAQpB,UAAU,OAAOqB,QAASqsC,EAAehhC,cAAY,aAA7D,SACE,eAAC,IAAD,CAAkBpQ,GAAG,iCCxIjCuxC,WAAY,yCAEd,CACEd,KAAM,YACNC,UAAWc,GACXD,WAAY,wBAEd,CACEd,KAAM,uCACNC,UAAWe,GACXF,WAAY,iCAEd,CACEd,KAAM,6BACNC,UAAWe,GACXF,WAAY,mCAEd,CACEd,KAAM,gBACNC,UAAWgB,GACXH,WAAY,qBAEd,CACEd,KAAM,kCACNC,UAAWpwC,GACXixC,WAAY,yBAEd,CACEd,KAAM,2BACNC,UAAWiB,GACXJ,WAAY,oBAEd,CACEd,KAAM,cACNC,UAAW/lB,GACX4mB,WAAY,mBAEd,CACEd,KAAM,4BACNC,UAAW1jB,GACXukB,WAAY,gCAEd,CACEd,KAAM,gBACNC,UAAWlf,GACX+f,WAAY,qBAEd,CACEd,KAAM,oBACNC,UAAWxc,GACXqd,WAAY,yBAEd,CACEd,KAAM,8BACNC,UAAWhW,GACX6W,WAAY,mCAEd,CACEd,KAAM,0BACNC,UAAWkB,GACXL,WAAY,+BAEd,CACEd,KAAM,gBACNC,UAAWrlC,GACXkmC,WAAY,oBACZM,kBAAmBxlC,IAErB,CACEokC,KAAM,kBACNC,UAAW9jC,GACX2kC,WAAY,sBACZM,kBAAmBxlC,IAErB,CACEokC,KAAM,oBACNC,UAAW1yB,GACXuzB,WAAY,wBACZM,kBAAmBxlC,IAErB,CACEokC,KAAM,oBACNC,UAAW1yB,GACXuzB,WAAY,oBACZM,kBAAmBxlC,IAErB,CACEokC,KAAM,sBACNC,UAAWzyB,GACXszB,WAAY,0BACZM,kBAAmBxlC,IAErB,CACEokC,KAAM,sBACNC,UAAWzyB,GACXszB,WAAY,sBACZM,kBAAmBxlC,IAErB,CACEokC,KAAM,IACNC,UAAWxyB,GACXqzB,WAAY,eCjHVO,GAAY,eAACC,IAAD,gEAAuB,uBAAMruC,UAAU,YAAhB,SAA6BquC,GAAc,QAM9EC,G,4MACJC,iBAAmB,WAEjB,OADoB,EAAK7wC,MAAMzC,YAE5BgD,KAAI,WAA6B4I,GAAO,IAAjCpI,EAAgC,EAAhCA,MAAYovC,GAAoB,EAAzBj8B,IAAyB,EAApBi8B,YACZvxC,EAAKuxC,GAAcA,EAAU,OAAaA,EAAU,MAAUW,SAC9DC,EAAgB,CAAEC,QAASpyC,EAAIuD,MAAOgH,EAAGnN,IAAI,IAAD,OAAM+E,EAAM/E,MAI9D,OAHU,IAANmN,IACF4nC,EAAc/0C,IAAMjD,IAEG,IAArB6F,EAAGyW,QAAQ,KACN07B,EAEF,QAER5kC,QAAO,SAAAgkC,GAAU,QAAMA,M,4CAG5B,WACE,IAAI5yC,EAAcqE,KAAKivC,mBACjBI,EAAWh4C,EAAY2I,KAAK5B,MAAMC,SAAS/G,QAC3Cg4C,E5H7BkB,SAAAh4C,GAC1B,IAAM8H,EAAS7H,IAAYC,MAAMF,GACjC,OAAO8H,EAAM,MAAYA,EAAM,KAAS3H,W4H2BpB83C,CAAavvC,KAAK5B,MAAMC,SAAS/G,QASnD,OARI+3C,GAAYC,GACd3zC,EAAYuD,KAAK,CACf9E,IAAKi1C,EACL7wC,MAAO8wC,EACP/uC,MAAO,IAGX5E,EAAcA,EAAYE,OAAOmE,KAAK5B,MAAM3C,uBAAuBmrB,MAAK,SAAC4oB,EAAIC,GAAL,OAAYD,EAAGjvC,MAAQkvC,EAAGlvC,SAEhG,sBAAKG,UAAU,cAAf,SACG/E,EAAYgD,KAAI,WAA0B4I,GAA1B,IAAGnN,EAAH,EAAGA,IAAKg1C,EAAR,EAAQA,QAAS5wC,EAAjB,EAAiBA,MAAjB,OACf,uCACG+I,IAAM5L,EAAYzB,OAAS,EAC1B,gCAAOsE,GAAS,eAAC,IAAD,CAAkBxB,GAAIoyC,MAEtC,oBAAG1nC,KAAMtN,EAAT,SAAeoE,GAAS,eAAC,IAAD,CAAkBxB,GAAIoyC,MAE/CN,GAAUvnC,IAAM5L,EAAYzB,OAAS,e,GAvCxB+H,IAAMC,WAwDjBG,sBATS,SAAC,GAAD,MAAsB,CAC5C5G,sBADsB,EAAGE,YACUF,yBAGV,GAKZ4G,CAA6CqtC,YAAgBlC,GAAhBkC,CAA6BltC,qBAAWwsC,M,oBCnErFW,GAFA,kBAAM,eAAC,UAAD,KCiBNC,G,4MAlBbp3C,MAAQ,CACNq3C,UAAU,G,4CAOZ,WACE,OAAI7vC,KAAKxH,MAAMq3C,SAEN,wDAGF7vC,KAAK5B,MAAM8wC,Y,uCAVpB,SAAgCvuC,GAC9B,MAAO,CAAEkvC,UAAU,O,GANK5tC,IAAMC,WCcnB4tC,I,QAbM,kBACnB,sBAAKpvC,UAAU,8BAAf,SACE,sBAAKA,UAAU,cAAf,SACE,uBAAKA,UAAU,eAAf,UACE,uBAAMA,UAAU,4CAChB,sBAAKA,UAAU,UAAf,SACE,wF,WCKJqvC,G,4MACJC,gBAAkB,SAAAC,GAAU,IAAD,EACsB,EAAK7xC,MAA5C8xC,EADiB,EACjBA,cAAeC,EADE,EACFA,WAAYn4C,EADV,EACUA,QACnC,GAAIi4C,EAAMpB,kBAAmB,CAC3B,GAAI72C,EACF,OAAO,eAACmP,GAAA,EAAD,IACF,IAAK+oC,IAAkBC,EAAW3jC,SAASyjC,EAAMpB,mBACtD,OAAO,eAAC,GAAD,IAGX,IAAM3sC,EAAY+tC,EAAMvC,UACxB,OAAO,eAACxrC,EAAD,eAAe,EAAK9D,S,EAG7BgO,OAAS,kBACP,gBAAC,IAAD,WACE,eAAC,KAAD,IACA,eAAC,GAAD,IACA,uBAAK1L,UAAU,UAAf,UACE,eAAC,GAAD,IACA,eAAC,GAAD,UACE,eAAC,SAAD,UACG7C,IAAEc,IAAI6uC,IAAa,SAAAyC,GAAK,OACvB,eAAC,QAAD,CAAOxC,KAAMwC,EAAMxC,KAAnB,SACG,EAAKuC,gBAAgBC,IADMA,EAAMxC,oB,YAvB7BxrC,IAAMC,WA6CZG,sBAXS,SAAC,GAAD,IAAG+tC,EAAH,EAAGA,QAAH,MAAkB,CACxCF,cAAeE,EAAQF,cACvBl4C,QAASo4C,EAAQp4C,QACjBm4C,WAAYC,EAAQD,cAGK,GAKZ9tC,CAA6C0tC,ICvD/Cj4C,GACE,sBADFA,GAEU,8BAFVA,GAGS,6BAHTA,GAII,wBAGXC,GAAe,CACnBC,SAAS,EACTM,aAAc,KACd83C,QAAS,KACTC,eAAgB,GAChBH,eAAe,EACfC,WAAY,IAkFC53C,GA/EC,WAAmC,IAAlCC,EAAiC,uDAAzBT,GAAcU,EAAW,uCAChD,OAAQA,EAAOC,MACb,KAAKhB,EAAQI,IACb,KAAKJ,EAAQI,IACb,KAAKJ,EAAQI,IACX,OAAO,2BACFU,GADL,IAEER,SAAS,IAEb,KAAKH,EAAQC,IACX,OAAO,2BACFC,IADL,IAEEO,aAAcG,EAAOE,QAAQC,UAEjC,KAAKf,EAAQC,IACb,KAAKD,EAAQC,IACX,OAAO,2BACFU,GADL,IAEEF,aAAcG,EAAOE,QAAQC,UAEjC,KAAKhB,EAAQE,IACX,IAAMo4C,EAAgBz3C,EAAOE,QAAQI,KAAKm3C,cAC1C,OAAO,2BACFn4C,IADL,IAEEm4C,gBACAC,WAAYD,EAAgBz3C,EAAOE,QAAQI,KAAKisC,KAAKmL,WAAWxxC,KAAI,SAAC2xC,GAAD,OAAaA,EAAE7wC,KAAO6wC,EAAE7wC,KAAO6wC,EAAE1xC,WAAY,GACjHwxC,QAAS33C,EAAOE,QAAQI,OAE5B,KAAKnB,EAAQE,IACX,OAAO,2BACFU,GADL,IAEE63C,eAAgB53C,EAAOE,QAAQI,KAC/Bf,SAAS,EACTM,aAAc,OAElB,KAAKV,EAAQE,IACX,OAAO,2BACFU,GADL,IAEER,SAAS,EACTM,aAAc,OAElB,KAAKR,GACH,OAAO,eACFC,IAEP,QACE,OAAOS,I,UClEA+3C,I,+BAAe,SAACxmC,EAAMymC,GACjC,IAAMC,EAAMC,GAAO3mC,EAAMymC,GACzB,OAAOC,GAAOA,EAAIt2C,SAGPu2C,GAAS,SAAC3mC,EAAM3R,GAAP,OAAgB2R,GAAQA,EAAK5M,MAAK,SAAAszC,GAAG,OAAIA,EAAIr4C,OAASA,MCA/Du4C,GAA0BC,8BCO1B94C,GACD,oBAGNC,GAAe,CACnBC,SAAS,EACTM,aAAc,KACdyR,KAAM,GACN8mC,wBAAyB,KACzB7mC,0BAA2B,KAC3B4Q,yBAA0B,KAC1BE,2BAA4B,KAC5B8O,cAAe,KACfC,aAAc,KACdyC,oBAAqB,KACrBxC,0BAA2B,MAGhBgnB,GAAe,SAAA/mC,GAAI,0BAAK,CACnCA,OACA8mC,wBAAuB,UAAEN,GAAaxmC,ED/BR6mC,4BC+BP,aAAE,EAAsCznC,aAC/Da,0BAAyB,UAAEumC,GAAaxmC,ED/BR6mC,8BC+BP,aAAE,EAAwCznC,aACnEyR,yBAAwB,UAAE21B,GAAaxmC,ED/BL6mC,gCC+BV,aAAE,EAA0C38B,MACpE6G,2BAA0B,UAAEy1B,GAAaxmC,ED/BL6mC,kCC+BV,aAAE,EAA4C38B,MACxE2V,cAAa,UAAE2mB,GAAaxmC,EAAM4mC,WAArB,aAAE,EAA6CzyB,WAC5D2L,aAAY,UAAE0mB,GAAaxmC,EAAM4mC,WAArB,aAAE,EAA6C15B,UAC3DqV,oBAAmB,UAAEikB,GAAaxmC,EAAM4mC,WAArB,aAAE,EAA6C5lB,iBAClEjB,0BAAyB,UAAEymB,GAAaxmC,EAAM4mC,WAArB,aAAE,EAA6ChnB,yBAoC3DpxB,GAjCC,WAAmC,IAAlCC,EAAiC,uDAAzBT,GAAcU,EAAW,uCAChD,OAAQA,EAAOC,MACb,KAAKhB,EAAQI,IACX,OAAO,2BACFU,GADL,IAEER,SAAS,EACTM,aAAc,OAElB,KAAKT,EAAQC,IACX,OAAO,2BACFU,GADL,IAEER,SAAS,EACTM,aAAcG,EAAOE,QAAQC,UAEjC,KAAKhB,EAAQE,IACX,OAAO,2BACFC,IACA+4C,GAAar4C,EAAOE,QAAQI,KAAKC,UAExC,QACE,OAAOR,I,2BC/Cbu4C,KAAMC,Y,IAIAC,G,uKACJ,WACEjxC,KAAK5B,MAAM8yC,aACXlxC,KAAK5B,MAAM+yC,Y,oBAGb,WACE,OACE,uBAAKn0C,GAAG,MAAM0D,UAAU,MAAxB,UACE,eAAC,GAAD,IACA,eAAC,cAAD,W,GAVUuB,IAAMC,WAoBlBC,GAAqB,CAAE+uC,WJgCH,WAExB,MAAO,CACLx4C,KAAMZ,GACNa,QAASe,IAAMC,IAHD,uCIjCuBw3C,QD4BlB,WAErB,MAAO,CACLz4C,KAAMZ,GACNa,QAASe,IAAMC,IAHD,wCCxBH0I,sBATS,SAAC,GAAD,MAAkB,CACxC+tC,QADsB,EAAGA,QACRA,WAQqBjuC,GAAzBE,CAA6C4uC,IC9B7CG,GAZS,SAACC,GACnBA,GAAeA,aAAuBC,UACxC,+BAAqBC,MAAK,YAAkD,IAA/CC,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAON,GACPO,EAAQP,O,sFCuBCQ,gBAAgB,CAC7BvvC,cACAqY,aACA7Q,aACAsmC,WACAn3C,WACAoF,YACAoM,oBACAkK,gBACA5K,QACA7R,UACAiD,aACAQ,eACA0E,YACA9D,aACAu1C,kBACA/M,QACAC,QACA+M,sBACA5nB,SACAsC,eACAgM,YACA2F,YACAmK,kBACAkB,YACAhC,SACAkB,kBACAkC,aACAiC,mCACAkF,QAASC,YACTC,KAAMC,O,WCvDFC,GAAiBC,eAEjBC,GAAqB,CAACC,KAAiBC,KAAmBJ,IAE1DK,GAAsB,SAAAC,GAAW,OAAIC,aAAQC,KAAe,WAAf,EAAmBN,GAAnB,oBAA0CI,OAQ9EG,GANI,SAAC96C,GAAqC,IAAtB26C,EAAqB,uDAAP,GACzCI,EAAQC,aAAYC,GAAaj7C,EAAc06C,GAAoBC,IAEzE,OADAN,GAAea,IAAIC,UACZJ,G,4CCLHA,GAAQK,KACR/U,GAAWgV,KAAQC,IAIzBC,IAASlnC,OACP,eAAC,IAAMmnC,WAAP,UACE,eAAC,WAAD,CAAUT,MAAOA,GAAjB,SACE,eAAC,KAAD,CAAcU,OANL,KAMqBpV,SAAUA,GAAxC,SACE,eAAC,GAAD,UAINqV,SAASC,eAAe,SAM1BtC,M","file":"main.9c21525e.chunk.js","sourcesContent":["export const ROOT_URL = '/openmrs/';\nexport const PATIENT_PAGE_URL = ROOT_URL + 'coreapps/clinicianfacing/patient.page';\nexport const CONDITIONS_PAGE_URL = ROOT_URL + 'coreapps/conditionlist/manageConditions.page';\n","import queryString from 'query-string';\nimport { ROOT_URL } from '../constants/openmrs';\n\nexport const redirectUrl = search => {\n  const params = queryString.parse(search);\n  const redirect = params['redirect'];\n  return (redirect || ROOT_URL).toString();\n};\n\nexport const nameParamVal = search => {\n  const params = queryString.parse(search);\n  return params['name'] && params['name'].toString();\n};\n","/**\n * Appends REQUEST async action type\n */\n\nexport const REQUEST = actionType => `${actionType}_PENDING`;\n\n/**\n * Appends SUCCESS async action type\n */\n\nexport const SUCCESS = actionType => `${actionType}_FULFILLED`;\n\n/**\n * Appends FAILURE async action type\n */\n\nexport const FAILURE = actionType => `${actionType}_REJECTED`;\n","import axios from 'axios';\nimport { IConceptState } from '../../shared/models/concept';\n\nimport { FAILURE, REQUEST, SUCCESS } from '../action-type.util';\n\nexport const ACTION_TYPES = {\n  SEARCH_CONCEPTS: 'concept/SEARCH_CONCEPTS',\n  RESET_CONCEPTS: 'concept/RESET_CONCEPTS',\n  GET_CONCEPT: 'concept/GET_CONCEPT'\n};\n\nconst initialState: IConceptState = {\n  loading: {\n    concepts: false,\n    concept: false\n  },\n  query: '',\n  concepts: [],\n  concept: {\n    uuid: '',\n    setMembers: []\n  },\n  errorMessage: ''\n};\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case REQUEST(ACTION_TYPES.SEARCH_CONCEPTS):\n      return {\n        ...state,\n        loading: {\n          ...state.loading,\n          concepts: true\n        }\n      };\n    case REQUEST(ACTION_TYPES.GET_CONCEPT):\n      return {\n        ...state,\n        loading: {\n          ...state.loading,\n          concept: true\n        }\n      };\n    case FAILURE(ACTION_TYPES.SEARCH_CONCEPTS):\n      return {\n        ...state,\n        loading: {\n          ...state.loading,\n          concepts: false\n        },\n        errorMessage: action.payload.message\n      };\n    case FAILURE(ACTION_TYPES.GET_CONCEPT):\n      return {\n        ...state,\n        loading: {\n          ...state.loading,\n          concept: false\n        },\n        errorMessage: action.payload.message\n      };\n    case SUCCESS(ACTION_TYPES.SEARCH_CONCEPTS):\n      return {\n        ...state,\n        loading: {\n          ...state.loading,\n          concepts: false\n        },\n        query: action.meta.q,\n        concepts: action.payload.data.results\n      };\n    case SUCCESS(ACTION_TYPES.GET_CONCEPT):\n      return {\n        ...state,\n        loading: {\n          ...state.loading,\n          concept: false\n        },\n        concept: action.payload.data\n      };\n    case ACTION_TYPES.RESET_CONCEPTS:\n      return {\n        ...initialState\n      };\n    default:\n      return state;\n  }\n};\n\n// actions\nexport const searchConcepts = (q, conceptClasses) => {\n  const requestUrl = `/openmrs/ws/rest/v1/conceptsearch?conceptClasses=${conceptClasses}${!!q ? '&q=' + q : ''}`;\n  return {\n    type: ACTION_TYPES.SEARCH_CONCEPTS,\n    payload: axios.get(requestUrl),\n    meta: {\n      q\n    }\n  };\n};\n\nexport const getConcept = (uuid: string, custom?: string) => ({\n  type: ACTION_TYPES.GET_CONCEPT,\n  payload: axios.get(`/openmrs/ws/rest/v1/concept/${uuid}?v=${custom ? `custom:(${custom})` : 'full'}`)\n});\n\nexport const reset = () => ({\n  type: ACTION_TYPES.RESET_CONCEPTS\n});\n\nexport default reducer;\n","import axios from 'axios';\n\nimport { FAILURE, REQUEST, SUCCESS } from '../action-type.util';\n\nexport const ACTION_TYPES = {\n  GET_SETTING: 'settings/GET_SETTING',\n  GET_SETTINGS: 'settings/GET_SETTINGS',\n  CREATE_SETTING: 'settings/CREATE_SETTING',\n  DELETE_SETTING: 'settings/DELETE_SETTING'\n};\n\nconst initialState = {\n  loading: false,\n  errorMessage: null,\n  settings: [],\n  setting: null,\n  success: false,\n  isSettingExist: { settingPropertyUrl: null, value: false }\n};\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case REQUEST(ACTION_TYPES.GET_SETTING):\n    case REQUEST(ACTION_TYPES.GET_SETTINGS):\n    case REQUEST(ACTION_TYPES.CREATE_SETTING):\n    case REQUEST(ACTION_TYPES.DELETE_SETTING):\n      return {\n        ...state,\n        loading: true,\n        success: false,\n        errorMessage: null\n      };\n    case FAILURE(ACTION_TYPES.GET_SETTING):\n    case FAILURE(ACTION_TYPES.GET_SETTINGS):\n    case FAILURE(ACTION_TYPES.CREATE_SETTING):\n    case FAILURE(ACTION_TYPES.DELETE_SETTING):\n      return {\n        ...state,\n        loading: false,\n        success: false,\n        errorMessage: action.payload.message\n      };\n    case SUCCESS(ACTION_TYPES.GET_SETTINGS):\n      return {\n        ...initialState,\n        settings: action.payload.data.results\n      };\n    case SUCCESS(ACTION_TYPES.GET_SETTING):\n      const results = action.payload.data.results;\n      const isSettingExist = !!results && results.length > 0;\n      return {\n        ...state,\n        loading: false,\n        errorMessage: null,\n        isSettingExist: { settingPropertyUrl: action.payload.config.url, value: isSettingExist },\n        setting: isSettingExist ? results[0] : state.setting\n      };\n    case SUCCESS(ACTION_TYPES.CREATE_SETTING):\n    case SUCCESS(ACTION_TYPES.DELETE_SETTING):\n      return {\n        ...state,\n        loading: false,\n        errorMessage: null,\n        success: true\n      };\n    default:\n      return state;\n  }\n};\n\n// actions\nexport const getSettings = (prefix = '') => {\n  const requestUrl = `/openmrs/ws/rest/v1/systemsetting?q=${prefix}&v=full`;\n  return {\n    type: ACTION_TYPES.GET_SETTINGS,\n    payload: axios.get(requestUrl)\n  };\n};\n\nexport const getSettingByQuery = q => {\n  const requestUrl = `/openmrs/ws/rest/v1/systemsetting?q=${q}&v=full`;\n  return {\n    type: ACTION_TYPES.GET_SETTING,\n    payload: axios.get(requestUrl)\n  };\n};\n\nexport const createSetting = (property, value = '', description = '') => {\n  const requestUrl = `/openmrs/ws/rest/v1/systemsetting`;\n  const data = {\n    property,\n    description\n  };\n  if (value) {\n    data['value'] = value;\n  }\n  return {\n    type: ACTION_TYPES.CREATE_SETTING,\n    payload: axios.post(requestUrl, data)\n  };\n};\n\nexport const updateSetting = setting => {\n  const requestUrl = `/openmrs/ws/rest/v1/systemsetting/${setting.uuid}`;\n  return {\n    type: ACTION_TYPES.CREATE_SETTING,\n    payload: axios.post(requestUrl, setting)\n  };\n};\n\nexport const deleteSetting = setting => ({\n  type: ACTION_TYPES.DELETE_SETTING,\n  payload: axios.delete(`/openmrs/ws/rest/v1/systemsetting/${setting.uuid}`)\n});\n\nexport default reducer;\n","export const dobToAge = dob => {\n  if (!dob) return dob;\n  const birthDate = new Date(dob);\n  const difference = Date.now() - birthDate.getTime();\n  const age = new Date(difference);\n\n  return Math.abs(age.getUTCFullYear() - 1970);\n};\n\nexport const DATE_FORMAT = 'dd MMM yyyy';\n\nexport const formatDate = (intl, date) =>\n  new Intl.DateTimeFormat('en-GB', {\n    day: '2-digit',\n    month: 'short',\n    year: 'numeric'\n  }).format(date);\n\nexport const isoDateString = jsDate => (jsDate ? jsDate.toISOString().split('T')[0] : null);\n","import axios from 'axios';\n\nimport { FAILURE, REQUEST, SUCCESS } from '../action-type.util';\n\nexport const ACTION_TYPES = {\n  GET_CONDITION: 'condition/GET_CONDITION',\n  CONDITION_HISTORY: 'condition/CONDITION_HISTORY',\n  SAVE_CONDITION: 'condition/SAVE_CONDITION',\n  RESET_CONDITION: 'condition/RESET_CONDITION'\n};\n\nconst initialState = {\n  loading: false,\n  q: '',\n  condition: null,\n  conditions: [],\n  errorMessage: '',\n  conditionUpdated: false\n};\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case REQUEST(ACTION_TYPES.GET_CONDITION):\n    case REQUEST(ACTION_TYPES.CONDITION_HISTORY):\n    case REQUEST(ACTION_TYPES.SAVE_CONDITION):\n      return {\n        ...state,\n        loading: true,\n        conditionUpdated: false\n      };\n    case FAILURE(ACTION_TYPES.GET_CONDITION):\n    case FAILURE(ACTION_TYPES.SAVE_CONDITION):\n      return {\n        ...initialState,\n        errorMessage: action.payload.message\n      };\n    case SUCCESS(ACTION_TYPES.GET_CONDITION):\n      return {\n        ...initialState,\n        condition: action.payload.data && action.payload.data[0]\n      };\n    case SUCCESS(ACTION_TYPES.CONDITION_HISTORY):\n      return {\n        ...initialState,\n        conditions: action.payload.data\n      };\n    case SUCCESS(ACTION_TYPES.SAVE_CONDITION):\n      return {\n        ...state,\n        loading: false,\n        conditionUpdated: true\n      };\n    case ACTION_TYPES.RESET_CONDITION:\n      return {\n        ...initialState\n      };\n    default:\n      return state;\n  }\n};\n\n// actions\nexport const getCondition = uuid => {\n  const requestUrl = `/openmrs/ws/rest/emrapi/condition?conditionUuid=${uuid}`;\n  return {\n    type: ACTION_TYPES.GET_CONDITION,\n    payload: axios.get(requestUrl)\n  };\n};\n\nexport const getConditionHistory = patientId => {\n  const requestUrl = `/openmrs/ws/rest/emrapi/conditionhistory?patientUuid=${patientId}`;\n  return {\n    type: ACTION_TYPES.CONDITION_HISTORY,\n    payload: axios.get(requestUrl)\n  };\n};\n\nexport const saveCondition = condition => {\n  const requestUrl = `/openmrs/ws/rest/emrapi/condition`;\n  return {\n    type: ACTION_TYPES.SAVE_CONDITION,\n    payload: axios.post(requestUrl, [prepareCondition(condition)])\n  };\n};\n\nexport const saveConditions = conditions => {\n  const requestUrl = `/openmrs/ws/rest/emrapi/condition`;\n  return {\n    type: ACTION_TYPES.SAVE_CONDITION,\n    payload: axios.post(\n      requestUrl,\n      conditions?.map(condition => prepareCondition(condition))\n    )\n  };\n};\n\nconst prepareCondition = condition => ({\n  ...condition,\n  conditionNonCoded: condition.conditionNonCoded || null\n});\n\nexport const reset = () => ({\n  type: ACTION_TYPES.RESET_CONDITION\n});\n\nexport default reducer;\n","import { IBreadcrumb } from '../../shared/models/breadcrumb';\n\nexport const ACTION_TYPES = {\n  ADD_BREADCRUMBS: 'breadcrumbs/ADD',\n  RESET_BREADCRUMBS: 'breadcrumbs/RESET'\n};\n\nconst initialState = {\n  additionalBreadcrumbs: [] as IBreadcrumb[]\n};\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case ACTION_TYPES.ADD_BREADCRUMBS:\n      return {\n        ...state,\n        additionalBreadcrumbs: state.additionalBreadcrumbs.concat(action.meta.breadcrumbs)\n      };\n    case ACTION_TYPES.RESET_BREADCRUMBS:\n      return {\n        ...initialState\n      };\n    default:\n      return state;\n  }\n};\n\n// actions\nexport const addBreadcrumbs = (breadcrumbs: IBreadcrumb[]) => ({\n  type: ACTION_TYPES.ADD_BREADCRUMBS,\n  meta: {\n    breadcrumbs\n  }\n});\n\nexport const resetBreadcrumbs = () => ({\n  type: ACTION_TYPES.RESET_BREADCRUMBS\n});\n\nexport default reducer;\n","export const STATUS_ACTIVE = 'ACTIVE';\nexport const STATUS_INACTIVE = 'INACTIVE';\n","export const DEFAULT_PAGE_SIZE = 50;\n\nexport const pageOf = (entities, currentPage, pageSize = DEFAULT_PAGE_SIZE) =>\n  !!entities ? entities.slice(currentPage * pageSize, (currentPage + 1) * pageSize) : [];\n","import axios from 'axios';\n\nimport { FAILURE, REQUEST, SUCCESS } from '../action-type.util';\nimport { DEFAULT_PAGE_SIZE } from '../page.util';\n\nexport const ACTION_TYPES = {\n  SEARCH_PATIENTS: 'patient/SEARCH_PATIENTS',\n  GET_PATIENT: 'patient/GET_PATIENT',\n  RESET_PATIENTS: 'patient/RESET_PATIENTS',\n  GET_PATIENT_RELATIONSHIPS: 'patient/GET_PATIENT_RELATIONSHIPS',\n  GET_PATIENT_LINKED_REGIMENS: 'patient/GET_PATIENT_LINKED_REGIMENS'\n};\n\nconst initialState = {\n  loading: false,\n  patients: [],\n  patient: null,\n  patientRelationships: null,\n  errorMessage: '',\n  currentPage: 0,\n  totalCount: 0,\n  hasNext: false,\n  hasPrev: false,\n  q: '',\n  patientLinkedRegimens: []\n};\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case REQUEST(ACTION_TYPES.GET_PATIENT_RELATIONSHIPS):\n      return {\n        ...state,\n        patientRelationships: null\n      };\n    case REQUEST(ACTION_TYPES.SEARCH_PATIENTS):\n      return {\n        ...state,\n        loading: true,\n        q: action.meta.q\n      };\n    case FAILURE(ACTION_TYPES.SEARCH_PATIENTS):\n      return {\n        ...initialState,\n        errorMessage: action.payload.message\n      };\n    case SUCCESS(ACTION_TYPES.SEARCH_PATIENTS):\n      const links = action.payload.data.links;\n      const page = action.meta.currentPage || 0;\n      const patients = action.payload.data.results || [];\n      if (action.meta.q === state.q) {\n        return {\n          ...initialState,\n          patients: page === 0 ? patients : [...state.patients, ...patients],\n          hasNext: links && !!links.find(link => link.rel === 'next'),\n          hasPrev: links && !!links.find(link => link.rel === 'prev'),\n          totalCount: action.payload.data.totalCount,\n          currentPage: action.meta.currentPage\n        };\n      } else {\n        return { ...state };\n      }\n    case SUCCESS(ACTION_TYPES.GET_PATIENT):\n      return {\n        ...state,\n        patient: action.payload.data\n      };\n    case SUCCESS(ACTION_TYPES.GET_PATIENT_RELATIONSHIPS):\n      return {\n        ...state,\n        patientRelationships: action.payload.data.results\n      };\n    case SUCCESS(ACTION_TYPES.GET_PATIENT_LINKED_REGIMENS):\n      return {\n        ...state,\n        patientLinkedRegimens: action.payload.data\n      };\n    case ACTION_TYPES.RESET_PATIENTS:\n      return {\n        ...initialState\n      };\n    default:\n      return state;\n  }\n};\n\n// actions\nexport const search = (q, page = 0, limit = DEFAULT_PAGE_SIZE) => {\n  const requestUrl = `/openmrs/ws/rest/v1/patient?q=${q || ''}&startIndex=${page * limit}&limit=${limit}&v=full&totalCount=true`;\n  return {\n    type: ACTION_TYPES.SEARCH_PATIENTS,\n    payload: axios.get(requestUrl),\n    meta: {\n      q,\n      currentPage: page\n    }\n  };\n};\n\nconst PATIENT_CUSTOM_V = `patientId,uuid,identifiers,person:(gender,age,birthdate,birthdateEstimated,preferredAddress,preferredName,attributes),attributes:(value,attributeType:(name))`;\n\nexport const getPatient = id => {\n  const requestUrl = `/openmrs/ws/rest/v1/patient/${id}?v=custom:(${PATIENT_CUSTOM_V})`;\n  return {\n    type: ACTION_TYPES.GET_PATIENT,\n    payload: axios.get(requestUrl)\n  };\n};\n\nexport const getPersonRelationships = id => {\n  const requestUrl = `/openmrs/ws/rest/v1/relationship?v=default&person=${id}`;\n  return {\n    type: ACTION_TYPES.GET_PATIENT_RELATIONSHIPS,\n    payload: axios.get(requestUrl)\n  };\n};\n\nexport const getPatientLinkedRegimens = () => {\n  const requestUrl = '/openmrs/ws/cfl/regimens/patient-info';\n  return {\n    type: ACTION_TYPES.GET_PATIENT_LINKED_REGIMENS,\n    payload: axios.get(requestUrl)\n  };\n};\n\nexport const reset = () => ({\n  type: ACTION_TYPES.RESET_PATIENTS\n});\n\nexport default reducer;\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { reset, searchConcepts } from '../../redux/reducers/concept';\nimport _ from 'lodash';\nimport { Button, FormGroup } from 'reactstrap';\nimport './Conditions.scss';\nimport { FormattedMessage, injectIntl } from 'react-intl';\nimport { getSettingByQuery } from '../../redux/reducers/setttings';\nimport Select from 'react-select/creatable';\nimport '../Inputs.scss';\nimport { DATE_FORMAT, isoDateString } from '../../shared/util/date-util';\nimport DatePicker from 'react-datepicker';\nimport { RouteComponentProps, withRouter } from 'react-router-dom';\nimport { getCondition, saveCondition } from '../../redux/reducers/condition';\nimport queryString from 'query-string';\nimport { addBreadcrumbs, resetBreadcrumbs } from '../../redux/reducers/breadcrumbs';\nimport { PATIENT_PAGE_URL } from '../../shared/constants/openmrs';\nimport { STATUS_ACTIVE, STATUS_INACTIVE } from '../../shared/constants/condition';\nimport { getPatient } from '../../redux/reducers/patient';\nimport { successToast } from '@bit/soldevelo-omrs.cfl-components.toast-handler';\n\nexport interface IConditionsProps extends StateProps, DispatchProps, RouteComponentProps<{ patientUuid?: string }> {\n  intl: any;\n}\n\nexport interface IConditionsState {\n  conceptQuery: string;\n  concept: object | null;\n  conceptInput: string;\n  onsetDate: any;\n  endDate: any;\n  active: boolean;\n}\n\nclass Condition extends React.Component<IConditionsProps, IConditionsState> {\n  state = {\n    conceptQuery: '',\n    concept: null,\n    conceptInput: '',\n    onsetDate: null,\n    endDate: null,\n    active: true\n  };\n\n  loadOptions = _.debounce(() => {\n    this.searchConcepts();\n  }, 500);\n\n  setConceptInput = value => {\n    this.setState({\n      conceptQuery: value,\n      conceptInput: value\n    });\n    this.loadOptions();\n  };\n\n  onConceptChange = concept => {\n    this.setState({\n      concept\n    });\n  };\n\n  conditionId = () => {\n    const params = queryString.parse(this.props.location.search);\n    return params.conditionId;\n  };\n\n  componentDidMount() {\n    this.props.reset();\n    this.props.getSettingByQuery('coreapps.conditionListClasses');\n    const conditionId = this.conditionId();\n    if (!!conditionId) {\n      this.props.getCondition(conditionId);\n    }\n    const id = this.props.match.params.patientUuid;\n    this.props.getPatient(id);\n  }\n\n  componentDidUpdate(prevProps: Readonly<IConditionsProps>, prevState: Readonly<IConditionsState>, snapshot?: any) {\n    const { condition, patient, match, conditionUpdated, conceptListClasses } = this.props;\n    const id = match.params.patientUuid;\n    if (prevProps.condition !== condition && !!condition) {\n      const { concept, status, onSetDate, endDate } = condition;\n      this.setState({\n        concept: concept && {\n          label: concept.name,\n          value: concept.uuid\n        },\n        active: status === STATUS_ACTIVE,\n        onsetDate: onSetDate && new Date(onSetDate),\n        endDate: endDate && new Date(endDate)\n      });\n    }\n    if (prevProps.conceptListClasses !== conceptListClasses) {\n      this.props.searchConcepts('', conceptListClasses);\n    }\n    if (!!patient && patient !== prevProps.patient) {\n      this.props.resetBreadcrumbs();\n      this.props.addBreadcrumbs([\n        {\n          label: patient.person.preferredName.display,\n          url: `${PATIENT_PAGE_URL}?patientId=${id}`,\n          order: 1\n        }\n      ]);\n    }\n    if (conditionUpdated && !prevProps.conditionUpdated) {\n      successToast(this.props.intl.formatMessage({ id: 'conditions.success' }));\n      this.props.history.push(`/conditions/${this.props.match.params.patientUuid}`);\n    }\n  }\n\n  searchConcepts = () => {\n    if (this.state.conceptInput.length > 0 && this.state.conceptInput !== this.props.conceptQuery) {\n      this.props.searchConcepts(this.state.conceptInput, this.props.conceptListClasses);\n    }\n  };\n\n  onConceptFocus = () => {\n    const { concept } = this.state;\n    if (!!concept) {\n      this.setConceptInput(concept.label);\n    }\n  };\n\n  onQueryChange = conceptQuery => {\n    this.setConceptInput(conceptQuery);\n    this.loadOptions();\n  };\n\n  conceptOptions = () => {\n    const { concepts } = this.props;\n    const options = concepts.map(concept => ({\n      value: concept.concept.uuid,\n      label: concept.display\n    }));\n    return options;\n  };\n\n  onOnsetDateChange = onsetDate => {\n    this.setState({\n      onsetDate\n    });\n  };\n\n  onEndDateChange = endDate => {\n    this.setState({\n      endDate\n    });\n  };\n\n  onActiveChange = active => () => {\n    this.setState({\n      active\n    });\n  };\n\n  cancel = () => {\n    this.props.history.push(`/conditions/${this.props.match.params.patientUuid}`);\n  };\n\n  save = () => {\n    if (this.state.concept) {\n      const conditionId = this.conditionId();\n      const condition = !!conditionId ? { ...this.props.condition } : {};\n      condition.status = this.state.active ? STATUS_ACTIVE : STATUS_INACTIVE;\n      condition.patientUuid = this.props.match.params.patientUuid;\n      if (this.state.concept?.__isNew__) {\n        condition.concept = { uuid: '', name: '', shortName: '' };\n        condition.conditionNonCoded = this.state.concept.label;\n      } else {\n        condition.concept = { ...(condition.concept || {}), uuid: this.state.concept.value };\n      }\n      condition.onSetDate = isoDateString(this.state.onsetDate || new Date());\n      condition.endDate = !this.state.active ? isoDateString(this.state.endDate) : '';\n      condition.voided = false;\n      if (!condition.additionalDetail) {\n        condition.additionalDetail = '';\n      }\n      if (!condition.endReason) {\n        condition.endReason = { shortName: '' };\n      }\n      this.props.saveCondition(condition);\n    }\n  };\n\n  render() {\n    const { intl } = this.props;\n    const conditionId = this.conditionId();\n    return (\n      <div className=\"condition\">\n        <h2>\n          <FormattedMessage id={!!conditionId ? 'manageCondition.editCondition' : 'manageCondition.addNewCondition'} />\n        </h2>\n        <div className=\"error\">{this.props.error}</div>\n        <div className=\"inner-content\">\n          <div className=\"d-flex\">\n            <div className=\"col-12 mt-3\">\n              <div className=\"input-container\">\n                <Select\n                  options={this.conceptOptions()}\n                  onInputChange={this.onQueryChange}\n                  onChange={this.onConceptChange}\n                  className=\"flex-fill concept\"\n                  classNamePrefix=\"default-select\"\n                  placeholder={intl.formatMessage({ id: 'manageCondition.condition' })}\n                  value={this.state.concept}\n                  inputValue={this.state.conceptInput}\n                  onFocus={this.onConceptFocus}\n                  isDisabled={!!conditionId}\n                />\n                {this.state.concept && <span className=\"placeholder\">{intl.formatMessage({ id: 'manageCondition.condition' })}</span>}\n              </div>\n            </div>\n          </div>\n          <div className=\"d-flex flex-wrap\">\n            <div className={this.state.active ? 'col-12' : 'col-12 col-sm-6'}>\n              <div className=\"input-container\">\n                <DatePicker\n                  placeholderText={intl.formatMessage({ id: 'manageCondition.onsetDate' })}\n                  selected={this.state.onsetDate}\n                  className=\"form-control\"\n                  onChange={this.onOnsetDateChange}\n                  peekNextMonth\n                  showMonthDropdown\n                  showYearDropdown\n                  dropdownMode=\"select\"\n                  dateFormat={DATE_FORMAT}\n                />\n                {this.state.onsetDate && <span className=\"placeholder\">{intl.formatMessage({ id: 'manageCondition.onsetDate' })}</span>}\n              </div>\n            </div>\n            <div className=\"col-12 col-sm-6\">\n              {this.state.active === false && (\n                <div className=\"input-container\">\n                  <DatePicker\n                    placeholderText={intl.formatMessage({ id: 'manageCondition.endDate' })}\n                    selected={this.state.endDate}\n                    className=\"form-control\"\n                    onChange={this.onEndDateChange}\n                    peekNextMonth\n                    showMonthDropdown\n                    showYearDropdown\n                    dropdownMode=\"select\"\n                    dateFormat={DATE_FORMAT}\n                  />\n                  {this.state.onsetDate && <span className=\"placeholder\">{intl.formatMessage({ id: 'manageCondition.endDate' })}</span>}\n                </div>\n              )}\n            </div>\n          </div>\n          <div>\n            <div className=\"col-12\">\n              <FormGroup check inline key=\"button-active\" className=\"mb-2\">\n                <Button onClick={this.onActiveChange(true)} className={`select-button w-100 ${this.state.active === true ? 'active' : ''}`}>\n                  <span>{intl.formatMessage({ id: 'conditions.active' })}</span>\n                </Button>\n              </FormGroup>\n              <FormGroup check inline key=\"button-inactive\" className=\"mb-2\">\n                <Button\n                  onClick={this.onActiveChange(false)}\n                  className={`select-button w-100 ${this.state.active === false ? 'active' : ''}`}\n                >\n                  <span>{intl.formatMessage({ id: 'conditions.inactive' })}</span>\n                </Button>\n              </FormGroup>\n            </div>\n          </div>\n        </div>\n        <div className=\"mt-5\">\n          <div className=\"d-inline\">\n            <Button className=\"cancel\" onClick={this.cancel}>\n              <span>{intl.formatMessage({ id: 'manageCondition.cancel' })}</span>\n            </Button>\n          </div>\n          <div className=\"d-inline pull-right confirm-button-container\">\n            <Button className=\"save\" onClick={this.save} disabled={!this.state.concept}>\n              <FormattedMessage id=\"common.save\" />\n            </Button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = ({ concept, settings, condition, cflPatient }) => ({\n  concepts: concept.concepts,\n  error: concept.errorMessage,\n  conceptListClasses: settings.setting?.value,\n  conceptQuery: concept.query,\n  condition: condition.condition,\n  conditionUpdated: condition.conditionUpdated,\n  patient: cflPatient.patient\n});\n\nconst mapDispatchToProps = {\n  searchConcepts,\n  reset,\n  getSettingByQuery,\n  getCondition,\n  addBreadcrumbs,\n  resetBreadcrumbs,\n  getPatient,\n  saveCondition\n};\n\ntype StateProps = ReturnType<typeof mapStateToProps>;\ntype DispatchProps = typeof mapDispatchToProps;\n\nexport default connect(mapStateToProps, mapDispatchToProps)(injectIntl(withRouter(Condition)));\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABHNCSVQICAgIfAhkiAAAAjpJREFUOI2l1M9LKlEUwPGv907iMAmpkAudchUYuGiXQwtpduFfK25cFKJEbaKWQmGBUoRI+GtmGrXb4r3x6Rvr+egs59774Zxzz52IUkqxFEopHh8fub+/x/d9lFJIKdnd3aVQKBCLxfguIstgp9Ph7u6O8Xi8drMQAtM0OT4+RgjxPdhqtbi9vQVga2uLXC5HIpFASonjODw/P9Pr9QDY2dnBtm2i0eh6sNvt0mw2ATBNE8uy1mbQ6XS4vr5mNpuRTqcplUqhfUIptcgsm81ycnLyZTmmaVIulxFC8Pr6ytPTU7gt7Xab8XiMpmlYlrUWWg5d1zk4OCBoUwh8eHgAIJfLIaX8JwhwdHSElJLBYBC6QOH7PgCJRGIjLIhgfIbD4SoYTM2m2S0O/u7zfD5f/R5AjuP8FxhUpuv6KphKpQB4eXnZGOv3+7y/v6NpWqhVolAoIISg1+vR7XY3Ai8vLwHY398PtUoYhkEmkwHg6uoK13W/xZrNJpPJBIB8Ph9aFwDFYpF4PM5sNqNSqXBzc8Nf/wze3t6oVCqLKqSUax/A4i17nkej0aDf7y8OxGIxhBBMp1M8z/uThRB8fHyg6zq2bROPx8Mg/BqBdrtNq9UKDayUkr29PfL5PJFIhPPzczzPwzAMTk9P2d7eDoPLMRgMGI1GzOdzdF0nmUyiadrKer1ex3EcDMPAtm0Mw/ga3CRGoxEXFxc4jkM0GuXs7OxnYIDWajWm0ymapv0cBHBdl2q1yuHhIZ/WPwvNTaPpawAAAABJRU5ErkJggg==\"","// patient/person's defaultFields\nexport const PATIENT_IDENTIFIER = 'patientIdentifier';\nexport const OPENMRS_ID = 'OpenMRS ID';\nexport const DISPLAY = 'display';\nexport const GENDER = 'gender';\nexport const AGE = 'age';\nexport const BIRTHDATE = 'birthdate';\nexport const DEATH_DATE = 'deathDate';\nexport const PHONE_NUMBER = 'phoneNumber';\nexport const PERSON_LANGUAGE = 'personLanguage';\nexport const PERSON_IDENTIFIER = 'personIdentifier';\nexport const GIVEN_NAME = 'givenName';\nexport const MIDDLE_NAME = 'middleName';\nexport const FAMILY_NAME = 'familyName';\n\n// attribute types\nexport const TELEPHONE_NUMBER_ATTRIBUTE_TYPE = 'Telephone Number';\nexport const PERSON_LANGUAGE_ATTRIBUTE_TYPE = 'personLanguage';\nexport const LOCATION_ATTRIBUTE_TYPE = 'LocationAttribute';\nexport const PERSON_IDENTIFIER_ATTRIBUTE_TYPE = 'Person identifier';\n\n// table column defaults\nexport const DEFAULT_FIND_CAREGIVER_TABLE_COLUMNS = `${PATIENT_IDENTIFIER},${DISPLAY},${GENDER},${AGE},${BIRTHDATE},${PHONE_NUMBER}`;\n\n// patient/person's gender\nexport const GENDER_DICT = { M: 'Male', F: 'Female' };\n\nexport const DEFAULT_COLUMN_VALUE = '';\n","import { DEFAULT_COLUMN_VALUE, DISPLAY } from '../constants/patient';\n\nexport const extractValue = prop => {\n  if (!prop) {\n    return DEFAULT_COLUMN_VALUE;\n  } else if (Array.isArray(prop)) {\n    return prop[0][DISPLAY] || DEFAULT_COLUMN_VALUE;\n  } else if (typeof prop === 'object') {\n    return prop[DISPLAY] || DEFAULT_COLUMN_VALUE;\n  } else {\n    return prop;\n  }\n};\n\nexport const extractAttribute = (entity, type) => {\n  if (!entity) {\n    return DEFAULT_COLUMN_VALUE;\n  }\n  const attr = entity.attributes && entity.attributes.find(a => a.attributeType[DISPLAY].toLowerCase() === type.toLowerCase());\n  return (attr && attr.value) || DEFAULT_COLUMN_VALUE;\n};\n\nexport const extractAttributes = entity => {\n  const attributes = {};\n  entity &&\n    entity.attributes &&\n    entity.attributes.forEach(attr => (attributes[attr.attributeType[DISPLAY]] = attr.value || DEFAULT_COLUMN_VALUE));\n  return attributes;\n};\n\nexport const extractIdentifier = (entity, type) => {\n  if (!entity) {\n    return DEFAULT_COLUMN_VALUE;\n  }\n  const identifier = entity.identifiers && entity.identifiers.find(id => id.identifierType[DISPLAY].toLowerCase() === type.toLowerCase());\n  return (identifier && identifier.identifier) || DEFAULT_COLUMN_VALUE;\n};\n\nexport const extractIdentifiers = entity => {\n  const identifiers = {};\n  entity &&\n    entity.identifiers &&\n    entity.identifiers.forEach(id => (identifiers[id.identifierType[DISPLAY]] = id.identifier || DEFAULT_COLUMN_VALUE));\n  return identifiers;\n};\n","import {\n  BIRTHDATE,\n  DEATH_DATE,\n  FAMILY_NAME,\n  GIVEN_NAME,\n  MIDDLE_NAME,\n  PERSON_IDENTIFIER,\n  PERSON_IDENTIFIER_ATTRIBUTE_TYPE,\n  PERSON_LANGUAGE,\n  PERSON_LANGUAGE_ATTRIBUTE_TYPE,\n  PHONE_NUMBER,\n  TELEPHONE_NUMBER_ATTRIBUTE_TYPE,\n  GENDER,\n  GENDER_DICT\n} from '../constants/patient';\nimport { extractAttribute, extractValue } from './omrs-entity-util';\nimport { formatDate } from './date-util';\nimport { formatPhoneNumberIntl } from 'react-phone-number-input';\n\nconst PLUS_SIGN = '+';\n\nexport const columnContent = (person, column, intl) => {\n  switch (column) {\n    case BIRTHDATE:\n      return person && person.birthdate && formatDate(intl, new Date(person.birthdate));\n    case DEATH_DATE:\n      return person && person.deathDate && formatDate(intl, new Date(person.deathDate));\n    case GIVEN_NAME:\n      return person.preferredName && person.preferredName.givenName;\n    case MIDDLE_NAME:\n      return person.preferredName && person.preferredName.middleName;\n    case FAMILY_NAME:\n      return person.preferredName && person.preferredName.familyName;\n    case PERSON_IDENTIFIER:\n      return extractAttribute(person, PERSON_IDENTIFIER_ATTRIBUTE_TYPE);\n    case PHONE_NUMBER: {\n      const phoneNumber = extractAttribute(person, TELEPHONE_NUMBER_ATTRIBUTE_TYPE);\n      return formatPhoneNumberIntl(getPhoneNumberWithPlusSign(phoneNumber)) || phoneNumber;\n    }\n    case PERSON_LANGUAGE:\n      return extractAttribute(person, PERSON_LANGUAGE_ATTRIBUTE_TYPE);\n    case GENDER:\n      return person && (GENDER_DICT[person.gender] || person.gender);\n    default:\n      return extractValue(person && person[column]);\n  }\n};\n\nexport const getPhoneNumberWithPlusSign = phoneNumber => phoneNumber && PLUS_SIGN + phoneNumber;\n","import { BIRTHDATE, TELEPHONE_NUMBER_ATTRIBUTE_TYPE } from '../constants/patient';\nimport { extractAttribute, extractAttributes, extractIdentifier, extractIdentifiers } from './omrs-entity-util';\nimport { getPhoneNumberWithPlusSign } from './person-util';\nimport { IPatient } from '../models/patient';\nimport { formatDate } from './date-util';\nimport { formatPhoneNumberIntl } from 'react-phone-number-input';\n\nexport const columnContent = (patient, column, intl) => {\n  const { person } = patient;\n  const { preferredAddress, preferredName } = person;\n  const attributesValue = extractAttribute(person, column);\n  const personValue = person[column];\n\n  if (attributesValue) {\n    return column === TELEPHONE_NUMBER_ATTRIBUTE_TYPE\n      ? formatPhoneNumberIntl(getPhoneNumberWithPlusSign(attributesValue))\n        ? getPhoneNumberWithPlusSign(attributesValue)\n        : attributesValue\n      : attributesValue;\n  } else if (personValue) {\n    return column === BIRTHDATE ? formatDate(intl, new Date(personValue)) : personValue;\n  } else {\n    return preferredName?.[column] || preferredAddress?.[column] || extractIdentifier(patient, column);\n  }\n};\n\nexport const extractPatientOrPersonData = patient => {\n  const person = patient.person || patient;\n  const { preferredName, preferredAddress, gender, uuid, personId } = person;\n  const { givenName, middleName, familyName } = preferredName;\n  const { address1, address2, cityVillage, stateProvince, country, postalCode } = preferredAddress || {};\n  return {\n    patientId: patient.patientId || uuid,\n    uuid: patient.uuid,\n    personId,\n    givenName,\n    middleName,\n    familyName,\n    gender,\n    birthdate: !!person.birthdate ? new Date(person.birthdate) : null,\n    address1,\n    address2,\n    cityVillage,\n    stateProvince,\n    country,\n    postalCode,\n    ...extractAttributes(person),\n    ...extractIdentifiers(patient)\n  } as IPatient;\n};\n\nexport const extractPersonRelationships = (patientId, personRelationships) =>\n  personRelationships.map(relationship => {\n    const { personA, personB, relationshipType } = relationship;\n    const isPersonA = personA.uuid === patientId;\n    return {\n      relationshipType: isPersonA ? relationshipType.uuid + '-B' : relationshipType.uuid + '-A',\n      otherPerson: {\n        label: isPersonA ? personB.display : personA.display,\n        value: isPersonA ? personB.uuid : personA.uuid\n      }\n    };\n  });\n","export const SEARCH_INPUT_DELAY = 500;\nexport const SEARCH_INPUT_MIN_CHARS = 3;\nexport const ZERO = 0;\nexport const ONE = 1;\nexport const TEN = 10;\nexport const HUNDRED = 100;\nexport const EMPTY_STRING = '';\nexport const DEFAULT_TIME_FORMAT = 'HH:mm';\nexport const STRING_TRUE = 'true';\nexport const STRING_FALSE = 'false';\n","import { FormattedMessage } from 'react-intl';\nimport React from 'react';\n\nexport const helperText = (query, loading, totalCount) => {\n  if (totalCount > 0) {\n    return (\n      <span>\n        {totalCount} <FormattedMessage id=\"table.recordsFound\" />\n      </span>\n    );\n  } else if (query.length < 3) {\n    return <FormattedMessage id=\"table.enterSearch\" />;\n  } else if (!loading && totalCount === 0) {\n    return <FormattedMessage id=\"table.noRecords\" />;\n  }\n};\n","import './Table.scss';\nimport './InfiniteTable.scss';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { Spinner, Table } from 'reactstrap';\nimport React from 'react';\nimport _ from 'lodash';\nimport InfiniteScroll from 'react-infinite-scroll-component';\nimport { IColumnConfiguration } from '../../shared/models/columns-configuration';\n\nexport interface InfiniteTableProps {\n  columns: string[] | IColumnConfiguration[];\n  entities: object[];\n  columnContent: any;\n  hasNext: boolean;\n  currentPage: number;\n  switchPage: any;\n  getRecordLink?: any;\n}\n\nconst InfiniteTable = (props: InfiniteTableProps) => {\n  const intl = useIntl();\n  const handleRowClick = entity => {\n    if (!!props.getRecordLink) {\n      window.location.href = props.getRecordLink(entity);\n    }\n  };\n  const isColumnObject = props.columns[0]?.constructor === Object;\n\n  return (\n    <InfiniteScroll\n      dataLength={props.entities.length}\n      next={() => props.switchPage(props.currentPage + 1)}\n      hasMore={props.hasNext}\n      loader={\n        <div className=\"spinner\">\n          <Spinner />\n        </div>\n      }\n    >\n      <Table borderless striped responsive className=\"table\">\n        <thead>\n          <tr>\n            {_.map(props.columns, (column, i) => (\n              <th key={i}>{isColumnObject ? column.label : <FormattedMessage id={`columnNames.${column}`} />}</th>\n            ))}\n          </tr>\n        </thead>\n        <tbody>\n          {_.map(props.entities, (entity, i) => (\n            <tr key={i} onClick={() => handleRowClick(entity)}>\n              {_.map(props.columns, column => {\n                const columnValue = isColumnObject ? column.value : column;\n\n                return (\n                  <td key={columnValue} className={!!props.getRecordLink ? 'td-clickable' : undefined}>\n                    {props.columnContent(entity, columnValue, intl)}\n                  </td>\n                );\n              })}\n            </tr>\n          ))}\n        </tbody>\n      </Table>\n    </InfiniteScroll>\n  );\n};\n\nexport default InfiniteTable;\n","import { AGE, BIRTHDATE, DISPLAY, GENDER, OPENMRS_ID, TELEPHONE_NUMBER_ATTRIBUTE_TYPE } from './patient';\n\nexport const RETURN_LOCATION = '/openmrs/adminui/metadata/configureMetadata.page';\nexport const COLUMNS_CONFIGURATION_SETTING_KEY = 'cflui.findPatientColumnsConfiguration';\nexport const DEFAULT_COLUMN_CONFIGURATION = { label: '', value: '', isValid: true };\nexport const FIRST_COLUMN_NAME_LETTERS_REGEX = /\\w\\S*/g;\nexport const ADJACENT_LOWER_AND_UPPER_LETTERS_REGEX = /([a-z])([A-Z])/g;\nexport const FIXED_COLUMNS = [\n  { label: 'Identifier', value: OPENMRS_ID },\n  { label: 'Name', value: DISPLAY },\n  { label: 'Age', value: AGE }\n];\nexport const DEFAULT_COLUMNS = [\n  ...FIXED_COLUMNS,\n  { label: 'Gender', value: GENDER },\n  { label: 'Birthdate', value: BIRTHDATE },\n  { label: TELEPHONE_NUMBER_ATTRIBUTE_TYPE, value: TELEPHONE_NUMBER_ATTRIBUTE_TYPE }\n];\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { reset, search } from '../../redux/reducers/patient';\nimport _ from 'lodash';\nimport { Form, FormGroup, Input, Spinner } from 'reactstrap';\nimport './FindPatient.scss';\nimport { FormattedMessage, injectIntl } from 'react-intl';\nimport searchIcon from '../../assets/img/search.png';\nimport { columnContent } from '../../shared/util/patient-util';\nimport { SEARCH_INPUT_DELAY, SEARCH_INPUT_MIN_CHARS } from '../../shared/constants/input';\nimport { helperText } from '../../shared/util/table-util';\nimport { PATIENT_PAGE_URL } from '../../shared/constants/openmrs';\nimport InfiniteTable from '../common/InfiniteTable';\nimport { COLUMNS_CONFIGURATION_SETTING_KEY, DEFAULT_COLUMNS } from '../../shared/constants/columns-configuration';\nimport { getSettingByQuery } from '../../redux/reducers/setttings';\n\nexport interface IPatientsProps extends StateProps, DispatchProps {\n  intl: any;\n}\n\nexport interface IPatientsState {\n  query: string;\n  page: number;\n}\n\nclass FindPatient extends React.Component<IPatientsProps, IPatientsState> {\n  state = {\n    query: '',\n    page: 0\n  };\n\n  searchAfterDelay = _.debounce(() => {\n    if (this.state.query.length >= SEARCH_INPUT_MIN_CHARS) {\n      this.props.search(this.state.query, this.state.page);\n    }\n  }, SEARCH_INPUT_DELAY);\n\n  componentDidMount() {\n    this.props.reset();\n    this.props.getSettingByQuery(COLUMNS_CONFIGURATION_SETTING_KEY);\n  }\n\n  search = () => {\n    if (this.state.query.length >= SEARCH_INPUT_MIN_CHARS) {\n      this.props.search(this.state.query, this.state.page);\n    }\n  };\n\n  onQueryChange = event => {\n    this.setState({\n      query: event.target.value,\n      page: 0\n    });\n    this.searchAfterDelay();\n  };\n\n  onSearchClick = e => {\n    e.preventDefault();\n    this.searchAfterDelay.cancel();\n    this.setState({\n      page: 0\n    });\n    this.search();\n  };\n\n  switchPage = page =>\n    this.setState(\n      {\n        page\n      },\n      this.search\n    );\n\n  getRecordLink = entity => `${PATIENT_PAGE_URL}?patientId=${entity.uuid}`;\n\n  render() {\n    return (\n      <div className=\"find-patient\">\n        <h2>\n          <FormattedMessage id=\"findPatient.title\" />\n        </h2>\n        <div className=\"error\">{this.props.error}</div>\n        <div className=\"search-section\">\n          <Form onSubmit={this.onSearchClick}>\n            <FormGroup className=\"patient-search\">\n              <img src={searchIcon} alt=\"search\" className=\"search-icon\" />\n              <Input\n                id=\"search-patient\"\n                placeholder={this.props.intl.formatMessage({\n                  id: 'findPatient.searchInputPlaceholder'\n                })}\n                value={this.state.query}\n                onChange={this.onQueryChange}\n                className=\"search-input\"\n              />\n            </FormGroup>\n          </Form>\n          <div className=\"patient-table\">\n            <div className=\"helper-text\">\n              {this.props.loading ? (\n                <Spinner color=\"dark\" size=\"sm\" />\n              ) : (\n                helperText(this.state.query, this.props.loading, this.props.totalCount)\n              )}\n            </div>\n            {this.props.totalCount > 0 && (\n              <InfiniteTable\n                columns={this.props.tableColumns}\n                entities={this.props.patients}\n                columnContent={columnContent}\n                hasNext={this.props.hasNext}\n                currentPage={this.props.currentPage}\n                switchPage={this.switchPage}\n                getRecordLink={this.getRecordLink}\n              />\n            )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = ({ cflPatient, settings: { setting } }) => ({\n  patients: cflPatient.patients,\n  loading: cflPatient.loading,\n  error: cflPatient.errorMessage,\n  hasNext: cflPatient.hasNext,\n  hasPrev: cflPatient.hasPrev,\n  currentPage: cflPatient.currentPage,\n  totalCount: cflPatient.totalCount,\n  tableColumns: setting?.value ? JSON.parse(setting.value) : DEFAULT_COLUMNS\n});\n\nconst mapDispatchToProps = { search, reset, getSettingByQuery };\n\ntype StateProps = ReturnType<typeof mapStateToProps>;\ntype DispatchProps = typeof mapDispatchToProps;\n\nexport default connect(mapStateToProps, mapDispatchToProps)(injectIntl(FindPatient));\n","export const PRIVILEGES = {\n  EDIT_PATIENTS: 'Edit Patients',\n  GET_PEOPLE: 'Get People',\n  GET_PATIENTS: 'Get Patients',\n  ADD_PATIENTS: 'Add Patients'\n};\n","import axios from 'axios';\n\nimport { FAILURE, REQUEST, SUCCESS } from '../action-type.util';\n\nexport const ACTION_TYPES = {\n  SEARCH_PEOPLE: 'cfl-people/SEARCH_PEOPLE',\n  RESET_PEOPLE: 'cfl-people/RESET_PEOPLE'\n};\n\nconst initialState = {\n  loading: false,\n  people: [],\n  errorMessage: '',\n  totalCount: 0,\n  q: ''\n};\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case REQUEST(ACTION_TYPES.SEARCH_PEOPLE):\n      return {\n        ...state,\n        loading: true,\n        q: action.meta.q\n      };\n    case FAILURE(ACTION_TYPES.SEARCH_PEOPLE):\n      return {\n        ...initialState,\n        errorMessage: action.payload.message\n      };\n    case SUCCESS(ACTION_TYPES.SEARCH_PEOPLE):\n      const people = action.payload.data.results;\n      if (action.meta.q === state.q) {\n        return {\n          ...initialState,\n          people,\n          totalCount: people.length\n        };\n      } else {\n        return {\n          ...state\n        };\n      }\n    case ACTION_TYPES.RESET_PEOPLE:\n      return {\n        ...initialState\n      };\n    default:\n      return state;\n  }\n};\n\n// actions\nexport const search = q => {\n  const requestUrl = `/openmrs/ws/cfl/people?query=${q || ''}`;\n  return {\n    type: ACTION_TYPES.SEARCH_PEOPLE,\n    payload: axios.get(requestUrl),\n    meta: {\n      q\n    }\n  };\n};\n\nexport const reset = () => ({\n  type: ACTION_TYPES.RESET_PEOPLE\n});\n\nexport default reducer;\n","import {\n  BIRTHDATE,\n  DEATH_DATE,\n  DEFAULT_COLUMN_VALUE,\n  DISPLAY,\n  FAMILY_NAME,\n  GIVEN_NAME,\n  PATIENT_IDENTIFIER,\n  PERSON_IDENTIFIER,\n  PERSON_LANGUAGE,\n  PERSON_LANGUAGE_ATTRIBUTE_TYPE,\n  PHONE_NUMBER,\n  TELEPHONE_NUMBER_ATTRIBUTE_TYPE,\n  GENDER,\n  GENDER_DICT\n} from '../constants/patient';\nimport { extractValue } from './omrs-entity-util';\nimport { formatDate } from './date-util';\nimport { formatPhoneNumberIntl } from 'react-phone-number-input';\nimport { getPhoneNumberWithPlusSign } from '../../shared/util/person-util';\n\nexport const extractAttribute = (entity, type) => {\n  if (!entity) {\n    return DEFAULT_COLUMN_VALUE;\n  }\n  const attr = entity.attributes && entity.attributes.find(a => a.name.toLowerCase() === type.toLowerCase());\n  return (attr && attr.value) || DEFAULT_COLUMN_VALUE;\n};\n\nexport const columnContent = (person, column, intl) => {\n  const names = person.personName && person.personName.split(' ');\n  switch (column) {\n    case BIRTHDATE:\n      return person && person.birthdate && formatDate(intl, new Date(person.birthdate));\n    case DEATH_DATE:\n      return person && person.deathDate && formatDate(intl, new Date(person.deathDate));\n    case GIVEN_NAME:\n      return names && names[0];\n    case FAMILY_NAME:\n      return names && (names.length > 1 ? names[1] : DEFAULT_COLUMN_VALUE);\n    case DISPLAY:\n      return person.personName;\n    case PERSON_IDENTIFIER:\n    case PATIENT_IDENTIFIER:\n      return person && (person.patientIdentifier || person.personIdentifier);\n    case PHONE_NUMBER: {\n      const phoneNumber = extractAttribute(person, TELEPHONE_NUMBER_ATTRIBUTE_TYPE);\n      return formatPhoneNumberIntl(getPhoneNumberWithPlusSign(phoneNumber)) || phoneNumber;\n    }\n    case PERSON_LANGUAGE:\n      return extractAttribute(person, PERSON_LANGUAGE_ATTRIBUTE_TYPE);\n    case GENDER:\n      return person && (GENDER_DICT[person.gender] || person.gender);\n    default:\n      return extractValue(person && person[column]);\n  }\n};\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { reset, search } from '../../redux/reducers/cfl-people';\nimport _ from 'lodash';\nimport { Form, FormGroup, Input, Spinner } from 'reactstrap';\nimport './FindCaregiver.scss';\nimport { FormattedMessage, injectIntl } from 'react-intl';\nimport searchIcon from '../../assets/img/search.png';\nimport { columnContent } from '../../shared/util/cfl-person-util';\nimport { DEFAULT_FIND_CAREGIVER_TABLE_COLUMNS } from '../../shared/constants/patient';\nimport { SEARCH_INPUT_DELAY, SEARCH_INPUT_MIN_CHARS } from '../../shared/constants/input';\nimport { DEFAULT_PAGE_SIZE, pageOf } from '../../redux/page.util';\nimport { helperText } from '../../shared/util/table-util';\nimport { PATIENT_PAGE_URL } from '../../shared/constants/openmrs';\nimport InfiniteTable from '../common/InfiniteTable';\n\nexport interface ICaregiversProps extends StateProps, DispatchProps {\n  intl: any;\n}\n\nexport interface ICaregiversState {\n  query: string;\n  page: number;\n}\n\nclass FindCaregiver extends React.Component<ICaregiversProps, ICaregiversState> {\n  state = {\n    query: '',\n    page: 0\n  };\n\n  searchAfterDelay = _.debounce(e => {\n    if (this.state.query.length >= SEARCH_INPUT_MIN_CHARS) {\n      this.props.search(this.state.query);\n    }\n  }, SEARCH_INPUT_DELAY);\n\n  componentDidMount() {\n    this.props.reset();\n  }\n\n  search = () => {\n    if (this.state.query.length >= SEARCH_INPUT_MIN_CHARS) {\n      this.props.search(this.state.query);\n    }\n  };\n\n  onQueryChange = event => {\n    this.setState({\n      query: event.target.value,\n      page: 0\n    });\n    this.searchAfterDelay();\n  };\n\n  onSearchClick = e => {\n    e.preventDefault();\n    this.searchAfterDelay.cancel();\n    this.setState({\n      page: 0\n    });\n    this.search();\n  };\n\n  switchPage = page =>\n    this.setState({\n      page\n    });\n\n  getRecordLink = entity => `${PATIENT_PAGE_URL}?patientId=${entity.uuid}&dashboard=person`;\n\n  render() {\n    return (\n      <div className=\"find-caregiver\">\n        <h2>\n          <FormattedMessage id=\"findCaregiver.title\" />\n        </h2>\n        <div className=\"error\">{this.props.error}</div>\n        <div className=\"search-section\">\n          <Form onSubmit={this.onSearchClick}>\n            <FormGroup className=\"caregiver-search\">\n              <img src={searchIcon} alt=\"search\" className=\"search-icon\" />\n              <Input\n                id=\"search-caregiver\"\n                placeholder={this.props.intl.formatMessage({\n                  id: 'findCaregiver.searchInputPlaceholder'\n                })}\n                value={this.state.query}\n                onChange={this.onQueryChange}\n                className=\"search-input\"\n              />\n            </FormGroup>\n          </Form>\n          <div className=\"caregiver-table\">\n            <div className=\"helper-text\">\n              {this.props.loading ? (\n                <Spinner color=\"dark\" size=\"sm\" />\n              ) : (\n                helperText(this.state.query, this.props.loading, this.props.totalCount)\n              )}\n            </div>\n            {this.props.totalCount > 0 && (\n              <InfiniteTable\n                columns={this.props.tableColumns.split(',')}\n                // frontend paging as the endpoint has no support for it\n                entities={pageOf(this.props.caregivers, this.state.page)}\n                columnContent={columnContent}\n                hasNext={this.props.totalCount > (this.state.page + 1) * DEFAULT_PAGE_SIZE}\n                currentPage={this.state.page}\n                switchPage={this.switchPage}\n                getRecordLink={this.getRecordLink}\n              />\n            )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = ({ cflPeople, apps }) => ({\n  caregivers: cflPeople.people,\n  loading: cflPeople.loading,\n  error: cflPeople.errorMessage,\n  hasNext: cflPeople.hasNext,\n  hasPrev: cflPeople.hasPrev,\n  currentPage: cflPeople.currentPage,\n  totalCount: cflPeople.totalCount,\n  tableColumns: (apps.findCaregiverTableColumns && apps.findCaregiverTableColumns) || DEFAULT_FIND_CAREGIVER_TABLE_COLUMNS\n});\n\nconst mapDispatchToProps = { search, reset };\n\ntype StateProps = ReturnType<typeof mapStateToProps>;\ntype DispatchProps = typeof mapDispatchToProps;\n\nexport default connect(mapStateToProps, mapDispatchToProps)(injectIntl(FindCaregiver));\n","export default __webpack_public_path__ + \"check.1ac181e2.svg\";","export default __webpack_public_path__ + \"check-circle.6e017b8a.svg\";","export const GENERIC_ERROR_MESSAGE = 'Server error, please try again later.';\n","import axios from 'axios';\n\nimport { FAILURE, REQUEST, SUCCESS } from '../action-type.util';\nimport querystring from 'querystring';\nimport { GENERIC_ERROR_MESSAGE } from '../../shared/constants/error';\n\nexport const ACTION_TYPES = {\n  REGISTER: 'registration/REGISTER',\n  UPDATE_RELATIONSHIPS: 'registration/UPDATE_RELATIONSHIPS',\n  UPDATE_PROFILE: 'registration/UPDATE_PROFILE',\n  GET_PATIENT_IDENTIFIER_TYPES: 'registration/GET_PATIENT_IDENTIFIER_TYPE'\n};\n\nconst initialState = {\n  loading: false,\n  success: false,\n  message: null,\n  errors: [],\n  id: null,\n  patientIdentifierTypes: []\n};\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case REQUEST(ACTION_TYPES.REGISTER):\n    case REQUEST(ACTION_TYPES.UPDATE_PROFILE):\n    case REQUEST(ACTION_TYPES.GET_PATIENT_IDENTIFIER_TYPES):\n      return {\n        ...state,\n        loading: true\n      };\n    case FAILURE(ACTION_TYPES.REGISTER):\n    case FAILURE(ACTION_TYPES.UPDATE_PROFILE):\n      const error = action.payload.response.data?.error;\n      let message = error?.message;\n      message = message?.split('reason: ')[1]?.replace(']', '') || message;\n      return {\n        ...initialState,\n        success: false,\n        loading: false,\n        errors: !!message ? [message] : [GENERIC_ERROR_MESSAGE]\n      };\n    case SUCCESS(ACTION_TYPES.REGISTER):\n    case SUCCESS(ACTION_TYPES.UPDATE_PROFILE):\n      const { data } = action.payload;\n      return {\n        ...state,\n        success: true,\n        loading: false,\n        id: data\n      };\n    case SUCCESS(ACTION_TYPES.GET_PATIENT_IDENTIFIER_TYPES):\n      return {\n        ...state,\n        patientIdentifierTypes: action.payload.data.results,\n        loading: false\n      };\n    default: {\n      return state;\n    }\n  }\n};\n\nconst extractFormData = patient => {\n  const validRelatives = patient.relatives?.filter(relative => !!relative.relationshipType && !!relative.otherPerson);\n  const relationships = validRelatives?.map(relative => ({\n    relationshipType: relative.relationshipType,\n    otherPersonUuid: relative.otherPerson.value\n  }));\n  const formData = {\n    ...patient,\n    relationships\n  };\n  if (!formData.birthdate) {\n    formData.birthdate = null;\n  } else {\n    formData.birthdateEstimated = false;\n    formData.birthdate = formData.birthdate.toISOString().split('T')[0];\n  }\n  return formData;\n};\n\n// actions\nexport const register = patient => {\n  const requestUrl = `/openmrs/ws/cfl/patientRegistration`;\n  const formData = extractFormData(patient);\n  return {\n    type: ACTION_TYPES.REGISTER,\n    payload: axios.post(requestUrl, formData)\n  };\n};\n\nexport const registerPerson = person => {\n  const requestUrl = `/openmrs/ws/cfl/caregiverRegistration`;\n  const formData = extractFormData(person);\n  return {\n    type: ACTION_TYPES.REGISTER,\n    payload: axios.post(requestUrl, formData)\n  };\n};\n\nexport const editPatient = patient => {\n  const requestUrl = `/openmrs/ws/cfl/patientRegistration`;\n  const formData = extractFormData(patient);\n  return {\n    type: ACTION_TYPES.UPDATE_PROFILE,\n    payload: axios.put(requestUrl, formData)\n  };\n};\n\nexport const editPerson = person => {\n  const requestUrl = `/openmrs/ws/cfl/caregiverRegistration`;\n  const formData = extractFormData(person);\n  return {\n    type: ACTION_TYPES.UPDATE_PROFILE,\n    payload: axios.put(requestUrl, formData)\n  };\n};\n\nexport const updateRelationships = person => {\n  const requestUrl = `/openmrs/cfl/field/personRelationship/updateRelationships.action`;\n  const formData = extractFormData(person);\n  return {\n    type: ACTION_TYPES.UPDATE_RELATIONSHIPS,\n    payload: axios.post(requestUrl, querystring.stringify(formData))\n  };\n};\n\nexport const getPatientIdentifierTypes = () => ({\n  type: ACTION_TYPES.GET_PATIENT_IDENTIFIER_TYPES,\n  payload: axios.get('/openmrs/ws/rest/v1/patientidentifiertype?v=default')\n});\n\nexport default reducer;\n","import axios from 'axios';\n\nimport { FAILURE, REQUEST, SUCCESS } from '../action-type.util';\nimport { DEFAULT_PAGE_SIZE } from '../page.util';\n\nexport const ACTION_TYPES = {\n  SEARCH_PEOPLE: 'patient/SEARCH_PEOPLE',\n  RESET_PEOPLE: 'patient/RESET_PEOPLE',\n  GET_PERSON: 'patient/GET_PERSON',\n  GET_PERSON_RELATIONSHIPS: 'patient/GET_PERSON_RELATIONSHIPS'\n};\n\nconst initialState = {\n  loading: false,\n  people: [],\n  errorMessage: '',\n  hasNext: false,\n  hasPrev: false,\n  currentPage: 0,\n  totalCount: 0,\n  person: null,\n  personRelationships: null\n};\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case REQUEST(ACTION_TYPES.SEARCH_PEOPLE):\n      return {\n        ...state,\n        loading: true\n      };\n    case REQUEST(ACTION_TYPES.GET_PERSON_RELATIONSHIPS):\n      return {\n        ...state,\n        personRelationships: null\n      };\n    case FAILURE(ACTION_TYPES.SEARCH_PEOPLE):\n      return {\n        ...initialState,\n        errorMessage: action.payload.message\n      };\n    case SUCCESS(ACTION_TYPES.SEARCH_PEOPLE):\n      const links = action.payload.data.links;\n      const page = action.meta.currentPage || 0;\n      const people = action.payload.data.results || [];\n      return {\n        ...initialState,\n        people: page === 0 ? people : [...state.people, ...people],\n        hasNext: links && !!links.find(link => link.rel === 'next'),\n        hasPrev: links && !!links.find(link => link.rel === 'prev'),\n        totalCount: action.payload.data.totalCount,\n        currentPage: action.meta.currentPage\n      };\n    case SUCCESS(ACTION_TYPES.GET_PERSON):\n      return {\n        ...state,\n        person: action.payload.data\n      };\n    case SUCCESS(ACTION_TYPES.GET_PERSON_RELATIONSHIPS):\n      return {\n        ...state,\n        personRelationships: action.payload.data.results\n      };\n    case ACTION_TYPES.RESET_PEOPLE:\n      return {\n        ...initialState\n      };\n    default:\n      return state;\n  }\n};\n\n// actions\nexport const search = (q, page = 0, limit = DEFAULT_PAGE_SIZE) => {\n  const requestUrl = `/openmrs/ws/rest/v1/person?q=${q || ''}&startIndex=${page * limit}&limit=${limit}&v=full&totalCount=true`;\n  return {\n    type: ACTION_TYPES.SEARCH_PEOPLE,\n    payload: axios.get(requestUrl),\n    meta: {\n      currentPage: page\n    }\n  };\n};\n\nconst PERSON_CUSTOM_V = `personId,gender,age,birthdate,birthdateEstimated,preferredAddress,preferredName,attributes,uuid`;\n\nexport const getPerson = id => {\n  const requestUrl = `/openmrs/ws/rest/v1/person/${id}?v=custom:(${PERSON_CUSTOM_V})`;\n  return {\n    type: ACTION_TYPES.GET_PERSON,\n    payload: axios.get(requestUrl)\n  };\n};\n\nexport const getPersonRelationships = id => {\n  const requestUrl = `/openmrs/ws/rest/v1/relationship?v=default&person=${id}`;\n  return {\n    type: ACTION_TYPES.GET_PERSON_RELATIONSHIPS,\n    payload: axios.get(requestUrl)\n  };\n};\n\nexport const reset = () => ({\n  type: ACTION_TYPES.RESET_PEOPLE\n});\n\nexport default reducer;\n","import { IFieldProps } from '../../components/register/inputs/Field';\n\nexport const getPlaceholder = (intl, label, fieldName, required) => {\n  let placeholder =\n    label ||\n    intl.formatMessage({\n      id: 'registerPatient.fields.' + fieldName\n    }) ||\n    fieldName;\n  if (required) {\n    placeholder = [\n      placeholder,\n      intl.formatMessage({\n        id: 'registerPatient.fields.required'\n      })\n    ].join(' ');\n  }\n  return placeholder;\n};\n\nexport const getCommonInputProps = (props: IFieldProps, placeholder) => {\n  const { field, isInvalid, isDirty, value, onChange, patient, onPatientChange, onKeyDown } = props;\n  const { name, required, type } = field;\n  return {\n    name,\n    id: name,\n    placeholder,\n    value: value != null ? value : patient[name],\n    onChange: onChange || setValueOnChange(patient, name, onPatientChange),\n    required,\n    className: 'form-control ' + (isDirty && isInvalid ? 'invalid' : ''),\n    type: type || 'text',\n    onKeyDown: !!onKeyDown && onKeyDown\n  };\n};\n\nexport const setValue = (patient, prop, callback, value) => {\n  patient[prop] = value;\n  callback(patient);\n};\n\nexport const setValueOnChange = (patient, prop, callback) => event =>\n  setValue(patient, prop, callback, event && event.target ? event.target.value : event);\n","import { Button, FormGroup } from 'reactstrap';\nimport React from 'react';\nimport _ from 'lodash';\n\nexport interface IButtonsProps {\n  options: any[];\n  entity: any;\n  fieldName: any;\n  onChange: (value) => void;\n  onKeyDown?: () => void;\n}\n\nexport const Buttons = (props: IButtonsProps) => {\n  const { options, entity, fieldName, onKeyDown, onChange } = props;\n  const handleOnChange = value => evt => onChange(value);\n\n  return (\n    <>\n      {_.map(options || [], (option, i) => {\n        const value = option.value !== undefined ? option.value : option;\n        const label = option.label !== undefined ? option.label : option;\n        return (\n          <FormGroup check inline key={`button-${value}`} className=\"mb-2\">\n            <Button\n              onClick={handleOnChange(value)}\n              className={`select-button w-100 ${entity[fieldName] === value ? 'active' : ''}`}\n              {...(!!onKeyDown &&\n                i === options.length - 1 && {\n                  onKeyDown\n                })}\n            >\n              {label}\n            </Button>\n          </FormGroup>\n        );\n      })}\n    </>\n  );\n};\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { injectIntl } from 'react-intl';\nimport { setValue } from '../../../shared/util/patient-form-util';\nimport { IFieldProps, IFieldState } from './Field';\nimport { Buttons as GenericButtons } from '../../common/form/Buttons';\n\nexport interface IButtonsProps extends StateProps, DispatchProps, IFieldProps {\n  intl: any;\n}\n\nclass Buttons extends React.Component<IButtonsProps, IFieldState> {\n  onChange = value => setValue(this.props.patient, this.props.field.name, this.props.onPatientChange, value);\n\n  render = () => {\n    const { intl, field, isInvalid, className, patient, isDirty, onKeyDown } = this.props;\n    const { options } = field;\n    const hasValue = !!patient[field.name];\n    return (\n      <div className={`${className}`}>\n        <GenericButtons options={options} entity={patient} fieldName={field.name} onChange={this.onChange} onKeyDown={onKeyDown} />\n        {isDirty && isInvalid && (\n          <span className=\"error field-error\">\n            {intl.formatMessage({\n              id: hasValue ? field.errorMessage || `registerPatient.invalid` : `registerPatient.required`\n            })}\n          </span>\n        )}\n      </div>\n    );\n  };\n}\n\nconst mapStateToProps = () => ({});\n\nconst mapDispatchToProps = {};\n\ntype StateProps = ReturnType<typeof mapStateToProps>;\ntype DispatchProps = typeof mapDispatchToProps;\n\nexport default connect(mapStateToProps, mapDispatchToProps)(injectIntl(Buttons));\n","import React from 'react';\nimport { injectIntl } from 'react-intl';\n\nexport interface IValidationErrorProps {\n  intl: any;\n  hasValue: boolean;\n  message?: string;\n  field: any;\n}\n\nfunction ValidationError(props: IValidationErrorProps) {\n  const { intl, hasValue, message, field } = props;\n  return (\n    <span className=\"error field-error\">\n      {intl.formatMessage({\n        id: message || (hasValue ? field.errorMessage || `registerPatient.invalid` : `registerPatient.required`)\n      })}\n    </span>\n  );\n}\n\nexport default injectIntl(ValidationError);\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { injectIntl } from 'react-intl';\nimport { IFieldProps, IFieldState } from './Field';\nimport ValidationError from './ValidationError';\nimport { getCommonInputProps, getPlaceholder } from '../../../shared/util/patient-form-util';\nimport { BIRTHDATE_FIELD, ESTIMATED_BIRTHDATE_FIELDS } from '../Step';\nimport InputMask from 'react-input-mask';\n\nexport interface IInputProps extends StateProps, DispatchProps, IFieldProps {\n  intl: any;\n}\n\nclass Input extends React.Component<IInputProps, IFieldState> {\n  isDisabled = (patient, fieldName) => {\n    if (ESTIMATED_BIRTHDATE_FIELDS.includes(fieldName)) {\n      return !!patient[BIRTHDATE_FIELD];\n    }\n    return false;\n  };\n\n  render = () => {\n    const { intl, field, isInvalid, isDirty, className, value, patient, message } = this.props;\n    const { name, required, type, label, mask } = field;\n    const hasValue = !!value || !!patient[field.name];\n    const placeholder = getPlaceholder(intl, label, name, required);\n    const props = getCommonInputProps(this.props, placeholder);\n\n    props['disabled'] = this.isDisabled(patient, name);\n    props['data-testid'] = this.props['data-testid'] || name;\n\n    if (type === 'number') {\n      // Firefox doesn't support number inputs\n      props['pattern'] = '[1-9]';\n    }\n\n    return (\n      <div className={`${className} input-container`}>\n        <InputMask {...props} mask={mask} maskChar={null} value={props.value} onChange={props.onChange} />\n        {hasValue && <span className=\"placeholder\">{placeholder}</span>}\n        {isDirty && isInvalid && <ValidationError hasValue={hasValue} field={field} message={message} />}\n      </div>\n    );\n  };\n}\n\nconst mapStateToProps = () => ({});\n\nconst mapDispatchToProps = {};\n\ntype StateProps = ReturnType<typeof mapStateToProps>;\ntype DispatchProps = typeof mapDispatchToProps;\n\nexport default connect(mapStateToProps, mapDispatchToProps)(injectIntl(Input));\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { injectIntl } from 'react-intl';\nimport { Input as ReactstrapInput } from 'reactstrap';\nimport { IFieldProps, IFieldState } from './Field';\nimport ValidationError from './ValidationError';\nimport { getCommonInputProps, getPlaceholder } from '../../../shared/util/patient-form-util';\n\nexport interface ISelectProps extends StateProps, DispatchProps, IFieldProps {\n  intl: any;\n}\n\nclass Select extends React.Component<ISelectProps, IFieldState> {\n  setDirty = callback => {\n    this.setState({\n      isDirty: true\n    });\n    callback();\n  };\n\n  getSelectOptions = (fieldDefinition, placeholder) => {\n    const { selectOptions } = this.props;\n    const { options } = fieldDefinition;\n    const opts = selectOptions || options;\n    if (!!opts) {\n      return (\n        <>\n          {\n            <option value=\"\" disabled selected hidden>\n              {placeholder}\n            </option>\n          }\n          {opts.map(option => (\n            <option value={option.value || option} key={`option-${option.value || option}`}>\n              {option.label || option}\n            </option>\n          ))}\n        </>\n      );\n    }\n  };\n\n  render = () => {\n    const { field, isInvalid, isDirty, className, value, patient, intl } = this.props;\n    const { name, required, label } = field;\n    const hasValue = !!value || !!patient[field.name];\n    const placeholder = getPlaceholder(intl, label, name, required);\n    const props = getCommonInputProps(this.props, placeholder);\n    const dataTestId = this.props['data-testid'] || name;\n\n    return (\n      <div className={`${className} input-container`}>\n        <ReactstrapInput\n          {...props}\n          className={'form-control ' + (isDirty && isInvalid ? 'invalid ' : ' ') + (!value && !patient[name] ? 'placeholder' : '')}\n          type=\"select\"\n          data-testid={dataTestId}\n        >\n          {this.getSelectOptions(field, placeholder)}\n        </ReactstrapInput>\n        {hasValue && <span className=\"placeholder\">{placeholder}</span>}\n        {isDirty && isInvalid && <ValidationError hasValue={hasValue} field={field} />}\n      </div>\n    );\n  };\n}\n\nconst mapStateToProps = () => ({});\n\nconst mapDispatchToProps = {};\n\ntype StateProps = ReturnType<typeof mapStateToProps>;\ntype DispatchProps = typeof mapDispatchToProps;\n\nexport default connect(mapStateToProps, mapDispatchToProps)(injectIntl(Select));\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAABHNCSVQICAgIfAhkiAAAAaxJREFUWIXtmDFLw0AYht/7EkxCq2lVDC4Wd1EQ/AmCXR2Lc4sO4lJ/RhEHFzsUHHRy8ie4CII/QcdKpCVNtaXt3TmIIMJdq6lNkTxrXpInx/HmuzAppQzfOqg3AwghMWmIGLyMi7mUAzN866B8fonr23twISYuYxAhv7WBk/09mPVmgOvbe/hBOHGRT27uHnC0uwMSQsayIl/hXIALDorV4huJjIrIMsQYluczMI3o7xX5Do41g0qpgGw6Fb8MA7CUdWHQFKzMOElkVCQyKqZKxtRdJMbgWDNgmkzasWEQQ8q2kLYtZU4C6Pb62o+yVsbLuqiUCljKusqMQQzrqyuolYvoDbgy12i1cVy9wmPd/52MH7RweHahLbSUbaFWLuLgtKadiYSUaLTausfpZQZcDB260raF3oDDD0LUm4E2O4yp2sCJjIpERsX/kpH4KDQho59GI8t0e30cV6+GFtooaEtvFLgQ2or/Cf9rz4yT6ZIhYmM5ZkTBMAjEGEwv4yK/tYGbuwdwHsP/GYOwvbmGnLcIJqWUzfAVT88v4EI9HP0VxBhy3iIW5mbxDlBljlt+hWQJAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAABHNCSVQICAgIfAhkiAAAAU1JREFUWIXt2LFLQlEUx/HfOZjVlhgFOiiUe+DiIgjlVtDm5hr1F7Q1t9VfkIubf4GBxHu8ySkeFI8GNYM0LWiy90BPgw0OXXg95L2G+53P8OHcCxcuiYh8eR4aZhu94RizmSCsmAnpZAKVUgHrq3HQxHXl+OIKhu1gOpsCoNAwgICJkc9lcXt5jljDbMOwHUw8L0TEYlNYD0+otyxwbzj+2Ui0dQYj8PyOhHk0vycCcNSIxTRGlcao0hhVGqNKY1TF/AztpraRSm6AKNgbNvj4hPPyuhzM6eE+zo4OwBwMU2saOLm+WQ6m1jRxd/+IgIvB89u7rzlfGLvbh93tB5P8oX91gTVGlcao0hhVGqNKY1Tx/CUO7xtEFRHA6WQCTNEvKLO1Ca6UCsjnspFC9nYyqJaLIBGRieuh3rLQGYwgIZ4Y0Xwj1XIRa/EVfAPyGGP3JFBJygAAAABJRU5ErkJggg==\"","import axios from 'axios';\n\nimport { FAILURE, REQUEST, SUCCESS } from '../action-type.util';\n\nexport const ACTION_TYPES = {\n  GET_RELATIONSHIP_TYPES: 'relationshipType/GET_RELATIONSHIP_TYPES',\n  RESET_RELATIONSHIP_TYPES: 'relationshipType/RESET_RELATIONSHIP_TYPES'\n};\n\nconst initialState = {\n  loading: false,\n  relationshipTypes: [],\n  errorMessage: ''\n};\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case REQUEST(ACTION_TYPES.GET_RELATIONSHIP_TYPES):\n      return {\n        ...state,\n        loading: true\n      };\n    case FAILURE(ACTION_TYPES.GET_RELATIONSHIP_TYPES):\n      return {\n        ...initialState,\n        errorMessage: action.payload.message\n      };\n    case SUCCESS(ACTION_TYPES.GET_RELATIONSHIP_TYPES):\n      return {\n        ...initialState,\n        relationshipTypes: action.payload.data.results\n      };\n    case ACTION_TYPES.RESET_RELATIONSHIP_TYPES:\n      return {\n        ...initialState\n      };\n    default:\n      return state;\n  }\n};\n\n// actions\nexport const getRelationshipTypes = () => {\n  const requestUrl = `/openmrs/ws/rest/v1/relationshiptype?v=full`;\n  return {\n    type: ACTION_TYPES.GET_RELATIONSHIP_TYPES,\n    payload: axios.get(requestUrl)\n  };\n};\n\nexport const reset = () => ({\n  type: ACTION_TYPES.RESET_RELATIONSHIP_TYPES\n});\n\nexport default reducer;\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { injectIntl } from 'react-intl';\nimport { FormGroup } from 'reactstrap';\nimport _ from 'lodash';\nimport Plus from '../../../assets/img/plus.png';\nimport Minus from '../../../assets/img/minus.png';\nimport { getRelationshipTypes } from '../../../redux/reducers/relationship-type';\nimport Select from 'react-select';\nimport { reset, search } from '../../../redux/reducers/patient';\nimport Field, { IFieldProps } from './Field';\n\nexport interface IRelativesProps extends StateProps, DispatchProps, IFieldProps {\n  intl: any;\n}\n\nconst OTHER_PERSON_NAME = 'otherPersonInput';\n\nconst relationshipTypeField = {\n  name: 'relationshipType',\n  required: false,\n  type: 'select'\n};\n\nconst otherPersonField = {\n  name: 'otherPerson',\n  required: false\n};\n\nexport const rowFields = [relationshipTypeField, otherPersonField];\n\nexport interface IRelative {\n  relationshipType: string;\n  otherPerson: object | null;\n  otherPersonInput: string;\n}\n\nconst emptyRelative = {\n  relationshipType: '',\n  otherPerson: null,\n  otherPersonInput: ''\n};\n\nexport interface IRelativesState {\n  invalidFields: any[];\n  relatives: IRelative[];\n  otherPersonInput: string;\n}\n\nclass Relatives extends React.Component<IRelativesProps, IRelativesState> {\n  state = {\n    invalidFields: [],\n    relatives: [] as IRelative[],\n    otherPersonInput: ''\n  };\n\n  loadOptions = _.debounce(e => {\n    this.props.search(this.state.otherPersonInput);\n  }, 500);\n\n  componentDidMount() {\n    this.props.getRelationshipTypes();\n    this.props.reset();\n  }\n\n  componentDidUpdate(prevProps: Readonly<IRelativesProps>, prevState: Readonly<IRelativesState>, snapshot?: any) {\n    const { patient } = this.props;\n    if (prevProps.patient !== patient && !!patient) {\n      this.setState({\n        relatives: patient.relatives && patient.relatives.length > 0 ? patient.relatives : [{ ...emptyRelative }]\n      });\n    }\n  }\n\n  addRelative = () => {\n    const { relatives } = this.state;\n    relatives.push({ ...emptyRelative });\n    this.setState({\n      relatives\n    });\n  };\n\n  relationshipTypeOptions = () =>\n    this.props.relationshipTypes\n      .filter(relationshipType => !relationshipType.retired)\n      .flatMap(relationshipType => [\n        {\n          value: relationshipType.uuid + '-A',\n          label: relationshipType.displayAIsToB\n        },\n        {\n          value: relationshipType.uuid + '-B',\n          label: relationshipType.displayBIsToA\n        }\n      ]);\n\n  removeRelative = rowNo => () => {\n    const { relatives } = this.state;\n    if (relatives.length > 1) {\n      relatives.splice(rowNo, 1);\n    }\n    this.setState({\n      relatives\n    });\n  };\n\n  onChangeEvent = (rowNo, fieldName) => event => this.onChange(rowNo, fieldName)(event.target.value);\n\n  setOtherPersonInput = (rowNo, value, relatives) => {\n    relatives[rowNo].otherPersonInput = value;\n    this.setState({\n      relatives,\n      otherPersonInput: value\n    });\n  };\n\n  onChange = (rowNo, fieldName) => value => {\n    const { relatives } = this.state;\n    const { patient, onPatientChange } = this.props;\n    if (fieldName === OTHER_PERSON_NAME) {\n      this.setOtherPersonInput(rowNo, value, relatives);\n      this.loadOptions();\n    } else {\n      relatives[rowNo][fieldName] = value;\n      this.setState({\n        relatives\n      });\n    }\n    patient.relatives = relatives;\n    onPatientChange(patient);\n  };\n\n  onFocus = rowNo => e => {\n    const { relatives } = this.state;\n    const selectedOpt = relatives[rowNo][otherPersonField.name];\n    if (selectedOpt) {\n      this.setOtherPersonInput(rowNo, selectedOpt.label, relatives);\n      this.props.search(selectedOpt.label);\n    }\n  };\n\n  patientOptions = rowNo => {\n    const { relatives } = this.state;\n    const name = relatives[rowNo].otherPersonInput;\n    const options =\n      name && name.length >= 3\n        ? this.props.patients.map(patient => ({\n            value: patient.uuid,\n            label: patient.person.display\n          }))\n        : [];\n    return options;\n  };\n\n  relative = (relative, rowNo) => {\n    const otherPersonPlaceholder = this.props.intl.formatMessage({\n      id: 'registerPatient.fields.otherPerson'\n    });\n    return (\n      <FormGroup className=\"d-flex flex-row flex-wrap w-100\">\n        {rowFields.includes(relationshipTypeField) && (\n          <Field\n            {...this.props}\n            field={relationshipTypeField}\n            selectOptions={this.relationshipTypeOptions()}\n            value={relative[relationshipTypeField.name]}\n            onChange={this.onChangeEvent(rowNo, relationshipTypeField.name)}\n            onKeyDown={null}\n          />\n        )}\n        {rowFields.includes(otherPersonField) && (\n          <div className={`input-container flex-fill`}>\n            <Select\n              options={this.patientOptions(rowNo)}\n              onInputChange={this.onChange(rowNo, OTHER_PERSON_NAME)}\n              onChange={this.onChange(rowNo, otherPersonField.name)}\n              className=\"flex-fill other-person\"\n              classNamePrefix=\"default-select\"\n              placeholder={otherPersonPlaceholder}\n              value={relative.otherPerson}\n              inputValue={relative.otherPersonInput}\n              onKeyDown={rowNo + 1 === this.state.relatives.length ? this.props.onKeyDown : null}\n              onFocus={this.onFocus(rowNo)}\n              isFocused\n            />\n            {(!!relative.otherPerson || !!relative.otherPersonInput) && <span className=\"placeholder\">{otherPersonPlaceholder}</span>}\n          </div>\n        )}\n        <div className=\"align-items-center justify-content-center d-flex\">\n          <img src={Plus} alt=\"add\" className=\"mx-2\" onClick={this.addRelative} />\n          <img src={Minus} alt=\"remove\" onClick={this.removeRelative(rowNo)} />\n        </div>\n      </FormGroup>\n    );\n  };\n\n  render() {\n    return <>{_.map(this.state.relatives, (relative, i) => this.relative(relative, i))}</>;\n  }\n}\n\nconst mapStateToProps = ({ relationshipType, cflPatient }) => ({\n  relationshipTypes: relationshipType.relationshipTypes,\n  patients: cflPatient.patients || []\n});\n\nconst mapDispatchToProps = {\n  getRelationshipTypes,\n  search,\n  reset\n};\n\ntype StateProps = ReturnType<typeof mapStateToProps>;\ntype DispatchProps = typeof mapDispatchToProps;\n\nexport default connect(mapStateToProps, mapDispatchToProps)(injectIntl(Relatives));\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { injectIntl } from 'react-intl';\nimport DatePicker from 'react-datepicker';\nimport { IFieldProps, IFieldState } from './Field';\nimport ValidationError from './ValidationError';\nimport { getCommonInputProps, getPlaceholder } from '../../../shared/util/patient-form-util';\nimport { DATE_FORMAT } from '../../../shared/util/date-util';\n\nexport interface IDateInputProps extends StateProps, DispatchProps, IFieldProps {\n  intl: any;\n}\n\nclass DateInput extends React.Component<IDateInputProps, IFieldState> {\n  render = () => {\n    const { intl, field, isInvalid, isDirty, className, value, patient } = this.props;\n    const { name, required, label } = field;\n    const hasValue = !!value || !!patient[field.name];\n    const placeholder = getPlaceholder(intl, label, name, required);\n    const props = {\n      ...getCommonInputProps(this.props, placeholder),\n      placeholderText: placeholder,\n      selected: value != null ? value : patient[name]\n    };\n    return (\n      <div className={`${className} input-container`}>\n        <DatePicker {...props} peekNextMonth showMonthDropdown showYearDropdown dropdownMode=\"select\" dateFormat={DATE_FORMAT} />\n        {hasValue && <span className=\"placeholder\">{placeholder}</span>}\n        {isDirty && isInvalid && <ValidationError hasValue={hasValue} field={field} />}\n      </div>\n    );\n  };\n}\n\nconst mapStateToProps = () => ({});\n\nconst mapDispatchToProps = {};\n\ntype StateProps = ReturnType<typeof mapStateToProps>;\ntype DispatchProps = typeof mapDispatchToProps;\n\nexport default connect(mapStateToProps, mapDispatchToProps)(injectIntl(DateInput));\n","import React, { RefObject } from 'react';\nimport { connect } from 'react-redux';\nimport { injectIntl } from 'react-intl';\nimport { IFieldProps, IFieldState } from './Field';\nimport ValidationError from './ValidationError';\nimport { getCommonInputProps, getPlaceholder } from '../../../shared/util/patient-form-util';\nimport { getPhoneNumberWithPlusSign } from '../../../shared/util/person-util';\nimport PhoneInput, { isPossiblePhoneNumber } from 'react-phone-number-input';\nimport 'react-phone-number-input/style.css';\n\nexport interface IInputProps extends StateProps, DispatchProps, IFieldProps {\n  intl: any;\n}\n\nconst PLUS_SIGN_LENGTH = 1;\n\nclass Input extends React.Component<IInputProps, IFieldState> {\n  private inputRef = React.createRef() as RefObject<HTMLInputElement>;\n\n  getErrorMessage = inputValue => {\n    if (inputValue.length > 0 && !isPossiblePhoneNumber(inputValue)) {\n      return 'registerPatient.invalidPhoneNumber';\n    }\n  };\n\n  removePlusSign = phoneNumber => phoneNumber && phoneNumber.substring(PLUS_SIGN_LENGTH);\n\n  render = () => {\n    const { intl, field, isInvalid, isDirty, className, value, patient } = this.props;\n    const { name, required, label } = field;\n    const inputValue = getPhoneNumberWithPlusSign(value || patient[field.name] || '');\n    const placeholder = getPlaceholder(intl, label, name, required);\n    const props = getCommonInputProps(this.props, placeholder);\n    const errorMessage = this.getErrorMessage(inputValue);\n    const dataTestId = this.props['data-testid'] || name;\n\n    return (\n      <div className={`${className} input-container`}>\n        <PhoneInput\n          {...props}\n          value={inputValue}\n          onChange={phoneNumber => props.onChange(this.removePlusSign(phoneNumber))}\n          ref={this.inputRef}\n          international\n          numberInputProps={{ className: props.className }}\n          className={null}\n          data-testid={dataTestId}\n        />\n        {inputValue.length > 0 && <span className=\"placeholder\">{placeholder}</span>}\n        {((isDirty && isInvalid) || errorMessage) && (\n          <ValidationError hasValue={inputValue.length > 0} message={errorMessage} field={field} />\n        )}\n      </div>\n    );\n  };\n}\n\nconst mapStateToProps = () => ({});\n\nconst mapDispatchToProps = {};\n\ntype StateProps = ReturnType<typeof mapStateToProps>;\ntype DispatchProps = typeof mapDispatchToProps;\n\nexport default connect(mapStateToProps, mapDispatchToProps)(injectIntl(Input));\n","import Buttons from './Buttons';\nimport Input from './Input';\nimport React from 'react';\nimport Select from './Select';\nimport Relatives from './Relatives';\nimport DateInput from './DateInput';\nimport PhoneInput from './PhoneInput';\n\nconst DEFAULT_FIELD_TYPE = 'text';\nconst DEFAULT_INPUT = Input;\n\nexport interface IFieldProps {\n  patient: any;\n  field: any;\n  className?: any;\n  value?: any;\n  onChange?: any;\n  onPatientChange: any;\n  selectOptions?: any[];\n  isInvalid: boolean;\n  isDirty: boolean;\n  onKeyDown?: any;\n  message?: string;\n}\n\n// tslint:disable-next-line:no-empty-interface\nexport interface IFieldState {}\n\nexport const inputsByType = {\n  buttons: Buttons,\n  select: Select,\n  number: Input,\n  text: Input,\n  phone: PhoneInput,\n  date: DateInput,\n  relatives: Relatives\n};\n\nfunction Field(props: IFieldProps) {\n  const type = props.field.type || DEFAULT_FIELD_TYPE;\n  const InputComponent = inputsByType[type] || DEFAULT_INPUT;\n  return <InputComponent {...props} />;\n}\n\nexport default Field;\n","import axios from 'axios';\nimport { ILocation, ILocationState } from '../../shared/models/location';\nimport { FAILURE, REQUEST, SUCCESS } from '../action-type.util';\nimport { AnyAction } from 'redux';\n\nexport const ACTION_TYPES = {\n  SEARCH_LOCATIONS: 'location/SEARCH_LOCATIONS',\n  GET_LOCATION: 'location/GET_LOCATION',\n  GET_LOCATION_ATTRIBUTE_TYPES: 'location/GET_LOCATION_ATTRIBUTE_TYPES',\n  POST_LOCATION: 'location/POST_LOCATION'\n};\n\nconst initialState: ILocationState = {\n  loadingLocations: false,\n  locations: [],\n  errorMessage: '',\n  locationAttributeTypes: [],\n  loadingLocationAttributeTypes: false,\n  success: false,\n  loadingLocation: false,\n  location: null\n};\n\nconst reducer = (state = initialState, action: AnyAction) => {\n  switch (action.type) {\n    case REQUEST(ACTION_TYPES.SEARCH_LOCATIONS):\n      return {\n        ...state,\n        loadingLocations: true\n      };\n    case REQUEST(ACTION_TYPES.GET_LOCATION):\n      return {\n        ...state,\n        loadingLocation: true\n      };\n    case REQUEST(ACTION_TYPES.GET_LOCATION_ATTRIBUTE_TYPES):\n      return {\n        ...state,\n        loadingLocationAttributeTypes: true\n      };\n    case FAILURE(ACTION_TYPES.SEARCH_LOCATIONS):\n      return {\n        ...state,\n        errorMessage: action.payload.message\n      };\n    case SUCCESS(ACTION_TYPES.SEARCH_LOCATIONS):\n      return {\n        ...state,\n        loadingLocations: false,\n        locations: action.payload.data.results\n      };\n    case SUCCESS(ACTION_TYPES.GET_LOCATION):\n      return {\n        ...state,\n        loadingLocation: false,\n        location: action.payload.data.results[0]\n      };\n    case SUCCESS(ACTION_TYPES.GET_LOCATION_ATTRIBUTE_TYPES):\n      return {\n        ...state,\n        loadingLocationAttributeTypes: false,\n        locationAttributeTypes: action.payload.data.results\n      };\n    case SUCCESS(ACTION_TYPES.POST_LOCATION):\n      return {\n        ...state,\n        success: true\n      };\n    default:\n      return state;\n  }\n};\n\n// actions\nexport const searchLocations = (q?: string) => {\n  const requestUrl = `/openmrs/ws/rest/v1/location${!!q ? '?q=' + q : ''}`;\n  return {\n    type: ACTION_TYPES.SEARCH_LOCATIONS,\n    payload: axios.get(requestUrl)\n  };\n};\n\nexport const getLocation = (id: string) => ({\n  type: ACTION_TYPES.GET_LOCATION,\n  payload: axios.get(`/openmrs/ws/rest/v1/location?s=byId&id=${id}&v=full`)\n});\n\nexport const getLocationAttributeTypes = () => ({\n  type: ACTION_TYPES.GET_LOCATION_ATTRIBUTE_TYPES,\n  payload: axios.get('/openmrs/ws/rest/v1/locationattributetype?v=full')\n});\n\nexport const saveLocation = (location: ILocation) => ({\n  type: ACTION_TYPES.POST_LOCATION,\n  payload: axios.post(`/openmrs/ws/rest/v1/location${location.uuid ? '/' + location.uuid : ''}`, location)\n});\n\nexport default reducer;\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { injectIntl } from 'react-intl';\nimport { FormGroup } from 'reactstrap';\nimport { IPatient } from '../../shared/models/patient';\nimport _ from 'lodash';\nimport Field from './inputs/Field';\nimport { isPossiblePhoneNumber } from 'react-phone-number-input';\nimport { searchLocations } from '../../redux/reducers/location';\nimport { getPhoneNumberWithPlusSign } from '../../shared/util/person-util';\nimport { EMPTY_STRING } from '../../shared/constants/input';\n\nexport interface IPatientIdentifierType {\n  format: string;\n  formatDescription: string;\n  required: boolean;\n  name: string;\n}\n\nexport interface IStepProps extends StateProps, DispatchProps {\n  intl: any;\n  patient: IPatient;\n  onPatientChange: any;\n  stepButtons: any;\n  stepDefinition: any;\n  setValidity: any;\n  setStep: any;\n  stepNumber: number;\n  patientIdentifierTypes: IPatientIdentifierType[];\n  regimens: string[];\n}\n\nexport interface IStepState {\n  invalidFields: any[];\n  dirtyFields: any[];\n}\n\nexport const LOCATIONS_OPTION_SOURCE = 'locations';\nexport const SEPARATOR_FIELD_TYPE = 'separator';\nexport const RELATIVES_FIELD_TYPE = 'relatives';\nexport const PHONE_FIELD_TYPE = 'phone';\nexport const BIRTHDATE_FIELD = 'birthdate';\nexport const ESTIMATED_BIRTHDATE_FIELDS = ['birthdateYears', 'birthdateMonths'];\n\nexport class Step extends React.Component<IStepProps, IStepState> {\n  state = {\n    invalidFields: [] as any[],\n    dirtyFields: [] as any[]\n  };\n\n  componentDidMount() {\n    this.fetchOptionSources();\n    this.validate();\n  }\n\n  componentDidUpdate(prevProps: Readonly<IStepProps>, prevState: Readonly<IStepState>, snapshot?: any) {\n    if (prevProps.stepDefinition !== this.props.stepDefinition) {\n      this.fetchOptionSources();\n    }\n    // re-validate fields\n    if (prevProps.patient !== this.props.patient) {\n      this.validate();\n    }\n  }\n\n  fetchOptionSources = () => {\n    const { stepDefinition } = this.props;\n    const optionSources = stepDefinition.fields ? stepDefinition.fields.map(field => field.optionSource).filter(os => !!os) : [];\n    if (optionSources.includes(LOCATIONS_OPTION_SOURCE)) {\n      this.props.searchLocations();\n    }\n  };\n\n  getOptions = field => {\n    const { optionSource = EMPTY_STRING } = field;\n    const { locations } = this.props;\n    let { options = [] } = field;\n\n    if (optionSource === LOCATIONS_OPTION_SOURCE && locations) {\n      return locations.map(l => ({\n        value: l.uuid,\n        label: l.display\n      }));\n    } else if (this.props[optionSource]?.length) {\n      options = this.props[optionSource];\n    }\n\n    return options;\n  };\n\n  getClassName = field => {\n    const { stepDefinition } = this.props;\n    const columns = stepDefinition.columns && stepDefinition.columns.toString();\n    if (columns === '1') {\n      return 'col-sm-12';\n    } else if (columns === '2') {\n      return 'col-sm-6';\n    } else if (columns === '3') {\n      return 'col-sm-4';\n    } else if (columns === '4') {\n      return 'col-sm-3';\n    }\n    if (field.type === 'buttons') {\n      return 'col-sm-12';\n    }\n    return 'col-sm-4';\n  };\n\n  // return true if invalid\n  validateField = field => {\n    const { patient } = this.props;\n    const value = patient[field.name];\n    const patientIdentifierType = this.getPatientIdentifierType(field);\n    const regex = field.regex || patientIdentifierType?.format;\n    let isInvalid = field.required && !value;\n\n    if (field.type === PHONE_FIELD_TYPE && !!value) {\n      isInvalid = !isPossiblePhoneNumber(getPhoneNumberWithPlusSign(value));\n    }\n\n    if (regex) {\n      const re = new RegExp(regex);\n      const isRequired = field.required || patientIdentifierType.required;\n      isInvalid = !isRequired && !value ? false : !re.test(value);\n    }\n\n    if (BIRTHDATE_FIELD === field.name || ESTIMATED_BIRTHDATE_FIELDS.includes(field.name)) {\n      // if estimation was made, don't require exact birthdate\n      const usesEstimate = ESTIMATED_BIRTHDATE_FIELDS.every(fieldName => !!this.props.patient[fieldName]);\n\n      if (usesEstimate) {\n        return false;\n      }\n    }\n\n    return isInvalid;\n  };\n\n  isFieldNonEmpty = field => {\n    const { patient } = this.props;\n    return !!patient[field.name];\n  };\n\n  validate = (fields = this.props.stepDefinition.fields, nonEmptyFields = _.filter(fields, this.isFieldNonEmpty)) => {\n    const invalidFields = _.filter(fields, this.validateField);\n    const dirtyFields = [...this.state.dirtyFields, ...nonEmptyFields];\n    this.setState({\n      invalidFields,\n      dirtyFields\n    });\n    const isStepValid = invalidFields.length === 0;\n    const isStepDirty = dirtyFields.length > 0;\n    this.props.setValidity(isStepValid, isStepDirty);\n    return isStepValid;\n  };\n\n  handleLastFieldKeyDown = e => {\n    const { fields } = this.props.stepDefinition;\n    if (e.key === 'Tab') {\n      if (e.shiftKey) {\n        if (this.props.stepNumber > 0) {\n          this.props.setStep(this.props.stepNumber - 1);\n        }\n      } else {\n        const isValid = this.validate(fields, fields);\n        e.preventDefault();\n        if (isValid) {\n          this.props.setStep(this.props.stepNumber + 1);\n        }\n      }\n    }\n  };\n\n  getPatientIdentifierType = field => this.props.patientIdentifierTypes.find(type => type.name === field.name && type.format);\n\n  render() {\n    const { stepDefinition, patient } = this.props;\n    const { invalidFields, dirtyFields } = this.state;\n\n    return (\n      <>\n        <div className=\"step-fields\" key={stepDefinition.name}>\n          <div className=\"step-title\">\n            <h2>{stepDefinition.title}</h2>\n            <p>{stepDefinition.subtitle}</p>\n          </div>\n          <FormGroup className=\"d-flex flex-row flex-wrap\">\n            {_.map(stepDefinition.fields, (field, i) => {\n              const selectOptions = this.getOptions(field);\n              const additionalProps = {} as any;\n              const patientIdentifierType = this.getPatientIdentifierType(field);\n\n              if (i === stepDefinition.fields.length - 1 || (field.name === BIRTHDATE_FIELD && !!patient[BIRTHDATE_FIELD])) {\n                additionalProps.onKeyDown = this.handleLastFieldKeyDown;\n              }\n\n              if (patientIdentifierType) {\n                additionalProps.message = patientIdentifierType.formatDescription;\n              }\n\n              return field.type === SEPARATOR_FIELD_TYPE ? (\n                <p className={field.class || 'col-7 offset-5 col-sm-10 offset-sm-2 mb-5 mt-5'} key={`field-${i}`}>\n                  {field.label}\n                </p>\n              ) : (\n                <Field\n                  {...this.props}\n                  field={field}\n                  isInvalid={!!invalidFields.find(f => f['name'] === field.name)}\n                  isDirty={!!dirtyFields.find(f => f['name'] === field.name)}\n                  className={this.getClassName(field)}\n                  selectOptions={selectOptions}\n                  key={`field-${i}`}\n                  data-testid={field.name}\n                  {...additionalProps}\n                />\n              );\n            })}\n          </FormGroup>\n        </div>\n        {this.props.stepButtons(invalidFields.length === 0)}\n      </>\n    );\n  }\n}\n\nconst mapStateToProps = ({ location }) => ({\n  locations: location.locations\n});\n\nconst mapDispatchToProps = {\n  searchLocations\n};\n\ntype StateProps = ReturnType<typeof mapStateToProps>;\ntype DispatchProps = typeof mapDispatchToProps;\n\nexport default connect(mapStateToProps, mapDispatchToProps)(injectIntl(Step));\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport './Confirm.scss';\nimport { FormattedMessage, injectIntl } from 'react-intl';\nimport { IPatient } from '../../shared/models/patient';\nimport { Alert } from 'reactstrap';\nimport _ from 'lodash';\nimport { BIRTHDATE_FIELD, ESTIMATED_BIRTHDATE_FIELDS, LOCATIONS_OPTION_SOURCE, RELATIVES_FIELD_TYPE } from './Step';\nimport { formatDate } from '../../shared/util/date-util';\nimport { formatPhoneNumberIntl } from 'react-phone-number-input';\nimport { getPhoneNumberWithPlusSign } from '../../shared/util/person-util';\n\nexport interface IConfirmProps extends StateProps, DispatchProps {\n  intl: any;\n  patient: IPatient;\n  onPatientChange: any;\n  stepButtons: any;\n  steps: any[];\n  isCaregiver: boolean;\n}\n\nclass Confirm extends React.Component<IConfirmProps> {\n  state = {};\n\n  componentDidMount() {}\n\n  validate = () => true;\n\n  birthdate = patient => {\n    const { intl } = this.props;\n    if (!!patient.birthdate) {\n      return formatDate(intl, new Date(patient.birthdate));\n    } else if (!!patient.birthdateYears || !!patient.birthdateMonths) {\n      const yearPart =\n        !!patient.birthdateYears && patient.birthdateYears + ' ' + intl.formatMessage({ id: 'registerPatient.steps.confirm.years' });\n      const monthPart =\n        !!patient.birthdateMonths && patient.birthdateMonths + ' ' + intl.formatMessage({ id: 'registerPatient.steps.confirm.months' });\n      return [intl.formatMessage({ id: 'registerPatient.steps.confirm.estimated' }), yearPart, monthPart].filter(Boolean).join(' ');\n    }\n  };\n\n  location = (patient, fieldName) => {\n    const id = patient[fieldName];\n    if (!!id) {\n      return this.props.locations.find(loc => loc.uuid === id)?.display;\n    }\n  };\n\n  relationshipType = relationshipTypeId => {\n    const relationshipType = this.props.relationshipTypes.find(type => relationshipTypeId.indexOf(type.uuid) >= 0);\n    return relationshipType && (relationshipTypeId.endsWith('-A') ? relationshipType.displayAIsToB : relationshipType.displayBIsToA);\n  };\n\n  relatives = patient =>\n    patient.relatives &&\n    patient.relatives\n      .filter(relative => !!relative.relationshipType && !!relative.otherPerson)\n      .map(relative => [this.relationshipType(relative.relationshipType), relative.otherPerson.label].join(' - '))\n      .join(', ');\n\n  getFieldLabel = field =>\n    !!field.label\n      ? field.label\n      : this.props.intl.formatMessage({\n          id: 'registerPatient.fields.' + field.name,\n          defaultMessage: field.name\n        });\n\n  getFieldValue = (patient, field) => {\n    const val = patient[field.name];\n    if (!!field.options) {\n      const option = field.options.find(opt => opt.value === val || opt === val);\n      if (!!option) {\n        return option.label || option;\n      }\n    }\n    if (field.type === 'phone' && !!val) {\n      return formatPhoneNumberIntl(getPhoneNumberWithPlusSign(val));\n    }\n    return val;\n  };\n\n  sections = patient => {\n    const { steps } = this.props;\n    const sections = [] as any[];\n    steps.forEach(step => {\n      let value;\n      const locField = step.fields.find(field => field.optionSource === LOCATIONS_OPTION_SOURCE);\n      if (step.fields.find(field => BIRTHDATE_FIELD === field.name || ESTIMATED_BIRTHDATE_FIELDS.includes(field.name))) {\n        value = this.birthdate(patient);\n      } else if (step.fields.find(field => field.type === RELATIVES_FIELD_TYPE)) {\n        value = this.relatives(patient);\n      } else if (locField) {\n        value = this.location(patient, locField.name);\n      } else {\n        step.fields\n          .filter(field => !!field.name && !!this.getFieldValue(patient, field))\n          .forEach(field => {\n            sections.push({\n              label: this.getFieldLabel(field),\n              value: this.getFieldValue(patient, field)\n            });\n          });\n        return sections;\n      }\n      sections.push({\n        label: step.label,\n        value\n      });\n    });\n    return sections;\n  };\n\n  renderField = field => {\n    const COLON = ':';\n    return (\n      <div className=\"mb-3 col-confirm\" key={`field-${field.label}`}>\n        <div className=\"col-sm-4 col-confirm-label\">\n          <span className=\"helper-text\">\n            {field.label}\n            {COLON}\n          </span>\n        </div>\n        <div className=\"col-sm-8\">\n          <span>{field.value}</span>\n        </div>\n      </div>\n    );\n  };\n\n  errors = errors => errors && _.map(errors, err => <Alert color=\"danger\">{err && err.replace(/<\\/?[^>]+(>|$)/g, '')}</Alert>);\n\n  render() {\n    const fields = this.sections(this.props.patient);\n    const itemsPerColumn = Math.floor(fields.length / 2);\n    const { errors } = this.props;\n    return (\n      <>\n        <div className=\"step-fields\">\n          {this.errors(errors)}\n          <div className=\"step-title\">\n            <h2>\n              <FormattedMessage id={(this.props.isCaregiver ? 'registerCaregiver' : 'registerPatient') + '.steps.confirm.title'} />\n            </h2>\n            <p>\n              <FormattedMessage id={(this.props.isCaregiver ? 'registerCaregiver' : 'registerPatient') + '.steps.confirm.subtitle'} />\n            </p>\n          </div>\n          <div className=\"row\">\n            <div className=\"col-sm-6\">{fields.slice(0, itemsPerColumn).map(field => this.renderField(field))}</div>\n            <div className=\"col-sm-6\">{fields.slice(itemsPerColumn).map(field => this.renderField(field))}</div>\n          </div>\n        </div>\n        {this.props.stepButtons(this.validate)}\n      </>\n    );\n  }\n}\n\nconst mapStateToProps = ({ relationshipType, location, registration }) => ({\n  relationshipTypes: relationshipType.relationshipTypes,\n  locations: location.locations,\n  errors: registration.errors\n});\n\nconst mapDispatchToProps = {};\n\ntype StateProps = ReturnType<typeof mapStateToProps>;\ntype DispatchProps = typeof mapDispatchToProps;\n\nexport default connect(mapStateToProps, mapDispatchToProps)(injectIntl(Confirm));\n","import React from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport './Modal.scss';\nimport cx from 'classnames';\n\nexport interface IConfirmationModalProps {\n  className?: string;\n  header: {\n    id: string;\n    values?: {};\n  };\n  body: {\n    id: string;\n    values?: {};\n  };\n  onYes: () => void;\n  onNo?: () => void;\n  isOpen: boolean;\n}\n\nexport const ConfirmationModal = (props: IConfirmationModalProps) => {\n  const {\n    className,\n    header: { id: headerId, values: headerValues = {} },\n    body: { id: bodyId, values: bodyValues = {} },\n    onYes,\n    onNo,\n    isOpen\n  } = props;\n\n  return (\n    <Modal className={className} isOpen={isOpen} fade={false}>\n      <ModalHeader>\n        <div className=\"modal-images\">\n          <i className=\"bi bi-person-check\"></i>\n        </div>\n        <FormattedMessage id={headerId} values={{ ...headerValues, br: <br /> }} />\n      </ModalHeader>\n      <ModalBody>\n        <FormattedMessage id={bodyId} values={{ ...bodyValues, br: <br /> }} tagName=\"p\" />\n      </ModalBody>\n      <ModalFooter className={cx({ 'justify-content-end': !onNo })}>\n        {onNo && (\n          <Button className=\"btn cancel\" onClick={onNo} data-testid=\"cancelModalButton\">\n            <FormattedMessage id=\"common.no\" />\n          </Button>\n        )}\n        {onYes && (\n          <Button className=\"btn btn-primary\" onClick={onYes} data-testid=\"confirmModalButton\">\n            <FormattedMessage id={`${onNo ? 'common.yes' : 'common.ok'}`} />\n          </Button>\n        )}\n      </ModalFooter>\n    </Modal>\n  );\n};\n","import React from 'react';\nimport './RegisterPatientConfirmationModal.scss';\nimport { ConfirmationModal } from '../common/form/ConfirmationModal';\n\nconst RegisterPatientConfirmationModal = props => <ConfirmationModal {...props} />;\n\nexport default RegisterPatientConfirmationModal;\n","import { getData } from 'country-list';\nimport _ from 'lodash';\n\nconst DEFAULT_OPERATOR_CREDENTIALS_RETENTION_TIME = 604800000;\nconst DEFAULT_OPERATOR_OFFLINE_SESSION_TIMEOUT = 43200000;\nexport const SETTING_KEY = 'biometric.api.config.main';\nexport const DEFAULT_REGIMEN_UPDATE_PERMITTED = true;\nexport const EMPTY_COUNTRY = { fields: [{}] };\nexport const COUNTRY_OPTIONS = _.sortBy(getData(), 'name').map(({ name }) => ({ label: name, value: name }));\nexport const ORDERED_ADDRESS_FIELD_PARTS = ['field', 'type', 'name', 'displayOrder'];\nexport const DEFAULT_SYNC_SCOPES = [\n  {\n    value: 'country',\n    label: 'Country'\n  },\n  {\n    value: 'site',\n    label: 'Site'\n  },\n  {\n    value: 'cluster',\n    label: 'Cluster'\n  }\n];\nexport const DEFAULT_AUTH_STEPS = [\n  {\n    value: 'id_card',\n    label: 'ID Card'\n  },\n  {\n    value: 'phone',\n    label: 'Phone'\n  },\n  {\n    value: 'iris_scan',\n    label: 'Iris Scan'\n  }\n];\nexport const DEFAULT_VMP_CONFIG = {\n  syncScope: DEFAULT_SYNC_SCOPES[0].value,\n  operatorCredentialsRetentionTime: DEFAULT_OPERATOR_CREDENTIALS_RETENTION_TIME,\n  operatorOfflineSessionTimeout: DEFAULT_OPERATOR_OFFLINE_SESSION_TIMEOUT,\n  vaccine: [{}],\n  canUseDifferentManufacturers: true,\n  allowManualParticipantIDEntry: true,\n  manufacturers: [{}],\n  personLanguages: [],\n  authSteps: [{}],\n  irisScore: null,\n  addressFields: [],\n  participantIDRegex: '',\n  isBiometricOnlySearchWithoutPhone: true\n};\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport './RegisterPatient.scss';\nimport '../Inputs.scss';\nimport { FormattedMessage, injectIntl } from 'react-intl';\nimport { Button, Col, Form, ListGroup, ListGroupItem, Row, Spinner } from 'reactstrap';\nimport _ from 'lodash';\nimport { IPatient } from '../../shared/models/patient';\nimport { extractPatientOrPersonData, extractPersonRelationships } from '../../shared/util/patient-util';\nimport Check from '../../assets/img/check.svg';\nimport CheckCircle from '../../assets/img/check-circle.svg';\nimport {\n  editPatient,\n  editPerson,\n  register,\n  registerPerson,\n  updateRelationships,\n  getPatientIdentifierTypes\n} from '../../redux/reducers/registration';\nimport { RouteComponentProps, withRouter } from 'react-router-dom';\nimport { getPatient } from '../../redux/reducers/patient';\nimport { getPerson, getPersonRelationships } from '../../redux/reducers/person';\nimport defaultSteps from './patientDefaultSteps.json';\nimport caregiverDefaultSteps from './caregiverDefaultSteps.json';\nimport Step from './Step';\nimport Confirm from './Confirm';\nimport queryString from 'query-string';\nimport { redirectUrl } from '../../shared/util/url-util';\nimport { PATIENT_PAGE_URL } from '../../shared/constants/openmrs';\nimport RegisterPatientConfirmationModal from './RegisterPatientConfirmationModal';\nimport { SETTING_KEY as VMP_CONFIG_SETTING_KEY } from '../../shared/constants/vmp-config';\nimport { getSettingByQuery } from '../../redux/reducers/setttings';\n\nexport interface IRegistrationProps extends StateProps, DispatchProps, RouteComponentProps<{ id?: string }> {\n  intl: any;\n  isCaregiver: boolean;\n}\n\nexport interface IRegistrationState {\n  step: number;\n  patient: IPatient;\n  stepValidity: object;\n  visitedSteps: number[];\n  success: boolean;\n}\n\nclass RegistrationForm extends React.Component<IRegistrationProps, IRegistrationState> {\n  state = {\n    step: 0,\n    patient: {} as IPatient,\n    stepValidity: {},\n    visitedSteps: [0] as number[],\n    success: false\n  };\n  entityName = this.props.isCaregiver ? 'Caregiver' : 'Patient';\n  steps = () => (this.props.isCaregiver ? this.props.caregiverSteps : this.props.patientSteps);\n  patient = () => (this.props.isCaregiver ? this.props.person : this.props.patient);\n\n  componentDidMount() {\n    this.props.getPatientIdentifierTypes();\n    this.props.getSettingByQuery(VMP_CONFIG_SETTING_KEY);\n\n    if (this.isEdit()) {\n      this.props.getPersonRelationships(this.props.match.params.id);\n      if (this.props.isCaregiver) {\n        this.props.getPerson(this.props.match.params.id);\n      } else {\n        this.props.getPatient(this.props.match.params.id);\n      }\n    }\n  }\n\n  componentDidUpdate(prevProps: Readonly<IRegistrationProps>, prevState: Readonly<IRegistrationState>, snapshot?: any) {\n    if (this.isEdit()) {\n      const prevPatient = this.props.isCaregiver ? prevProps.person : prevProps.patient;\n      if (prevPatient !== this.patient() && !!this.patient()) {\n        const patient = {\n          relatives: this.state.patient?.relatives || [],\n          ...extractPatientOrPersonData(this.patient())\n        };\n        this.setState({\n          patient,\n          stepValidity: {},\n          visitedSteps: _.map(this.steps(), (stepDefinition, i) => i)\n        });\n      } else if (prevProps.personRelationships !== this.props.personRelationships && this.props.personRelationships != null) {\n        const patient = {\n          ...this.state.patient,\n          relatives: extractPersonRelationships(this.props.match.params.id, this.props.personRelationships)\n        };\n        this.setState({\n          patient\n        });\n      }\n    }\n    if (!prevProps.success && this.props.success) {\n      this.setState({\n        success: true\n      });\n    }\n  }\n\n  isEdit() {\n    const { match } = this.props;\n    return match && match.params.id;\n  }\n\n  formName = () => (this.isEdit() ? `edit${this.entityName}` : `register${this.entityName}`);\n\n  setStep = step => {\n    const highestVisitedStep = Math.max(step, Math.max.apply(Math, this.state.visitedSteps));\n    this.setState({\n      step,\n      // tslint:disable-next-line:no-shadowed-variable\n      visitedSteps: [...Array(highestVisitedStep + 1)].map((_, stepNumber) => stepNumber)\n    });\n  };\n\n  canVisitStep = step => {\n    const highestVisitedStep = Math.max.apply(Math, this.state.visitedSteps);\n    if (highestVisitedStep >= step) {\n      // if a step (or any of the following steps) has already been visited, return true regardless of validation errors\n      return true;\n    }\n    // tslint:disable-next-line:no-shadowed-variable\n    if ([...Array(step)].every((_, stepNumber) => this.state.stepValidity[stepNumber]?.isValid)) {\n      // if every preceding step is valid (or non-required), return true\n      return true;\n    }\n    return false;\n  };\n\n  onStepClick = step => e => {\n    if (this.canVisitStep(step)) {\n      this.setStep(step);\n    }\n  };\n\n  stepList = () => {\n    const { stepValidity, visitedSteps } = this.state;\n    const isConfirmActive = this.steps().length === this.state.step;\n    return (\n      <ListGroup>\n        {_.map(this.steps(), (stepDefinition, i) => {\n          const isValid = stepValidity[i]?.isValid;\n          const isVisited = visitedSteps.indexOf(i) >= 0;\n          const isActive = i === this.state.step;\n          const icon = isValid ? (isActive ? CheckCircle : Check) : null;\n          return (\n            <ListGroupItem\n              active={i === this.state.step}\n              onClick={this.onStepClick(i)}\n              key={`step-${i}`}\n              className={isValid && isVisited ? 'valid' : ''}\n            >\n              {icon && <img src={icon} alt=\"step\" className=\"step-icon\" />}\n              {stepDefinition.label}\n            </ListGroupItem>\n          );\n        })}\n        <ListGroupItem active={isConfirmActive} onClick={this.onStepClick(this.steps().length)} key={`step-${this.steps().length}`}>\n          <FormattedMessage id={`registerPatient.steps.confirm.label`} />\n        </ListGroupItem>\n      </ListGroup>\n    );\n  };\n\n  stepForm = () => {\n    let regimenOptions = [];\n\n    if (this.props.settings?.setting?.value) {\n      const { vaccine: regimens } = JSON.parse(this.props.settings.setting.value);\n      regimenOptions = regimens.map(regimen => regimen['name']);\n    }\n\n    return (\n      <Form className=\"h-100 w-100\">\n        {_.map(this.steps(), (stepDefinition, i) => (\n          <div className={`step-content ${i === this.state.step ? '' : 'd-none'}`} key={`step-${i}`}>\n            <Step\n              patient={this.state.patient}\n              onPatientChange={this.onPatientChange}\n              stepButtons={this.stepButtons(i)}\n              stepDefinition={stepDefinition}\n              patientIdentifierTypes={this.props.patientIdentifierTypes}\n              setValidity={this.setValidity(i)}\n              setStep={this.setStep}\n              stepNumber={i}\n              regimens={regimenOptions}\n            />\n          </div>\n        ))}\n        <div className={`step-content ${this.steps().length === this.state.step ? '' : 'd-none'}`} key={`step-${this.steps().length}`}>\n          <Confirm\n            patient={this.state.patient}\n            onPatientChange={this.onPatientChange}\n            stepButtons={this.stepButtons(this.steps().length)}\n            steps={this.steps()}\n            isCaregiver={this.props.isCaregiver}\n          />\n        </div>\n      </Form>\n    );\n  };\n\n  onNextClick = isValid => e => {\n    if (isValid) {\n      this.setStep(this.state.step + 1);\n    }\n  };\n\n  isFormValid = () => _.isEmpty(_.pickBy(this.state.stepValidity, step => !step.isValid));\n\n  onConfirmClick = e => {\n    if (!this.props.loading && this.isFormValid()) {\n      if (this.isEdit()) {\n        if (this.props.isCaregiver) {\n          this.props.updateRelationships(this.state.patient);\n          this.props.editPerson(this.state.patient);\n        } else {\n          this.props.editPatient(this.state.patient);\n        }\n      } else {\n        if (this.props.isCaregiver) {\n          this.props.registerPerson(this.state.patient);\n        } else {\n          this.props.register(this.state.patient);\n        }\n      }\n    }\n  };\n\n  stepButtons = stepNumber => isValid => {\n    const person = this.props.isCaregiver ? 'caregiver' : 'patient';\n    const stepCount = this.steps().length;\n    return (\n      <div className=\"step-buttons\">\n        {stepNumber > 0 ? (\n          <Button id={`${person}-previous-button`} onClick={() => this.setStep(stepNumber - 1)}>\n            <FormattedMessage id=\"registerPatient.previous\" />\n          </Button>\n        ) : (\n          <div />\n        )}\n        {stepNumber < stepCount ? (\n          <Button\n            id={`${person}-next-button`}\n            onClick={this.onNextClick(isValid)}\n            disabled={!isValid || stepNumber >= stepCount + 1}\n            className=\"next\"\n          >\n            <FormattedMessage id=\"registerPatient.next\" />\n          </Button>\n        ) : (\n          <Button\n            id={`${person}-confirm-button`}\n            onClick={this.onConfirmClick}\n            className=\"next\"\n            disabled={this.props.loading || !this.isFormValid()}\n          >\n            <FormattedMessage id=\"registerPatient.confirm\" />\n          </Button>\n        )}\n      </div>\n    );\n  };\n\n  onPatientChange = patient =>\n    this.setState({\n      patient: { ...patient }\n    });\n\n  setValidity = step => (isValid, isDirty) => {\n    const { stepValidity } = this.state;\n    stepValidity[step] = {\n      isValid,\n      isDirty\n    };\n    this.setState({\n      stepValidity\n    });\n  };\n\n  success = () => {\n    const { location, id } = this.props;\n    const redirect = () =>\n      (window.location.href = id\n        ? `${PATIENT_PAGE_URL}?patientId=${id}${this.props.isCaregiver ? '&dashboard=person' : ''}`\n        : queryString.stringifyUrl({\n            url: redirectUrl(location.search)\n          }));\n\n    return (\n      <RegisterPatientConfirmationModal\n        className=\"register-patient-modal\"\n        header={{ id: 'registerPatient.steps.confirm.modal.title' }}\n        body={{ id: 'registerPatient.steps.confirm.modal.message' }}\n        onYes={redirect}\n        isOpen={this.state.success}\n      />\n    );\n  };\n\n  render() {\n    if (this.props.settingsLoading) {\n      return <Spinner />;\n    }\n    const formName = this.formName();\n    return (\n      <div className=\"register-patient\">\n        <>\n          {this.state.success && this.success()}\n          <h1>\n            <FormattedMessage id={`${formName}.title`} />\n          </h1>\n          <div className=\"helper-text\">\n            <FormattedMessage id={`${formName}.subtitle`} />\n          </div>\n          <Row className=\"mt-2\">\n            <Col xs={4} sm={3} className=\"step-list\">\n              {this.stepList()}\n            </Col>\n            <Col xs={8} sm={9} className=\"step\">\n              {this.stepForm()}\n            </Col>\n          </Row>\n        </>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = ({ registration, cflPatient, cflPerson, apps, settings }) => ({\n  loading: registration.loading,\n  success: registration.success,\n  message: registration.message,\n  id: registration.id,\n  patientIdentifierTypes: registration.patientIdentifierTypes,\n  patient: cflPatient.patient,\n  person: cflPerson.person,\n  personRelationships: cflPerson.personRelationships,\n  patientSteps: apps.patientRegistrationSteps || defaultSteps,\n  caregiverSteps: apps.caregiverRegistrationSteps || caregiverDefaultSteps,\n  settingsLoading: apps.loading || registration.loading,\n  settings\n});\n\nconst mapDispatchToProps = {\n  register,\n  registerPerson,\n  getPatient,\n  getPerson,\n  editPatient,\n  editPerson,\n  updateRelationships,\n  getPersonRelationships,\n  getPatientIdentifierTypes,\n  getSettingByQuery\n};\n\ntype StateProps = ReturnType<typeof mapStateToProps>;\ntype DispatchProps = typeof mapDispatchToProps;\n\nexport default connect(mapStateToProps, mapDispatchToProps)(injectIntl(withRouter(RegistrationForm)));\n","import React from 'react';\nimport RegistrationForm from './RegistrationForm';\n\nconst RegisterPatient = () => <RegistrationForm isCaregiver={false} />;\n\nexport default RegisterPatient;\n","import React from 'react';\nimport RegistrationForm from './RegistrationForm';\n\nconst RegisterCaregiver = () => <RegistrationForm isCaregiver />;\n\nexport default RegisterCaregiver;\n","import React from 'react';\nimport './Dashboard.scss';\nimport findPatient from '../../assets/img/find-patient.png';\nimport findCaregiver from '../../assets/img/find-caregiver.png';\nimport registerPatient from '../../assets/img/register-patient.png';\n\nimport { Link } from 'react-router-dom';\nimport { FormattedMessage } from 'react-intl';\n\nconst Dashboard = () => (\n  <div className=\"dashboard\">\n    <h2 className=\"title\">\n      <FormattedMessage id=\"home.title\" />\n    </h2>\n    <div className=\"items\">\n      <Link to=\"/find-patient\" className=\"item\">\n        <div className=\"item-content\">\n          <div className=\"item-icon\">\n            <img src={findPatient} alt=\"icon\" />\n          </div>\n          <div className=\"item-label\">\n            <FormattedMessage id=\"dashboard.findPatient\" />\n          </div>\n        </div>\n      </Link>\n      <Link to=\"/find-caregiver\" className=\"item\">\n        <div className=\"item-content\">\n          <div className=\"item-icon\">\n            <img src={findCaregiver} alt=\"icon\" />\n          </div>\n          <div className=\"item-label\">\n            <FormattedMessage id=\"dashboard.findCaregiver\" />\n          </div>\n        </div>\n      </Link>\n      <Link to=\"/register-patient\" className=\"item\">\n        <div className=\"item-content\">\n          <div className=\"item-icon\">\n            <img src={registerPatient} alt=\"icon\" />\n          </div>\n          <div className=\"item-label\">\n            <FormattedMessage id=\"dashboard.registerPatient\" />\n          </div>\n        </div>\n      </Link>\n    </div>\n  </div>\n);\n\nexport default Dashboard;\n","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","import React from 'react';\nimport { connect } from 'react-redux';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Table, Spinner } from 'reactstrap';\nimport './Conditions.scss';\nimport { FormattedMessage, injectIntl } from 'react-intl';\nimport '../Inputs.scss';\nimport { Link, RouteComponentProps, withRouter } from 'react-router-dom';\nimport { getConditionHistory, saveCondition, saveConditions } from '../../redux/reducers/condition';\nimport { addBreadcrumbs, resetBreadcrumbs } from '../../redux/reducers/breadcrumbs';\nimport { PATIENT_PAGE_URL } from '../../shared/constants/openmrs';\nimport { getPatient } from '../../redux/reducers/patient';\nimport Header from '@bit/soldevelo-omrs.cfl-components.person-header';\nimport PersonStatus from '@bit/soldevelo-cfl.omrs-components.person-status';\nimport { STATUS_ACTIVE, STATUS_INACTIVE } from '../../shared/constants/condition';\nimport { formatDate } from '../../shared/util/date-util';\nimport { successToast } from '@bit/soldevelo-omrs.cfl-components.toast-handler';\n\nexport interface IConditionsProps extends StateProps, DispatchProps, RouteComponentProps<{ patientUuid?: string }> {\n  intl: any;\n}\n\nexport interface IConditionsState {\n  active: boolean;\n  conditionToDelete: any;\n}\n\nclass Condition extends React.Component<IConditionsProps, IConditionsState> {\n  state = {\n    active: true,\n    conditionToDelete: null\n  };\n\n  redirectUrl = () => `${PATIENT_PAGE_URL}?patientId=${this.props.match.params.patientUuid}`;\n\n  componentDidMount() {\n    const id = this.props.match.params.patientUuid;\n    this.props.getConditionHistory(id);\n    this.props.getPatient(id);\n  }\n\n  componentDidUpdate(prevProps: Readonly<IConditionsProps>, prevState: Readonly<IConditionsState>, snapshot?: any) {\n    const { patient, match, conditionUpdated } = this.props;\n    const id = match.params.patientUuid;\n    if (!!patient && patient !== prevProps.patient) {\n      this.props.resetBreadcrumbs();\n      this.props.addBreadcrumbs([\n        {\n          label: patient.person.preferredName.display,\n          url: `${PATIENT_PAGE_URL}?patientId=${id}`,\n          order: 1\n        }\n      ]);\n    }\n    if (conditionUpdated && !prevProps.conditionUpdated) {\n      this.props.getConditionHistory(id);\n      successToast(this.props.intl.formatMessage({ id: 'conditions.success' }));\n    }\n  }\n\n  cancel = () => {\n    this.props.history.goBack();\n  };\n\n  editCondition = id => () => {\n    this.props.history.push(`/conditions/${this.props.match.params.patientUuid}/manage/?conditionId=${id}`);\n  };\n\n  setConditionToDelete = condition => () => {\n    this.setState({\n      conditionToDelete: condition\n    });\n  };\n\n  switchConditionActive = condition => () => {\n    condition.status = condition.status === STATUS_ACTIVE ? STATUS_INACTIVE : STATUS_ACTIVE;\n    this.props.saveCondition(condition);\n  };\n\n  renderConditionRow = (condition, i) => {\n    const { intl } = this.props;\n    const lastCondition = condition.conditions[condition.conditions.length - 1];\n    const isActive = lastCondition.status === STATUS_ACTIVE;\n    if (isActive === this.state.active) {\n      return (\n        <tr>\n          <td>{lastCondition.concept?.name}</td>\n          <td>{lastCondition.onSetDate && formatDate(intl, new Date(lastCondition.onSetDate))}</td>\n          <td>\n            <i className=\"icon-pencil edit-action\" onClick={this.editCondition(lastCondition.uuid)} />\n            <i className=\"icon-remove delete-action\" onClick={this.setConditionToDelete(condition)} />\n            <button className=\"btn-small set-status-button\" onClick={this.switchConditionActive(lastCondition)}>{`${intl.formatMessage({\n              id: 'conditions.set'\n            })} ${isActive ? STATUS_INACTIVE : STATUS_ACTIVE}`}</button>\n          </td>\n        </tr>\n      );\n    }\n  };\n\n  switchActive = () => {\n    this.setState({\n      active: !this.state.active\n    });\n  };\n\n  voidCondition = () => {\n    const { conditionToDelete } = this.state;\n    conditionToDelete.conditions.forEach(condition => {\n      condition.voided = true;\n      condition.endDate = new Date().toISOString();\n    });\n    this.props.saveConditions(conditionToDelete.conditions);\n    this.setState({\n      conditionToDelete: null\n    });\n  };\n\n  renderDeleteModal = () => (\n    <Modal isOpen fade={false}>\n      <ModalHeader closeButton>\n        <FormattedMessage id=\"conditions.remove\" />\n      </ModalHeader>\n\n      <ModalBody>\n        <p>\n          <FormattedMessage id=\"conditions.removeConfirmation\" />\n        </p>\n      </ModalBody>\n\n      <ModalFooter>\n        <button className=\"btn cancel\" onClick={this.setConditionToDelete(null)}>\n          <FormattedMessage id=\"conditions.no\" />\n        </button>\n        <button className=\"btn btn-primary\" onClick={this.voidCondition}>\n          <FormattedMessage id=\"conditions.yes\" />\n        </button>\n      </ModalFooter>\n    </Modal>\n  );\n\n  renderConditionTable = () => (\n    <Table borderless striped responsive className=\"table\">\n      <thead>\n        <tr>\n          <th>\n            <FormattedMessage id=\"conditions.condition\" />\n          </th>\n          <th>\n            <FormattedMessage id=\"conditions.onsetDate\" />\n          </th>\n          <th>\n            <FormattedMessage id=\"conditions.actions\" />\n          </th>\n        </tr>\n      </thead>\n      <tbody>{this.props.conditions.map((condition, i) => this.renderConditionRow(condition, i))}</tbody>\n    </Table>\n  );\n\n  loading = () => (\n    <div className=\"px-5 py-3\">\n      <Spinner />\n    </div>\n  );\n\n  render() {\n    const headerProps = {\n      ...this.props,\n      patientUuid: this.props.match.params.patientUuid,\n      dashboardType: 'PATIENT',\n      redirectUrl: this.redirectUrl(),\n      displayTelephone: true\n    };\n    return (\n      <div className=\"conditions\">\n        <Header {...headerProps}>\n          <PersonStatus patientUuid={headerProps.patientUuid} />\n        </Header>\n        {!!this.state.conditionToDelete && this.renderDeleteModal()}\n        <h2>\n          <FormattedMessage id={'conditions.title'} />\n        </h2>\n        <div className=\"inner-content\">\n          <div className=\"error\">{this.props.error}</div>\n          <ul className=\"nav nav-tabs\">\n            <li className=\"nav-item\">\n              <div className={`nav-link ${this.state.active && 'active'}`} onClick={this.switchActive}>\n                <FormattedMessage id={'conditions.active'} />\n              </div>\n            </li>\n            <li className=\"nav-item\">\n              <div className={`nav-link ${!this.state.active && 'active'}`} onClick={this.switchActive}>\n                <FormattedMessage id={'conditions.inactive'} />\n              </div>\n            </li>\n          </ul>\n          {this.props.loading && this.props.conditions.length === 0 ? this.loading() : this.renderConditionTable()}\n        </div>\n        <div className=\"mt-5\">\n          <div className=\"d-inline\">\n            <a href={this.redirectUrl()} className=\"cancel btn\">\n              <FormattedMessage id={'common.return'} />\n            </a>\n          </div>\n          <div className=\"d-inline pull-right confirm-button-container\">\n            <Link to={this.props.location.pathname + '/manage'} className=\"save btn\">\n              <FormattedMessage id={'conditions.addNew'} />\n            </Link>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = ({ condition, cflPatient, cflPerson }) => ({\n  error: condition.errorMessage,\n  conditions: condition.conditions,\n  loading: condition.loading,\n  conditionUpdated: condition.conditionUpdated,\n  patient: cflPatient.patient,\n  person: cflPerson.person\n});\n\nconst mapDispatchToProps = { saveCondition, saveConditions, getConditionHistory, addBreadcrumbs, resetBreadcrumbs, getPatient };\n\ntype StateProps = ReturnType<typeof mapStateToProps>;\ntype DispatchProps = typeof mapDispatchToProps;\n\nexport default connect(mapStateToProps, mapDispatchToProps)(injectIntl(withRouter(Condition)));\n","import { ZERO } from './input';\n\nexport const VMP_VACCINATION_SCHEDULE_SETTING_KEY = 'cfl.vaccines';\nexport const DEFAULT_DOSING_VISIT_TYPES = ['Dosing'];\nexport const EMPTY_VISIT = {\n  doseNumber: ZERO,\n  nameOfDose: '',\n  numberOfFutureVisit: ZERO,\n  lowWindow: ZERO,\n  midPointWindow: ZERO,\n  upWindow: ZERO\n};\nexport const EMPTY_REGIMEN = { name: null };\nexport const DEFAULT_VMP_VACCINATION_SCHEDULE = [EMPTY_REGIMEN];\n","export const parseJson = (value, defaultValue = [] as any) => (value ? JSON.parse(value) : defaultValue);\n","import { FormattedMessage } from 'react-intl';\nimport React from 'react';\n\nexport const getSelectOptions = (selectOptions, placeholderId) => (\n  <>\n    {placeholderId && (\n      <option value=\"\" disabled selected hidden>\n        <FormattedMessage id={placeholderId} />\n      </option>\n    )}\n    {selectOptions.map(option => (\n      <option value={option.value || option} key={`option-${option.value || option}`}>\n        {option.label || option}\n      </option>\n    ))}\n  </>\n);\n\nexport const extractEventValue = e => (!!e?.target ? (e?.target?.type === 'checkbox' ? e.target.checked : e?.target?.value) : e);\n\nexport const validateRegex = expr => {\n  if (!!expr) {\n    try {\n      // tslint:disable-next-line:no-unused-expression\n      new RegExp(expr);\n      return true;\n    } catch {\n      return false;\n    }\n  }\n  return true;\n};\n\nexport const ordinalIndicator = number => {\n  const i = number % 10;\n  const j = number % 100;\n  if (i === 1 && j !== 11) {\n    return 'common.ordinalSuffix.st';\n  } else if (i === 2 && j !== 12) {\n    return 'common.ordinalSuffix.nd';\n  } else if (i === 3 && j !== 13) {\n    return 'common.ordinalSuffix.rd';\n  }\n  return 'common.ordinalSuffix.th';\n};\n\nexport const selectDefaultTheme = theme => ({\n  ...theme,\n  colors: {\n    ...theme.colors,\n    primary: '#00455c',\n    primary25: '#e4e7e7',\n    primary50: '#e4e7e7'\n  }\n});\n\nexport const getPlaceholder = (intl, translationId, required) => {\n  let placeholder = intl.formatMessage({ id: translationId });\n  if (required) {\n    placeholder = [\n      placeholder,\n      intl.formatMessage({\n        id: 'common.required'\n      })\n    ].join(' ');\n  }\n  return placeholder;\n};\n\nexport const yesNoOptions = intl => [\n  {\n    label: intl.formatMessage({ id: 'common.yes' }),\n    value: true\n  },\n  {\n    label: intl.formatMessage({ id: 'common.no' }),\n    value: false\n  }\n];\n","import React from 'react';\nimport './VmpConfig.scss';\nimport { FormattedMessage } from 'react-intl';\nimport { Label } from 'reactstrap';\nimport { Buttons } from '../common/form/Buttons';\n\nexport function SyncScope({ intl, config, syncScopes, onValueChange }) {\n  return (\n    <>\n      <Label className=\"mr-5 mb-0\">\n        <FormattedMessage id=\"vmpConfig.syncScope\" />\n        <span\n          className=\"glyphicon glyphicon-info-sign ml-2\"\n          aria-hidden=\"true\"\n          title={intl.formatMessage({ id: 'vmpConfig.syncScopeTooltip' })}\n        />\n      </Label>\n      <Buttons options={syncScopes} entity={config} fieldName=\"syncScope\" onChange={onValueChange('syncScope')} />\n    </>\n  );\n}\n","export const swapPositions = (array, idx, offset) => {\n  const targetIdx = idx + offset;\n  if (targetIdx >= 0 && targetIdx < array.length) {\n    [array[idx], array[targetIdx]] = [array[targetIdx], array[idx]];\n  }\n  return array;\n};\n","import React from 'react';\n\nimport Select, { components } from 'react-select';\nimport { SortableContainer, SortableElement, SortableHandle } from 'react-sortable-hoc';\nimport { swapPositions } from '../../../shared/util/array-util';\n\nconst NONE = 'none';\nconst READONLY_VALUE_LABEL_PADDING_RIGHT = 6;\n\nexport const SortableMultiValue = SortableElement(props => {\n  // this prevents the menu from being opened/closed when the user clicks\n  // on a value to begin dragging it. ideally, detecting a click (instead of\n  // a drag) would still focus the control and toggle the menu\n  const onMouseDown = e => {\n    e.preventDefault();\n    e.stopPropagation();\n  };\n  const innerProps = { ...props.innerProps, onMouseDown };\n  return <components.MultiValue {...props} innerProps={innerProps} />;\n});\n\nexport const SortableMultiValueLabel = SortableHandle(props => <components.MultiValueLabel {...props} />);\n\nexport const SortableSelect = SortableContainer(Select);\n\nconst SortableMultiSelect = props => {\n  const onSortEnd = ({ oldIndex, newIndex }) => {\n    const newValue = swapPositions(props.value, oldIndex, newIndex - oldIndex);\n    props.onChange(newValue);\n  };\n\n  return (\n    <SortableSelect\n      useDragHandle\n      // react-sortable-hoc props:\n      axis=\"xy\"\n      onSortEnd={onSortEnd}\n      distance={4}\n      // small fix for https://github.com/clauderic/react-sortable-hoc/pull/352:\n      getHelperDimensions={({ node }) => node.getBoundingClientRect()}\n      // react-select props:\n      {...props}\n      isMulti\n      components={{\n        MultiValue: SortableMultiValue,\n        MultiValueLabel: SortableMultiValueLabel\n      }}\n      closeMenuOnSelect={false}\n      {...(props.isDisabled && {\n        styles: {\n          ...props.styles,\n          indicatorsContainer: base => ({\n            ...base,\n            display: NONE\n          }),\n          multiValueLabel: base => ({\n            ...base,\n            paddingRight: READONLY_VALUE_LABEL_PADDING_RIGHT\n          }),\n          multiValueRemove: base => ({\n            ...base,\n            display: NONE\n          })\n        }\n      })}\n    />\n  );\n};\n\nexport default SortableMultiSelect;\n","import React, { FormEvent } from 'react';\nimport './RadioButtons.scss';\n\ninterface IRadioButtonOption {\n  value: string;\n  label: string;\n}\n\nexport interface IRadioButtonsProps {\n  name: string;\n  options: Array<IRadioButtonOption>;\n  value: string;\n  onChange: (event: FormEvent) => void;\n}\n\nconst RadioButtons = (props: IRadioButtonsProps) => (\n  <div onChange={props.onChange} className=\"input-container radio-buttons\">\n    {props.options.map(option => (\n      <div className=\"radio-button-wrapper\" key={option.label}>\n        <input\n          type=\"radio\"\n          id={`${option.value}-${props.name}`}\n          name={props.name}\n          value={option.value}\n          className=\"radio-button\"\n          checked={props.value === option.value}\n        />\n        <label htmlFor={`${option.value}-${props.name}`}>{option.label}</label>\n      </div>\n    ))}\n  </div>\n);\n\nexport default RadioButtons;\n","import React from 'react';\nimport { Input } from 'reactstrap';\nimport Select from 'react-select';\nimport SortableMultiSelect from './SortableSelect';\nimport TextareaAutosize from 'react-textarea-autosize';\nimport RadioButtons from '../radio-buttons/RadioButtons';\n\ninterface IWithPlaceholderProps {\n  placeholder: string;\n  showPlaceholder: boolean;\n  wrapperClassName?: string;\n  // input props\n  value?: any;\n  onChange?: any;\n  options?: any[];\n  isMulti?: boolean;\n  isOptionSelected?: any;\n  classNamePrefix?: string;\n  theme?: any;\n  [propName: string]: any;\n}\n\nexport const withPlaceholder = <P extends object>(WrappedComponent: React.ComponentType<P>) =>\n  class extends React.Component<P & IWithPlaceholderProps> {\n    render() {\n      return (\n        <div className={`input-container ${this.props.wrapperClassName || ''}`}>\n          <WrappedComponent\n            {...this.props}\n            placeholder={this.props.placeholder || ''}\n            styles={{\n              menu: provided => ({ ...provided, zIndex: 9999 })\n            }}\n          />\n          {!!this.props.showPlaceholder && <span className=\"placeholder\">{this.props.placeholder || ''}</span>}\n        </div>\n      );\n    }\n  };\n\nexport const InputWithPlaceholder = withPlaceholder(Input);\nexport const SelectWithPlaceholder = withPlaceholder(Select);\nexport const SortableSelectWithPlaceholder = withPlaceholder(SortableMultiSelect);\nexport const TextareaAutosizeWithPlaceholder = withPlaceholder(TextareaAutosize);\nexport const RadioButtonsWithPlaceholder = withPlaceholder(RadioButtons);\n","import React from 'react';\nimport './VmpConfig.scss';\nimport { FormattedMessage } from 'react-intl';\nimport { Label } from 'reactstrap';\nimport { InputWithPlaceholder } from '../common/form/withPlaceholder';\nimport { ONE } from 'src/shared/constants/input';\n\nexport function OperatorCredentialsOfflineRetentionTime({ intl, config, getPlaceholder, onNumberValueChange }) {\n  const operatorCredentialsOfflineRetentionTime = config.operatorCredentialsRetentionTime;\n  return (\n    <>\n      <Label>\n        <FormattedMessage id=\"vmpConfig.operatorCredentialsOfflineRetentionTime\" />\n        <span\n          className=\"glyphicon glyphicon-info-sign ml-2\"\n          aria-hidden=\"true\"\n          title={intl.formatMessage({ id: 'vmpConfig.operatorCredentialsOfflineRetentionTimeTooltip' })}\n        />\n      </Label>\n      <InputWithPlaceholder\n        placeholder={getPlaceholder(intl, 'vmpConfig.days', true)}\n        showPlaceholder={!!operatorCredentialsOfflineRetentionTime}\n        value={operatorCredentialsOfflineRetentionTime}\n        onChange={onNumberValueChange('operatorCredentialsRetentionTime', ONE)}\n        type=\"number\"\n        pattern=\"[1-9]\"\n        min={ONE}\n        data-testid=\"operatorCredentialsOfflineRetentionTimeInput\"\n      />\n    </>\n  );\n}\n\nexport function OperatorSessionTimeout({ intl, config, getPlaceholder, onNumberValueChange }) {\n  const operatorSessionTimeout = config.operatorOfflineSessionTimeout;\n  return (\n    <>\n      <Label>\n        <FormattedMessage id=\"vmpConfig.operatorSessionTimeout\" />\n        <span\n          className=\"glyphicon glyphicon-info-sign ml-2\"\n          aria-hidden=\"true\"\n          title={intl.formatMessage({ id: 'vmpConfig.operatorSessionTimeoutTooltip' })}\n        />\n      </Label>\n      <InputWithPlaceholder\n        placeholder={getPlaceholder(intl, 'vmpConfig.minutes', true)}\n        showPlaceholder={!!operatorSessionTimeout}\n        value={operatorSessionTimeout}\n        onChange={onNumberValueChange('operatorOfflineSessionTimeout', ONE)}\n        type=\"number\"\n        pattern=\"[1-9]\"\n        min={ONE}\n        data-testid=\"operatorOfflineSessionTimeoutInput\"\n      />\n    </>\n  );\n}\n","import React from 'react';\nimport { injectIntl } from 'react-intl';\n\nexport interface IValidationErrorProps {\n  intl: any;\n  message?: string;\n  required?: boolean;\n}\n\nfunction ValidationError(props: IValidationErrorProps) {\n  const { intl, message, required } = props;\n  return (\n    <span className=\"error field-error\" data-testid=\"fieldError\">\n      {intl.formatMessage({\n        id: required ? 'common.error.required' : message\n      })}\n    </span>\n  );\n}\n\nexport default injectIntl(ValidationError);\n","import React from 'react';\nimport Plus from '../../../assets/img/plus.png';\nimport Minus from '../../../assets/img/minus.png';\n\nexport function PlusMinusButtons({ intl, onPlusClick, onMinusClick, isPlusButtonVisible = true }) {\n  return (\n    <div className=\"align-items-center justify-content-center d-flex action-icons\">\n      <div className=\"action-icons-inner\">\n        <img\n          src={Minus}\n          title={intl.formatMessage({ id: 'vmpConfig.delete' })}\n          alt=\"remove\"\n          className=\"remove-item\"\n          onClick={onMinusClick}\n          data-testid=\"removeItem\"\n        />\n        {isPlusButtonVisible && (\n          <img\n            src={Plus}\n            title={intl.formatMessage({ id: 'vmpConfig.addNew' })}\n            alt=\"add\"\n            className=\"mx-2 add-item\"\n            onClick={onPlusClick}\n            data-testid=\"addItem\"\n          />\n        )}\n      </div>\n    </div>\n  );\n}\n","import React from 'react';\nimport './VmpConfig.scss';\nimport { FormattedMessage } from 'react-intl';\nimport { Label } from 'reactstrap';\nimport { InputWithPlaceholder } from '../common/form/withPlaceholder';\nimport { Buttons } from '../common/form/Buttons';\nimport { extractEventValue, validateRegex, yesNoOptions } from '../../shared/util/form-util';\nimport _ from 'lodash';\nimport ValidationError from '../common/form/ValidationError';\nimport { PlusMinusButtons } from '../common/form/PlusMinusButtons';\n\nconst EMPTY_MANUFACTURER = { name: '', barcodeRegex: '' };\n\nexport function CanUseDifferentManufacturers({ intl, config, onValueChange }) {\n  return (\n    <>\n      <Label className=\"mr-4 mb-0\">\n        <FormattedMessage id=\"vmpConfig.canUseDifferentManufacturers\" />\n        <span\n          className=\"glyphicon glyphicon-info-sign ml-2\"\n          aria-hidden=\"true\"\n          title={intl.formatMessage({ id: 'vmpConfig.canUseDifferentManufacturersTooltip' })}\n        />\n      </Label>\n      <Buttons\n        options={yesNoOptions(intl)}\n        entity={config}\n        fieldName=\"canUseDifferentManufacturers\"\n        onChange={onValueChange('canUseDifferentManufacturers')}\n      />\n    </>\n  );\n}\n\nexport function Manufacturers({ intl, config, showValidationErrors, openModal, closeModal, onValueChange }) {\n  const manufacturers = config.manufacturers || [];\n  const vaccine = config.vaccine || [];\n\n  const removeManufacturer = idx => {\n    const manufacturerName = manufacturers[idx].name;\n    manufacturers.splice(idx, 1);\n    if (manufacturers.length === 0) {\n      addManufacturer();\n    }\n    onValueChange('manufacturers')(manufacturers);\n    // remove manufacturer from regimen\n    vaccine.forEach(v => {\n      if (!!v.manufacturers) {\n        v.manufacturers = v.manufacturers.filter(mf => mf !== manufacturerName);\n      }\n    });\n    onValueChange('vaccine')(vaccine);\n  };\n\n  const onManufacturerRemove = idx => {\n    const manufacturerName = manufacturers[idx].name;\n    if (vaccine.some(regimen => !!regimen.manufacturers && regimen.manufacturers.includes(manufacturerName))) {\n      openModal('vmpConfig.error.header', 'vmpConfig.error.manufacturerAssigned');\n    } else {\n      openModal('vmpConfig.warning.header', 'vmpConfig.warning.deleteManufacturer', () => removeManufacturer(idx), closeModal);\n    }\n  };\n\n  const addManufacturer = () => {\n    manufacturers.push(_.clone(EMPTY_MANUFACTURER));\n    onValueChange('manufacturers')(manufacturers);\n  };\n\n  const onManufacturerChange = (i, fieldName) => e => {\n    const value = extractEventValue(e);\n    if (fieldName === 'name') {\n      // update regimen's manufacturers when the name has changed\n      const name = manufacturers[i].name;\n      vaccine.forEach(v => {\n        if (!!v.manufacturers && !!v.manufacturers.length) {\n          v.manufacturers = v.manufacturers.map(mf => (mf === name ? value : mf));\n        }\n      });\n      onValueChange('vaccine')(vaccine);\n    }\n    manufacturers[i][fieldName] = value;\n    onValueChange('manufacturers')(manufacturers);\n  };\n\n  return (\n    <>\n      <Label>\n        <FormattedMessage id=\"vmpConfig.manufacturers\" />\n        <span\n          className=\"glyphicon glyphicon-info-sign ml-2\"\n          aria-hidden=\"true\"\n          title={intl.formatMessage({ id: 'vmpConfig.manufacturersTooltip' })}\n        />\n      </Label>\n      {(manufacturers || []).map((manufacturer, i) => {\n        const isNameEmpty = !manufacturer.name;\n        const isBarcodeRegexInvalid = !validateRegex(manufacturer.barcodeRegex) || !manufacturer.barcodeRegex;\n        return (\n          <div key={`manufacturers-${i}`} className=\"inline-fields\">\n            <div className=\"flex-1 input-container\">\n              <InputWithPlaceholder\n                placeholder={intl.formatMessage({ id: 'vmpConfig.manufacturersName' })}\n                showPlaceholder={!!manufacturer.name}\n                value={manufacturer.name}\n                onChange={onManufacturerChange(i, 'name')}\n                className={showValidationErrors && isNameEmpty ? 'invalid' : ''}\n              />\n              {showValidationErrors && isNameEmpty && <ValidationError message=\"vmpConfig.error.nameRequired\" />}\n            </div>\n            <div className=\"flex-2 input-container\">\n              <InputWithPlaceholder\n                placeholder={intl.formatMessage({ id: 'vmpConfig.barcodeRegex' })}\n                showPlaceholder={!!manufacturer.barcodeRegex}\n                value={manufacturer.barcodeRegex}\n                onChange={onManufacturerChange(i, 'barcodeRegex')}\n                className={showValidationErrors && isBarcodeRegexInvalid ? 'invalid' : ''}\n              />\n              {showValidationErrors && isBarcodeRegexInvalid && <ValidationError message=\"vmpConfig.error.barcodeRegexInvalid\" />}\n            </div>\n            <PlusMinusButtons\n              intl={intl}\n              onPlusClick={addManufacturer}\n              onMinusClick={() => onManufacturerRemove(i)}\n              isPlusButtonVisible={i === manufacturers.length - 1}\n            />\n          </div>\n        );\n      })}\n    </>\n  );\n}\n","import React from 'react';\nimport './VmpConfig.scss';\nimport { FormattedMessage } from 'react-intl';\nimport { Label } from 'reactstrap';\nimport { InputWithPlaceholder, SortableSelectWithPlaceholder } from '../common/form/withPlaceholder';\nimport { extractEventValue, selectDefaultTheme } from '../../shared/util/form-util';\nimport _ from 'lodash';\nimport ValidationError from '../common/form/ValidationError';\nimport { PlusMinusButtons } from '../common/form/PlusMinusButtons';\n\nconst EMPTY_REGIMEN = { name: '', manufacturers: [] };\n\nexport function Regimen({\n  intl,\n  config,\n  vaccinationSchedule,\n  savedRegimen,\n  patientLinkedRegimens,\n  showValidationErrors,\n  isRegimenNameDuplicated,\n  readOnly = false,\n  openModal,\n  closeModal,\n  onValueChange,\n  onVaccinationScheduleChange\n}) {\n  const { vaccine, manufacturers } = config;\n\n  const onVaccineChange = (i, fieldName, isMultiselect) => e => {\n    vaccine[i][fieldName] = isMultiselect ? e.map(option => option.label) : extractEventValue(e);\n    onValueChange('vaccine')(vaccine);\n  };\n\n  const removeRegimen = idx => {\n    // delete a regimen together with a corresponding vaccination schedule (if exists)\n    onVaccinationScheduleChange(vaccinationSchedule.filter(vs => vs.name !== vaccine[idx].name));\n    vaccine.splice(idx, 1);\n    if (vaccine.length === 0) {\n      addRegimen();\n    }\n    onValueChange('vaccine')(vaccine);\n  };\n\n  const onRegimenRemove = idx => {\n    const regimenName = !!vaccine[idx] ? vaccine[idx].name : null;\n    const linkedRegimen = !!regimenName ? patientLinkedRegimens.find(regimen => regimen.regimenName === regimenName) : null;\n    if (!!linkedRegimen && !!linkedRegimen.anyPatientLinkedWithRegimen) {\n      openModal('vmpConfig.error.header', 'vmpConfig.error.regimenLinked');\n    } else {\n      openModal('vmpConfig.warning.header', 'vmpConfig.warning.deleteRegimen', () => removeRegimen(idx), closeModal);\n    }\n  };\n\n  const addRegimen = () => {\n    vaccine.push(_.clone(EMPTY_REGIMEN));\n    onValueChange('vaccine')(vaccine);\n  };\n\n  return (\n    <>\n      <Label>\n        <FormattedMessage id=\"vmpConfig.regimen\" />\n        <span\n          className=\"glyphicon glyphicon-info-sign ml-2\"\n          aria-hidden=\"true\"\n          title={intl.formatMessage({ id: 'vmpConfig.regimenTooltip' })}\n        />\n      </Label>\n      {(vaccine || []).map((regimen, i) => {\n        const isNameEmpty = !regimen.name;\n        const isNameDuplicated = isRegimenNameDuplicated(vaccine, regimen, i);\n        const isManufacturersEmpty = !regimen.manufacturers.length;\n        return (\n          <div key={`regimen-${i}`} className=\"inline-fields\">\n            <div className=\"flex-1 input-container\">\n              <InputWithPlaceholder\n                placeholder={intl.formatMessage({ id: 'vmpConfig.regimenName' })}\n                showPlaceholder={!!regimen.name}\n                value={regimen.name}\n                onChange={onVaccineChange(i, 'name', false)}\n                readOnly={!!regimen.name && savedRegimen.includes(regimen)}\n                className={showValidationErrors && (isNameEmpty || isNameDuplicated) ? 'invalid' : ''}\n              />\n              {showValidationErrors &&\n                (isNameEmpty ? (\n                  <ValidationError message=\"vmpConfig.error.nameRequired\" />\n                ) : (\n                  isNameDuplicated && <ValidationError message=\"vmpConfig.error.nameDuplicate\" />\n                ))}\n            </div>\n            <div className=\"flex-2 default-select-multi input-container\">\n              <SortableSelectWithPlaceholder\n                placeholder={intl.formatMessage({ id: 'vmpConfig.manufacturers' })}\n                showPlaceholder={!!regimen.manufacturers && regimen.manufacturers.length}\n                // value = index so it's possible to remove an option that was selected multiple times\n                value={regimen.manufacturers && regimen.manufacturers.map((mf, idx) => ({ label: mf, value: idx }))}\n                onChange={onVaccineChange(i, 'manufacturers', true)}\n                options={(manufacturers || []).map(manufacturer => ({\n                  label: manufacturer.name,\n                  value: manufacturer.name\n                }))}\n                className={showValidationErrors && isManufacturersEmpty ? 'default-select invalid' : 'default-select'}\n                classNamePrefix=\"default-select\"\n                isMulti\n                isOptionSelected={() => false}\n                theme={selectDefaultTheme}\n                isDisabled={savedRegimen.includes(regimen) && readOnly}\n              />\n              {showValidationErrors && isManufacturersEmpty && <ValidationError message=\"vmpConfig.error.regimenManufacturersEmpty\" />}\n            </div>\n            <PlusMinusButtons\n              intl={intl}\n              onPlusClick={addRegimen}\n              onMinusClick={() => onRegimenRemove(i)}\n              isPlusButtonVisible={i === vaccine.length - 1}\n            />\n          </div>\n        );\n      })}\n    </>\n  );\n}\n","import React from 'react';\nimport './VmpConfig.scss';\nimport { FormattedMessage } from 'react-intl';\nimport { Label } from 'reactstrap';\nimport { SelectWithPlaceholder } from '../common/form/withPlaceholder';\nimport { selectDefaultTheme } from '../../shared/util/form-util';\nimport ISO6391 from 'iso-639-1';\n\nconst LANGUAGE_OPTIONS = ISO6391.getAllNames().map(name => ({ label: name, value: name }));\n\nexport function PersonLanguages({ intl, config, onValueChange }) {\n  const personLanguages = config.personLanguages || [];\n\n  const onPersonLanguagesChange = name => selectedOptions => {\n    // person languages has a form of [{ name: value }, ...]\n    onValueChange(name)(selectedOptions.map(option => ({ name: option.value })));\n  };\n\n  return (\n    <>\n      <Label data-testid=\"personLanguagesLabel\">\n        <FormattedMessage id=\"vmpConfig.personLanguages\" />\n        <span\n          className=\"glyphicon glyphicon-info-sign ml-2\"\n          aria-hidden=\"true\"\n          title={intl.formatMessage({ id: 'vmpConfig.personLanguagesTooltip' })}\n        />\n      </Label>\n      <SelectWithPlaceholder\n        placeholder={intl.formatMessage({ id: 'vmpConfig.personLanguages' })}\n        showPlaceholder={!!personLanguages && personLanguages.length > 0}\n        value={personLanguages.map(lang => ({ label: lang.name, value: lang.name }))}\n        onChange={onPersonLanguagesChange('personLanguages')}\n        options={LANGUAGE_OPTIONS}\n        classNamePrefix=\"default-select\"\n        wrapperClassName=\"default-select-multi\"\n        isMulti\n        theme={selectDefaultTheme}\n      />\n    </>\n  );\n}\n","import React from 'react';\nimport './VmpConfig.scss';\nimport { FormattedMessage } from 'react-intl';\nimport { SelectWithPlaceholder } from '../common/form/withPlaceholder';\nimport { Input, Label } from 'reactstrap';\nimport { extractEventValue, selectDefaultTheme } from '../../shared/util/form-util';\nimport { swapPositions } from '../../shared/util/array-util';\nimport { PlusMinusButtons } from '../common/form/PlusMinusButtons';\n\nexport function AuthSteps({ intl, config, options, onValueChange }) {\n  const { authSteps } = config;\n\n  const onAuthStepsChange = (i, fieldName, isSelect) => e => {\n    authSteps[i][fieldName] = isSelect ? e.value : extractEventValue(e);\n    onValueChange('authSteps')(authSteps);\n  };\n\n  const removeAuthStep = idx => {\n    authSteps.splice(idx, 1);\n    if (authSteps.length === 0) {\n      addAuthStep();\n    }\n    onValueChange('authSteps')(authSteps);\n  };\n\n  const addAuthStep = () => {\n    authSteps.push({ mandatory: false });\n    onValueChange('authSteps')(authSteps);\n  };\n\n  const moveAuthStep = (idx, offset) => () => {\n    swapPositions(authSteps, idx, offset);\n    onValueChange('authSteps')(authSteps);\n  };\n\n  return (\n    <>\n      <Label>\n        <FormattedMessage id=\"vmpConfig.authSteps\" />\n        <span\n          className=\"glyphicon glyphicon-info-sign ml-2\"\n          aria-hidden=\"true\"\n          title={intl.formatMessage({ id: 'vmpConfig.authStepsTooltip' })}\n        />\n      </Label>\n      {(authSteps || []).map((authStep, i) => (\n        <div key={`authStep-${i}`} className=\"inline-fields\">\n          <div className=\"d-flex flex-column order-icons\">\n            <span\n              className={`glyphicon glyphicon-chevron-up ${i === 0 ? 'disabled' : ''}`}\n              title={intl.formatMessage({ id: 'common.moveUp' })}\n              aria-hidden=\"true\"\n              onClick={moveAuthStep(i, -1)}\n            />\n            <span\n              className={`glyphicon glyphicon-chevron-down ${i === authSteps.length - 1 ? 'disabled' : ''}`}\n              title={intl.formatMessage({ id: 'common.moveDown' })}\n              aria-hidden=\"true\"\n              onClick={moveAuthStep(i, 1)}\n            />\n          </div>\n          <div className=\"input-container d-flex align-items-center justify-content-center\">\n            <Label>\n              <Input\n                checked={authStep.mandatory}\n                onClick={() => onAuthStepsChange(i, 'mandatory', false)(!authStep.mandatory)}\n                type=\"checkbox\"\n              />\n              <span>\n                <FormattedMessage id=\"vmpConfig.mandatoryField\" />\n              </span>\n            </Label>\n          </div>\n          <SelectWithPlaceholder\n            placeholder={intl.formatMessage({ id: 'vmpConfig.authStepType' })}\n            showPlaceholder={!!authStep.type}\n            value={options.find(opt => opt.value === authStep.type) || null}\n            onChange={onAuthStepsChange(i, 'type', true)}\n            options={options.filter(opt => !authSteps.find(as => as.type === opt.value))}\n            wrapperClassName=\"flex-2\"\n            classNamePrefix=\"default-select\"\n            theme={selectDefaultTheme}\n          />\n          <PlusMinusButtons\n            intl={intl}\n            onPlusClick={addAuthStep}\n            onMinusClick={() => removeAuthStep(i)}\n            isPlusButtonVisible={i === authSteps.length - 1}\n          />\n        </div>\n      ))}\n    </>\n  );\n}\n","import React from 'react';\nimport './VmpConfig.scss';\nimport { FormattedMessage } from 'react-intl';\nimport { InputWithPlaceholder } from '../common/form/withPlaceholder';\nimport { Label } from 'reactstrap';\nimport { HUNDRED, ZERO } from 'src/shared/constants/input';\n\nexport function IrisScore({ intl, config, onNumberValueChange }) {\n  const { irisScore } = config;\n  return (\n    <>\n      <Label className=\"mr-4 mb-0\">\n        <FormattedMessage id=\"vmpConfig.irisScore\" />\n        <span\n          className=\"glyphicon glyphicon-info-sign ml-2\"\n          aria-hidden=\"true\"\n          title={intl.formatMessage({ id: 'vmpConfig.irisScoreTooltip' })}\n        />\n      </Label>\n      <div className=\"d-inline-block\">\n        <InputWithPlaceholder\n          placeholder={intl.formatMessage({ id: 'vmpConfig.irisScore' })}\n          showPlaceholder={irisScore !== null}\n          value={irisScore}\n          onChange={onNumberValueChange('irisScore', ZERO, HUNDRED)}\n          type=\"number\"\n          pattern=\"[1-9]\"\n          className=\"iris-score\"\n          min={ZERO}\n          max={HUNDRED}\n          data-testid=\"irisScoreInput\"\n        />\n      </div>\n    </>\n  );\n}\n","const DROPDOWN = 'DROPDOWN';\nconst FREE_INPUT = 'FREE_INPUT';\nexport const ADDRESS_FIELDS = ['countyDistrict', 'stateProvince', 'cityVillage', 'postalCode', 'address1', 'address2'];\nexport const ADDRESS_FIELD_TYPE = {\n  countyDistrict: DROPDOWN,\n  stateProvince: DROPDOWN,\n  cityVillage: DROPDOWN,\n  postalCode: DROPDOWN,\n  address1: FREE_INPUT,\n  address2: FREE_INPUT\n};\n","import React from 'react';\nimport './VmpConfig.scss';\nimport { FormattedMessage } from 'react-intl';\nimport { Label } from 'reactstrap';\nimport { InputWithPlaceholder, SelectWithPlaceholder } from '../common/form/withPlaceholder';\nimport { extractEventValue, selectDefaultTheme } from '../../shared/util/form-util';\nimport _ from 'lodash';\nimport { swapPositions } from '../../shared/util/array-util';\nimport { ADDRESS_FIELDS, ADDRESS_FIELD_TYPE } from '../../shared/constants/address';\nimport { COUNTRY_OPTIONS, EMPTY_COUNTRY } from 'src/shared/constants/vmp-config';\nimport { PlusMinusButtons } from '../common/form/PlusMinusButtons';\n\nexport function AddressFields({ intl, config, onValueChange }) {\n  const addressFields = config.addressFields || [];\n\n  const onCountryChange = (countryIdx, fieldIdx, fieldName, isSelect) => e => {\n    const value = isSelect ? e.value : extractEventValue(e);\n    if (!fieldName) {\n      // country name select\n      addressFields[countryIdx].countryName = value;\n    } else {\n      addressFields[countryIdx].fields[fieldIdx][fieldName] = value;\n    }\n    onValueChange('addressFields')(addressFields);\n  };\n\n  const onAddressPartFieldChange = (countryIdx, fieldIdx) => e => {\n    const addressPartField = e.value;\n    addressFields[countryIdx].fields[fieldIdx].field = addressPartField;\n    addressFields[countryIdx].fields[fieldIdx].type = ADDRESS_FIELD_TYPE[addressPartField];\n    onValueChange('addressFields')(addressFields);\n  };\n\n  const addAddressPart = countryIdx => {\n    addressFields[countryIdx].fields.push({});\n    onValueChange('addressFields')(addressFields);\n  };\n\n  const removeAddressPart = (countryIdx, addressPartIdx) => {\n    const fields = addressFields[countryIdx].fields;\n    fields.splice(addressPartIdx, 1);\n    if (fields.length === 0) {\n      fields.push({});\n    }\n    onValueChange('addressFields')(addressFields);\n  };\n\n  const moveAddressPart = (countryIdx, idx, offset) => () => {\n    swapPositions(addressFields[countryIdx]?.fields, idx, offset);\n    onValueChange('addressFields')(addressFields);\n  };\n\n  const deleteCountry = countryIdx => () => {\n    addressFields.splice(countryIdx, 1);\n    if (addressFields.length === 0) {\n      addCountry();\n    }\n    onValueChange('addressFields')(addressFields);\n  };\n\n  const addCountry = () => {\n    addressFields.push(_.cloneDeep(EMPTY_COUNTRY));\n    onValueChange('addressFields')(addressFields);\n  };\n\n  const addressPartOptions = (countryIdx, addressPartIdx) => {\n    const selectedAddressParts = (addressFields[countryIdx].fields || [])\n      .filter((addressPart, idx) => idx !== addressPartIdx)\n      .map(addressPart => addressPart.field);\n    return ADDRESS_FIELDS.filter(addressPart => !selectedAddressParts.includes(addressPart)).map(fieldName => ({\n      label: fieldName,\n      value: fieldName\n    }));\n  };\n\n  return (\n    <>\n      <Label className=\"mb-3\">\n        <FormattedMessage id=\"vmpConfig.addressFields\" />\n        <span\n          className=\"glyphicon glyphicon-info-sign ml-2\"\n          aria-hidden=\"true\"\n          title={intl.formatMessage({ id: 'vmpConfig.addressFieldsTooltip' })}\n        />\n      </Label>\n      {addressFields.map((country, i) => {\n        const addressParts = country.fields || [];\n        addressParts.sort((ap1, ap2) => ap1.displayOrder || 0 > ap2.displayOrder || 0);\n        return (\n          <div key={`addressField-${i}`} className=\"country\" data-testid=\"country\">\n            <div className=\"delete-button-container d-flex justify-content-end\">\n              <button className=\"btn btn-primary\" onClick={deleteCountry(i)}>\n                <FormattedMessage id=\"vmpConfig.delete\" />\n              </button>\n            </div>\n            <div className=\"inline-fields\">\n              <div className=\"order-icons\" />\n              <SelectWithPlaceholder\n                placeholder={intl.formatMessage({ id: 'vmpConfig.country' })}\n                showPlaceholder={!!country.countryName}\n                value={country.countryName && { value: country.countryName, label: country.countryName }}\n                onChange={onCountryChange(i, null, null, true)}\n                options={COUNTRY_OPTIONS}\n                wrapperClassName=\"flex-1\"\n                classNamePrefix=\"default-select\"\n                theme={selectDefaultTheme}\n              />\n              <InputWithPlaceholder\n                placeholder={intl.formatMessage({ id: 'vmpConfig.country' })}\n                showPlaceholder={!!country.countryName}\n                value={country.countryName}\n                onChange={onCountryChange(i, null, null, false)}\n                wrapperClassName=\"flex-1\"\n              />\n              <div className=\"action-icons\" />\n            </div>\n            {addressParts.map((addressPart, j) => {\n              const { name, field } = addressPart;\n              return (\n                <div key={`addressField-${i}-${j}`} className=\"inline-fields\">\n                  <div className=\"d-flex flex-column order-icons\">\n                    <span\n                      className={`glyphicon glyphicon-chevron-up ${j === 0 ? 'disabled' : ''}`}\n                      title={intl.formatMessage({ id: 'common.moveUp' })}\n                      aria-hidden=\"true\"\n                      onClick={moveAddressPart(i, j, -1)}\n                      data-testid=\"up-button\"\n                    />\n                    <span\n                      className={`glyphicon glyphicon-chevron-down ${j === addressParts.length - 1 ? 'disabled' : ''}`}\n                      title={intl.formatMessage({ id: 'common.moveDown' })}\n                      aria-hidden=\"true\"\n                      onClick={moveAddressPart(i, j, 1)}\n                      data-testid=\"down-button\"\n                    />\n                  </div>\n                  <SelectWithPlaceholder\n                    placeholder={intl.formatMessage({ id: 'vmpConfig.addressField' })}\n                    showPlaceholder={!!field}\n                    value={field ? { value: field, label: field } : null}\n                    onChange={onAddressPartFieldChange(i, j)}\n                    options={addressPartOptions(i, j)}\n                    wrapperClassName=\"flex-1\"\n                    classNamePrefix=\"default-select\"\n                    theme={selectDefaultTheme}\n                  />\n                  <InputWithPlaceholder\n                    placeholder={intl.formatMessage({ id: 'vmpConfig.addressName' })}\n                    showPlaceholder={!!name}\n                    value={name || ''}\n                    onChange={onCountryChange(i, j, 'name', false)}\n                    wrapperClassName=\"flex-1\"\n                  />\n                  <PlusMinusButtons\n                    intl={intl}\n                    onPlusClick={() => addAddressPart(i)}\n                    onMinusClick={() => removeAddressPart(i, j)}\n                    isPlusButtonVisible={j === addressParts.length - 1}\n                  />\n                </div>\n              );\n            })}\n          </div>\n        );\n      })}\n      <div className=\"d-flex justify-content-end mt-2 mb-2\">\n        <button className=\"btn btn-primary\" onClick={addCountry}>\n          <FormattedMessage id=\"vmpConfig.addNewCountry\" />\n        </button>\n      </div>\n    </>\n  );\n}\n","import React from 'react';\nimport './VmpConfig.scss';\nimport { FormattedMessage } from 'react-intl';\nimport { Label } from 'reactstrap';\nimport { InputWithPlaceholder } from '../common/form/withPlaceholder';\nimport { validateRegex, yesNoOptions } from '../../shared/util/form-util';\nimport { Buttons } from '../common/form/Buttons';\n\nexport function ParticipantIDRegex({ intl, config, onValueChange }) {\n  const { participantIDRegex } = config;\n  return (\n    <>\n      <Label className=\"mr-4 mb-0\">\n        <FormattedMessage id=\"vmpConfig.participantIDRegex\" />\n      </Label>\n      <div className=\"d-inline-block\">\n        <InputWithPlaceholder\n          placeholder={intl.formatMessage({ id: 'vmpConfig.participantIDRegex' })}\n          showPlaceholder={!!participantIDRegex}\n          value={participantIDRegex}\n          onChange={onValueChange('participantIDRegex')}\n          className={validateRegex(participantIDRegex) ? 'id-regex' : 'invalid id-regex'}\n        />\n      </div>\n    </>\n  );\n}\n\nexport function AllowManualParticipantIDEntry({ intl, config, onValueChange }) {\n  return (\n    <>\n      <Label className=\"mr-4\">\n        <FormattedMessage id=\"vmpConfig.allowManualParticipantIDEntry\" />\n        <span\n          className=\"glyphicon glyphicon-info-sign ml-2\"\n          aria-hidden=\"true\"\n          title={intl.formatMessage({ id: 'vmpConfig.allowManualParticipantIDEntryTooltip' })}\n        />\n      </Label>\n      <Buttons\n        options={yesNoOptions(intl)}\n        entity={config}\n        fieldName=\"allowManualParticipantIDEntry\"\n        onChange={onValueChange('allowManualParticipantIDEntry')}\n      />\n    </>\n  );\n}\n","import React from 'react';\nimport './VmpConfig.scss';\nimport { FormattedMessage } from 'react-intl';\nimport { Label } from 'reactstrap';\nimport { yesNoOptions } from '../../shared/util/form-util';\nimport { Buttons } from '../common/form/Buttons';\n\nexport function EnableBiometricOnlySearchWithoutPhone({ intl, config, onValueChange }) {\n  return (\n    <>\n      <Label className=\"mr-4\">\n        <FormattedMessage id=\"vmpConfig.enableBiometricOnlySearchWithoutPhone\" />\n        <span\n          className=\"glyphicon glyphicon-info-sign ml-2\"\n          aria-hidden=\"true\"\n          title={intl.formatMessage({ id: 'vmpConfig.enableBiometricOnlySearchWithoutPhoneTooltip' })}\n        />\n      </Label>\n      <Buttons\n        options={yesNoOptions(intl)}\n        entity={config}\n        fieldName=\"isBiometricOnlySearchWithoutPhone\"\n        onChange={onValueChange('isBiometricOnlySearchWithoutPhone')}\n      />\n    </>\n  );\n}\n","export const scrollToTop = () => window.scrollTo({ top: 0, behavior: 'smooth' });\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport './VmpConfig.scss';\nimport { FormattedMessage, injectIntl, IntlShape } from 'react-intl';\nimport {\n  DEFAULT_AUTH_STEPS,\n  DEFAULT_REGIMEN_UPDATE_PERMITTED,\n  DEFAULT_SYNC_SCOPES,\n  DEFAULT_VMP_CONFIG,\n  SETTING_KEY as VMP_CONFIG_SETTING_KEY,\n  ORDERED_ADDRESS_FIELD_PARTS\n} from '../../shared/constants/vmp-config';\nimport { VMP_VACCINATION_SCHEDULE_SETTING_KEY } from '../../shared/constants/vmp-vaccination-schedule';\nimport { createSetting, getSettingByQuery, updateSetting } from '../../redux/reducers/setttings';\nimport { parseJson } from '../../shared/util/json-util';\nimport '../Inputs.scss';\nimport { Button, Spinner } from 'reactstrap';\nimport { RouteComponentProps, withRouter } from 'react-router-dom';\nimport { ROOT_URL } from '../../shared/constants/openmrs';\nimport { IVmpConfig } from '../../shared/models/vmp-config';\nimport { extractEventValue, getPlaceholder, validateRegex } from '../../shared/util/form-util';\nimport _ from 'lodash';\nimport { successToast, errorToast } from '@bit/soldevelo-omrs.cfl-components.toast-handler';\nimport { TEN, ZERO } from '../../shared/constants/input';\nimport { ConfirmationModal } from '../common/form/ConfirmationModal';\nimport { getPatientLinkedRegimens } from '../../redux/reducers/patient';\nimport { SyncScope } from './SyncScope';\nimport { OperatorCredentialsOfflineRetentionTime, OperatorSessionTimeout } from './OperatorTimeout';\nimport { CanUseDifferentManufacturers, Manufacturers } from './Manufacturer';\nimport { Regimen } from './Regimen';\nimport { PersonLanguages } from './PersonLanguages';\nimport { AuthSteps } from './AuthSteps';\nimport { IrisScore } from './IrisScore';\nimport { AddressFields } from './AddressFields';\nimport { AllowManualParticipantIDEntry, ParticipantIDRegex } from './ParticipantId';\nimport { EnableBiometricOnlySearchWithoutPhone } from './SearchWithoutPhone';\nimport { IVmpVaccinationSchedule } from '../../shared/models/vmp-vaccination-schedule';\nimport { scrollToTop } from '../../shared/util/window-util';\n\nexport interface IVmpConfigProps extends StateProps, DispatchProps, RouteComponentProps {\n  intl: IntlShape;\n}\n\nexport interface IVmpConfigState {\n  vmpConfig: IVmpConfig;\n  vmpConfigSetting: {};\n  vmpVaccinationSchedule: IVmpVaccinationSchedule[];\n  vmpVaccinationScheduleSetting: {};\n  savedRegimen: any[];\n  showValidationErrors: boolean;\n  isModalOpen: boolean;\n  modalHeader: {};\n  modalBody: {};\n  onModalConfirm: any;\n  onModalCancel: any;\n}\n\nconst MS_IN_A_MINUTE = 1000 * 60;\nconst MS_IN_A_DAY = MS_IN_A_MINUTE * 60 * 24;\n\nexport class VmpConfig extends React.Component<IVmpConfigProps, IVmpConfigState> {\n  state = {\n    vmpConfig: {} as IVmpConfig,\n    vmpConfigSetting: { uuid: null, value: null },\n    vmpVaccinationSchedule: [],\n    vmpVaccinationScheduleSetting: { uuid: null, value: null },\n    savedRegimen: [],\n    showValidationErrors: false,\n    isModalOpen: false,\n    modalHeader: { id: '', values: {} },\n    modalBody: { id: '', values: {} },\n    onModalConfirm: null,\n    onModalCancel: null\n  };\n\n  componentDidMount() {\n    this.props.getSettingByQuery(VMP_CONFIG_SETTING_KEY);\n    this.props.getSettingByQuery(VMP_VACCINATION_SCHEDULE_SETTING_KEY);\n    this.props.getPatientLinkedRegimens();\n  }\n\n  componentDidUpdate(prevProps: Readonly<IVmpConfigProps>, prevState: Readonly<IVmpConfigState>, snapshot?: any) {\n    const { intl, config, loading, success, error } = this.props;\n    if (prevProps.config !== config) {\n      this.extractConfigData();\n    }\n    if (!prevProps.success && success) {\n      successToast(intl.formatMessage({ id: 'vmpConfig.success' }));\n    } else if (prevProps.error !== this.props.error && !loading) {\n      errorToast(error);\n    }\n  }\n\n  extractConfigData = () => {\n    let config = parseJson(this.props.config);\n\n    if (this.props.setting?.property === VMP_CONFIG_SETTING_KEY) {\n      config = _.defaults(config, DEFAULT_VMP_CONFIG);\n      const addressFields = config.addressFields;\n\n      // make it a list so it's possible to maintain the order while replacing country name\n      config.addressFields = Object.keys(addressFields).map(countryName => ({\n        countryName,\n        fields: addressFields[countryName]\n      }));\n\n      config.operatorCredentialsRetentionTime = config.operatorCredentialsRetentionTime / MS_IN_A_DAY;\n      config.operatorOfflineSessionTimeout = config.operatorOfflineSessionTimeout / MS_IN_A_MINUTE;\n\n      this.setState({\n        vmpConfig: config,\n        vmpConfigSetting: this.props.setting,\n        savedRegimen: _.clone(config.vaccine),\n        showValidationErrors: false\n      });\n    } else if (this.props.setting?.property === VMP_VACCINATION_SCHEDULE_SETTING_KEY) {\n      this.setState({\n        vmpVaccinationSchedule: config,\n        vmpVaccinationScheduleSetting: this.props.setting\n      });\n    }\n  };\n\n  generateConfig = () => {\n    const config = _.cloneDeep(this.state.vmpConfig);\n    // revert address fields back to a map\n    config.addressFields = !!config.addressFields\n      ? config.addressFields.reduce((map, obj) => {\n          if (!!obj.countryName) {\n            map[obj.countryName] = (obj.fields || []).map((field, i) => {\n              field.displayOrder = i + 1;\n              return ORDERED_ADDRESS_FIELD_PARTS.reduce((obj, key) => {\n                obj[key] = field[key];\n                return obj;\n              }, {});\n            });\n          }\n          return map;\n        }, {})\n      : {};\n    // revert the timeouts back to ms\n    if (!!config.operatorCredentialsRetentionTime) {\n      config.operatorCredentialsRetentionTime = config.operatorCredentialsRetentionTime * MS_IN_A_DAY;\n    }\n    if (!!config.operatorOfflineSessionTimeout) {\n      config.operatorOfflineSessionTimeout = config.operatorOfflineSessionTimeout * MS_IN_A_MINUTE;\n    }\n    // filter out empty rows\n    if (!!config.manufacturers) {\n      config.manufacturers = config.manufacturers.filter(mf => !!mf.name);\n    }\n    if (!!config.vaccine) {\n      config.vaccine = config.vaccine.filter(vc => !!vc.name);\n      config.vaccine.forEach(vc => {\n        vc.name = vc.name.trim();\n        vc.manufacturers = !!vc.manufacturers ? vc.manufacturers.filter(vcm => !!vcm) : [];\n      });\n    }\n    if (!!config.personLanguages) {\n      config.personLanguages = config.personLanguages.filter(pl => !!pl.name);\n    }\n    if (!!config.authSteps) {\n      config.authSteps = config.authSteps.filter(as => !!as.type);\n    }\n    return config;\n  };\n\n  onValueChange = name => e => {\n    const { vmpConfig } = this.state;\n    vmpConfig[name] = extractEventValue(e);\n    this.setState({\n      vmpConfig\n    });\n  };\n\n  onVaccinationScheduleChange = vmpVaccinationSchedule => this.setState({ vmpVaccinationSchedule });\n\n  onNumberValueChange = (name, min?, max?) => e => {\n    const { vmpConfig } = this.state;\n    const extractedEventValue = extractEventValue(e);\n    const value = !!extractedEventValue ? Number.parseInt(extractedEventValue, TEN) : !!min ? min : ZERO;\n    if (Number.isInteger(value)) {\n      if ((min !== null && value < min) || (max !== null && value > max)) return;\n      vmpConfig[name] = value;\n      this.setState({\n        vmpConfig\n      });\n    }\n  };\n\n  return = () => {\n    window.location.href = ROOT_URL;\n  };\n\n  isFormValid = () => {\n    const { manufacturers, vaccine } = this.state.vmpConfig;\n    return (\n      !manufacturers.some(manufacturer => !manufacturer.name || !validateRegex(manufacturer.barcodeRegex) || !manufacturer.barcodeRegex) &&\n      !vaccine.some(regimen => !regimen.name || !regimen.manufacturers.length) &&\n      !vaccine.some((regimen, idx) => this.isRegimenNameDuplicated(vaccine, regimen, idx))\n    );\n  };\n\n  save = () => {\n    const { vmpVaccinationSchedule, vmpConfigSetting, vmpVaccinationScheduleSetting } = this.state;\n    if (this.isFormValid()) {\n      const config = this.generateConfig();\n      const configJson = JSON.stringify(config);\n      if (vmpConfigSetting?.uuid) {\n        vmpConfigSetting.value = configJson;\n        this.props.updateSetting(vmpConfigSetting);\n      } else {\n        this.props.createSetting(VMP_CONFIG_SETTING_KEY, configJson);\n      }\n      if (vmpVaccinationScheduleSetting?.uuid) {\n        vmpVaccinationScheduleSetting.value = JSON.stringify(vmpVaccinationSchedule);\n        this.props.updateSetting(vmpVaccinationScheduleSetting);\n      }\n    } else {\n      this.setState({\n        isModalOpen: true,\n        modalHeader: { id: 'vmpConfig.error.header' },\n        modalBody: { id: 'vmpConfig.error.configurationInvalid' },\n        onModalConfirm: () => {\n          this.closeModal();\n          scrollToTop();\n        },\n        onModalCancel: null,\n        showValidationErrors: true\n      });\n    }\n  };\n\n  isRegimenNameDuplicated = (vaccine, regimen, idx) =>\n    !!regimen.name && !this.state.savedRegimen.includes(regimen) && !!vaccine.find((r, j) => idx !== j && r.name === regimen.name);\n\n  modal = () => (\n    <ConfirmationModal\n      header={this.state.modalHeader}\n      body={this.state.modalBody}\n      onYes={this.state.onModalConfirm}\n      onNo={this.state.onModalCancel}\n      isOpen={this.state.isModalOpen}\n    />\n  );\n\n  openModal = (modalHeader, modalBody, onModalConfirm = null, onModalCancel = null) => {\n    this.setState({\n      isModalOpen: true,\n      modalHeader: { id: modalHeader },\n      modalBody: { id: modalBody },\n      onModalConfirm: () => {\n        if (!!onModalConfirm) {\n          onModalConfirm();\n        }\n        this.closeModal();\n      },\n      onModalCancel\n    });\n  };\n\n  closeModal = () => this.setState({ isModalOpen: false });\n\n  render() {\n    const { intl, appError, appLoading, loading, patientLinkedRegimens, syncScopes, authSteps, regimenUpdatePermitted } = this.props;\n    const { vmpConfig, vmpVaccinationSchedule, savedRegimen, showValidationErrors } = this.state;\n    return (\n      <div className=\"vmp-config\">\n        {this.modal()}\n        <h2>\n          <FormattedMessage id=\"vmpConfig.title\" />\n        </h2>\n        <div className=\"error\">{appError}</div>\n        <div className=\"inner-content\">\n          {appLoading || (loading && !vmpConfig) ? (\n            <Spinner />\n          ) : (\n            <>\n              <div className=\"section\" data-testid=\"syncScopeSection\">\n                <SyncScope intl={intl} syncScopes={syncScopes} config={vmpConfig} onValueChange={this.onValueChange} />\n              </div>\n              <div className=\"inline-sections\">\n                <div className=\"section\" data-testid=\"operatorCredentialsOfflineRetentionTimeSection\">\n                  <OperatorCredentialsOfflineRetentionTime\n                    intl={intl}\n                    config={vmpConfig}\n                    getPlaceholder={getPlaceholder}\n                    onNumberValueChange={this.onNumberValueChange}\n                  />\n                </div>\n                <div className=\"section\" data-testid=\"operatorSessionTimeoutSection\">\n                  <OperatorSessionTimeout\n                    intl={intl}\n                    config={vmpConfig}\n                    getPlaceholder={getPlaceholder}\n                    onNumberValueChange={this.onNumberValueChange}\n                  />\n                </div>\n              </div>\n              <div className=\"section\" data-testid=\"manufacturersSection\">\n                <Manufacturers\n                  intl={intl}\n                  config={vmpConfig}\n                  showValidationErrors={showValidationErrors}\n                  openModal={this.openModal}\n                  closeModal={this.closeModal}\n                  onValueChange={this.onValueChange}\n                />\n              </div>\n              <div className=\"section\" data-testid=\"regimenSection\">\n                <Regimen\n                  intl={intl}\n                  config={vmpConfig}\n                  vaccinationSchedule={vmpVaccinationSchedule}\n                  savedRegimen={savedRegimen}\n                  patientLinkedRegimens={patientLinkedRegimens}\n                  showValidationErrors={showValidationErrors}\n                  isRegimenNameDuplicated={this.isRegimenNameDuplicated}\n                  readOnly={!regimenUpdatePermitted}\n                  openModal={this.openModal}\n                  closeModal={this.closeModal}\n                  onValueChange={this.onValueChange}\n                  onVaccinationScheduleChange={this.onVaccinationScheduleChange}\n                />\n              </div>\n              <div className=\"section\" data-testid=\"canUseDifferentManufacturersSection\">\n                <CanUseDifferentManufacturers intl={intl} config={vmpConfig} onValueChange={this.onValueChange} />\n              </div>\n              <div className=\"section\" data-testid=\"personLanguagesSection\">\n                <PersonLanguages intl={intl} config={vmpConfig} onValueChange={this.onValueChange} />\n              </div>\n              <div className=\"section\" data-testid=\"authStepsSection\">\n                <AuthSteps intl={intl} config={vmpConfig} options={authSteps} onValueChange={this.onValueChange} />\n              </div>\n              <div className=\"section\" data-testid=\"allowManualParticipantIDEntrySection\">\n                <AllowManualParticipantIDEntry intl={intl} config={vmpConfig} onValueChange={this.onValueChange} />\n              </div>\n              <div className=\"section\" data-testid=\"enableBiometricOnlySearchWithoutPhoneSection\">\n                <EnableBiometricOnlySearchWithoutPhone intl={intl} config={vmpConfig} onValueChange={this.onValueChange} />\n              </div>\n              <div className=\"section\" data-testid=\"participantIDRegexSection\">\n                <ParticipantIDRegex intl={intl} config={vmpConfig} onValueChange={this.onValueChange} />\n              </div>\n              <div className=\"section\" data-testid=\"irisScoreSection\">\n                <IrisScore intl={intl} config={vmpConfig} onNumberValueChange={this.onNumberValueChange} />\n              </div>\n              <div className=\"section\" data-testid=\"addressFieldsSection\">\n                <AddressFields intl={intl} config={vmpConfig} onValueChange={this.onValueChange} />\n              </div>\n              <div className=\"mt-5 pb-5\">\n                <div className=\"d-inline\">\n                  <Button className=\"cancel\" onClick={this.return} data-testid=\"cancelButton\">\n                    <FormattedMessage id=\"common.return\" />\n                  </Button>\n                </div>\n                <div className=\"d-inline pull-right confirm-button-container\">\n                  <Button className=\"save\" onClick={this.save} disabled={loading} data-testid=\"saveButton\">\n                    <FormattedMessage id=\"common.save\" />\n                  </Button>\n                </div>\n              </div>\n            </>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = ({ apps, settings, cflPatient }) => ({\n  syncScopes: apps?.vmpSyncScopes ?? DEFAULT_SYNC_SCOPES,\n  authSteps: apps?.vmpAuthSteps ?? DEFAULT_AUTH_STEPS,\n  regimenUpdatePermitted: apps?.vmpRegimenUpdatePermitted ?? DEFAULT_REGIMEN_UPDATE_PERMITTED,\n  appError: apps.errorMessage,\n  appLoading: apps.loading,\n  error: apps.errorMessage,\n  loading: settings.loading,\n  success: settings.success,\n  config: settings.setting?.value && settings.setting?.value,\n  setting: settings.setting,\n  patientLinkedRegimens: cflPatient.patientLinkedRegimens\n});\n\nconst mapDispatchToProps = { getSettingByQuery, updateSetting, createSetting, getPatientLinkedRegimens };\n\ntype StateProps = ReturnType<typeof mapStateToProps>;\ntype DispatchProps = typeof mapDispatchToProps;\n\nexport default connect(mapStateToProps, mapDispatchToProps)(injectIntl(withRouter(VmpConfig)));\n","import axios from 'axios';\n\nimport { FAILURE, REQUEST, SUCCESS } from '../action-type.util';\n\nexport const ACTION_TYPES = {\n  GET_VISIT_TYPES: 'visit/GET_VISIT_TYPES'\n};\n\nconst initialState = {\n  visitTypes: []\n};\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case REQUEST(ACTION_TYPES.GET_VISIT_TYPES):\n    case FAILURE(ACTION_TYPES.GET_VISIT_TYPES):\n      return {\n        ...state\n      };\n    case SUCCESS(ACTION_TYPES.GET_VISIT_TYPES):\n      return {\n        ...state,\n        visitTypes: action.payload.data.results\n      };\n    default:\n      return state;\n  }\n};\n\nexport const getVisitTypes = () => {\n  const baseUrl = '/openmrs/ws';\n  const restUrl = `${baseUrl}/rest/v1`;\n  const visitTypeUrl = `${restUrl}/visittype`;\n  return {\n    type: ACTION_TYPES.GET_VISIT_TYPES,\n    payload: axios.get(visitTypeUrl)\n  };\n};\n\nexport default reducer;\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport './VmpVaccinationSchedule.scss';\nimport { FormattedMessage, injectIntl } from 'react-intl';\nimport { DEFAULT_REGIMEN_UPDATE_PERMITTED, SETTING_KEY as VMP_CONFIG_SETTING_KEY } from '../../shared/constants/vmp-config';\nimport {\n  DEFAULT_DOSING_VISIT_TYPES,\n  DEFAULT_VMP_VACCINATION_SCHEDULE,\n  EMPTY_REGIMEN,\n  EMPTY_VISIT,\n  VMP_VACCINATION_SCHEDULE_SETTING_KEY\n} from '../../shared/constants/vmp-vaccination-schedule';\nimport { createSetting, getSettingByQuery, updateSetting } from '../../redux/reducers/setttings';\nimport { getVisitTypes } from '../../redux/reducers/visit';\nimport { parseJson } from '../../shared/util/json-util';\nimport '../Inputs.scss';\nimport { InputWithPlaceholder, SelectWithPlaceholder } from '../common/form/withPlaceholder';\nimport { Button, Spinner } from 'reactstrap';\nimport { RouteComponentProps, withRouter } from 'react-router-dom';\nimport { ROOT_URL } from '../../shared/constants/openmrs';\nimport { ZERO } from '../../shared/constants/input';\nimport { IVmpVaccinationSchedule } from '../../shared/models/vmp-vaccination-schedule';\nimport { ConfirmationModal } from '../common/form/ConfirmationModal';\nimport { extractEventValue, ordinalIndicator, selectDefaultTheme } from '../../shared/util/form-util';\nimport _ from 'lodash';\nimport { successToast, errorToast } from '@bit/soldevelo-omrs.cfl-components.toast-handler';\nimport { IVmpConfig } from 'src/shared/models/vmp-config';\nimport { PlusMinusButtons } from '../common/form/PlusMinusButtons';\n\nexport interface IVmpVaccinationScheduleProps extends StateProps, DispatchProps, RouteComponentProps {\n  intl: any;\n}\n\nexport interface IVmpVaccinationScheduleState {\n  vmpConfig: IVmpConfig;\n  vmpVaccinationSchedule: IVmpVaccinationSchedule[];\n  savedVmpVaccinationSchedule: IVmpVaccinationSchedule[];\n  vmpVaccinationScheduleSetting: {};\n  isModalOpen: boolean;\n  modalHeader: {};\n  modalBody: {};\n  onModalConfirm: any;\n  onModalCancel: any;\n}\n\nclass VmpVaccinationSchedule extends React.Component<IVmpVaccinationScheduleProps, IVmpVaccinationScheduleState> {\n  state = {\n    vmpConfig: {} as IVmpConfig,\n    vmpVaccinationSchedule: [],\n    savedVmpVaccinationSchedule: [],\n    vmpVaccinationScheduleSetting: { uuid: null, value: null },\n    isModalOpen: false,\n    modalHeader: { id: '', values: {} },\n    modalBody: { id: '', values: {} },\n    onModalConfirm: null,\n    onModalCancel: null\n  };\n\n  componentDidMount() {\n    this.props.getSettingByQuery(VMP_CONFIG_SETTING_KEY);\n    this.props.getSettingByQuery(VMP_VACCINATION_SCHEDULE_SETTING_KEY);\n    this.props.getVisitTypes();\n    this.extractConfigData();\n  }\n\n  componentDidUpdate(prevProps: Readonly<IVmpVaccinationScheduleProps>, prevState: Readonly<IVmpVaccinationScheduleState>, snapshot?: any) {\n    const { intl, config, loading, success, error } = this.props;\n    if (prevProps.config !== config) {\n      this.extractConfigData();\n    }\n    if (!prevProps.success && success) {\n      successToast(intl.formatMessage({ id: 'vmpVaccinationSchedule.success' }));\n      this.props.getSettingByQuery(VMP_VACCINATION_SCHEDULE_SETTING_KEY);\n    } else if (prevProps.error !== this.props.error && !loading) {\n      errorToast(error);\n    }\n  }\n\n  extractConfigData = () => {\n    let config = parseJson(this.props.config);\n    if (!config || config.length === 0) {\n      config = _.cloneDeep(DEFAULT_VMP_VACCINATION_SCHEDULE);\n    }\n    if (this.props.setting?.property === VMP_VACCINATION_SCHEDULE_SETTING_KEY) {\n      this.setState({\n        vmpVaccinationSchedule: config,\n        vmpVaccinationScheduleSetting: this.props.setting,\n        savedVmpVaccinationSchedule: _.clone(config)\n      });\n    } else if (this.props.setting?.property === VMP_CONFIG_SETTING_KEY) {\n      this.setState({ vmpConfig: config });\n    }\n  };\n\n  generateConfig = () => {\n    let config = _.cloneDeep(this.state.vmpVaccinationSchedule);\n    // filter out empty rows\n    if (!!config) {\n      config = config.filter(regimen => !!regimen.name);\n      config.forEach(regimen => {\n        regimen.visits = !!regimen.visits ? regimen.visits.filter(visit => !!visit.nameOfDose) : [];\n      });\n    }\n    return config;\n  };\n\n  onValueChange = event => {\n    let config = _.cloneDeep(this.state.vmpVaccinationSchedule);\n    config = extractEventValue(event);\n    this.setState({ vmpVaccinationSchedule: config });\n  };\n\n  return = () => {\n    window.location.href = ROOT_URL;\n  };\n\n  getVaccineByRegimenIndex = regimenIdx => {\n    const { vmpConfig, vmpVaccinationSchedule } = this.state;\n    return !!vmpConfig &&\n      !!vmpConfig.vaccine &&\n      !!vmpConfig.vaccine.find(vaccine => vaccine.name === vmpVaccinationSchedule[regimenIdx].name)\n      ? vmpConfig.vaccine.find(vaccine => vaccine.name === vmpVaccinationSchedule[regimenIdx].name)\n      : null;\n  };\n\n  save = () => {\n    const { vmpVaccinationScheduleSetting } = this.state;\n    const config = this.generateConfig();\n    const configJson = JSON.stringify(config);\n    if (vmpVaccinationScheduleSetting && vmpVaccinationScheduleSetting.uuid) {\n      vmpVaccinationScheduleSetting.value = configJson;\n      this.props.updateSetting(vmpVaccinationScheduleSetting);\n    } else {\n      this.props.createSetting(VMP_VACCINATION_SCHEDULE_SETTING_KEY, configJson);\n    }\n  };\n\n  onSave = () => {\n    const allRegimen = !!this.state.vmpConfig && !!this.state.vmpConfig.vaccine && this.state.vmpConfig.vaccine.length;\n    const configuredRegimen = !!this.state.vmpVaccinationSchedule && this.state.vmpVaccinationSchedule.length;\n    this.setState({\n      isModalOpen: true,\n      modalHeader: { id: 'vmpVaccinationSchedule.submit.header' },\n      modalBody: this.isAllRegimenConfigured()\n        ? { id: 'vmpVaccinationSchedule.submit.body.regimenAllConfigured' }\n        : { id: 'vmpVaccinationSchedule.submit.body.regimenPartlyConfigured', values: { allRegimen, configuredRegimen } },\n      onModalConfirm: () => {\n        this.save();\n        this.closeModal();\n      },\n      onModalCancel: this.closeModal\n    });\n  };\n\n  deleteRegimenConfig = regimenIdx => {\n    const { vmpVaccinationSchedule } = this.state;\n    vmpVaccinationSchedule.splice(regimenIdx, 1);\n    if (vmpVaccinationSchedule.length === 0) {\n      this.addRegimenConfig();\n    }\n    this.onValueChange(vmpVaccinationSchedule);\n  };\n\n  onDeleteRegimenConfig = regimenIdx => {\n    const { vmpVaccinationSchedule } = this.state;\n    const regimenName = !!vmpVaccinationSchedule && !!vmpVaccinationSchedule[regimenIdx] ? vmpVaccinationSchedule[regimenIdx].name : null;\n    if (!!regimenName) {\n      this.setState({\n        isModalOpen: true,\n        modalHeader: { id: 'vmpVaccinationSchedule.deleteRegimenConfig.header' },\n        modalBody: { id: 'vmpVaccinationSchedule.deleteRegimenConfig.body', values: { regimenName } },\n        onModalConfirm: () => {\n          this.deleteRegimenConfig(regimenIdx);\n          this.closeModal();\n        },\n        onModalCancel: this.closeModal\n      });\n    } else {\n      this.deleteRegimenConfig(regimenIdx);\n    }\n  };\n\n  addRegimenConfig = () => {\n    const { vmpVaccinationSchedule } = this.state;\n    vmpVaccinationSchedule.push(_.cloneDeep(EMPTY_REGIMEN));\n    this.onValueChange(vmpVaccinationSchedule);\n  };\n\n  recalculateNumberOfFutureVisit = visits => {\n    let numberOfFutureVisit = 0;\n    visits.reverse().forEach(visit => {\n      if (this.props.dosingVisitTypes.includes(visit.nameOfDose)) {\n        visit.numberOfFutureVisit = numberOfFutureVisit;\n        numberOfFutureVisit = 0;\n      } else {\n        visit.numberOfFutureVisit = 0;\n      }\n      numberOfFutureVisit = numberOfFutureVisit + 1;\n    });\n    return visits.reverse();\n  };\n\n  regimenOptions = regimenIdx => {\n    const { vmpConfig, vmpVaccinationSchedule } = this.state;\n    const selectedRegimen = !!vmpVaccinationSchedule\n      ? vmpVaccinationSchedule.filter((regimen, idx) => idx !== regimenIdx).map(regimen => regimen.name)\n      : [];\n    return !!vmpConfig && !!vmpConfig.vaccine\n      ? vmpConfig.vaccine\n          .filter(regimen => !selectedRegimen.includes(regimen.name))\n          .map(regimen => ({ label: regimen.name, value: regimen.name }))\n      : [];\n  };\n\n  onRegimenChange = regimenIdx => event => {\n    const { vmpConfig, vmpVaccinationSchedule } = this.state;\n    const regimenName = event.value;\n    const vaccine = !!vmpConfig && !!vmpConfig.vaccine && vmpConfig.vaccine.find(vc => vc.name === regimenName);\n    const regimen = {\n      name: regimenName,\n      numberOfDose: !!vaccine && !!vaccine.manufacturers ? vaccine.manufacturers.length : ZERO,\n      visits: [EMPTY_VISIT]\n    };\n    if (\n      !!vmpVaccinationSchedule &&\n      !!vmpVaccinationSchedule[regimenIdx] &&\n      !!vmpVaccinationSchedule[regimenIdx].visits &&\n      vmpVaccinationSchedule[regimenIdx].visits.some(visit => !!visit.nameOfDose)\n    ) {\n      this.setState({\n        isModalOpen: true,\n        modalHeader: { id: 'vmpVaccinationSchedule.changeRegimen.header' },\n        modalBody: { id: 'vmpVaccinationSchedule.changeRegimen.body' },\n        onModalConfirm: () => {\n          vmpVaccinationSchedule[regimenIdx] = regimen;\n          this.onValueChange(vmpVaccinationSchedule);\n          this.closeModal();\n        },\n        onModalCancel: this.closeModal\n      });\n    } else {\n      vmpVaccinationSchedule[regimenIdx] = regimen;\n      this.onValueChange(vmpVaccinationSchedule);\n    }\n  };\n\n  addVisit = (regimenIdx, prevVisitIdx) => {\n    const { vmpVaccinationSchedule } = this.state;\n    vmpVaccinationSchedule[regimenIdx].visits.splice(prevVisitIdx + 1, 0, EMPTY_VISIT);\n    this.onValueChange(vmpVaccinationSchedule);\n  };\n\n  removeVisit = (regimenIdx, visitIdx) => {\n    const { vmpVaccinationSchedule } = this.state;\n    let visits = vmpVaccinationSchedule[regimenIdx].visits;\n    visits.splice(visitIdx, 1);\n    if (visits.length === 0) {\n      visits.push({});\n    }\n    visits = this.recalculateNumberOfFutureVisit(visits);\n    this.onValueChange(vmpVaccinationSchedule);\n  };\n\n  visitTypeOptions = regimenIdx => {\n    const { visitTypes, dosingVisitTypes } = this.props;\n    if (this.isAllDosesConfigured(regimenIdx) && !!dosingVisitTypes) {\n      return visitTypes\n        .filter(visitType => !dosingVisitTypes.includes(visitType.display))\n        .map(visitType => ({ label: visitType.display, value: visitType.display }));\n    }\n    return visitTypes.map(visitType => ({ label: visitType.display, value: visitType.display }));\n  };\n\n  onVisitTypeChange = (regimenIdx, visitIdx) => event => {\n    const { vmpVaccinationSchedule } = this.state;\n    const { dosingVisitTypes } = this.props;\n    const nameOfDose = event.value;\n    let doseNumber = 1;\n    if (!!dosingVisitTypes && dosingVisitTypes.includes(nameOfDose)) {\n      vmpVaccinationSchedule[regimenIdx].visits.forEach((visit, idx) => {\n        if (dosingVisitTypes.includes(visit.nameOfDose) && idx < visitIdx) {\n          doseNumber = doseNumber + 1;\n        }\n      });\n    }\n    vmpVaccinationSchedule[regimenIdx].visits[visitIdx] = {\n      ...vmpVaccinationSchedule[regimenIdx].visits[visitIdx],\n      nameOfDose,\n      doseNumber\n    };\n    vmpVaccinationSchedule[regimenIdx].visits = this.recalculateNumberOfFutureVisit(vmpVaccinationSchedule[regimenIdx].visits);\n    this.onValueChange(vmpVaccinationSchedule);\n  };\n\n  onWindowChange = (regimenIdx, visitIdx, name) => e => {\n    const { vmpVaccinationSchedule } = this.state;\n    vmpVaccinationSchedule[regimenIdx].visits[visitIdx][name] = parseInt(e.target.value, 10);\n    this.onValueChange(vmpVaccinationSchedule);\n  };\n\n  doseManufacturer = (regimenIdx, doseNumber) => {\n    const vaccine = this.getVaccineByRegimenIndex(regimenIdx);\n    return !!vaccine && !!vaccine.manufacturers && !!vaccine.manufacturers[doseNumber - 1] ? vaccine.manufacturers[doseNumber - 1] : '';\n  };\n\n  vaccineManufacturers = regimenIdx => {\n    const { vmpVaccinationSchedule } = this.state;\n    const { intl, dosingVisitTypes } = this.props;\n    const vaccine = this.getVaccineByRegimenIndex(regimenIdx);\n    const configuredDoses =\n      !!vmpVaccinationSchedule &&\n      !!vmpVaccinationSchedule[regimenIdx] &&\n      !!vmpVaccinationSchedule[regimenIdx].visits &&\n      !!dosingVisitTypes &&\n      vmpVaccinationSchedule[regimenIdx].visits.filter(visit => dosingVisitTypes.includes(visit.nameOfDose)).length;\n    return (\n      !!vaccine &&\n      !!vaccine.manufacturers &&\n      vaccine.manufacturers.map((manufacturer, i) => (\n        <span\n          key={`manufacturer-${regimenIdx}-${i}`}\n          className={i < configuredDoses ? 'vaccine-manufacturer-configured' : 'vaccine-manufacturer'}\n          title={intl.formatMessage({ id: 'vmpVaccinationSchedule.dosesTooltip' })}\n        >\n          {manufacturer}\n        </span>\n      ))\n    );\n  };\n\n  isAllRegimenConfigured = () => {\n    const { vmpConfig, vmpVaccinationSchedule } = this.state;\n    return !!vmpVaccinationSchedule && !!vmpConfig && !!vmpConfig.vaccine && vmpVaccinationSchedule.length === vmpConfig.vaccine.length;\n  };\n\n  isAllDosesConfigured = regimenIdx => {\n    const { vmpVaccinationSchedule } = this.state;\n    const { dosingVisitTypes } = this.props;\n    return !!vmpVaccinationSchedule &&\n      !!vmpVaccinationSchedule[regimenIdx] &&\n      !!vmpVaccinationSchedule[regimenIdx].visits &&\n      !!vmpVaccinationSchedule[regimenIdx].numberOfDose &&\n      !!dosingVisitTypes\n      ? vmpVaccinationSchedule[regimenIdx].numberOfDose ===\n          vmpVaccinationSchedule[regimenIdx].visits.filter(visit => dosingVisitTypes.includes(visit.nameOfDose)).length\n      : true;\n  };\n\n  canSave = () => this.state.vmpVaccinationSchedule.every((regimen, idx) => this.isAllDosesConfigured(idx));\n\n  closeModal = () => this.setState({ isModalOpen: false });\n\n  regimenConfig = () => {\n    const { intl, dosingVisitTypes, regimenUpdatePermitted } = this.props;\n    const regimenConfig = this.state.vmpVaccinationSchedule || [];\n    return (\n      <>\n        {regimenConfig.map((regimen, i) => {\n          const visits = regimen.visits || [];\n          const isReadOnly = this.state.savedVmpVaccinationSchedule.includes(regimen) && !regimenUpdatePermitted;\n          return (\n            <div key={`regimen-${i}`} className=\"regimen\">\n              <div className=\"delete-button-container d-flex justify-content-end\">\n                <button className=\"btn btn-primary\" onClick={() => this.onDeleteRegimenConfig(i)}>\n                  <FormattedMessage id=\"vmpVaccinationSchedule.delete\" />\n                </button>\n              </div>\n              <div className=\"d-flex\">\n                <div className=\"inline-fields\">\n                  <div className=\"col-lg-3 col-xs-12 regimen-visit\">\n                    <SelectWithPlaceholder\n                      placeholder={intl.formatMessage({ id: 'vmpVaccinationSchedule.regimen' })}\n                      showPlaceholder={!!regimen.name}\n                      value={regimen.name && { value: regimen.name, label: regimen.name }}\n                      onChange={this.onRegimenChange(i)}\n                      options={this.regimenOptions(i)}\n                      wrapperClassName=\"flex-1\"\n                      classNamePrefix=\"default-select\"\n                      theme={selectDefaultTheme}\n                      isDisabled={isReadOnly}\n                    />\n                  </div>\n                  <div className=\"col-lg-9 col-xs-12 regimen-visit justify-content-start\">\n                    {this.vaccineManufacturers(i)}\n                    {!this.isAllDosesConfigured(i) && (\n                      <span className=\"validation-error\">\n                        <FormattedMessage id=\"vmpVaccinationSchedule.dosesCountValidationError\" />\n                      </span>\n                    )}\n                  </div>\n                </div>\n                <div className=\"action-icons\" />\n              </div>\n              {visits.map((visit, j) => {\n                const { doseNumber, nameOfDose, lowWindow, midPointWindow, upWindow } = visit;\n                return (\n                  <div key={`addressField-${i}-${j}`} className=\"d-flex\">\n                    <div className=\"inline-fields\">\n                      <div className=\"col-lg-6 col-sm-12 regimen-visit\">\n                        <SelectWithPlaceholder\n                          placeholder={intl.formatMessage({ id: 'vmpVaccinationSchedule.visitType' })}\n                          showPlaceholder={!!nameOfDose}\n                          value={nameOfDose ? { value: nameOfDose, label: nameOfDose } : null}\n                          onChange={this.onVisitTypeChange(i, j)}\n                          options={this.visitTypeOptions(i)}\n                          wrapperClassName=\"flex-1\"\n                          classNamePrefix=\"default-select\"\n                          theme={selectDefaultTheme}\n                          isDisabled={isReadOnly}\n                        />\n                        <InputWithPlaceholder\n                          type=\"number\"\n                          placeholder={intl.formatMessage({ id: 'vmpVaccinationSchedule.midPointWindow' })}\n                          showPlaceholder\n                          value={midPointWindow || 0}\n                          onChange={this.onWindowChange(i, j, 'midPointWindow')}\n                          wrapperClassName=\"flex-1\"\n                          min={ZERO}\n                          readOnly={isReadOnly}\n                        />\n                      </div>\n                      {!!dosingVisitTypes && dosingVisitTypes.includes(nameOfDose) && (\n                        <div className=\"col-lg-6 col-sm-12 regimen-visit\">\n                          <InputWithPlaceholder\n                            placeholder={`${doseNumber}${intl.formatMessage({\n                              id: ordinalIndicator(doseNumber)\n                            })} ${intl.formatMessage({ id: 'vmpVaccinationSchedule.doseNumber' })}`}\n                            showPlaceholder\n                            value={this.doseManufacturer(i, doseNumber)}\n                            wrapperClassName=\"flex-1\"\n                            disabled\n                          />\n                          <InputWithPlaceholder\n                            type=\"number\"\n                            placeholder={intl.formatMessage({ id: 'vmpVaccinationSchedule.lowWindow' })}\n                            showPlaceholder\n                            value={lowWindow || 0}\n                            onChange={this.onWindowChange(i, j, 'lowWindow')}\n                            wrapperClassName=\"flex-1\"\n                            min={ZERO}\n                            readOnly={isReadOnly}\n                          />\n                          <InputWithPlaceholder\n                            type=\"number\"\n                            placeholder={intl.formatMessage({ id: 'vmpVaccinationSchedule.upWindow' })}\n                            showPlaceholder\n                            value={upWindow || 0}\n                            onChange={this.onWindowChange(i, j, 'upWindow')}\n                            wrapperClassName=\"flex-1\"\n                            min={ZERO}\n                            readOnly={isReadOnly}\n                          />\n                        </div>\n                      )}\n                    </div>\n                    {!isReadOnly && (\n                      <PlusMinusButtons intl={intl} onPlusClick={() => this.addVisit(i, j)} onMinusClick={() => this.removeVisit(i, j)} />\n                    )}\n                  </div>\n                );\n              })}\n            </div>\n          );\n        })}\n        <div className=\"d-flex justify-content-end mt-2 mb-2\">\n          <button className=\"btn btn-primary\" onClick={this.addRegimenConfig} disabled={this.isAllRegimenConfigured()}>\n            <FormattedMessage id=\"vmpVaccinationSchedule.addRegimenConfig\" />\n          </button>\n        </div>\n      </>\n    );\n  };\n\n  renderConfirmationModal = () => (\n    <ConfirmationModal\n      header={this.state.modalHeader}\n      body={this.state.modalBody}\n      onYes={this.state.onModalConfirm}\n      onNo={this.state.onModalCancel}\n      isOpen={this.state.isModalOpen}\n    />\n  );\n\n  render() {\n    const { appError, appLoading, loading, config } = this.props;\n    return (\n      <div className=\"vmp-vaccination-schedule\">\n        {this.renderConfirmationModal()}\n        <h2>\n          <FormattedMessage id=\"vmpVaccinationSchedule.title\" />\n        </h2>\n        <div className=\"error\">{appError}</div>\n        <div className=\"inner-content\">\n          {appLoading || (loading && !config) ? (\n            <Spinner />\n          ) : (\n            <>\n              <div className=\"section\">{this.regimenConfig()}</div>\n              <div className=\"mt-5 pb-5\">\n                <div className=\"d-inline\">\n                  <Button className=\"cancel\" onClick={this.return}>\n                    <FormattedMessage id=\"common.return\" />\n                  </Button>\n                </div>\n                <div className=\"d-inline pull-right confirm-button-container\">\n                  <Button className=\"save\" onClick={this.onSave} disabled={loading || !this.canSave()}>\n                    <FormattedMessage id=\"common.save\" />\n                  </Button>\n                </div>\n              </div>\n            </>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = ({ apps, settings, visit }) => ({\n  dosingVisitTypes: apps?.vmpDosingVisitTypes ?? DEFAULT_DOSING_VISIT_TYPES,\n  regimenUpdatePermitted: apps?.vmpRegimenUpdatePermitted ?? DEFAULT_REGIMEN_UPDATE_PERMITTED,\n  appError: apps.errorMessage,\n  appLoading: apps.loading,\n  error: apps.errorMessage,\n  loading: settings.loading,\n  success: settings.success,\n  config: settings.setting?.value && settings.setting?.value,\n  setting: settings.setting,\n  visitTypes: visit.visitTypes\n});\n\nconst mapDispatchToProps = { getSettingByQuery, updateSetting, createSetting, getVisitTypes };\n\ntype StateProps = ReturnType<typeof mapStateToProps>;\ntype DispatchProps = typeof mapDispatchToProps;\n\nexport default connect(mapStateToProps, mapDispatchToProps)(injectIntl(withRouter(VmpVaccinationSchedule)));\n","export const DEFAULT_DELIMITER = ',';\nexport const ADDRESS_DATA_TABLE_COLUMNS = ['field1', 'field2', 'field3', 'field4', 'field5', 'field6', 'field7'];\nexport const DEFAULT_DOWNLOAD_FILENAME = 'address-data.csv';\nexport const ACCEPTED_FILE_EXTENSIONS = '.txt,.csv';\n","import axios from 'axios';\nimport { ONE, ZERO } from '../../shared/constants/input';\nimport { DEFAULT_DELIMITER } from '../../shared/constants/address-data';\nimport { FAILURE, REQUEST, SUCCESS } from '../action-type.util';\nimport { DEFAULT_PAGE_SIZE } from '../page.util';\n\nexport const ACTION_TYPES = {\n  GET_ADDRESS_DATA: 'addressData/GET_ADDRESS_DATA',\n  GET_ADDRESS_DATA_PAGE: 'addressData/GET_ADDRESS_DATA_PAGE',\n  POST_ADDRESS_DATA: 'addressData/POST_ADDRESS_DATA'\n};\n\nconst initialState = {\n  addressData: [],\n  currentPage: ONE,\n  hasNextPage: false,\n  totalCount: ZERO,\n  loadingAddressData: false,\n  downloadableAddressData: [],\n  errorMessage: null,\n  addressDataUploading: false\n};\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case REQUEST(ACTION_TYPES.GET_ADDRESS_DATA):\n    case REQUEST(ACTION_TYPES.GET_ADDRESS_DATA_PAGE):\n      return {\n        ...state,\n        loadingAddressData: true\n      };\n    case FAILURE(ACTION_TYPES.GET_ADDRESS_DATA):\n    case FAILURE(ACTION_TYPES.GET_ADDRESS_DATA_PAGE):\n      return {\n        ...state\n      };\n    case SUCCESS(ACTION_TYPES.GET_ADDRESS_DATA):\n      return {\n        ...state,\n        loadingAddressData: false,\n        downloadableAddressData: !!action.payload.data.content ? action.payload.data.content.map(content => content.content) : []\n      };\n    case SUCCESS(ACTION_TYPES.GET_ADDRESS_DATA_PAGE):\n      const data = !!action.payload.data.content ? action.payload.data.content.map(content => content.content) : [];\n      const currentPage = action.payload.data.pageNumber;\n      return {\n        ...state,\n        addressData: currentPage === ONE ? data : [...state.addressData, ...data],\n        hasNextPage: action.payload.data.nextPage,\n        currentPage,\n        totalCount: action.payload.data.totalCount,\n        loadingAddressData: false\n      };\n    case REQUEST(ACTION_TYPES.POST_ADDRESS_DATA):\n      return {\n        ...state,\n        addressData: [],\n        currentPage: ONE,\n        hasNextPage: false,\n        totalCount: ZERO,\n        loadingAddressData: true,\n        addressDataUploaded: false,\n        addressDataUploading: true\n      };\n    case FAILURE(ACTION_TYPES.POST_ADDRESS_DATA):\n      return {\n        ...state,\n        errorMessage: action.payload.response.data\n      };\n    case SUCCESS(ACTION_TYPES.POST_ADDRESS_DATA):\n      return {\n        ...state,\n        addressDataUploaded: true,\n        loadingAddressData: false,\n        errorMessage: null,\n        addressDataUploading: false\n      };\n    default:\n      return state;\n  }\n};\n\nexport const getAddressDataPage = (page: number = ZERO, size: number = DEFAULT_PAGE_SIZE) => {\n  const requestUrl = '/openmrs/ws/cfl/address-data';\n  return {\n    type: ACTION_TYPES.GET_ADDRESS_DATA_PAGE,\n    payload: axios.get(requestUrl, {\n      params: {\n        page: page + 1,\n        rows: size\n      }\n    })\n  };\n};\n\nexport const getAddressData = () => {\n  const requestUrl = '/openmrs/ws/cfl/address-data';\n  return {\n    type: ACTION_TYPES.GET_ADDRESS_DATA,\n    payload: axios.get(requestUrl)\n  };\n};\n\nexport const postAddressData = (file: File, isOverwriteAddressData: boolean) => {\n  const requestUrl = '/openmrs/ws/cfl/address-data/upload';\n  const formData = new FormData();\n  formData.append('file', file);\n  formData.append('delimeter', DEFAULT_DELIMITER);\n  formData.append('userGeneratedIdDelimiter', 'false');\n  formData.append('overwrite', `${isOverwriteAddressData}`);\n  return {\n    type: ACTION_TYPES.POST_ADDRESS_DATA,\n    payload: axios.post(requestUrl, formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      }\n    })\n  };\n};\n\nexport default reducer;\n","import React from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { Button } from 'reactstrap';\nimport ReactDropzone from 'react-dropzone';\nimport './Dropzone.scss';\nimport '../../Inputs.scss';\n\nexport default function Dropzone({ acceptedFileExt, instructionMessageId, onFileAccepted }) {\n  const [isDragActive, setIsDragActive] = React.useState(false);\n  const [acceptedFile, setAcceptedFile] = React.useState(null);\n  const [rejectedFile, setRejectedFile] = React.useState(null);\n\n  const isFileDropped = () => !!acceptedFile || !!rejectedFile;\n\n  return (\n    <>\n      <ReactDropzone\n        accept={acceptedFileExt}\n        multiple={false}\n        onDropAccepted={file => {\n          setAcceptedFile(file.find(Boolean));\n          setRejectedFile(null);\n          setIsDragActive(false);\n          onFileAccepted(file.find(Boolean));\n        }}\n        onDropRejected={file => {\n          setAcceptedFile(null);\n          setRejectedFile(file.find(Boolean));\n          setIsDragActive(false);\n          onFileAccepted(null);\n        }}\n        onDragEnter={() => setIsDragActive(true)}\n        onDragLeave={() => setIsDragActive(false)}\n      >\n        {({ getRootProps, getInputProps }) => (\n          <section>\n            <div {...getRootProps({ className: isDragActive ? 'dropzone dropzone-active' : 'dropzone' })}>\n              <input {...getInputProps()} />\n              <div className=\"dropzone-instruction\">\n                <FormattedMessage id={instructionMessageId} />\n              </div>\n              <Button>\n                <FormattedMessage id=\"dropzone.openFileDialog\" />\n              </Button>\n            </div>\n          </section>\n        )}\n      </ReactDropzone>\n      <div className=\"drop-result\">\n        {isFileDropped() && (\n          <>\n            <div className={`d-inline ${!!acceptedFile ? 'accepted-file' : 'rejected-file'}`}>\n              <FormattedMessage\n                id={`dropzone.${!!acceptedFile ? 'acceptedFile' : 'rejectedFile'}`}\n                values={{ b: (...text) => <b>{text}</b> }}\n              />\n            </div>\n            <p className=\"d-inline ml-2\">{!!acceptedFile ? acceptedFile.name : rejectedFile.file.name}</p>\n          </>\n        )}\n      </div>\n    </>\n  );\n}\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport './AddressData.scss';\nimport { FormattedMessage, injectIntl } from 'react-intl';\nimport '../Inputs.scss';\nimport { Button, Spinner } from 'reactstrap';\nimport { RouteComponentProps, withRouter } from 'react-router-dom';\nimport { ROOT_URL } from '../../shared/constants/openmrs';\nimport { ZERO } from '../../shared/constants/input';\nimport { ConfirmationModal } from '../common/form/ConfirmationModal';\nimport { successToast, errorToast } from '@bit/soldevelo-omrs.cfl-components.toast-handler';\nimport InfiniteTable from '../common/InfiniteTable';\nimport { getAddressDataPage, getAddressData, postAddressData } from '../../redux/reducers/address-data';\nimport { ACCEPTED_FILE_EXTENSIONS, ADDRESS_DATA_TABLE_COLUMNS, DEFAULT_DOWNLOAD_FILENAME } from '../../shared/constants/address-data';\nimport { STRING_FALSE, STRING_TRUE } from '../../shared/constants/input';\nimport downloadCsv from 'download-csv';\nimport Dropzone from '../common/dropzone/Dropzone';\n\nexport interface IAddressDataProps extends StateProps, DispatchProps, RouteComponentProps {\n  intl: any;\n}\n\nexport interface IAddressDataState {\n  isModalOpen: boolean;\n  modalHeader: {};\n  modalBody: {};\n  onModalConfirm: any;\n  onModalCancel: any;\n  isDragActive: boolean;\n  acceptedFile: any;\n  rejectedFile: any;\n  isOverwriteAddressData: boolean;\n  page: number;\n  isDownloadableAddressDataValid: boolean;\n}\n\nclass AddressData extends React.Component<IAddressDataProps, IAddressDataState> {\n  state = {\n    isModalOpen: false,\n    modalHeader: { id: '', values: {} },\n    modalBody: { id: '', values: {} },\n    onModalConfirm: null,\n    onModalCancel: null,\n    isDragActive: false,\n    acceptedFile: null,\n    rejectedFile: null,\n    isOverwriteAddressData: false,\n    page: 0,\n    isDownloadableAddressDataValid: false\n  };\n\n  componentDidMount() {\n    this.props.getAddressDataPage(this.state.page);\n  }\n\n  componentDidUpdate(prevProps: Readonly<IAddressDataProps>, prevState: Readonly<IAddressDataState>, snapshot?: any) {\n    const { intl, error, addressDataUploaded, downloadableAddressData } = this.props;\n    if (!prevProps.addressDataUploaded && addressDataUploaded) {\n      successToast(intl.formatMessage({ id: 'addressData.upload.success' }));\n      this.setState({ page: ZERO, isDownloadableAddressDataValid: false }, () => this.props.getAddressDataPage(this.state.page));\n    } else if (prevProps.downloadableAddressData !== downloadableAddressData) {\n      this.setState({ isDownloadableAddressDataValid: true }, this.triggerAddressDataDownload);\n    } else if (prevProps.error !== error) {\n      errorToast(error);\n    }\n  }\n\n  return = () => {\n    window.location.href = ROOT_URL;\n  };\n\n  onUpload = () => {\n    const { acceptedFile, isOverwriteAddressData } = this.state;\n    this.setState({\n      isModalOpen: true,\n      modalHeader: { id: `addressData.upload.overwriteAddressData.${isOverwriteAddressData}.modalHeader` },\n      modalBody: { id: `addressData.upload.overwriteAddressData.${isOverwriteAddressData}.modalBody` },\n      onModalConfirm: () => {\n        this.props.postAddressData(acceptedFile, isOverwriteAddressData);\n        this.closeModal();\n      },\n      onModalCancel: this.closeModal\n    });\n  };\n\n  closeModal = () => this.setState({ isModalOpen: false });\n\n  onOverwriteAddressDataChange = event => this.setState({ isOverwriteAddressData: event.target.value === STRING_TRUE });\n\n  switchPage = page => this.setState({ page }, () => this.props.getAddressDataPage(this.state.page));\n\n  columnContent = (entity, column) => entity[ADDRESS_DATA_TABLE_COLUMNS.indexOf(column)];\n\n  triggerAddressDataDownload = () => downloadCsv(this.props.downloadableAddressData, null, DEFAULT_DOWNLOAD_FILENAME);\n\n  downloadAddressData = () => (this.state.isDownloadableAddressDataValid ? this.triggerAddressDataDownload() : this.props.getAddressData());\n\n  confirmationModal = () => (\n    <ConfirmationModal\n      header={this.state.modalHeader}\n      body={this.state.modalBody}\n      onYes={this.state.onModalConfirm}\n      onNo={this.state.onModalCancel}\n      isOpen={this.state.isModalOpen}\n    />\n  );\n\n  instructions = () => (\n    <>\n      <p>\n        <FormattedMessage id=\"addressData.upload.instruction1\" values={{ b: (...text) => <b>{text}</b> }} />\n      </p>\n      <p className=\"d-inline\">\n        <FormattedMessage id=\"addressData.upload.instruction2\" />\n      </p>\n      <a href={`${ROOT_URL}owa/cfl-ui/address-data/address-data-sample-file.csv`} download className=\"ml-2\">\n        <FormattedMessage id=\"addressData.download.csvFileSample\" />\n      </a>\n      <a href={`${ROOT_URL}owa/cfl-ui/address-data/address-data-sample-file.txt`} download className=\"ml-2\">\n        <FormattedMessage id=\"addressData.download.txtFileSample\" />\n      </a>\n    </>\n  );\n\n  overwriteAddressDataRadioButtons = () => (\n    <div onChange={this.onOverwriteAddressDataChange} className=\"my-2\">\n      <div className=\"radio-button-wrapper\">\n        <input type=\"radio\" id=\"overwrite-false\" value={STRING_FALSE} name=\"overwriteAddressData\" className=\"radio-button\" defaultChecked />\n        <label htmlFor=\"overwrite-false\">\n          <FormattedMessage id=\"addressData.upload.overwriteAddressData.false.radioLabel\" />\n        </label>\n      </div>\n      <div className=\"radio-button-wrapper\">\n        <input type=\"radio\" id=\"overwrite-true\" value={STRING_TRUE} name=\"overwriteAddressData\" className=\"radio-button\" />\n        <label htmlFor=\"overwrite-true\">\n          <FormattedMessage id=\"addressData.upload.overwriteAddressData.true.radioLabel\" />\n        </label>\n      </div>\n    </div>\n  );\n\n  uploadButton = () => (\n    <div className=\"upload-button-wrapper\">\n      <div className=\"upload-button\">\n        {this.props.addressDataUploading && (\n          <div className=\"spinner\">\n            <Spinner />\n          </div>\n        )}\n        <Button onClick={this.onUpload} disabled={this.props.addressDataUploading || !this.state.acceptedFile} className=\"pull-right\">\n          <FormattedMessage id=\"addressData.upload.button\" />\n        </Button>\n      </div>\n      <p className=\"upload-error pull-right\">{this.props.uploadError}</p>\n    </div>\n  );\n\n  downloadButton = disabled => (\n    <Button onClick={this.downloadAddressData} disabled={disabled || !this.props.totalCount} className=\"cancel\">\n      <FormattedMessage id=\"addressData.download.button\" />\n    </Button>\n  );\n\n  uploadedFileTable = () => {\n    const { page } = this.state;\n    const { totalCount, addressDataLoading, addressDataUploading, addressData, hasNextPage } = this.props;\n    const isTotalCountMoreThanZero = totalCount > ZERO;\n    const displaySpinner = addressDataLoading && (!isTotalCountMoreThanZero || addressDataUploading);\n\n    return (\n      <div className=\"section table-section\">\n        <div className=\"title-section\">\n          <h2>\n            <FormattedMessage id=\"addressData.table.title\" />\n          </h2>\n          {this.downloadButton(displaySpinner)}\n        </div>\n        {displaySpinner ? (\n          <div className=\"spinner\">\n            <Spinner />\n          </div>\n        ) : isTotalCountMoreThanZero ? (\n          <InfiniteTable\n            columns={ADDRESS_DATA_TABLE_COLUMNS}\n            entities={addressData}\n            columnContent={this.columnContent}\n            hasNext={hasNextPage}\n            currentPage={page}\n            switchPage={this.switchPage}\n          />\n        ) : (\n          <p className=\"address-data-empty\">\n            <FormattedMessage id=\"addressData.upload.addressDataEmpty\" />\n          </p>\n        )}\n      </div>\n    );\n  };\n\n  render() {\n    const { appError, appLoading } = this.props;\n    return (\n      <div id=\"address-data\">\n        {this.confirmationModal()}\n        <h2>\n          <FormattedMessage id=\"addressData.title\" />\n        </h2>\n        <div className=\"error\">{appError}</div>\n        <div className=\"inner-content\">\n          {appLoading ? (\n            <div className=\"spinner\">\n              <Spinner />\n            </div>\n          ) : (\n            <div className=\"section\">\n              <h2>\n                <FormattedMessage id=\"addressData.upload.title\" />\n              </h2>\n              {this.instructions()}\n              <Dropzone\n                acceptedFileExt={ACCEPTED_FILE_EXTENSIONS}\n                instructionMessageId=\"addressData.dropzone.instruction\"\n                onFileAccepted={acceptedFile => this.setState({ acceptedFile })}\n              />\n              {this.overwriteAddressDataRadioButtons()}\n              {this.uploadButton()}\n              {this.uploadedFileTable()}\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = ({ apps, addressData }) => ({\n  appError: apps.errorMessage,\n  appLoading: apps.loading,\n  error: apps.errorMessage,\n  addressDataLoading: addressData.loadingAddressData,\n  addressDataUploading: addressData.addressDataUploading,\n  addressDataUploaded: addressData.addressDataUploaded,\n  addressData: addressData.addressData,\n  hasNextPage: addressData.hasNextPage,\n  totalCount: addressData.totalCount,\n  uploadError: addressData.errorMessage,\n  downloadableAddressData: addressData.downloadableAddressData\n});\n\nconst mapDispatchToProps = { getAddressDataPage, getAddressData, postAddressData };\n\ntype StateProps = ReturnType<typeof mapStateToProps>;\ntype DispatchProps = typeof mapDispatchToProps;\n\nexport default connect(mapStateToProps, mapDispatchToProps)(injectIntl(withRouter(AddressData)));\n","import ISO6391 from 'iso-639-1';\n\nexport const VMP_TRANSLATIONS_SETTING_KEY = 'biometric.api.config.localization';\nexport const LANGUAGES_ALLOWED_SETTING_KEY = 'locale.allowed.list';\nexport const LANGUAGE_OPTIONS = ISO6391.getAllCodes().map(code => ({ label: ISO6391.getName(code), value: code }));\nexport const DEFAULT_VMP_TRANSLATIONS_SETTING = { localization: {} };\nexport const DEFAULT_DOWNLOAD_FILENAME = 'translations.csv';\nexport const DEFAULT_DELIMITER = ',';\nexport const ACCEPTED_FILE_EXTENSIONS = '.csv';\n","import React, { useState } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport { SelectWithPlaceholder } from '../../common/form/withPlaceholder';\nimport { selectDefaultTheme } from '../../../shared/util/form-util';\nimport '../../common/form/Modal.scss';\nimport '../../Inputs.scss';\nimport { LANGUAGE_OPTIONS } from '../../../shared/constants/vmp-translations';\n\nexport interface IAddLanguageModalProps {\n  intl: any;\n  languages: any[];\n  isOpen: boolean;\n  onYes: (language) => void;\n  onNo: () => void;\n}\n\nexport function AddLanguageModal(props: IAddLanguageModalProps) {\n  const { intl, languages, isOpen, onYes, onNo } = props;\n  const [language, setLanguage] = useState(null);\n  return (\n    <Modal isOpen={isOpen} fade={false}>\n      <ModalHeader>\n        <FormattedMessage id=\"vmpTranslations.addLanguage.title\" />\n      </ModalHeader>\n      <ModalBody>\n        <SelectWithPlaceholder\n          placeholder={intl.formatMessage({ id: 'vmpTranslations.addLanguage.selectPlaceholder' })}\n          showPlaceholder={!!language}\n          value={LANGUAGE_OPTIONS.find(opt => opt.value === language) || null}\n          onChange={lang => setLanguage(lang.value)}\n          options={LANGUAGE_OPTIONS.filter(lang => languages.includes(lang.value))}\n          wrapperClassName=\"flex-2\"\n          classNamePrefix=\"default-select\"\n          theme={selectDefaultTheme}\n        />\n      </ModalBody>\n      <ModalFooter>\n        <Button\n          className=\"btn cancel\"\n          onClick={() => {\n            onNo();\n            setLanguage(null);\n          }}\n        >\n          <FormattedMessage id=\"common.cancel\" />\n        </Button>\n        <Button\n          className=\"btn btn-primary\"\n          onClick={() => {\n            onYes(language);\n            setLanguage(null);\n          }}\n        >\n          <FormattedMessage id=\"vmpTranslations.addLanguage.add\" />\n        </Button>\n      </ModalFooter>\n    </Modal>\n  );\n}\n","import React from 'react';\nimport { Input } from 'reactstrap';\nimport searchIcon from '../../../assets/img/search.png';\nimport './FilterInput.scss';\n\nexport const FilterInput = ({ intl, value, placeholderId, onChange }) => (\n  <div className=\"filter-input-wrapper\">\n    <img src={searchIcon} alt=\"search\" className=\"search-icon\" />\n    <Input value={value} onChange={onChange} placeholder={intl.formatMessage({ id: placeholderId })} className=\"filter-input\" />\n  </div>\n);\n","import React from 'react';\nimport Select from 'react-select';\nimport { selectDefaultTheme } from '../../../shared/util/form-util';\nimport './FilterSelect.scss';\n\nexport const FilterSelect = ({ intl, value, options, placeholderId, onChange }) => (\n  <Select\n    placeholder={intl.formatMessage({ id: placeholderId })}\n    value={value}\n    onChange={onChange}\n    options={options}\n    classNamePrefix=\"filter-select\"\n    className=\"filter-select\"\n    theme={selectDefaultTheme}\n  />\n);\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport Papa from 'papaparse';\nimport _ from 'lodash';\nimport downloadCsv from 'download-csv';\nimport { FormattedMessage, injectIntl } from 'react-intl';\nimport { Button, Spinner, Table } from 'reactstrap';\nimport { RouteComponentProps, withRouter } from 'react-router-dom';\nimport { ConfirmationModal } from '../common/form/ConfirmationModal';\nimport { successToast, errorToast } from '@bit/soldevelo-omrs.cfl-components.toast-handler';\nimport { getAddressData } from '../../redux/reducers/address-data';\nimport Dropzone from '../common/dropzone/Dropzone';\nimport { createSetting, getSettingByQuery, updateSetting } from '../../redux/reducers/setttings';\nimport { IVmpConfig } from 'src/shared/models/vmp-config';\nimport TextareaAutosize from 'react-textarea-autosize';\nimport { AddLanguageModal } from './add-language-modal/AddLanguageModal';\nimport { FilterInput } from '../common/filter-input/FilterInput';\nimport { FilterSelect } from '../common/filter-select/FilterSelect';\nimport { searchLocations } from '../../redux/reducers/location';\nimport { parseJson } from '../../shared/util/json-util';\nimport { extractEventValue } from '../../shared/util/form-util';\nimport { ROOT_URL } from '../../shared/constants/openmrs';\nimport { SETTING_KEY as VMP_CONFIG_SETTING_KEY } from '../../shared/constants/vmp-config';\nimport {\n  DEFAULT_VMP_TRANSLATIONS_SETTING,\n  LANGUAGES_ALLOWED_SETTING_KEY,\n  LANGUAGE_OPTIONS,\n  VMP_TRANSLATIONS_SETTING_KEY,\n  DEFAULT_DOWNLOAD_FILENAME,\n  DEFAULT_DELIMITER,\n  ACCEPTED_FILE_EXTENSIONS\n} from '../../shared/constants/vmp-translations';\nimport { EMPTY_STRING, ZERO } from '../../shared/constants/input';\nimport './VmpTranslations.scss';\nimport '../Inputs.scss';\n\nconst LANGUAGES_ALLOWED_LIST_DELIMITER = ',';\nconst LANGUAGE_FILTER_EMPTY_VALUE = { label: EMPTY_STRING, value: null };\nconst CSV_FILE_DEFAULT_COLUMN_LABEL = 'default';\n\nexport interface IVmpTranslationsProps extends StateProps, DispatchProps, RouteComponentProps {\n  intl: any;\n}\n\nexport interface IVmpTranslationsState {\n  isConfirmationModalOpen: boolean;\n  confirmationModalHeader: {};\n  confirmationModalBody: {};\n  onConfirmationModalConfirm: any;\n  onConfirmationModalCancel: any;\n  isDragActive: boolean;\n  acceptedFile: any;\n  rejectedFile: any;\n  translations: {};\n  downloadableTranslations: {};\n  translationsTableLanguages: any[];\n  vmpTranslationsSetting: any;\n  languagesAllowed: any[];\n  isAddLanguageModalOpen: boolean;\n  phraseFilterValue: any;\n  languageFilterValue: any;\n  isDirty: boolean;\n}\n\nexport class VmpTranslations extends React.Component<IVmpTranslationsProps, IVmpTranslationsState> {\n  state = {\n    isConfirmationModalOpen: false,\n    confirmationModalHeader: { id: EMPTY_STRING },\n    confirmationModalBody: { id: EMPTY_STRING },\n    onConfirmationModalConfirm: null,\n    onConfirmationModalCancel: null,\n    isDragActive: false,\n    acceptedFile: null,\n    rejectedFile: null,\n    translations: {},\n    downloadableTranslations: {},\n    translationsTableLanguages: [],\n    vmpTranslationsSetting: null,\n    languagesAllowed: [],\n    isAddLanguageModalOpen: false,\n    phraseFilterValue: EMPTY_STRING,\n    languageFilterValue: null,\n    isDirty: false\n  };\n\n  componentDidMount() {\n    this.loadTranslations();\n  }\n\n  componentDidUpdate(prevProps: Readonly<IVmpTranslationsProps>, prevState: Readonly<IVmpTranslationsState>, snapshot?: any) {\n    const { intl, config, addressData, locations, loading, success, error } = this.props;\n    if (prevProps.config !== config || this.isRequestedSettingNotExist(prevProps, this.props)) {\n      this.extractTranslations();\n    } else if (prevProps.addressData !== addressData) {\n      this.extractAddressDataTranslations();\n    } else if (prevProps.locations !== locations) {\n      this.extractLocationsTranslations();\n    }\n    if (!prevProps.success && success) {\n      successToast(intl.formatMessage({ id: 'vmpTranslations.save.success' }));\n      this.loadTranslations();\n    } else if (prevProps.error !== this.props.error && !loading) {\n      errorToast(error);\n    }\n  }\n\n  loadTranslations = () => {\n    this.props.getSettingByQuery(VMP_TRANSLATIONS_SETTING_KEY);\n    this.props.getAddressData();\n    this.props.searchLocations();\n  };\n\n  isRequestedSettingNotExist = (prevProps, props) =>\n    prevProps.loading && !props.loading && !!props.isSettingExist && !props.isSettingExist.value;\n\n  extractTranslations = () => {\n    if (\n      this.props.setting?.property === VMP_TRANSLATIONS_SETTING_KEY ||\n      this.props.isSettingExist.settingPropertyUrl.includes(VMP_TRANSLATIONS_SETTING_KEY)\n    ) {\n      let translations =\n        !!this.props.isSettingExist && this.props.isSettingExist.value ? parseJson(this.props.config) : DEFAULT_VMP_TRANSLATIONS_SETTING;\n      translations = !!translations && !!translations.localization ? translations.localization : [];\n      const translationsTableLanguages = Object.keys(translations).sort();\n      const parsedConfig = {};\n      Object.keys(translations).forEach(language => {\n        Object.keys(translations[language]).forEach(key => {\n          parsedConfig[key] = {\n            ...this.emptyTranslation(translationsTableLanguages),\n            ...parsedConfig[key],\n            [language]: translations[language][key]\n          };\n        });\n      });\n      this.setState(\n        {\n          translations: parsedConfig,\n          downloadableTranslations: _.cloneDeep(parsedConfig),\n          translationsTableLanguages,\n          vmpTranslationsSetting: this.props.setting,\n          isDirty: false\n        },\n        () => {\n          this.props.getSettingByQuery(VMP_CONFIG_SETTING_KEY);\n          this.props.getSettingByQuery(LANGUAGES_ALLOWED_SETTING_KEY);\n        }\n      );\n    } else if (this.props.setting?.property === VMP_CONFIG_SETTING_KEY) {\n      this.extractConfigTranslations();\n    } else if (this.props.setting?.property === LANGUAGES_ALLOWED_SETTING_KEY) {\n      this.setState(state => ({\n        languagesAllowed: !!this.props.config\n          ? this.props.config\n              .split(LANGUAGES_ALLOWED_LIST_DELIMITER)\n              .map(language => language.trim())\n              .filter(language => !state.translationsTableLanguages.includes(language))\n          : []\n      }));\n    }\n  };\n\n  extractAddressDataTranslations = () => {\n    const { translations, translationsTableLanguages } = this.state;\n    const distinctAddressFields = [];\n    if (Array.isArray(this.props.addressData)) {\n      this.props.addressData.forEach(address =>\n        address.forEach(addressField => {\n          if (!!addressField && !distinctAddressFields.includes(addressField) && isNaN(addressField)) {\n            distinctAddressFields.push(addressField);\n          }\n        })\n      );\n      distinctAddressFields\n        .filter(addressField => !translations[addressField])\n        .forEach(addressField => (translations[addressField] = this.emptyTranslation(translationsTableLanguages)));\n      this.setState({ translations, downloadableTranslations: _.cloneDeep(translations) });\n    }\n  };\n\n  extractConfigTranslations = () => {\n    const { translations, translationsTableLanguages } = this.state;\n    const vmpConfigTranslations = [];\n    const config = parseJson(this.props.config) as IVmpConfig;\n    config.vaccine.forEach(\n      regimen => !!regimen.name && !vmpConfigTranslations.includes(regimen.name) && vmpConfigTranslations.push(regimen.name)\n    );\n    config.manufacturers.forEach(\n      manufacturer =>\n        !!manufacturer.name && !vmpConfigTranslations.includes(manufacturer.name) && vmpConfigTranslations.push(manufacturer.name)\n    );\n    config.personLanguages.forEach(\n      language => !!language.name && !vmpConfigTranslations.includes(language.name) && vmpConfigTranslations.push(language.name)\n    );\n    Object.keys(config.addressFields).forEach(key =>\n      config.addressFields[key].forEach(\n        addressField =>\n          !!addressField.name && !vmpConfigTranslations.includes(addressField.name) && vmpConfigTranslations.push(addressField.name)\n      )\n    );\n    vmpConfigTranslations\n      .filter(translation => !translations[translation])\n      .forEach(translation => (translations[translation] = this.emptyTranslation(translationsTableLanguages)));\n    this.setState({ translations, downloadableTranslations: _.cloneDeep(translations) });\n  };\n\n  extractLocationsTranslations = () => {\n    const { translations, translationsTableLanguages } = this.state;\n    const { locations } = this.props;\n    if (Array.isArray(locations)) {\n      locations\n        .filter(location => !!location.display && !translations[location.display])\n        .forEach(location => (translations[location.display] = this.emptyTranslation(translationsTableLanguages)));\n      this.setState({ translations, downloadableTranslations: _.cloneDeep(translations) });\n    }\n  };\n\n  emptyTranslation = languages => {\n    const translation = {};\n    languages.forEach(language => (translation[language] = EMPTY_STRING));\n    return translation;\n  };\n\n  sortTranslationsAlphabetically = translations => {\n    const orderedTranslations = Object.keys(translations)\n      .sort()\n      .reduce((obj, key) => {\n        obj[key] = translations[key];\n        return obj;\n      }, {});\n    return orderedTranslations;\n  };\n\n  onValueChange = (translation, language) => e => {\n    const { translations } = this.state;\n    translations[translation][language] = extractEventValue(e);\n    this.setState({\n      translations,\n      isDirty: true\n    });\n  };\n\n  save = () => {\n    const { vmpTranslationsSetting, translations, translationsTableLanguages } = this.state;\n    const settingValue = DEFAULT_VMP_TRANSLATIONS_SETTING;\n    translationsTableLanguages.forEach(language => (settingValue.localization[language] = {}));\n    Object.keys(translations).forEach(translation =>\n      Object.keys(translations[translation]).forEach(\n        language => (settingValue.localization[language][translation] = translations[translation][language])\n      )\n    );\n    const settingValueJson = JSON.stringify(settingValue);\n    if (vmpTranslationsSetting && vmpTranslationsSetting.uuid) {\n      vmpTranslationsSetting.value = settingValueJson;\n      this.props.updateSetting(vmpTranslationsSetting);\n    } else {\n      this.props.createSetting(VMP_TRANSLATIONS_SETTING_KEY, settingValueJson);\n    }\n    this.resetState();\n  };\n\n  resetState = () => this.setState({ acceptedFile: null, rejectedFile: null });\n\n  onReturn = () => {\n    this.setState({\n      isConfirmationModalOpen: true,\n      confirmationModalHeader: { id: 'vmpTranslations.return.modalHeader' },\n      confirmationModalBody: { id: 'vmpTranslations.return.modalBody' },\n      onConfirmationModalConfirm: this.return,\n      onConfirmationModalCancel: this.closeConfirmationModal\n    });\n  };\n\n  return = () => {\n    window.location.href = ROOT_URL;\n  };\n\n  addLanguageModal = () => {\n    const { languagesAllowed, translationsTableLanguages, isAddLanguageModalOpen } = this.state;\n    return (\n      <AddLanguageModal\n        intl={this.props.intl}\n        languages={languagesAllowed.filter(language => !translationsTableLanguages.includes(language))}\n        isOpen={isAddLanguageModalOpen}\n        onYes={language => this.addLanguage(language)}\n        onNo={() => this.setState({ isAddLanguageModalOpen: false })}\n      />\n    );\n  };\n\n  confirmationModal = () => (\n    <ConfirmationModal\n      header={this.state.confirmationModalHeader}\n      body={this.state.confirmationModalBody}\n      onYes={this.state.onConfirmationModalConfirm}\n      onNo={this.state.onConfirmationModalCancel}\n      isOpen={this.state.isConfirmationModalOpen}\n    />\n  );\n\n  closeConfirmationModal = () => this.setState({ isConfirmationModalOpen: false });\n\n  instructions = () => (\n    <p>\n      <FormattedMessage id=\"vmpTranslations.upload.instruction1\" values={{ b: (...text) => <b>{text}</b> }} />\n    </p>\n  );\n\n  uploadButton = () => (\n    <div className=\"upload-button-wrapper\">\n      <Button onClick={this.onUpload} disabled={!this.state.acceptedFile} className=\"pull-right\">\n        <FormattedMessage id=\"vmpTranslations.upload.button\" />\n      </Button>\n    </div>\n  );\n\n  onUpload = () => {\n    const { acceptedFile } = this.state;\n    this.setState({\n      isConfirmationModalOpen: true,\n      confirmationModalHeader: { id: 'vmpTranslations.upload.modalHeader' },\n      confirmationModalBody: { id: 'vmpTranslations.upload.modalBody' },\n      onConfirmationModalConfirm: () => {\n        this.uploadTranslationFile(acceptedFile);\n        this.closeConfirmationModal();\n      },\n      onConfirmationModalCancel: this.closeConfirmationModal\n    });\n  };\n\n  uploadTranslationFile = translationFile => {\n    const { translations } = this.state;\n    Papa.parse(translationFile, {\n      delimiter: DEFAULT_DELIMITER,\n      header: true,\n      complete: parsedTranslationFile => {\n        !!parsedTranslationFile &&\n          !!parsedTranslationFile.data &&\n          parsedTranslationFile.data.forEach(row => {\n            const { default: defaultValue, ...translationValues } = row;\n            translations[defaultValue] = translationValues;\n          });\n        const translationsTableLanguages = !!parsedTranslationFile.meta.fields\n          ? parsedTranslationFile.meta.fields.filter(field => field !== CSV_FILE_DEFAULT_COLUMN_LABEL)\n          : [];\n        this.setState(state => ({\n          translations,\n          translationsTableLanguages: Array.from(new Set([...state.translationsTableLanguages, ...translationsTableLanguages])),\n          isDirty: true\n        }));\n      }\n    });\n  };\n\n  downloadButton = () => (\n    <Button onClick={this.onDownloadTranslations} disabled={!this.props.config} className=\"cancel\">\n      <FormattedMessage id=\"vmpTranslations.download.button\" />\n    </Button>\n  );\n\n  onDownloadTranslations = () => {\n    if (this.state.isDirty) {\n      this.setState({\n        isConfirmationModalOpen: true,\n        confirmationModalHeader: { id: 'vmpTranslations.download.modalHeader' },\n        confirmationModalBody: { id: 'vmpTranslations.download.modalBody' },\n        onConfirmationModalConfirm: () => {\n          this.downloadTranslations();\n          this.closeConfirmationModal();\n        },\n        onConfirmationModalCancel: this.closeConfirmationModal\n      });\n    } else {\n      this.downloadTranslations();\n    }\n  };\n\n  downloadTranslations = () => {\n    const { downloadableTranslations, translationsTableLanguages } = this.state;\n    const csvData = [];\n    Object.keys(this.sortTranslationsAlphabetically(downloadableTranslations)).forEach(translation =>\n      csvData.push({\n        default: translation,\n        ...downloadableTranslations[translation]\n      })\n    );\n    downloadCsv(csvData, [CSV_FILE_DEFAULT_COLUMN_LABEL, ...translationsTableLanguages], DEFAULT_DOWNLOAD_FILENAME);\n  };\n\n  filters = () => {\n    const { intl } = this.props;\n    const { translationsTableLanguages, phraseFilterValue, languageFilterValue } = this.state;\n    return (\n      <div className=\"pb-3 d-flex\">\n        <FilterInput\n          intl={intl}\n          value={phraseFilterValue}\n          placeholderId=\"vmpTranslations.table.filter.phrase\"\n          onChange={phrase => this.setState({ phraseFilterValue: extractEventValue(phrase) })}\n        />\n        <FilterSelect\n          intl={intl}\n          value={LANGUAGE_OPTIONS.find(opt => opt.value === languageFilterValue) || null}\n          options={[LANGUAGE_FILTER_EMPTY_VALUE, ...LANGUAGE_OPTIONS.filter(lang => translationsTableLanguages.includes(lang.value))]}\n          placeholderId=\"vmpTranslations.table.filter.language\"\n          onChange={lang => this.setState({ languageFilterValue: lang.value })}\n        />\n      </div>\n    );\n  };\n\n  addLanguageButton = () => (\n    <Button onClick={this.onAddLanguage} disabled={Object.keys(this.state.translations).length === ZERO} className=\"cancel mb-3\">\n      <FormattedMessage id=\"vmpTranslations.addLanguage.title\" />\n    </Button>\n  );\n\n  languageColumnLabel = column => {\n    const languageOption = LANGUAGE_OPTIONS.find(opt => opt.value === column);\n    return !!languageOption && !!languageOption.label && languageOption.label;\n  };\n\n  onAddLanguage = () => this.setState({ isAddLanguageModalOpen: true });\n\n  addLanguage = language => {\n    const { translationsTableLanguages } = this.state;\n    translationsTableLanguages.unshift(language);\n    this.setState({ translationsTableLanguages, isAddLanguageModalOpen: false });\n  };\n\n  filteredTableColumns = () => {\n    const { translationsTableLanguages, languageFilterValue } = this.state;\n    return translationsTableLanguages.filter(language => (!!languageFilterValue ? language === languageFilterValue : true));\n  };\n\n  filteredTableRows = () => {\n    const { translations, phraseFilterValue } = this.state;\n    return Object.keys(this.sortTranslationsAlphabetically(translations)).filter(\n      translation =>\n        translation.toLowerCase().includes(phraseFilterValue.toLowerCase()) ||\n        Object.keys(translations[translation]).some(language =>\n          translations[translation][language].toLowerCase().includes(phraseFilterValue.toLowerCase())\n        )\n    );\n  };\n\n  uploadedFileTable = () => {\n    const { intl } = this.props;\n    const { translations } = this.state;\n    return (\n      <div className=\"section table-section\">\n        <div className=\"title-section\">{this.downloadButton()}</div>\n        {this.filters()}\n        {this.addLanguageButton()}\n        {Object.keys(translations).length ? (\n          <Table borderless striped responsive className=\"table\">\n            <thead>\n              <tr>\n                <th key=\"id\">\n                  <FormattedMessage id=\"vmpTranslations.table.defaultLanguage\" />\n                </th>\n                {this.filteredTableColumns().map(column => (\n                  <th key={column}>{this.languageColumnLabel(column)}</th>\n                ))}\n              </tr>\n            </thead>\n            <tbody>\n              {this.filteredTableRows().map((translation, i) => (\n                <tr key={`${translation}${i}`}>\n                  <td className=\"px-3\">{translation}</td>\n                  {this.filteredTableColumns().map((language, j) => (\n                    <td key={`${language}${j}`}>\n                      <TextareaAutosize\n                        value={translations[translation][language]}\n                        onChange={this.onValueChange(translation, language)}\n                        className=\"translation-input\"\n                        placeholder={intl.formatMessage({ id: 'vmpTranslations.table.defaultValue' })}\n                      />\n                    </td>\n                  ))}\n                </tr>\n              ))}\n            </tbody>\n          </Table>\n        ) : (\n          <p className=\"data-empty\">\n            <FormattedMessage id=\"vmpTranslations.table.empty\" />\n          </p>\n        )}\n      </div>\n    );\n  };\n\n  render() {\n    const { appError, appLoading, loading, loadingAddressData, loadingLocations } = this.props;\n    return (\n      <div className=\"vmp-translations\">\n        {this.confirmationModal()}\n        {this.addLanguageModal()}\n        <h2>\n          <FormattedMessage id=\"vmpTranslations.title\" />\n        </h2>\n        <div className=\"error\">{appError}</div>\n        <div className=\"inner-content\">\n          {appLoading || loading || loadingAddressData || loadingLocations ? (\n            <Spinner />\n          ) : (\n            <>\n              <div className=\"section\">\n                <h2>\n                  <FormattedMessage id=\"vmpTranslations.upload.title\" />\n                </h2>\n                {this.instructions()}\n                <Dropzone\n                  acceptedFileExt={ACCEPTED_FILE_EXTENSIONS}\n                  instructionMessageId=\"vmpTranslations.dropzone.instruction\"\n                  onFileAccepted={acceptedFile => this.setState({ acceptedFile })}\n                />\n                {this.uploadButton()}\n                {this.uploadedFileTable()}\n              </div>\n              <div className=\"mt-5 pb-5\">\n                <div className=\"d-inline\">\n                  <Button className=\"cancel\" onClick={this.onReturn}>\n                    <FormattedMessage id=\"common.return\" />\n                  </Button>\n                </div>\n                <div className=\"d-inline pull-right confirm-button-container\">\n                  <Button className=\"save\" onClick={this.save} disabled={loading}>\n                    <FormattedMessage id=\"common.save\" />\n                  </Button>\n                </div>\n              </div>\n            </>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = ({ apps, settings, addressData, location }) => ({\n  appError: apps.errorMessage,\n  appLoading: apps.loading,\n  error: apps.errorMessage,\n  loading: settings.loading,\n  success: settings.success,\n  config: settings.setting?.value && settings.setting?.value,\n  setting: settings.setting,\n  isSettingExist: settings.isSettingExist,\n  loadingAddressData: addressData.loadingAddressData,\n  addressData: addressData.downloadableAddressData,\n  locations: location.locations,\n  loadingLocations: location.loadingLocations\n});\n\nconst mapDispatchToProps = { getSettingByQuery, getAddressData, createSetting, updateSetting, searchLocations };\n\ntype StateProps = ReturnType<typeof mapStateToProps>;\ntype DispatchProps = typeof mapDispatchToProps;\n\nexport default connect(mapStateToProps, mapDispatchToProps)(injectIntl(withRouter(VmpTranslations)));\n","import axios from 'axios';\nimport { FAILURE, REQUEST, SUCCESS } from '../action-type.util';\n\nexport const ACTION_TYPES = {\n  GET_SMS_PROVIDERS: 'provider/GET_SMS_PROVIDERS',\n  GET_CALLFLOWS_PROVIDERS: 'provider/GET_CALLFLOWS_PROVIDERS'\n};\n\nconst initialState = {\n  loading: false,\n  smsProviders: [],\n  callflowsProviders: [],\n  errorMessage: null\n};\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case REQUEST(ACTION_TYPES.GET_SMS_PROVIDERS):\n    case REQUEST(ACTION_TYPES.GET_CALLFLOWS_PROVIDERS):\n      return {\n        ...state,\n        loading: true\n      };\n    case FAILURE(ACTION_TYPES.GET_SMS_PROVIDERS):\n    case FAILURE(ACTION_TYPES.GET_CALLFLOWS_PROVIDERS):\n      return {\n        ...state,\n        errorMessage: action.payload.message\n      };\n    case SUCCESS(ACTION_TYPES.GET_SMS_PROVIDERS):\n      return {\n        ...state,\n        loading: false,\n        smsProviders: !!action.payload.data && !!action.payload.data.configs ? action.payload.data.configs : []\n      };\n    case SUCCESS(ACTION_TYPES.GET_CALLFLOWS_PROVIDERS):\n      return {\n        ...state,\n        loading: false,\n        callflowsProviders: !!action.payload.data ? action.payload.data : []\n      };\n    default:\n      return state;\n  }\n};\n\nexport const getSmsProviders = () => ({\n  type: ACTION_TYPES.GET_SMS_PROVIDERS,\n  payload: axios.get('/openmrs/ws/sms/configs')\n});\n\nexport const getCallflowsProviders = () => ({\n  type: ACTION_TYPES.GET_CALLFLOWS_PROVIDERS,\n  payload: axios.get('/openmrs/ws/callflows/configs')\n});\n\nexport default reducer;\n","import React, { useEffect, useRef, useState } from 'react';\nimport './ExpandableSection.scss';\nimport { Button } from 'reactstrap';\n\nexport default function ExpandableSection({\n  headerComponent,\n  disabledHeaderComponent = headerComponent,\n  bodyComponent,\n  isRemovable = false,\n  onRemove = null,\n  isExpandTriggered = false\n}) {\n  const [isOpen, setIsOpen] = useState(false);\n  const prevIsExpandTriggeredRef = useRef<Boolean>();\n  const prevIsOpenRef = useRef<Boolean>();\n  useEffect(() => {\n    prevIsExpandTriggeredRef.current = isExpandTriggered;\n    prevIsOpenRef.current = isOpen;\n  });\n  const isExpandTriggeredChanged = isExpandTriggered !== prevIsExpandTriggeredRef.current;\n  const isOpenChanged = isOpen !== prevIsOpenRef.current;\n  if (!isOpenChanged && isExpandTriggeredChanged && isOpen !== isExpandTriggered) {\n    setIsOpen(isExpandTriggered);\n  }\n  const isExpanded = isOpenChanged ? isOpen : isExpandTriggeredChanged ? isExpandTriggered : isOpen;\n  return (\n    <div className=\"expandable-section\">\n      <div className=\"expandable-section-header\">\n        <div className=\"inline-fields col-6 pl-0\">{isExpanded ? headerComponent : disabledHeaderComponent}</div>\n        <div className=\"icon-buttons col-6\">\n          {isRemovable && !!onRemove && (\n            <Button className=\"icon-button\" onClick={onRemove} data-testid=\"removeExpandableSectionButton\">\n              <i className=\"bi bi-trash\" />\n            </Button>\n          )}\n          <Button className=\"icon-button\" onClick={() => setIsOpen(!isExpanded)} data-testid=\"expandableSectionButton\">\n            <i className={`bi ${isExpanded ? 'bi-arrows-collapse' : 'bi-arrows-expand'}`} />\n          </Button>\n        </div>\n      </div>\n      {isExpanded && <div className=\"expandable-section-body\">{bodyComponent}</div>}\n    </div>\n  );\n}\n","import React from 'react';\nimport { default as ReactSwitch } from 'rc-switch';\nimport { FormattedMessage } from 'react-intl';\nimport './Switch.scss';\nimport 'rc-switch/assets/index.css';\n\nexport const Switch = ({\n  id,\n  intl,\n  onChange,\n  checkedTranslationId,\n  uncheckedTranslationId,\n  labelTranslationId,\n  checked = false,\n  disabled = false\n}) => (\n  <div className=\"inline-fields switch-with-label\">\n    <label htmlFor={id}>\n      <FormattedMessage id={labelTranslationId} />\n    </label>\n    <ReactSwitch\n      id={id}\n      onChange={onChange}\n      onClick={onChange}\n      disabled={disabled}\n      checked={checked}\n      checkedChildren={intl.formatMessage({ id: checkedTranslationId })}\n      unCheckedChildren={intl.formatMessage({ id: uncheckedTranslationId })}\n    />\n  </div>\n);\n","import React from 'react';\nimport './Divider.scss';\n\nexport default function Divider() {\n  return <hr />;\n}\n","import React from 'react';\nimport { TimePicker as ReactTimePicker } from 'antd';\nimport { DEFAULT_TIME_FORMAT, EMPTY_STRING } from '../../../shared/constants/input';\nimport 'antd/dist/antd.min.css';\nimport './TimePicker.scss';\nimport '../../Inputs.scss';\n\nexport const TimePicker = ({\n  format = DEFAULT_TIME_FORMAT,\n  placeholder = null,\n  showPlaceholder = false,\n  showNow = false,\n  value,\n  onChange\n}) => (\n  <div className=\"input-container\">\n    <ReactTimePicker\n      format={format}\n      placeholder={placeholder}\n      showNow={showNow}\n      value={value}\n      onChange={onChange}\n      className=\"default-time-picker\"\n    />\n    {!!showPlaceholder && <span className=\"placeholder\">{placeholder || EMPTY_STRING}</span>}\n  </div>\n);\n","import { ZERO } from './input';\n\nexport const COUNTRY_SETTINGS_MAP_SETTING_KEY = 'cfl.countrySettingsMap';\nexport const DEFAULT_COUNTRY_CONFIGURATION_NAME = 'default';\nexport const DEFAULT_COUNTRY_SETTINGS_MAP = { [DEFAULT_COUNTRY_CONFIGURATION_NAME]: {} };\nexport const CONFIGURATION_NAME_PROPERTY_NAME = 'name';\nexport const SMS_PROPERTY_NAME = 'SMS';\nexport const CALL_PROPERTY_NAME = 'CALL';\nexport const PERFORM_CALL_UPON_REGISTRATION_PROPERTY_NAME = 'performCallOnPatientRegistration';\nexport const SEND_SMS_UPON_REGISTRATION_PROPERTY_NAME = 'sendSmsOnPatientRegistration';\nexport const SEND_CALL_REMINDER_PROPERTY_NAME = 'shouldSendReminderViaCall';\nexport const SEND_SMS_REMINDER_PROPERTY_NAME = 'shouldSendReminderViaSms';\nexport const NOTIFICATION_TIME_WINDOW_FROM_PROPERTY_NAME = 'patientNotificationTimeWindowFrom';\nexport const NOTIFICATION_TIME_WINDOW_TO_PROPERTY_NAME = 'patientNotificationTimeWindowTo';\nexport const BEST_CONTACT_TIME_PROPERTY_NAME = 'message.bestContactTime.default';\nexport const VISIT_REMINDER_PROPERTY_NAME = 'message.daysToCallBeforeVisit.default';\nexport const DEFAULT_COUNTRY_CONFIGURATION = {\n  [CONFIGURATION_NAME_PROPERTY_NAME]: '',\n  [SMS_PROPERTY_NAME]: '',\n  [CALL_PROPERTY_NAME]: '',\n  [PERFORM_CALL_UPON_REGISTRATION_PROPERTY_NAME]: false,\n  [SEND_SMS_UPON_REGISTRATION_PROPERTY_NAME]: false,\n  [SEND_CALL_REMINDER_PROPERTY_NAME]: false,\n  [SEND_SMS_REMINDER_PROPERTY_NAME]: false,\n  shouldCreateFirstVisit: false,\n  shouldCreateFutureVisit: false,\n  [NOTIFICATION_TIME_WINDOW_FROM_PROPERTY_NAME]: null,\n  [NOTIFICATION_TIME_WINDOW_TO_PROPERTY_NAME]: null,\n  [BEST_CONTACT_TIME_PROPERTY_NAME]: null,\n  [VISIT_REMINDER_PROPERTY_NAME]: [ZERO]\n};\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { FormattedMessage, injectIntl } from 'react-intl';\nimport { RouteComponentProps, withRouter } from 'react-router-dom';\nimport { createSetting, getSettingByQuery, updateSetting } from '../../redux/reducers/setttings';\nimport { getCallflowsProviders, getSmsProviders } from '../../redux/reducers/provider';\nimport { Button, Label, Spinner } from 'reactstrap';\nimport ExpandableSection from '../common/expandable-section/ExpandableSection';\nimport { InputWithPlaceholder, SelectWithPlaceholder } from '../common/form/withPlaceholder';\nimport { extractEventValue, selectDefaultTheme } from '../../shared/util/form-util';\nimport { successToast, errorToast } from '@bit/soldevelo-omrs.cfl-components.toast-handler';\nimport _ from 'lodash';\nimport { parseJson } from '../../shared/util/json-util';\nimport { Switch } from '../common/switch/Switch';\nimport Divider from '../common/divider/Divider';\nimport { TimePicker } from '../common/time-picker/TimePicker';\nimport moment from 'moment';\nimport { PlusMinusButtons } from '../common/form/PlusMinusButtons';\nimport { ConfirmationModal } from '../common/form/ConfirmationModal';\nimport ValidationError from '../common/form/ValidationError';\nimport './NotificationConfiguration.scss';\nimport '../Inputs.scss';\nimport { COUNTRY_OPTIONS } from '../../shared/constants/vmp-config';\nimport {\n  COUNTRY_SETTINGS_MAP_SETTING_KEY,\n  DEFAULT_COUNTRY_SETTINGS_MAP,\n  DEFAULT_COUNTRY_CONFIGURATION_NAME,\n  DEFAULT_COUNTRY_CONFIGURATION,\n  CONFIGURATION_NAME_PROPERTY_NAME,\n  NOTIFICATION_TIME_WINDOW_FROM_PROPERTY_NAME,\n  NOTIFICATION_TIME_WINDOW_TO_PROPERTY_NAME,\n  BEST_CONTACT_TIME_PROPERTY_NAME,\n  VISIT_REMINDER_PROPERTY_NAME,\n  SMS_PROPERTY_NAME,\n  SEND_SMS_UPON_REGISTRATION_PROPERTY_NAME,\n  SEND_SMS_REMINDER_PROPERTY_NAME,\n  CALL_PROPERTY_NAME,\n  PERFORM_CALL_UPON_REGISTRATION_PROPERTY_NAME,\n  SEND_CALL_REMINDER_PROPERTY_NAME\n} from '../../shared/constants/notification-configuration';\nimport { DEFAULT_TIME_FORMAT, ONE, TEN, ZERO } from '../../shared/constants/input';\nimport { ROOT_URL } from '../../shared/constants/openmrs';\n\ninterface INotificationConfigurationProps extends StateProps, DispatchProps, RouteComponentProps {\n  intl: any;\n}\n\ninterface INotificationConfigurationState {\n  notificationConfiguration: any[];\n  isAllSectionsExpanded: boolean;\n  isConfirmationModalOpen: boolean;\n}\n\nclass NotificationConfiguration extends React.Component<INotificationConfigurationProps, INotificationConfigurationState> {\n  state = {\n    notificationConfiguration: [],\n    isAllSectionsExpanded: false,\n    isConfirmationModalOpen: false\n  };\n\n  componentDidMount() {\n    this.props.getSettingByQuery(COUNTRY_SETTINGS_MAP_SETTING_KEY);\n    this.props.getCallflowsProviders();\n    this.props.getSmsProviders();\n  }\n\n  componentDidUpdate(prevProps: Readonly<INotificationConfigurationProps>) {\n    const { intl, config, loading, success, error } = this.props;\n    if (prevProps.config !== config) {\n      this.extractConfigData();\n    }\n    if (!prevProps.success && success) {\n      successToast(intl.formatMessage({ id: 'notificationConfiguration.success' }));\n      this.setState({ isAllSectionsExpanded: false });\n    } else if (prevProps.error !== this.props.error && !loading) {\n      errorToast(error);\n    }\n  }\n\n  extractConfigData = () => {\n    let config = parseJson(this.props.config);\n    config = !!config[ZERO] ? config[ZERO] : _.cloneDeep(DEFAULT_COUNTRY_SETTINGS_MAP);\n    const notificationConfiguration = [];\n    Object.keys(config).forEach(configurationName => {\n      const configuration = configurationName ? config[configurationName] : null;\n      if (configuration) {\n        configuration[CONFIGURATION_NAME_PROPERTY_NAME] = configurationName;\n        if (configuration.hasOwnProperty(NOTIFICATION_TIME_WINDOW_FROM_PROPERTY_NAME)) {\n          configuration[NOTIFICATION_TIME_WINDOW_FROM_PROPERTY_NAME] = moment(\n            configuration[NOTIFICATION_TIME_WINDOW_FROM_PROPERTY_NAME],\n            DEFAULT_TIME_FORMAT\n          );\n        }\n        if (configuration.hasOwnProperty(NOTIFICATION_TIME_WINDOW_TO_PROPERTY_NAME)) {\n          configuration[NOTIFICATION_TIME_WINDOW_TO_PROPERTY_NAME] = moment(\n            configuration[NOTIFICATION_TIME_WINDOW_TO_PROPERTY_NAME],\n            DEFAULT_TIME_FORMAT\n          );\n        }\n        if (configuration.hasOwnProperty(BEST_CONTACT_TIME_PROPERTY_NAME)) {\n          configuration[BEST_CONTACT_TIME_PROPERTY_NAME] = moment(configuration[BEST_CONTACT_TIME_PROPERTY_NAME], DEFAULT_TIME_FORMAT);\n        }\n        if (\n          !configuration.hasOwnProperty(VISIT_REMINDER_PROPERTY_NAME) ||\n          !Array.isArray(configuration[VISIT_REMINDER_PROPERTY_NAME]) ||\n          !configuration[VISIT_REMINDER_PROPERTY_NAME].length\n        ) {\n          configuration[VISIT_REMINDER_PROPERTY_NAME] = [ZERO];\n        }\n        notificationConfiguration.push(configuration);\n      }\n    });\n    this.setState({ notificationConfiguration });\n  };\n\n  isSaveDisabled = () => this.props.loading || this.state.notificationConfiguration.some(configuration => !configuration.name);\n\n  onSave = () => this.setState({ isConfirmationModalOpen: true });\n\n  save = () => {\n    const { setting } = this.props;\n    const { notificationConfiguration } = this.state;\n    const settingValue = [{}];\n    notificationConfiguration.forEach(configuration => {\n      const { name, ...configurationProps } = configuration;\n      if (moment.isMoment(configurationProps[NOTIFICATION_TIME_WINDOW_FROM_PROPERTY_NAME])) {\n        configurationProps[NOTIFICATION_TIME_WINDOW_FROM_PROPERTY_NAME] = configurationProps[\n          NOTIFICATION_TIME_WINDOW_FROM_PROPERTY_NAME\n        ].format(DEFAULT_TIME_FORMAT);\n      }\n      if (moment.isMoment(configurationProps[NOTIFICATION_TIME_WINDOW_TO_PROPERTY_NAME])) {\n        configurationProps[NOTIFICATION_TIME_WINDOW_TO_PROPERTY_NAME] = configurationProps[\n          NOTIFICATION_TIME_WINDOW_TO_PROPERTY_NAME\n        ].format(DEFAULT_TIME_FORMAT);\n      }\n      if (moment.isMoment(configurationProps[BEST_CONTACT_TIME_PROPERTY_NAME])) {\n        configurationProps[BEST_CONTACT_TIME_PROPERTY_NAME] = configurationProps[BEST_CONTACT_TIME_PROPERTY_NAME].format(\n          DEFAULT_TIME_FORMAT\n        );\n      }\n      settingValue[ZERO][name] = configurationProps;\n    });\n    const settingValueJson = JSON.stringify(settingValue);\n    if (setting && setting.uuid) {\n      setting.value = settingValueJson;\n      this.props.updateSetting(setting);\n    } else {\n      this.props.createSetting(COUNTRY_SETTINGS_MAP_SETTING_KEY, settingValueJson);\n    }\n  };\n\n  return = () => {\n    window.location.href = ROOT_URL;\n  };\n\n  closeModal = () => this.setState({ isConfirmationModalOpen: false });\n\n  confirmationModal = () => (\n    <ConfirmationModal\n      header={{ id: 'notificationConfiguration.confirmationModal.header' }}\n      body={{ id: 'notificationConfiguration.confirmationModal.body' }}\n      onYes={() => {\n        this.save();\n        this.closeModal();\n      }}\n      onNo={this.closeModal}\n      isOpen={this.state.isConfirmationModalOpen}\n    />\n  );\n\n  onChange = (configurationIdx, propertyName, isSelect = false) => event => {\n    const { notificationConfiguration } = this.state;\n    const configuration = notificationConfiguration[configurationIdx];\n    const value = isSelect ? event.value : extractEventValue(event);\n    if (!configuration) {\n      notificationConfiguration.push({ [CONFIGURATION_NAME_PROPERTY_NAME]: configuration[CONFIGURATION_NAME_PROPERTY_NAME] });\n    }\n    configuration[propertyName] = value;\n    this.setState({ notificationConfiguration });\n  };\n\n  selectTextOption = value => ({ label: value, value });\n\n  smsSettings = configurationIdx => {\n    const { intl, smsProviders } = this.props;\n    const { notificationConfiguration } = this.state;\n    const configuration = notificationConfiguration[configurationIdx];\n    const smsProviderOptions = smsProviders.map(provider => ({ label: provider.name, value: provider.name }));\n    const smsProvider = !!configuration?.[SMS_PROPERTY_NAME] ? this.selectTextOption(configuration[SMS_PROPERTY_NAME]) : null;\n    const shouldSendSmsUponRegistration = !!configuration?.[SEND_SMS_UPON_REGISTRATION_PROPERTY_NAME];\n    const shouldSendSmsReminder = !!configuration?.[SEND_SMS_REMINDER_PROPERTY_NAME];\n    return (\n      <>\n        <div className=\"py-3\">\n          <Label>\n            <FormattedMessage id=\"notificationConfiguration.smsSettings\" />\n          </Label>\n          <div className=\"inline-fields\">\n            <div className=\"col-6 pl-0\">\n              <SelectWithPlaceholder\n                placeholder={intl.formatMessage({ id: 'notificationConfiguration.provider' })}\n                showPlaceholder={!!smsProvider}\n                value={smsProvider}\n                onChange={this.onChange(configurationIdx, SMS_PROPERTY_NAME, true)}\n                options={smsProviderOptions}\n                wrapperClassName=\"flex-1\"\n                classNamePrefix=\"default-select\"\n                theme={selectDefaultTheme}\n              />\n            </div>\n            <div className=\"col-6 px-5\">\n              <Switch\n                id={`sms-upon-registration-switch-${configurationIdx}`}\n                intl={intl}\n                labelTranslationId=\"notificationConfiguration.uponRegistration\"\n                checked={shouldSendSmsUponRegistration}\n                checkedTranslationId=\"common.switch.on\"\n                uncheckedTranslationId=\"common.switch.off\"\n                onChange={this.onChange(configurationIdx, SEND_SMS_UPON_REGISTRATION_PROPERTY_NAME)}\n              />\n              <Switch\n                id={`sms-visit-reminder-switch-${configurationIdx}`}\n                intl={intl}\n                labelTranslationId=\"notificationConfiguration.visitReminder.switch\"\n                checked={shouldSendSmsReminder}\n                checkedTranslationId=\"common.switch.on\"\n                uncheckedTranslationId=\"common.switch.off\"\n                onChange={this.onChange(configurationIdx, SEND_SMS_REMINDER_PROPERTY_NAME)}\n              />\n            </div>\n          </div>\n        </div>\n        <Divider />\n      </>\n    );\n  };\n\n  callSettings = configurationIdx => {\n    const { intl, callflowsProviders } = this.props;\n    const { notificationConfiguration } = this.state;\n    const configuration = notificationConfiguration[configurationIdx];\n    const callflowsProviderOptions = callflowsProviders.map(provider => ({ label: provider.name, value: provider.name }));\n    const callflowsProvider = !!configuration?.[CALL_PROPERTY_NAME] ? this.selectTextOption(configuration[CALL_PROPERTY_NAME]) : null;\n    const shouldPerformCallUponRegistration = !!configuration?.[PERFORM_CALL_UPON_REGISTRATION_PROPERTY_NAME];\n    const shouldSendCallReminder = !!configuration?.[SEND_CALL_REMINDER_PROPERTY_NAME];\n    return (\n      <>\n        <div className=\"py-3\">\n          <Label>\n            <FormattedMessage id=\"notificationConfiguration.callSettings\" />\n          </Label>\n          <div className=\"inline-fields\">\n            <div className=\"col-6 pl-0\">\n              <SelectWithPlaceholder\n                placeholder={intl.formatMessage({ id: 'notificationConfiguration.provider' })}\n                showPlaceholder={!!callflowsProvider}\n                value={callflowsProvider}\n                onChange={this.onChange(configurationIdx, CALL_PROPERTY_NAME, true)}\n                options={callflowsProviderOptions}\n                wrapperClassName=\"flex-1\"\n                classNamePrefix=\"default-select\"\n                theme={selectDefaultTheme}\n              />\n            </div>\n            <div className=\"col-6 px-5\">\n              <Switch\n                id={`call-upon-registration-switch-${configurationIdx}`}\n                intl={intl}\n                labelTranslationId=\"notificationConfiguration.uponRegistration\"\n                checked={shouldPerformCallUponRegistration}\n                checkedTranslationId=\"common.switch.on\"\n                uncheckedTranslationId=\"common.switch.off\"\n                onChange={this.onChange(configurationIdx, PERFORM_CALL_UPON_REGISTRATION_PROPERTY_NAME)}\n              />\n              <Switch\n                id={`call-visit-reminder-switch-${configurationIdx}`}\n                intl={intl}\n                labelTranslationId=\"notificationConfiguration.visitReminder.switch\"\n                checked={shouldSendCallReminder}\n                checkedTranslationId=\"common.switch.on\"\n                uncheckedTranslationId=\"common.switch.off\"\n                onChange={this.onChange(configurationIdx, SEND_CALL_REMINDER_PROPERTY_NAME)}\n              />\n            </div>\n          </div>\n        </div>\n        <Divider />\n      </>\n    );\n  };\n\n  notificationWindowAndBestContactTime = configurationIdx => {\n    const { intl } = this.props;\n    const { notificationConfiguration } = this.state;\n    const configuration = notificationConfiguration[configurationIdx];\n    const notificationTimeWindowFrom = !!configuration?.[NOTIFICATION_TIME_WINDOW_FROM_PROPERTY_NAME]\n      ? configuration[NOTIFICATION_TIME_WINDOW_FROM_PROPERTY_NAME]\n      : null;\n    const notificationTimeWindowTo = !!configuration?.[NOTIFICATION_TIME_WINDOW_TO_PROPERTY_NAME]\n      ? configuration[NOTIFICATION_TIME_WINDOW_TO_PROPERTY_NAME]\n      : null;\n    const bestContactTime = !!configuration?.[BEST_CONTACT_TIME_PROPERTY_NAME] ? configuration[BEST_CONTACT_TIME_PROPERTY_NAME] : null;\n    return (\n      <div className=\"inline-fields py-3\">\n        <div className=\"col-6 pl-0\">\n          <Label>\n            <FormattedMessage id=\"notificationConfiguration.allowedNotificationWindow.label\" />\n          </Label>\n          <div className=\"inline-fields\">\n            <TimePicker\n              placeholder={intl.formatMessage({ id: 'notificationConfiguration.allowedNotificationWindow.from' })}\n              showPlaceholder={!!notificationTimeWindowFrom}\n              value={notificationTimeWindowFrom}\n              onChange={this.onChange(configurationIdx, NOTIFICATION_TIME_WINDOW_FROM_PROPERTY_NAME)}\n            />\n            <TimePicker\n              placeholder={intl.formatMessage({ id: 'notificationConfiguration.allowedNotificationWindow.to' })}\n              showPlaceholder={!!notificationTimeWindowTo}\n              value={notificationTimeWindowTo}\n              onChange={this.onChange(configurationIdx, NOTIFICATION_TIME_WINDOW_TO_PROPERTY_NAME)}\n            />\n          </div>\n        </div>\n        <div className=\"col-6 pl-5\">\n          <Label>\n            <FormattedMessage id=\"notificationConfiguration.bestContactTime.label\" />\n          </Label>\n          <TimePicker\n            placeholder={intl.formatMessage({ id: 'notificationConfiguration.bestContactTime.placeholder' })}\n            showPlaceholder={!!bestContactTime}\n            value={bestContactTime}\n            onChange={this.onChange(configurationIdx, BEST_CONTACT_TIME_PROPERTY_NAME)}\n          />\n        </div>\n      </div>\n    );\n  };\n\n  onVisitReminderChange = (configurationIdx, reminderIdx) => event => {\n    const { notificationConfiguration } = this.state;\n    const extractedEventValue = extractEventValue(event);\n    const value = !!extractedEventValue ? Number.parseInt(extractedEventValue, TEN) : ZERO;\n    if (Number.isInteger(value) && value >= ZERO) {\n      notificationConfiguration[configurationIdx][VISIT_REMINDER_PROPERTY_NAME][reminderIdx] = value;\n      this.setState({ notificationConfiguration });\n    }\n  };\n\n  addVisitReminder = configurationIdx => {\n    const { notificationConfiguration } = this.state;\n    notificationConfiguration[configurationIdx][VISIT_REMINDER_PROPERTY_NAME].push(ZERO);\n    this.setState({ notificationConfiguration });\n  };\n\n  removeVisitReminder = (configurationIdx, reminderIdx) => {\n    const { notificationConfiguration } = this.state;\n    const configuration = notificationConfiguration[configurationIdx];\n    configuration[VISIT_REMINDER_PROPERTY_NAME].splice(reminderIdx, ONE);\n    if (!configuration[VISIT_REMINDER_PROPERTY_NAME].length) {\n      configuration[VISIT_REMINDER_PROPERTY_NAME].push(ZERO);\n    }\n    this.setState({ notificationConfiguration });\n  };\n\n  visitReminder = configurationIdx => {\n    const { intl } = this.props;\n    const { notificationConfiguration } = this.state;\n    const configuration = notificationConfiguration[configurationIdx];\n    const visitReminders = !!configuration?.[VISIT_REMINDER_PROPERTY_NAME] ? configuration[VISIT_REMINDER_PROPERTY_NAME] : [ZERO];\n    return (\n      <div className=\"pt-5\">\n        <Label>\n          <FormattedMessage id=\"notificationConfiguration.visitReminder.label\" />\n        </Label>\n        {visitReminders.map((reminder, i) => (\n          <div className=\"inline-fields py-1\" key={`${configuration}-${configurationIdx}-reminder-${i}`}>\n            <InputWithPlaceholder\n              placeholder={intl.formatMessage({ id: 'notificationConfiguration.visitReminder.placeholder' })}\n              showPlaceholder\n              value={reminder}\n              onChange={this.onVisitReminderChange(configurationIdx, i)}\n              type=\"number\"\n              pattern=\"[1-9]\"\n              min={ZERO}\n            />\n            <PlusMinusButtons\n              intl={intl}\n              onPlusClick={() => this.addVisitReminder(configurationIdx)}\n              onMinusClick={() => this.removeVisitReminder(configurationIdx, i)}\n              isPlusButtonVisible={i === visitReminders.length - 1}\n            />\n          </div>\n        ))}\n      </div>\n    );\n  };\n\n  onCountryChange = configurationIdx => event => {\n    const { notificationConfiguration } = this.state;\n    const configuration = notificationConfiguration[configurationIdx];\n    configuration[CONFIGURATION_NAME_PROPERTY_NAME] = event.value;\n    this.setState({ notificationConfiguration });\n  };\n\n  addNewCountryConfiguration = () => {\n    const { notificationConfiguration } = this.state;\n    notificationConfiguration.push(_.cloneDeep(DEFAULT_COUNTRY_CONFIGURATION));\n    this.setState({ notificationConfiguration });\n  };\n\n  removeCountryConfiguration = configurationIdx => {\n    const { notificationConfiguration } = this.state;\n    notificationConfiguration.splice(configurationIdx, ONE);\n    this.setState({ notificationConfiguration });\n  };\n\n  countryConfiguration = (configuration, configurationIdx) => {\n    const { intl } = this.props;\n    const { isAllSectionsExpanded, notificationConfiguration } = this.state;\n    const configurationName = configuration[CONFIGURATION_NAME_PROPERTY_NAME];\n    const isDefaultCountryConfiguration = configurationName === DEFAULT_COUNTRY_CONFIGURATION_NAME;\n    const countryOptions = COUNTRY_OPTIONS.filter(\n      country => !notificationConfiguration.map(configuration => configuration.name).includes(country.value)\n    );\n    const headerComponent = isDefaultCountryConfiguration ? (\n      <Label>\n        <FormattedMessage id=\"notificationConfiguration.defaultCountry\" />\n      </Label>\n    ) : (\n      <div className=\"flex-1\">\n        <SelectWithPlaceholder\n          placeholder={intl.formatMessage({ id: 'notificationConfiguration.country' })}\n          showPlaceholder={!!configurationName}\n          value={!!configurationName && COUNTRY_OPTIONS.find(countryName => countryName.value === configurationName)}\n          onChange={this.onCountryChange(configurationIdx)}\n          options={countryOptions}\n          wrapperClassName={!configurationName ? 'invalid' : ''}\n          classNamePrefix=\"default-select\"\n          theme={selectDefaultTheme}\n        />\n        {!configurationName && <ValidationError message=\"common.error.required\" />}\n      </div>\n    );\n    const disabledHeaderComponent = isDefaultCountryConfiguration ? (\n      headerComponent\n    ) : (\n      <InputWithPlaceholder\n        placeholder={intl.formatMessage({ id: 'notificationConfiguration.country' })}\n        showPlaceholder={!!configurationName}\n        value={!!configurationName ? configurationName : ''}\n        wrapperClassName=\"flex-1\"\n        readOnly\n      />\n    );\n    const bodyComponent = [\n      this.smsSettings(configurationIdx),\n      this.callSettings(configurationIdx),\n      this.notificationWindowAndBestContactTime(configurationIdx),\n      this.visitReminder(configurationIdx)\n    ];\n    return (\n      <ExpandableSection\n        key={`configuration-${configurationIdx}`}\n        headerComponent={headerComponent}\n        disabledHeaderComponent={disabledHeaderComponent}\n        bodyComponent={bodyComponent}\n        isRemovable={!isDefaultCountryConfiguration}\n        onRemove={() => this.removeCountryConfiguration(configurationIdx)}\n        isExpandTriggered={isAllSectionsExpanded}\n      />\n    );\n  };\n\n  expandOrCollapseAllButton = () => {\n    const { isAllSectionsExpanded } = this.state;\n    return (\n      <Button onClick={() => this.setState(state => ({ isAllSectionsExpanded: !state.isAllSectionsExpanded }))} className=\"cancel\">\n        <FormattedMessage id={`notificationConfiguration.button.${isAllSectionsExpanded ? 'collapse' : 'expand'}`} />\n      </Button>\n    );\n  };\n\n  render() {\n    const { appError, appLoading, loading } = this.props;\n    const { notificationConfiguration } = this.state;\n    return (\n      <div className=\"notification-configuration\">\n        {this.confirmationModal()}\n        <h2>\n          <FormattedMessage id=\"notificationConfiguration.title\" />\n        </h2>\n        <div className=\"error\">{appError}</div>\n        <div className=\"inner-content\">\n          {appLoading || loading ? (\n            <Spinner />\n          ) : (\n            <>\n              <div className=\"section\">\n                <div className=\"title-section\">\n                  <h2>\n                    <FormattedMessage id=\"notificationConfiguration.configureSettings\" />\n                  </h2>\n                  {this.expandOrCollapseAllButton()}\n                </div>\n                {notificationConfiguration.map((configuration, idx) => this.countryConfiguration(configuration, idx))}\n                <div className=\"d-flex justify-content-end mt-4 mb-2\">\n                  <Button className=\"btn btn-primary\" onClick={this.addNewCountryConfiguration}>\n                    <FormattedMessage id=\"notificationConfiguration.button.addNewCountry\" />\n                  </Button>\n                </div>\n              </div>\n              <div className=\"mt-5 pb-5\">\n                <div className=\"d-inline\">\n                  <Button className=\"cancel\" onClick={this.return}>\n                    <FormattedMessage id=\"common.return\" />\n                  </Button>\n                </div>\n                <div className=\"d-inline pull-right confirm-button-container\">\n                  <Button className=\"save\" onClick={this.onSave} disabled={this.isSaveDisabled()}>\n                    <FormattedMessage id=\"common.save\" />\n                  </Button>\n                </div>\n              </div>\n            </>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = ({ apps, settings, provider }) => ({\n  appError: apps.errorMessage,\n  appLoading: apps.loading,\n  error: apps.errorMessage,\n  loading: settings.loading,\n  success: settings.success,\n  config: settings.setting?.value && settings.setting?.value,\n  setting: settings.setting,\n  isSettingExist: settings.isSettingExist,\n  smsProviders: provider.smsProviders,\n  callflowsProviders: provider.callflowsProviders\n});\n\nconst mapDispatchToProps = { getSettingByQuery, createSetting, updateSetting, getCallflowsProviders, getSmsProviders };\n\ntype StateProps = ReturnType<typeof mapStateToProps>;\ntype DispatchProps = typeof mapDispatchToProps;\n\nexport default connect(mapStateToProps, mapDispatchToProps)(injectIntl(withRouter(NotificationConfiguration)));\n","import axios from 'axios';\n\nimport { FAILURE, REQUEST, SUCCESS } from '../action-type.util';\n\nexport const ACTION_TYPES = {\n  GET_MESSAGES_TEMPLATES_GLOBAL_PROPERTIES: 'messages/GET_MESSAGES_TEMPLATES_GLOBAL_PROPERTIES'\n};\n\nconst initialState = {\n  loading: false,\n  success: false,\n  errorMessage: null,\n  messagesTemplatesGlobalProperties: []\n};\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case REQUEST(ACTION_TYPES.GET_MESSAGES_TEMPLATES_GLOBAL_PROPERTIES):\n      return {\n        ...state,\n        loading: true,\n        success: false,\n        errorMessage: null\n      };\n    case FAILURE(ACTION_TYPES.GET_MESSAGES_TEMPLATES_GLOBAL_PROPERTIES):\n      return {\n        ...state,\n        loading: false,\n        success: false,\n        errorMessage: action.payload.message\n      };\n    case SUCCESS(ACTION_TYPES.GET_MESSAGES_TEMPLATES_GLOBAL_PROPERTIES):\n      return {\n        ...initialState,\n        loading: false,\n        success: true,\n        messagesTemplatesGlobalProperties: action.payload.data\n      };\n    default:\n      return state;\n  }\n};\n\nexport const getMessagesTemplatesGlobalProperties = () => ({\n  type: ACTION_TYPES.GET_MESSAGES_TEMPLATES_GLOBAL_PROPERTIES,\n  payload: axios.get('/openmrs/ws/messages/templates/globalProperties')\n});\n\nexport default reducer;\n","import { EMPTY_STRING } from './input';\n\nexport const NOTIFICATION_TEMPLATE_SETTING_KEY_PREFIX = 'messages.notificationTemplate.';\nexport const INJECTED_SERVICES_SETTING_KEY_SUFFIX = 'injectedServices';\nexport const INJECTED_SERVICES_SETTING_KEY = NOTIFICATION_TEMPLATE_SETTING_KEY_PREFIX + INJECTED_SERVICES_SETTING_KEY_SUFFIX;\nexport const TEMPLATE_NAME_PROPERTY_NAME = 'property';\nexport const TEMPLATE_DESCRIPTION_PROPERTY_NAME = 'description';\nexport const TEMPLATE_VALUE_PROPERTY_NAME = 'value';\nexport const TEMPLATE_UUID_PROPERTY_NAME = 'uuid';\nexport const TEMPLATE_NAME_REGEX = /^[^\\d\\s][a-z-]*$/g;\nexport const INJECTED_SERVICES_DELIMITER = ',';\nexport const INJECTED_SERVICES_KEY_VALUE_DELIMITER = ':';\nexport const INJECTED_SERVICES_KEY = 'key';\nexport const INJECTED_SERVICES_VALUE = 'value';\nexport const DEFAULT_INJECTED_SERVICE = { [INJECTED_SERVICES_KEY]: EMPTY_STRING, [INJECTED_SERVICES_VALUE]: EMPTY_STRING };\n","import React from 'react';\nimport TextareaAutosize from 'react-textarea-autosize';\nimport { EMPTY_STRING } from 'src/shared/constants/input';\nimport { withPlaceholder } from '../form/withPlaceholder';\nimport './Textarea.scss';\n\nconst TextareaAutosizeWithPlaceholder = withPlaceholder(TextareaAutosize);\n\nexport const TextareaWithPlaceholder = ({\n  value,\n  placeholder,\n  showPlaceholder,\n  minRows = undefined,\n  maxRows = undefined,\n  isResizable = false,\n  className = EMPTY_STRING,\n  onChange\n}) => (\n  <TextareaAutosizeWithPlaceholder\n    value={value}\n    onChange={onChange}\n    placeholder={placeholder}\n    showPlaceholder={showPlaceholder}\n    minRows={minRows}\n    maxRows={maxRows}\n    className={`form-control default-textarea ${isResizable ? 'resizable' : EMPTY_STRING} ${className}`}\n  />\n);\n","import React from 'react';\nimport { UnControlled as CodeMirror } from 'react-codemirror2';\nimport { withPlaceholder } from '../form/withPlaceholder';\nimport 'codemirror/lib/codemirror.css';\nimport 'codemirror/mode/velocity/velocity';\nimport 'codemirror/addon/display/placeholder';\nimport './VelocityCodeEditor.scss';\n\nexport const VelocityCodeEditor = ({ value, lineNumbers = false, placeholder, onChange }) => (\n  <CodeMirror\n    value={value}\n    options={{\n      mode: 'velocity',\n      theme: 'default',\n      lineNumbers,\n      placeholder\n    }}\n    autoCursor={false}\n    onChange={(editor, data, value) => onChange(value)}\n  />\n);\n\nexport const VelocityCodeEditorWithPlaceholder = withPlaceholder(VelocityCodeEditor);\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { FormattedMessage, injectIntl } from 'react-intl';\nimport { RouteComponentProps, withRouter } from 'react-router-dom';\nimport { createSetting, getSettings, updateSetting, deleteSetting } from '../../redux/reducers/setttings';\nimport { getCallflowsProviders, getSmsProviders } from '../../redux/reducers/provider';\nimport { getMessagesTemplatesGlobalProperties } from '../../redux/reducers/messages';\nimport { Button, Label, Spinner } from 'reactstrap';\nimport ExpandableSection from '../common/expandable-section/ExpandableSection';\nimport { InputWithPlaceholder } from '../common/form/withPlaceholder';\nimport { extractEventValue } from '../../shared/util/form-util';\nimport { successToast, errorToast } from '@bit/soldevelo-omrs.cfl-components.toast-handler';\nimport _ from 'lodash';\nimport { PlusMinusButtons } from '../common/form/PlusMinusButtons';\nimport { ConfirmationModal } from '../common/form/ConfirmationModal';\nimport ValidationError from '../common/form/ValidationError';\nimport './NotificationTemplates.scss';\nimport '../Inputs.scss';\nimport { EMPTY_STRING, ONE, ZERO } from '../../shared/constants/input';\nimport { ROOT_URL } from '../../shared/constants/openmrs';\nimport {\n  DEFAULT_INJECTED_SERVICE,\n  INJECTED_SERVICES_DELIMITER,\n  INJECTED_SERVICES_KEY,\n  INJECTED_SERVICES_KEY_VALUE_DELIMITER,\n  INJECTED_SERVICES_SETTING_KEY,\n  INJECTED_SERVICES_SETTING_KEY_SUFFIX,\n  INJECTED_SERVICES_VALUE,\n  NOTIFICATION_TEMPLATE_SETTING_KEY_PREFIX,\n  TEMPLATE_DESCRIPTION_PROPERTY_NAME,\n  TEMPLATE_NAME_PROPERTY_NAME,\n  TEMPLATE_NAME_REGEX,\n  TEMPLATE_UUID_PROPERTY_NAME,\n  TEMPLATE_VALUE_PROPERTY_NAME\n} from '../../shared/constants/notification-templates';\nimport { TextareaWithPlaceholder } from '../common/textarea/Textarea';\nimport { VelocityCodeEditorWithPlaceholder } from '../common/code-editor/VelocityCodeEditor';\n\ninterface INotificationConfigurationProps extends StateProps, DispatchProps, RouteComponentProps {\n  intl: any;\n}\n\ninterface INotificationConfigurationState {\n  notificationTemplates: any[];\n  savedNotificationTemplates: any[];\n  isAllSectionsExpanded: boolean;\n  isConfirmationModalOpen: boolean;\n  unremovableGlobalProperties: string[];\n  confirmationModalHeader: {};\n  confirmationModalBody: {};\n  onConfirmationModalConfirm: () => void;\n  onConfirmationModalCancel: () => void;\n  dirtyNotificationTemplates: Set<string>;\n  unifiedSuccessToastDisplayed: boolean;\n  isAllRequestsSent: boolean;\n}\n\nclass NotificationConfiguration extends React.Component<INotificationConfigurationProps, INotificationConfigurationState> {\n  state = {\n    notificationTemplates: [],\n    savedNotificationTemplates: [],\n    isAllSectionsExpanded: false,\n    isConfirmationModalOpen: false,\n    unremovableGlobalProperties: [],\n    confirmationModalHeader: { id: EMPTY_STRING },\n    confirmationModalBody: { id: EMPTY_STRING },\n    onConfirmationModalConfirm: null,\n    onConfirmationModalCancel: null,\n    dirtyNotificationTemplates: new Set<string>(),\n    unifiedSuccessToastDisplayed: false,\n    isAllRequestsSent: false\n  };\n\n  componentDidMount() {\n    this.props.getMessagesTemplatesGlobalProperties();\n  }\n\n  componentDidUpdate(prevProps: Readonly<INotificationConfigurationProps>) {\n    const { intl, settings, loading, success, appError, unremovableGlobalProperties } = this.props;\n    if (prevProps.unremovableGlobalProperties !== unremovableGlobalProperties) {\n      this.setState({ unremovableGlobalProperties: unremovableGlobalProperties.map(globalProperty => globalProperty.toLowerCase()) }, () =>\n        this.props.getSettings(NOTIFICATION_TEMPLATE_SETTING_KEY_PREFIX)\n      );\n    } else if (prevProps.settings !== settings) {\n      const sortedSettings = [];\n      const injectedServicesSetting = settings.find(setting => setting[TEMPLATE_NAME_PROPERTY_NAME] === INJECTED_SERVICES_SETTING_KEY);\n      const injectedServices = injectedServicesSetting[TEMPLATE_VALUE_PROPERTY_NAME].split(INJECTED_SERVICES_DELIMITER).map(service => ({\n        [INJECTED_SERVICES_KEY]: service.split(INJECTED_SERVICES_KEY_VALUE_DELIMITER)[ZERO],\n        [INJECTED_SERVICES_VALUE]: service.split(INJECTED_SERVICES_KEY_VALUE_DELIMITER)[ONE]\n      }));\n      injectedServicesSetting[TEMPLATE_VALUE_PROPERTY_NAME] = injectedServices;\n      sortedSettings.push(injectedServicesSetting);\n      const otherSetttings = settings.filter(setting => setting !== injectedServicesSetting);\n      sortedSettings.push(...otherSetttings);\n      sortedSettings.forEach(\n        setting =>\n          (setting[TEMPLATE_NAME_PROPERTY_NAME] = setting[TEMPLATE_NAME_PROPERTY_NAME].replace(\n            NOTIFICATION_TEMPLATE_SETTING_KEY_PREFIX,\n            EMPTY_STRING\n          ))\n      );\n      this.setState({\n        notificationTemplates: sortedSettings,\n        savedNotificationTemplates: _.clone(sortedSettings),\n        unifiedSuccessToastDisplayed: false\n      });\n    }\n    if (!prevProps.success && success && this.state.isAllRequestsSent && !this.state.unifiedSuccessToastDisplayed) {\n      successToast(intl.formatMessage({ id: 'notificationTemplates.success' }));\n      this.setState(\n        {\n          isAllSectionsExpanded: false,\n          dirtyNotificationTemplates: new Set(),\n          isAllRequestsSent: false,\n          unifiedSuccessToastDisplayed: true\n        },\n        () => this.props.getSettings(NOTIFICATION_TEMPLATE_SETTING_KEY_PREFIX)\n      );\n    } else if (prevProps.appError !== this.props.appError && !loading) {\n      errorToast(appError);\n    }\n  }\n\n  isSaveDisabled = () =>\n    this.props.loading ||\n    this.state.notificationTemplates\n      .filter(template => template[TEMPLATE_NAME_PROPERTY_NAME] !== INJECTED_SERVICES_SETTING_KEY_SUFFIX)\n      .some(template => {\n        const templateNameRegex = new RegExp(TEMPLATE_NAME_REGEX);\n        const templateName = template[TEMPLATE_NAME_PROPERTY_NAME];\n        return !templateName || !templateNameRegex.test(templateName);\n      });\n\n  onSave = () =>\n    this.setState({\n      isConfirmationModalOpen: true,\n      confirmationModalHeader: { id: 'notificationTemplates.saveModal.header' },\n      confirmationModalBody: { id: 'notificationTemplates.saveModal.body' },\n      onConfirmationModalConfirm: () => {\n        this.save();\n        this.closeModal();\n      },\n      onConfirmationModalCancel: this.closeModal\n    });\n\n  save = () => {\n    const notificationTemplates = _.cloneDeep(this.state.notificationTemplates);\n    notificationTemplates.forEach(\n      template => (template[TEMPLATE_NAME_PROPERTY_NAME] = NOTIFICATION_TEMPLATE_SETTING_KEY_PREFIX + template[TEMPLATE_NAME_PROPERTY_NAME])\n    );\n    const savedNotificationTemplates = _.cloneDeep(this.state.savedNotificationTemplates);\n    savedNotificationTemplates.forEach(\n      template => (template[TEMPLATE_NAME_PROPERTY_NAME] = NOTIFICATION_TEMPLATE_SETTING_KEY_PREFIX + template[TEMPLATE_NAME_PROPERTY_NAME])\n    );\n    const injectedServices = notificationTemplates.find(\n      template => template[TEMPLATE_NAME_PROPERTY_NAME] === INJECTED_SERVICES_SETTING_KEY\n    );\n    injectedServices[TEMPLATE_VALUE_PROPERTY_NAME] = injectedServices[TEMPLATE_VALUE_PROPERTY_NAME].reduce(\n      (accumulator, currentService, counter) =>\n        accumulator +\n        currentService[INJECTED_SERVICES_KEY] +\n        INJECTED_SERVICES_KEY_VALUE_DELIMITER +\n        currentService[INJECTED_SERVICES_VALUE] +\n        (counter === injectedServices[TEMPLATE_VALUE_PROPERTY_NAME].length - ONE ? EMPTY_STRING : INJECTED_SERVICES_DELIMITER),\n      EMPTY_STRING\n    );\n    const deletedTemplates = savedNotificationTemplates.filter(\n      savedTemplate =>\n        !notificationTemplates.find(template => template[TEMPLATE_UUID_PROPERTY_NAME] === savedTemplate[TEMPLATE_UUID_PROPERTY_NAME])\n    );\n    deletedTemplates.forEach(template => this.props.deleteSetting(template));\n    notificationTemplates.forEach(template => {\n      if (template && template.uuid && this.state.dirtyNotificationTemplates.has(template[TEMPLATE_UUID_PROPERTY_NAME])) {\n        this.props.updateSetting(template);\n      } else if (template && !template.uuid) {\n        this.props.createSetting(\n          template[TEMPLATE_NAME_PROPERTY_NAME],\n          template[TEMPLATE_VALUE_PROPERTY_NAME],\n          template[TEMPLATE_DESCRIPTION_PROPERTY_NAME]\n        );\n      }\n    });\n    this.setState({ isAllRequestsSent: true });\n  };\n\n  isRemovable = templateIdx => {\n    const { notificationTemplates, unremovableGlobalProperties } = this.state;\n    const globalPropertyName = notificationTemplates[templateIdx][TEMPLATE_NAME_PROPERTY_NAME];\n    const globalPropertyFullName = NOTIFICATION_TEMPLATE_SETTING_KEY_PREFIX + globalPropertyName;\n    return !globalPropertyName || (globalPropertyName && !unremovableGlobalProperties.includes(globalPropertyFullName.toLowerCase()));\n  };\n\n  return = () => {\n    window.location.href = ROOT_URL;\n  };\n\n  closeModal = () => this.setState({ isConfirmationModalOpen: false });\n\n  confirmationModal = () => (\n    <ConfirmationModal\n      header={this.state.confirmationModalHeader}\n      body={this.state.confirmationModalBody}\n      onYes={this.state.onConfirmationModalConfirm}\n      onNo={this.state.onConfirmationModalCancel}\n      isOpen={this.state.isConfirmationModalOpen}\n    />\n  );\n\n  onChange = (templateIdx, propertyName) => event => {\n    const { notificationTemplates, dirtyNotificationTemplates } = this.state;\n    const template = notificationTemplates[templateIdx];\n    const value = extractEventValue(event);\n    template[propertyName] = value;\n    const templateUuid = notificationTemplates?.[templateIdx]?.[TEMPLATE_UUID_PROPERTY_NAME];\n    dirtyNotificationTemplates.add(templateUuid);\n    this.setState({ notificationTemplates, dirtyNotificationTemplates });\n  };\n\n  description = (template, templateIdx) => (\n    <div className=\"py-2\">\n      <TextareaWithPlaceholder\n        value={template[TEMPLATE_DESCRIPTION_PROPERTY_NAME]}\n        onChange={this.onChange(templateIdx, TEMPLATE_DESCRIPTION_PROPERTY_NAME)}\n        placeholder={this.props.intl.formatMessage({ id: 'notificationTemplates.template.description' })}\n        showPlaceholder={template[TEMPLATE_DESCRIPTION_PROPERTY_NAME]}\n      />\n    </div>\n  );\n\n  text = (template, templateIdx) => (\n    <div className=\"py-2\">\n      <VelocityCodeEditorWithPlaceholder\n        value={template[TEMPLATE_VALUE_PROPERTY_NAME]}\n        lineNumbers\n        placeholder={this.props.intl.formatMessage({ id: 'notificationTemplates.template.text' })}\n        showPlaceholder={!!template[TEMPLATE_VALUE_PROPERTY_NAME]}\n        onChange={this.onChange(templateIdx, TEMPLATE_VALUE_PROPERTY_NAME)}\n      />\n    </div>\n  );\n\n  addNewTemplate = () => {\n    const { notificationTemplates } = this.state;\n    notificationTemplates.push({});\n    this.setState({ notificationTemplates });\n  };\n\n  onRemoveTemplate = templateIdx => {\n    this.setState({\n      isConfirmationModalOpen: true,\n      confirmationModalHeader: { id: 'notificationTemplates.removeTemplateModal.header' },\n      confirmationModalBody: {\n        id: 'notificationTemplates.removeTemplateModal.body',\n        values: { templateName: this.state.notificationTemplates[templateIdx][TEMPLATE_NAME_PROPERTY_NAME] }\n      },\n      onConfirmationModalConfirm: () => {\n        this.removeTemplate(templateIdx);\n        this.closeModal();\n      },\n      onConfirmationModalCancel: this.closeModal\n    });\n  };\n\n  removeTemplate = templateIdx => {\n    const { notificationTemplates } = this.state;\n    notificationTemplates.splice(templateIdx, ONE);\n    this.setState({ notificationTemplates });\n  };\n\n  customTemplateHeader = (template, templateIdx, disabled = false) => {\n    const { intl } = this.props;\n    const templateName = template[TEMPLATE_NAME_PROPERTY_NAME];\n    const isTemplateNameEmpty = !templateName;\n    const templateNameRegex = new RegExp(TEMPLATE_NAME_REGEX);\n    const isTemplateNameInvalid = !templateNameRegex.test(templateName);\n    return (\n      <>\n        <div className=\"flex-1\">\n          <InputWithPlaceholder\n            placeholder={intl.formatMessage({ id: 'notificationTemplates.template.customTemplateName.label' })}\n            showPlaceholder={!isTemplateNameEmpty}\n            value={!!templateName ? templateName : ''}\n            onChange={this.onChange(templateIdx, TEMPLATE_NAME_PROPERTY_NAME)}\n            className={!disabled && (isTemplateNameEmpty || isTemplateNameInvalid) ? 'invalid' : ''}\n            disabled={disabled}\n          />\n          {!disabled &&\n            (isTemplateNameEmpty ? (\n              <ValidationError message=\"common.error.required\" />\n            ) : (\n              isTemplateNameInvalid && <ValidationError message=\"notificationTemplates.template.customTemplateName.invalid\" />\n            ))}\n        </div>\n        <Label className=\"custom-template-name-tooltip\">\n          <span\n            className=\"glyphicon glyphicon-info-sign ml-2\"\n            aria-hidden=\"true\"\n            title={intl.formatMessage({ id: 'notificationTemplates.template.customTemplateName.tooltip' })}\n          />\n        </Label>\n      </>\n    );\n  };\n\n  addInjectedService = () => {\n    const { notificationTemplates } = this.state;\n    const injectedServices = notificationTemplates.find(\n      template => template[TEMPLATE_NAME_PROPERTY_NAME] === INJECTED_SERVICES_SETTING_KEY_SUFFIX\n    );\n    injectedServices[TEMPLATE_VALUE_PROPERTY_NAME].push(_.clone(DEFAULT_INJECTED_SERVICE));\n    this.setState({ notificationTemplates });\n  };\n\n  removeInjectedService = injectedServiceIdx => {\n    const { notificationTemplates } = this.state;\n    const injectedServices = notificationTemplates.find(\n      template => template[TEMPLATE_NAME_PROPERTY_NAME] === INJECTED_SERVICES_SETTING_KEY_SUFFIX\n    );\n    injectedServices[TEMPLATE_VALUE_PROPERTY_NAME].splice(injectedServiceIdx, ONE);\n    if (!injectedServices[TEMPLATE_VALUE_PROPERTY_NAME].length) {\n      injectedServices[TEMPLATE_VALUE_PROPERTY_NAME].push(_.clone(DEFAULT_INJECTED_SERVICE));\n    }\n    this.setState({ notificationTemplates });\n  };\n\n  onInjectedServicePropertyChange = (injectedServiceIdx, propertyName) => event => {\n    const { notificationTemplates, dirtyNotificationTemplates } = this.state;\n    const injectedServices = notificationTemplates.find(\n      template => template[TEMPLATE_NAME_PROPERTY_NAME] === INJECTED_SERVICES_SETTING_KEY_SUFFIX\n    );\n    injectedServices[TEMPLATE_VALUE_PROPERTY_NAME][injectedServiceIdx][propertyName] = extractEventValue(event);\n    const templateUuid = injectedServices?.[TEMPLATE_UUID_PROPERTY_NAME];\n    dirtyNotificationTemplates.add(templateUuid);\n    this.setState({ notificationTemplates, dirtyNotificationTemplates });\n  };\n\n  injectedServicesBody = template => {\n    const { intl } = this.props;\n    const injectedServices = template[TEMPLATE_VALUE_PROPERTY_NAME];\n    return (\n      <div className=\"py-2\">\n        {injectedServices?.map((service, serviceIdx) => {\n          const key = service[INJECTED_SERVICES_KEY];\n          const value = service[INJECTED_SERVICES_VALUE];\n          return (\n            <div className=\"inline-fields py-1\" key={`injectedService-${serviceIdx}`}>\n              <InputWithPlaceholder\n                placeholder={intl.formatMessage({ id: 'notificationTemplates.injectedServices.key' })}\n                showPlaceholder={!!key}\n                value={key}\n                onChange={this.onInjectedServicePropertyChange(serviceIdx, INJECTED_SERVICES_KEY)}\n                wrapperClassName=\"flex-1\"\n              />\n              <InputWithPlaceholder\n                placeholder={intl.formatMessage({ id: 'notificationTemplates.injectedServices.value' })}\n                showPlaceholder={!!value}\n                value={value}\n                onChange={this.onInjectedServicePropertyChange(serviceIdx, INJECTED_SERVICES_VALUE)}\n                wrapperClassName=\"flex-1\"\n              />\n              <PlusMinusButtons\n                intl={intl}\n                onPlusClick={() => this.addInjectedService()}\n                onMinusClick={() => this.removeInjectedService(serviceIdx)}\n                isPlusButtonVisible={serviceIdx === injectedServices.length - 1}\n              />\n            </div>\n          );\n        })}\n      </div>\n    );\n  };\n\n  template = (template, templateIdx) => {\n    const { intl } = this.props;\n    const { isAllSectionsExpanded, savedNotificationTemplates } = this.state;\n    const templateName = template[TEMPLATE_NAME_PROPERTY_NAME];\n    const templateUuid = template[TEMPLATE_UUID_PROPERTY_NAME];\n    const isInjectedServices = templateName === INJECTED_SERVICES_SETTING_KEY_SUFFIX;\n    const isSavedTemplate = savedNotificationTemplates.includes(template);\n    const headerComponent = isInjectedServices ? (\n      <Label>\n        <FormattedMessage id=\"notificationTemplates.injectedServices.label\" />\n        <span\n          className=\"glyphicon glyphicon-info-sign ml-2\"\n          aria-hidden=\"true\"\n          title={intl.formatMessage({ id: 'notificationTemplates.injectedServices.tooltip' })}\n        />\n      </Label>\n    ) : isSavedTemplate ? (\n      <Label>{templateName}</Label>\n    ) : (\n      this.customTemplateHeader(template, templateIdx)\n    );\n    const disabledHeaderComponent =\n      isInjectedServices || isSavedTemplate ? headerComponent : this.customTemplateHeader(template, templateIdx, true);\n    const bodyComponent = isInjectedServices\n      ? this.injectedServicesBody(template)\n      : [this.description(template, templateIdx), this.text(template, templateIdx)];\n    return (\n      <ExpandableSection\n        key={`template-${templateIdx}-${templateUuid}`}\n        headerComponent={headerComponent}\n        disabledHeaderComponent={disabledHeaderComponent}\n        bodyComponent={bodyComponent}\n        isRemovable={this.isRemovable(templateIdx) && !isInjectedServices}\n        onRemove={() => this.onRemoveTemplate(templateIdx)}\n        isExpandTriggered={isAllSectionsExpanded}\n      />\n    );\n  };\n\n  expandOrCollapseAllButton = () => {\n    const { isAllSectionsExpanded } = this.state;\n    return (\n      <Button onClick={() => this.setState(state => ({ isAllSectionsExpanded: !state.isAllSectionsExpanded }))} className=\"cancel\">\n        <FormattedMessage id={`notificationTemplates.button.${isAllSectionsExpanded ? 'collapse' : 'expand'}`} />\n      </Button>\n    );\n  };\n\n  render() {\n    const { appError, appLoading, loadingUnremovableGlobalProperties, loading } = this.props;\n    const { notificationTemplates } = this.state;\n    return (\n      <div className=\"notification-templates\">\n        {this.confirmationModal()}\n        <h2>\n          <FormattedMessage id=\"notificationTemplates.title\" />\n        </h2>\n        <div className=\"error\">{appError}</div>\n        <div className=\"inner-content\">\n          {appLoading || loadingUnremovableGlobalProperties || loading ? (\n            <Spinner />\n          ) : (\n            <>\n              <div className=\"section\">\n                <div className=\"title-section\">{this.expandOrCollapseAllButton()}</div>\n                {notificationTemplates.map((template, idx) => this.template(template, idx))}\n                <div className=\"d-flex justify-content-end mt-4 mb-2\">\n                  <Button className=\"btn btn-primary\" onClick={this.addNewTemplate}>\n                    <FormattedMessage id=\"notificationTemplates.button.addNewTemplate\" />\n                  </Button>\n                </div>\n              </div>\n              <div className=\"mt-5 pb-5\">\n                <div className=\"d-inline\">\n                  <Button className=\"cancel\" onClick={this.return}>\n                    <FormattedMessage id=\"common.return\" />\n                  </Button>\n                </div>\n                <div className=\"d-inline pull-right confirm-button-container\">\n                  <Button className=\"save\" onClick={this.onSave} disabled={this.isSaveDisabled()}>\n                    <FormattedMessage id=\"common.save\" />\n                  </Button>\n                </div>\n              </div>\n            </>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = ({ apps, settings, provider, messages }) => ({\n  appError: apps.errorMessage,\n  appLoading: apps.loading,\n  loading: settings.loading,\n  success: settings.success,\n  config: settings.setting?.value && settings.setting?.value,\n  setting: settings.setting,\n  settings: settings.settings,\n  isSettingExist: settings.isSettingExist,\n  smsProviders: provider.smsProviders,\n  callflowsProviders: provider.callflowsProviders,\n  loadingUnremovableGlobalProperties: messages.loading,\n  unremovableGlobalProperties: messages.messagesTemplatesGlobalProperties\n});\n\nconst mapDispatchToProps = {\n  getSettings,\n  createSetting,\n  updateSetting,\n  deleteSetting,\n  getCallflowsProviders,\n  getSmsProviders,\n  getMessagesTemplatesGlobalProperties\n};\n\ntype StateProps = ReturnType<typeof mapStateToProps>;\ntype DispatchProps = typeof mapDispatchToProps;\n\nexport default connect(mapStateToProps, mapDispatchToProps)(injectIntl(withRouter(NotificationConfiguration)));\n","import { ILocation } from '../models/location';\n\nexport const REQUIRED_OCCURRENCE = 1;\nexport const COLUMNS = 2;\nexport const DROPDOWN_HANDLER_CONFIG_SEPARATOR = ',';\nexport const BOOLEAN_RADIOS_PREFERRED_HANDLER = 'org.openmrs.web.attribute.handler.BooleanFieldGenDatatypeHandler';\nexport const DROPDOWN_PREFERRED_HANDLER = 'org.openmrs.web.attribute.handler.SpecifiedTextOptionsDropdownHandler';\nexport const TEXTAREA_PREFERRED_HANDLER = 'org.openmrs.web.attribute.handler.LongFreeTextTextareaHandler';\nexport const LOCATION_DEFAULT_TAG_LIST_SETTING_KEY = 'cflui.location.defaultTag.uuid.list';\nexport const DEFAULT_LOCATION: ILocation = {\n  name: '',\n  description: '',\n  address1: '',\n  address2: '',\n  cityVillage: '',\n  stateProvince: '',\n  country: '',\n  postalCode: '',\n  tags: [],\n  attributes: []\n};\n","import React, { ChangeEvent, useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport './Location.scss';\nimport { FormattedMessage, injectIntl, IntlShape } from 'react-intl';\nimport '../Inputs.scss';\nimport { Button, Spinner } from 'reactstrap';\nimport { RouteComponentProps, withRouter } from 'react-router-dom';\nimport { ROOT_URL } from '../../shared/constants/openmrs';\nimport { InputWithPlaceholder, RadioButtonsWithPlaceholder, SelectWithPlaceholder } from '../common/form/withPlaceholder';\nimport { extractEventValue, selectDefaultTheme } from '../../shared/util/form-util';\nimport { getLocationAttributeTypes, searchLocations, saveLocation, getLocation } from '../../redux/reducers/location';\nimport { chunk, cloneDeep, uniq } from 'lodash';\nimport { ILocation, ILocationAttributeType, ILocationListItem } from '../../shared/models/location';\nimport { STRING_FALSE, STRING_TRUE } from '../../shared/constants/input';\nimport { TextareaWithPlaceholder } from '../common/textarea/Textarea';\nimport ValidationError from '../common/form/ValidationError';\nimport { scrollToTop } from '../../shared/util/window-util';\nimport cx from 'classnames';\nimport { getSettingByQuery } from '../../redux/reducers/setttings';\nimport {\n  BOOLEAN_RADIOS_PREFERRED_HANDLER,\n  COLUMNS,\n  DEFAULT_LOCATION,\n  DROPDOWN_HANDLER_CONFIG_SEPARATOR,\n  DROPDOWN_PREFERRED_HANDLER,\n  LOCATION_DEFAULT_TAG_LIST_SETTING_KEY,\n  TEXTAREA_PREFERRED_HANDLER,\n  REQUIRED_OCCURRENCE\n} from '../../shared/constants/location';\n\nexport interface ILocationProps extends StateProps, DispatchProps, RouteComponentProps {\n  intl: IntlShape;\n}\n\ninterface IStore {\n  location: {\n    loadingLocations: boolean;\n    locations: Array<ILocationListItem>;\n    errorMessage: string;\n    locationAttributeTypes: Array<ILocationAttributeType>;\n    loadingLocationAttributeTypes: boolean;\n    success: boolean;\n    loadingLocation: boolean;\n    location: ILocation;\n  };\n  settings: {\n    loading: boolean;\n    setting: { value: string } | null;\n  };\n}\n\ninterface IUrlParams {\n  locationId: string;\n}\n\ninterface IOption {\n  label: string;\n  value: string;\n}\n\nexport const Location = (props: ILocationProps) => {\n  const [location, setLocation] = useState(DEFAULT_LOCATION);\n  const [showValidationErrors, setShowValidationErrors] = useState(false);\n  const {\n    intl: { formatMessage }\n  } = props;\n  const { locationId } = props.match.params as IUrlParams;\n\n  useEffect(() => {\n    props.getLocationAttributeTypes();\n    props.searchLocations();\n    props.getSettingByQuery(LOCATION_DEFAULT_TAG_LIST_SETTING_KEY);\n    if (locationId) {\n      props.getLocation(locationId);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffect(() => {\n    if (props.editedLocation) {\n      setLocation(props.editedLocation);\n    }\n  }, [props.editedLocation]);\n\n  const onReturn = () => {\n    window.location.href = `${ROOT_URL}adminui/metadata/locations/manageLocations.page`;\n  };\n\n  const onSave = () => {\n    const requiredLocationAttributeTypes = props.locationAttributeTypes.filter(\n      locationAttributeType => locationAttributeType.minOccurs === REQUIRED_OCCURRENCE\n    );\n    const isAllRequiredLocationAttributeTypesFilled = requiredLocationAttributeTypes.every(({ uuid: requiredLocationAttributeTypeUuid }) =>\n      location.attributes.find(({ attributeType, value }) => requiredLocationAttributeTypeUuid === attributeType.uuid && value)\n    );\n\n    if (isLocationNameEmpty || isLocationNameDuplicated || isCountryEmpty || !isAllRequiredLocationAttributeTypesFilled) {\n      setShowValidationErrors(true);\n      scrollToTop();\n    } else {\n      const preparedLocation = cloneDeep(location) as ILocation;\n      const locationDefaultTags = props.settingValue ? JSON.parse(props.settingValue) : [];\n\n      preparedLocation.attributes = preparedLocation.attributes\n        .filter(attribute => attribute.value !== '')\n        .map(({ attributeType, value }) => ({ attributeType, value }));\n      preparedLocation.tags = uniq([...preparedLocation.tags, ...locationDefaultTags]);\n\n      props.saveLocation(preparedLocation);\n    }\n  };\n\n  useEffect(() => {\n    if (props.success) {\n      onReturn();\n    }\n  }, [props.success]);\n\n  const onValueChange = (name: string) => (event: ChangeEvent) => setLocation({ ...location, [name]: extractEventValue(event) });\n\n  const onAttributeValueChange = (uuid: string) => (event: ChangeEvent | string) => {\n    let attributes = location.attributes;\n    const attribute = attributes.find(attribute => attribute.attributeType.uuid === uuid);\n    const value = extractEventValue(event);\n\n    if (attribute) {\n      attribute.value = value;\n    } else {\n      attributes = [...location.attributes, { attributeType: { uuid }, value }];\n    }\n\n    setLocation({ ...location, attributes });\n  };\n\n  const isLocationNameEmpty = !location.name;\n\n  const isLocationNameDuplicated = props.locations\n    .filter(loc => loc.uuid !== location.uuid)\n    .map(loc => loc.display.toLowerCase())\n    .includes(location.name.toLowerCase());\n\n  const isCountryEmpty = !location.country;\n\n  const locationAttributeTypesGrouped: Array<Array<ILocationAttributeType>> = chunk(props.locationAttributeTypes, COLUMNS);\n\n  const input = (locationAttributeType: ILocationAttributeType) => {\n    const key = `locationAttribute${locationAttributeType.uuid}`;\n    const placeholder = locationAttributeType.name;\n    const value = location.attributes.find(attribute => locationAttributeType.uuid === attribute.attributeType.uuid)?.value;\n    const isRequired = locationAttributeType.minOccurs === REQUIRED_OCCURRENCE;\n    const isInvalid = isRequired && !value;\n    const onChange = onAttributeValueChange(locationAttributeType.uuid);\n\n    switch (locationAttributeType.preferredHandlerClassname) {\n      case DROPDOWN_PREFERRED_HANDLER:\n        const options: Array<IOption> = locationAttributeType.handlerConfig\n          .split(DROPDOWN_HANDLER_CONFIG_SEPARATOR)\n          .map(value => ({ label: value, value }));\n        return (\n          <div className=\"input-container\">\n            <SelectWithPlaceholder\n              key={key}\n              placeholder={placeholder}\n              showPlaceholder={!!value}\n              value={options.find(option => option.value === value)}\n              onChange={(option: IOption) => onChange(option.value)}\n              options={options}\n              wrapperClassName={cx('flex-1', { invalid: showValidationErrors && isInvalid })}\n              classNamePrefix=\"default-select\"\n              theme={selectDefaultTheme}\n            />\n            {showValidationErrors && isInvalid && <ValidationError message=\"common.error.required\" />}\n          </div>\n        );\n      case BOOLEAN_RADIOS_PREFERRED_HANDLER:\n        return (\n          <RadioButtonsWithPlaceholder\n            key={key}\n            name={key}\n            onChange={onChange}\n            options={[\n              { value: STRING_TRUE, label: formatMessage({ id: 'common.true' }) },\n              { value: STRING_FALSE, label: formatMessage({ id: 'common.false' }) }\n            ]}\n            value={value?.toString()}\n            placeholder={placeholder}\n            showPlaceholder\n          />\n        );\n      case TEXTAREA_PREFERRED_HANDLER:\n        return (\n          <div className=\"input-container\">\n            <TextareaWithPlaceholder\n              key={key}\n              className={cx(showValidationErrors && isInvalid)}\n              placeholder={placeholder}\n              showPlaceholder={!!value}\n              value={value}\n              onChange={onChange}\n              isResizable\n            />\n            {showValidationErrors && isInvalid && <ValidationError message=\"common.error.required\" />}\n          </div>\n        );\n      default:\n        return (\n          <div className=\"input-container\">\n            <InputWithPlaceholder\n              key={key}\n              className={cx({ invalid: showValidationErrors && isInvalid })}\n              placeholder={placeholder}\n              showPlaceholder={!!value}\n              value={value}\n              onChange={onChange}\n            />\n            {showValidationErrors && isInvalid && <ValidationError message=\"common.error.required\" />}\n          </div>\n        );\n    }\n  };\n\n  return (\n    <div id=\"location\">\n      <h2>\n        <FormattedMessage id={`locations.location.${locationId ? 'edit' : 'create'}.title`} />\n      </h2>\n      <div className=\"inner-content\">\n        {props.isLocationLoading ? (\n          <div className=\"spinner\">\n            <Spinner />\n          </div>\n        ) : (\n          <>\n            <div className=\"section\">\n              <div className=\"inline-fields\">\n                <div className=\"input-container\">\n                  <InputWithPlaceholder\n                    key=\"locationNameInput\"\n                    placeholder={formatMessage({ id: 'locations.location.name' })}\n                    showPlaceholder={!!location.name}\n                    value={location.name}\n                    onChange={onValueChange('name')}\n                    className={cx({ invalid: showValidationErrors && (isLocationNameEmpty || isLocationNameDuplicated) })}\n                    data-testid=\"locationNameInput\"\n                  />\n                  {showValidationErrors &&\n                    (isLocationNameEmpty ? (\n                      <ValidationError message=\"common.error.required\" />\n                    ) : (\n                      isLocationNameDuplicated && <ValidationError message=\"common.error.nameUnique\" />\n                    ))}\n                </div>\n                <InputWithPlaceholder\n                  key=\"locationDescriptionInput\"\n                  placeholder={formatMessage({ id: 'locations.location.description' })}\n                  showPlaceholder={!!location.description}\n                  value={location.description}\n                  onChange={onValueChange('description')}\n                  data-testid=\"locationDescriptionInput\"\n                />\n              </div>\n              <div className=\"inline-fields\">\n                <InputWithPlaceholder\n                  key=\"locationAddress1Input\"\n                  placeholder={formatMessage({ id: 'locations.location.address1' })}\n                  showPlaceholder={!!location.address1}\n                  value={location.address1}\n                  onChange={onValueChange('address1')}\n                  data-testid=\"locationAddress1Input\"\n                />\n                <InputWithPlaceholder\n                  key=\"locationAddress2Input\"\n                  placeholder={formatMessage({ id: 'locations.location.address2' })}\n                  showPlaceholder={!!location.address2}\n                  value={location.address2}\n                  onChange={onValueChange('address2')}\n                  data-testid=\"locationAddress2Input\"\n                />\n              </div>\n              <div className=\"inline-fields\">\n                <InputWithPlaceholder\n                  key=\"locationCityVillageInput\"\n                  placeholder={formatMessage({ id: 'locations.location.cityVillage' })}\n                  showPlaceholder={!!location.cityVillage}\n                  value={location.cityVillage}\n                  onChange={onValueChange('cityVillage')}\n                  data-testid=\"locationCityVillageInput\"\n                />\n                <InputWithPlaceholder\n                  key=\"locationStateProvinceInput\"\n                  placeholder={formatMessage({ id: 'locations.location.stateProvince' })}\n                  showPlaceholder={!!location.stateProvince}\n                  value={location.stateProvince}\n                  onChange={onValueChange('stateProvince')}\n                  data-testid=\"locationStateProvinceInput\"\n                />\n              </div>\n              <div className=\"inline-fields\">\n                <InputWithPlaceholder\n                  key=\"locationPostalCodeInput\"\n                  placeholder={formatMessage({ id: 'locations.location.postalCode' })}\n                  showPlaceholder={!!location.postalCode}\n                  value={location.postalCode}\n                  onChange={onValueChange('postalCode')}\n                  data-testid=\"locationPostalCodeInput\"\n                />\n                <div className=\"input-container\">\n                  <InputWithPlaceholder\n                    key=\"locationCountryInput\"\n                    placeholder={formatMessage({ id: 'locations.location.country' })}\n                    showPlaceholder={!!location.country}\n                    value={location.country}\n                    onChange={onValueChange('country')}\n                    className={cx({ invalid: showValidationErrors && isCountryEmpty })}\n                    data-testid=\"locationCountryInput\"\n                  />\n                  {showValidationErrors && isCountryEmpty && <ValidationError message=\"common.error.required\" />}\n                </div>\n              </div>\n              {locationAttributeTypesGrouped?.map((locationAttributeTypesGroup, idx) => (\n                <div className=\"inline-fields\" key={`locationAttributeTypesGroup${idx}`}>\n                  {locationAttributeTypesGroup.map(locationAttributeType => input(locationAttributeType))}\n                </div>\n              ))}\n            </div>\n            <div className=\"mt-5 pb-5\">\n              <div className=\"d-inline\">\n                <Button className=\"cancel\" onClick={onReturn} data-testid=\"returnButton\">\n                  <FormattedMessage id=\"common.return\" />\n                </Button>\n              </div>\n              <div className=\"d-inline pull-right confirm-button-container\">\n                <Button className=\"save\" onClick={onSave} data-testid=\"saveButton\">\n                  <FormattedMessage id=\"common.save\" />\n                </Button>\n              </div>\n            </div>\n          </>\n        )}\n      </div>\n    </div>\n  );\n};\n\nconst mapStateToProps = ({\n  location: { loadingLocationAttributeTypes, locationAttributeTypes, locations, success, loadingLocation, location: editedLocation },\n  settings: { loading: settingLoading, setting }\n}: IStore) => ({\n  isLocationLoading: loadingLocationAttributeTypes || loadingLocation || settingLoading,\n  locationAttributeTypes: locationAttributeTypes.filter(locationAttributeType => !locationAttributeType.retired),\n  locations,\n  success,\n  editedLocation,\n  settingValue: setting?.value\n});\n\nconst mapDispatchToProps = { getLocationAttributeTypes, searchLocations, saveLocation, getLocation, getSettingByQuery };\n\ntype StateProps = ReturnType<typeof mapStateToProps>;\ntype DispatchProps = typeof mapDispatchToProps;\n\nexport default connect(mapStateToProps, mapDispatchToProps)(injectIntl(withRouter(Location)));\n","export const PERSON_ID_LOOKUP_STRING = 'personId=';\nexport const EMAIL_REGEX = /^(([^<>()\\\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\nexport const PASSWORD_REGEX = /^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z]).{8,}$/;\nexport const USERNAME_REGEX = /^[\\w\\d\\\\_][\\w\\d\\\\_.-]{1,49}$/;\nexport const SETTING_ATTRIBUTE_TYPE_PREFIX = 'cfl.person.attributeType';\nexport const SETTING_TELEPHONE_NUMBER_ATRRIBUTE_TYPE = `${SETTING_ATTRIBUTE_TYPE_PREFIX}.telephoneNumberUuid`;\nexport const SETTING_EMAIL_ADDRESS_ATRRIBUTE_TYPE = `${SETTING_ATTRIBUTE_TYPE_PREFIX}.emailAddressUuid`;\nexport const DEFAULT_AUDIT_DATE_FORMAT = 'DD.MMM.YYYY, HH:mm:ss';\nexport const DEFAULT_EDIT_USER_PASSWORD = 'xxxxxx';\nexport const GENDER_OTHER = 'O';\nexport const FAMILY_NAME_FIELD = 'familyName';\nexport const GIVEN_NAME_FIELD = 'givenName';\nexport const PHONE_FIELD = 'phone';\nexport const EMAIL_FIELD = 'email';\nexport const USERNAME_FIELD = 'username';\nexport const LOCATION_FIELD = 'locations';\nexport const USER_ROLE_FIELD = 'userRole';\nexport const PASSWORD_FIELD = 'password';\nexport const CONFIRM_PASSWORD_FIELD = 'confirmPassword';\nexport const DEFAULT_USER_VALUES = {\n  familyName: { value: '', isValid: true, error: '' },\n  givenName: { value: '', isValid: true, error: '' },\n  phone: { value: '', isValid: true, error: '' },\n  email: { value: '', isValid: true, error: '' },\n  username: { value: '', isValid: true, error: '' },\n  locations: { value: [], isValid: true, error: '' },\n  userRole: { value: null, isValid: true, error: '' },\n  password: { value: '', isValid: true, error: '' },\n  confirmPassword: { value: '', isValid: true, error: '' }\n};\n","import React from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { Label } from 'reactstrap';\nimport { IDetails } from '../../shared/models/user-account';\nimport { InputWithPlaceholder } from '../common/form/withPlaceholder';\nimport ValidationError from '../common/form/ValidationError';\nimport PhoneInput from 'react-phone-number-input';\nimport 'react-phone-number-input/style.css';\nimport cx from 'classnames';\nimport { EMAIL_FIELD, FAMILY_NAME_FIELD, GIVEN_NAME_FIELD, PHONE_FIELD } from '../../shared/constants/user-account';\n\nconst PersonDetails = ({\n  intl: { formatMessage },\n  onValueChange,\n  userAccount: {\n    familyName: { value: familyNameValue, isValid: isFamilyNameValid, error: familyNameError },\n    givenName: { value: givenNameValue, isValid: isGivenNameValid, error: givenNameError },\n    phone: { value: phoneValue, isValid: isPhoneValid, error: phoneError },\n    email: { value: emailValue, isValid: isEmailValid, error: emailError }\n  }\n}: IDetails) => (\n  <>\n    <Label className=\"mb-3\">\n      <FormattedMessage id=\"userAccount.personDetails.title\" tagName=\"span\" />\n    </Label>\n    <div className=\"details\">\n      <div className=\"grid-1\">\n        <InputWithPlaceholder\n          placeholder={formatMessage({ id: `userAccount.personDetails.${FAMILY_NAME_FIELD}` })}\n          showPlaceholder={!!familyNameValue}\n          value={familyNameValue}\n          onChange={onValueChange(FAMILY_NAME_FIELD)}\n          type=\"text\"\n          className={cx({ invalid: !isFamilyNameValid })}\n        />\n        {!isFamilyNameValid && <ValidationError message={familyNameError} />}\n      </div>\n      <div className=\"grid-2\">\n        <InputWithPlaceholder\n          placeholder={formatMessage({ id: `userAccount.personDetails.${GIVEN_NAME_FIELD}` })}\n          showPlaceholder={!!givenNameValue}\n          value={givenNameValue}\n          onChange={onValueChange(GIVEN_NAME_FIELD)}\n          type=\"text\"\n          className={cx({ invalid: !isGivenNameValid })}\n        />\n        {!isGivenNameValid && <ValidationError message={givenNameError} />}\n      </div>\n      <div className=\"grid-3 input-container\">\n        <PhoneInput\n          placeholder={formatMessage({ id: `userAccount.personDetails.${PHONE_FIELD}` })}\n          onChange={onValueChange(PHONE_FIELD)}\n          value={phoneValue}\n          international\n          numberInputProps={{ className: cx('form-control', { invalid: !isPhoneValid }) }}\n          type=\"tel\"\n        />\n        {!!phoneValue && <span className=\"placeholder\">{formatMessage({ id: `userAccount.personDetails.${PHONE_FIELD}` })}</span>}\n        {!isPhoneValid && <ValidationError message={phoneError} />}\n      </div>\n      <div className=\"grid-4\">\n        <InputWithPlaceholder\n          placeholder={formatMessage({ id: `userAccount.personDetails.${EMAIL_FIELD}` })}\n          showPlaceholder={!!emailValue}\n          value={emailValue}\n          onChange={onValueChange(EMAIL_FIELD)}\n          type=\"text\"\n          className={cx({ invalid: !isEmailValid })}\n        />\n        {!isEmailValid && <ValidationError message={emailError} />}\n      </div>\n    </div>\n  </>\n);\n\nexport default PersonDetails;\n","import React from 'react';\nimport { FormattedMessage, IntlShape } from 'react-intl';\nimport { Label } from 'reactstrap';\nimport moment from 'moment';\nimport { IAudit } from '../../shared/models/user-account';\nimport { DEFAULT_AUDIT_DATE_FORMAT } from '../../shared/constants/user-account';\n\nexport interface IAuditInfo {\n  intl: IntlShape;\n  audit: IAudit;\n}\n\nconst AuditInfo = ({ intl, audit }: IAuditInfo) => {\n  const formatDate = (date: string) => moment(date).format(DEFAULT_AUDIT_DATE_FORMAT);\n\n  return (\n    <>\n      <Label className=\"mb-5\">\n        <FormattedMessage id=\"userAccount.auditInfo.title\" tagName=\"span\" />\n      </Label>\n      <p className=\"pb-3\" data-testid=\"userAccountCreatedBy\">\n        {intl.formatMessage(\n          { id: 'userAccount.auditInfo.created' },\n          {\n            creator: audit?.creator?.display,\n            date: formatDate(audit?.dateCreated)\n          }\n        )}\n      </p>\n      <p className=\"pb-3\" data-testid=\"userAccountChangedBy\">\n        {intl.formatMessage(\n          { id: 'userAccount.auditInfo.changedBy' },\n          {\n            changedBy: audit?.changedBy?.display,\n            date: formatDate(audit?.dateChanged)\n          }\n        )}\n      </p>\n    </>\n  );\n};\n\nexport default AuditInfo;\n","import React from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { Label, Input } from 'reactstrap';\nimport { IDetails, IDetailsOption } from '../../shared/models/user-account';\nimport { InputWithPlaceholder } from '../common/form/withPlaceholder';\nimport { selectDefaultTheme } from '../../shared/util/form-util';\nimport { SelectWithPlaceholder } from '../../components/common/form/withPlaceholder';\nimport ValidationError from '../common/form/ValidationError';\nimport cx from 'classnames';\nimport 'react-phone-number-input/style.css';\nimport {\n  CONFIRM_PASSWORD_FIELD,\n  LOCATION_FIELD,\n  PASSWORD_FIELD,\n  USERNAME_FIELD,\n  USER_ROLE_FIELD\n} from '../../shared/constants/user-account';\n\nconst UserAccountDetails = ({\n  intl: { formatMessage },\n  onValueChange,\n  dirtyFields,\n  roles,\n  locations,\n  forcePassword,\n  setForcePassword,\n  isEdit,\n  userAccount: {\n    username: { value: usernameValue, isValid: isUserNameValid, error: userNameError },\n    locations: { value: locationsValue, isValid: isLocationsValid, error: locationsError },\n    userRole: { value: userRoleValue, isValid: isUserRoleValid, error: userRoleError },\n    password: { value: passwordValue, isValid: isPasswordValid, error: passwordError },\n    confirmPassword: { value: confirmPasswordValue, isValid: isConfirmPasswordValid, error: confirmPasswordError }\n  }\n}: IDetails) => {\n  const getOptions = (options: IDetailsOption[]) => options.map(option => ({ label: option.display, value: option.uuid }));\n\n  return (\n    <>\n      <Label className=\"mb-3\">\n        <FormattedMessage id=\"userAccount.userAccountDetails.title\" tagName=\"span\" />\n      </Label>\n      <div className=\"details\">\n        <div className=\"grid-1\">\n          <InputWithPlaceholder\n            placeholder={formatMessage({ id: `userAccount.userAccountDetails.${USERNAME_FIELD}` })}\n            showPlaceholder={!!usernameValue}\n            value={usernameValue}\n            onChange={onValueChange(USERNAME_FIELD)}\n            type=\"text\"\n            className={cx({ invalid: !isUserNameValid })}\n          />\n          {!isUserNameValid && <ValidationError message={userNameError} />}\n        </div>\n        <div className=\"grid-2\">\n          <SelectWithPlaceholder\n            placeholder={formatMessage({ id: `userAccount.userAccountDetails.${LOCATION_FIELD}` })}\n            showPlaceholder={!!locationsValue.length}\n            value={locationsValue}\n            options={getOptions(locations)}\n            onChange={onValueChange(LOCATION_FIELD)}\n            isMulti\n            wrapperClassName={cx({ invalid: !isLocationsValid })}\n            classNamePrefix=\"default-select-multi\"\n            theme={selectDefaultTheme}\n            type=\"text\"\n          />\n          {!isLocationsValid && <ValidationError message={locationsError} />}\n        </div>\n        <div className=\"grid-3\">\n          <SelectWithPlaceholder\n            placeholder={formatMessage({ id: `userAccount.userAccountDetails.${USER_ROLE_FIELD}` })}\n            showPlaceholder={!!userRoleValue}\n            value={userRoleValue}\n            options={getOptions(roles)}\n            onChange={onValueChange(USER_ROLE_FIELD)}\n            wrapperClassName={cx({ invalid: !isUserRoleValid })}\n            classNamePrefix=\"default-select\"\n            theme={selectDefaultTheme}\n            type=\"text\"\n          />\n          {!isUserRoleValid && <ValidationError message={userRoleError} />}\n        </div>\n        <div className=\"grid-4\">\n          <InputWithPlaceholder\n            className={cx({ invalid: !isPasswordValid })}\n            placeholder={formatMessage({ id: `userAccount.userAccountDetails.${PASSWORD_FIELD}` })}\n            showPlaceholder={!!passwordValue}\n            value={passwordValue}\n            onChange={onValueChange(PASSWORD_FIELD)}\n            type=\"password\"\n            autoComplete=\"off\"\n          />\n          {!isPasswordValid && <ValidationError message={passwordError} />}\n        </div>\n        <div className=\"grid-5\">\n          <InputWithPlaceholder\n            className={cx({ invalid: !isConfirmPasswordValid })}\n            placeholder={formatMessage({ id: `userAccount.userAccountDetails.${CONFIRM_PASSWORD_FIELD}` })}\n            showPlaceholder={!!confirmPasswordValue}\n            value={confirmPasswordValue}\n            onChange={onValueChange(CONFIRM_PASSWORD_FIELD)}\n            type=\"password\"\n            autoComplete=\"off\"\n          />\n          {!isConfirmPasswordValid && <ValidationError message={confirmPasswordError} />}\n        </div>\n      </div>\n      <Label className={cx('force-password-change', { hide: isEdit && !dirtyFields.find(field => field === PASSWORD_FIELD) })}>\n        <Input type=\"checkbox\" onClick={() => setForcePassword(!forcePassword)} checked={forcePassword} />\n        <FormattedMessage id=\"userAccount.userAccountDetails.forcePasswordChange\" tagName=\"span\" />\n      </Label>\n    </>\n  );\n};\n\nexport default UserAccountDetails;\n","import axios from 'axios';\nimport { FAILURE, REQUEST, SUCCESS } from '../action-type.util';\n\nexport const ACTION_TYPES = {\n  GET_ROLES: 'roles/GET_ROLES',\n  RESET_ROLES: 'roles/RESET_ROLES'\n};\n\nconst initialState = {\n  loading: false,\n  roles: [],\n  errorMessage: ''\n};\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case REQUEST(ACTION_TYPES.GET_ROLES):\n      return {\n        ...state,\n        loading: true\n      };\n    case FAILURE(ACTION_TYPES.GET_ROLES):\n      return {\n        ...initialState,\n        errorMessage: action.payload.message\n      };\n    case SUCCESS(ACTION_TYPES.GET_ROLES):\n      return {\n        ...initialState,\n        roles: action.payload.data.results\n      };\n    case ACTION_TYPES.RESET_ROLES:\n      return {\n        ...initialState\n      };\n    default:\n      return state;\n  }\n};\n\nexport const getRoles = () => ({\n  type: ACTION_TYPES.GET_ROLES,\n  payload: axios.get('/openmrs/ws/rest/v1/role')\n});\n\nexport const reset = () => ({\n  type: ACTION_TYPES.RESET_ROLES\n});\n\nexport default reducer;\n","import axios from 'axios';\nimport { FAILURE, REQUEST, SUCCESS } from '../action-type.util';\n\nexport const ACTION_TYPES = {\n  GET_USER: 'user/GET_USER',\n  GET_USERS: 'user/GET_USERS',\n  POST_USER: 'user/POST_USER',\n  DELETE_USER: 'user/DELETE_USER'\n};\n\nconst initialState = {\n  loading: false,\n  users: [],\n  currentUser: {},\n  errorMessage: '',\n  success: false\n};\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case REQUEST(ACTION_TYPES.GET_USER):\n    case REQUEST(ACTION_TYPES.GET_USERS):\n      return {\n        ...state,\n        loading: true\n      };\n    case FAILURE(ACTION_TYPES.GET_USER):\n    case FAILURE(ACTION_TYPES.GET_USERS):\n      return {\n        ...state,\n        errorMessage: action.payload.message,\n        loading: false\n      };\n    case SUCCESS(ACTION_TYPES.GET_USER): {\n      const [currentUser] = action.payload.data.results;\n      return {\n        ...state,\n        currentUser,\n        loading: false\n      };\n    }\n    case SUCCESS(ACTION_TYPES.GET_USERS):\n      return {\n        ...state,\n        users: action.payload.data.results,\n        loading: false\n      };\n    case SUCCESS(ACTION_TYPES.DELETE_USER):\n    case SUCCESS(ACTION_TYPES.POST_USER):\n      return {\n        ...state,\n        success: true\n      };\n    default:\n      return state;\n  }\n};\n\nexport const getUsers = () => ({\n  type: ACTION_TYPES.GET_USERS,\n  payload: axios.get('/openmrs/ws/rest/v1/user')\n});\n\nexport const getUserByPersonId = (personId: string) => ({\n  type: ACTION_TYPES.GET_USER,\n  payload: axios.get(`/openmrs/ws/rest/v1/user?s=byPerson&personId=${personId}&v=full`)\n});\n\nexport const saveUser = (data: {}, uuid: string, newPassword?: string) => ({\n  type: ACTION_TYPES.POST_USER,\n  payload: Promise.all([\n    axios.post(`/openmrs/ws/rest/v1/user/${uuid ? uuid : ''}`, data),\n    newPassword && axios.post(`/openmrs/ws/rest/v1/password/${uuid}`, { newPassword })\n  ])\n});\n\nexport const deleteUser = (uuid: string) => ({\n  type: ACTION_TYPES.DELETE_USER,\n  payload: axios.delete(`/openmrs/ws/rest/v1/user/${uuid}?purge=true`)\n});\n\nexport default reducer;\n","import React, { FormEvent, useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport { RouteComponentProps, withRouter } from 'react-router-dom';\nimport { FormattedMessage, injectIntl, IntlShape } from 'react-intl';\nimport { Button, Spinner, Form } from 'reactstrap';\nimport PersonDetails from './PersonDetails';\nimport AuditInfo from './AuditInfo';\nimport UserAccountDetails from './UserAccountDetails';\nimport { searchLocations } from '../../redux/reducers/location';\nimport { getRoles } from '../../redux/reducers/role';\nimport { getUsers, getUserByPersonId, saveUser, deleteUser } from '../../redux/reducers/user';\nimport { extractEventValue } from '../../shared/util/form-util';\nimport { ROOT_URL } from '../../shared/constants/openmrs';\nimport { uniq, isNil } from 'lodash';\nimport cx from 'classnames';\nimport _ from 'lodash';\nimport { IUserAccount, IDetailsOption, ICurrentUser, IPersonAttribute } from '../../shared/models/user-account';\nimport '../Inputs.scss';\nimport './UserAccount.scss';\nimport { getSettings } from '../../redux/reducers/setttings';\nimport { getPerson } from '../../redux/reducers/person';\nimport { isPossiblePhoneNumber } from 'react-phone-number-input';\nimport { errorToast } from '@bit/soldevelo-omrs.cfl-components.toast-handler';\nimport {\n  PERSON_ID_LOOKUP_STRING,\n  SETTING_ATTRIBUTE_TYPE_PREFIX,\n  SETTING_EMAIL_ADDRESS_ATRRIBUTE_TYPE,\n  SETTING_TELEPHONE_NUMBER_ATRRIBUTE_TYPE,\n  DEFAULT_USER_VALUES,\n  DEFAULT_EDIT_USER_PASSWORD,\n  GENDER_OTHER,\n  PHONE_FIELD,\n  EMAIL_FIELD,\n  EMAIL_REGEX,\n  USERNAME_FIELD,\n  LOCATION_FIELD,\n  USER_ROLE_FIELD,\n  PASSWORD_FIELD,\n  PASSWORD_REGEX,\n  CONFIRM_PASSWORD_FIELD,\n  USERNAME_REGEX\n} from '../../shared/constants/user-account';\nimport { EMPTY_STRING } from 'src/shared/constants/input';\nimport { ConfirmationModal } from '../common/form/ConfirmationModal';\n\ninterface IStore {\n  role: { loading: boolean; roles: IDetailsOption[] };\n  location: { locations: IDetailsOption[] };\n  user: { loading: boolean; users: IDetailsOption[]; currentUser: ICurrentUser; success: boolean };\n  settings: { settings: [{ property: string; value: string }]; loading: boolean };\n  cflPerson: { person: { preferredName: { familyName: string; givenName: string }; attributes: IPersonAttribute[] } };\n}\n\ninterface ILocationProps extends StateProps, DispatchProps, RouteComponentProps {\n  intl: IntlShape;\n}\n\nconst locationHash = window.location.hash;\nconst positionPersonId = locationHash.indexOf(PERSON_ID_LOOKUP_STRING);\nconst personId = positionPersonId !== -1 ? locationHash.slice(positionPersonId + PERSON_ID_LOOKUP_STRING.length) : null;\n\nconst UserAccount = (props: ILocationProps) => {\n  const {\n    intl,\n    userLoading,\n    locations,\n    roles,\n    users,\n    currentUser,\n    settings,\n    loadingSettings,\n    person,\n    success,\n    searchLocations,\n    getRoles,\n    getUsers,\n    getUserByPersonId,\n    getSettings,\n    getPerson,\n    saveUser,\n    deleteUser\n  } = props;\n\n  const personUuid = currentUser?.person?.uuid;\n  const emailAddressAtributeTypeUuid = settings?.find(setting => setting.property === SETTING_EMAIL_ADDRESS_ATRRIBUTE_TYPE)?.value;\n  const telephoneNumberAtributeTypeUuid = settings?.find(setting => setting.property === SETTING_TELEPHONE_NUMBER_ATRRIBUTE_TYPE)?.value;\n\n  const [userAccount, setUserAccount] = useState<IUserAccount>(DEFAULT_USER_VALUES);\n  const [dirtyFields, setDirtyFields] = useState<string[]>([]);\n  const [forcePassword, setForcePassword] = useState(true);\n  const [isConfirmationModalOpen, setIsConfirmationModalOpen] = useState(false);\n\n  useEffect(() => {\n    success && onReturn();\n  }, [success]);\n\n  useEffect(() => {\n    searchLocations();\n    getRoles();\n    getUsers();\n    getSettings(SETTING_ATTRIBUTE_TYPE_PREFIX);\n    personId && getUserByPersonId(personId);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffect(() => {\n    personUuid && getPerson(personUuid);\n  }, [personUuid, getPerson]);\n\n  useEffect(() => {\n    if (person) {\n      const {\n        preferredName: { familyName, givenName },\n        attributes\n      } = person;\n      const {\n        username,\n        roles,\n        userProperties: { locationUuid: locationUuidString }\n      } = currentUser;\n      const [userRole] = roles;\n      const { display: label, uuid: value } = userRole;\n      // editing an account through Legacy UI results in 'null' string being added to 'locationUuid' user property\n      const fixedLocationUuidString = locationUuidString?.replace(/null/g, '');\n      const locationUuids = !!fixedLocationUuidString\n        ? fixedLocationUuidString.split(',').map(locationUuid => locations.find(({ uuid }) => locationUuid === uuid))\n        : [];\n\n      setUserAccount({\n        familyName: { ...userAccount.familyName, value: familyName },\n        givenName: { ...userAccount.givenName, value: givenName },\n        phone: {\n          ...userAccount.phone,\n          value: attributes.find(({ attributeType }) => attributeType.uuid === telephoneNumberAtributeTypeUuid)?.value\n        },\n        email: {\n          ...userAccount.email,\n          value: attributes.find(({ attributeType }) => attributeType.uuid === emailAddressAtributeTypeUuid)?.value\n        },\n        username: { ...userAccount.username, value: username },\n        locations: { ...userAccount.locations, value: locationUuids.map(option => ({ label: option.display, value: option.uuid })) },\n        userRole: { ...userAccount.userRole, value: { label, value } },\n        password: { ...userAccount.password, value: DEFAULT_EDIT_USER_PASSWORD },\n        confirmPassword: { ...userAccount.confirmPassword, value: DEFAULT_EDIT_USER_PASSWORD }\n      });\n      setForcePassword(false);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [person, currentUser]);\n\n  const validateEmptyFields = () => {\n    const validatedUserAccount: IUserAccount = _.cloneDeep(userAccount);\n\n    Object.keys(validatedUserAccount).forEach(fieldName => {\n      const field = validatedUserAccount[fieldName];\n      if (\n        field.isValid &&\n        (!field.value || (fieldName === LOCATION_FIELD && !field.value.length) || (fieldName === USER_ROLE_FIELD && !field.value?.value))\n      ) {\n        field.isValid = false;\n        field.error = 'common.error.required';\n      }\n    });\n\n    setUserAccount(validatedUserAccount);\n  };\n\n  const onValueChange = (name: string) => (event: FormEvent) => {\n    const fieldValue = extractEventValue(event) || EMPTY_STRING;\n\n    let isFieldValid = true;\n    let errorMessage = '';\n\n    switch (name) {\n      case PHONE_FIELD:\n        if (!isPossiblePhoneNumber(fieldValue)) {\n          isFieldValid = false;\n          errorMessage = 'registerPatient.invalidPhoneNumber';\n        }\n        break;\n      case EMAIL_FIELD:\n        if (!EMAIL_REGEX.test(fieldValue)) {\n          isFieldValid = false;\n          errorMessage = 'common.error.invalidEmail';\n        }\n        break;\n      case USERNAME_FIELD:\n        const isUsernameValid = fieldValue && USERNAME_REGEX.test(fieldValue);\n        const otherUsers = users.filter(({ uuid }) => uuid !== currentUser.uuid);\n        const isUsernameUnique = otherUsers.every(({ display }) => display.toLowerCase() !== fieldValue.toLowerCase());\n        if (!isUsernameValid) {\n          isFieldValid = false;\n          errorMessage = 'common.error.nameInvalid';\n        } else if (!isUsernameUnique) {\n          isFieldValid = false;\n          errorMessage = 'common.error.nameUnique';\n        }\n        break;\n      case PASSWORD_FIELD:\n        const isPasswordValid = fieldValue && PASSWORD_REGEX.test(fieldValue);\n        if (!isPasswordValid) {\n          isFieldValid = false;\n          errorMessage = 'common.error.invalidPassword';\n        }\n        person && !forcePassword && setForcePassword(true);\n        break;\n      case CONFIRM_PASSWORD_FIELD:\n        if (userAccount.password.value !== fieldValue) {\n          isFieldValid = false;\n          errorMessage = 'common.error.confirmPassword';\n        }\n    }\n\n    setUserAccount({ ...userAccount, [name]: { ...userAccount[name], value: fieldValue, isValid: isFieldValid, error: errorMessage } });\n    setDirtyFields(uniq([...dirtyFields, name]));\n  };\n\n  const onReturn = () => (window.location.href = `${ROOT_URL}adminui/systemadmin/accounts/manageAccounts.page`);\n\n  const onSave = () => {\n    validateEmptyFields();\n    const isFormValid = Object.values(userAccount).every(({ value, isValid }) => (value?.length || value?.value) && isValid);\n\n    if (isFormValid) {\n      const isPasswordFieldDirty = dirtyFields.find(field => field === PASSWORD_FIELD);\n      const personAttributes = [];\n      telephoneNumberAtributeTypeUuid &&\n        personAttributes.push({\n          attributeType: telephoneNumberAtributeTypeUuid,\n          value: userAccount.phone.value\n        });\n      emailAddressAtributeTypeUuid &&\n        personAttributes.push({\n          attributeType: emailAddressAtributeTypeUuid,\n          value: userAccount.email.value\n        });\n\n      saveUser(\n        {\n          username: userAccount.username.value,\n          ...(!person && isPasswordFieldDirty && { password: userAccount.password.value }),\n          userProperties: {\n            forcePassword: String(forcePassword),\n            locationUuid: userAccount?.locations.value.map(({ value }) => value).join(',')\n          },\n          roles: [\n            {\n              uuid: userAccount?.userRole.value?.value,\n              name: userAccount?.userRole.value?.label\n            }\n          ],\n          person: {\n            gender: GENDER_OTHER,\n            attributes: personAttributes,\n            names: [\n              {\n                givenName: userAccount.givenName.value,\n                familyName: userAccount.familyName.value\n              }\n            ]\n          }\n        },\n        currentUser?.uuid,\n        person && isPasswordFieldDirty && userAccount.password.value\n      );\n    } else {\n      errorToast(intl.formatMessage({ id: 'userAccount.accountNotSaved' }));\n    }\n  };\n\n  const onDelete = () => setIsConfirmationModalOpen(true);\n\n  const confirmationModal = () => (\n    <ConfirmationModal\n      header={{ id: 'userAccount.deleteAccount.confirmationModal.header' }}\n      body={{ id: 'userAccount.deleteAccount.confirmationModal.body' }}\n      onYes={() => {\n        deleteUser(currentUser?.uuid);\n        setIsConfirmationModalOpen(false);\n      }}\n      onNo={() => setIsConfirmationModalOpen(false)}\n      isOpen={isConfirmationModalOpen}\n    />\n  );\n\n  return (\n    <div id=\"user-account\" className={cx({ edit: personId })}>\n      {confirmationModal()}\n      <FormattedMessage id={`userAccount.${!personId ? 'add' : 'edit'}`} tagName=\"h2\" />\n      {userLoading || loadingSettings ? (\n        <div className=\"spinner\">\n          <Spinner />\n        </div>\n      ) : (\n        <>\n          {personId && (\n            <div className=\"d-inline pull-right\">\n              <Button className=\"delete\" onClick={onDelete} data-testid=\"deleteAccount\">\n                <FormattedMessage id=\"userAccount.deleteAccount.label\" />\n              </Button>\n            </div>\n          )}\n          <Form className={cx({ hide: userLoading })}>\n            <div className=\"section person\">\n              <PersonDetails intl={intl} onValueChange={onValueChange} userAccount={userAccount} />\n            </div>\n            {personId && (\n              <div className=\"section audit\">\n                <AuditInfo intl={intl} audit={currentUser?.auditInfo} />\n              </div>\n            )}\n            <div className=\"section user\">\n              <UserAccountDetails\n                intl={intl}\n                onValueChange={onValueChange}\n                userAccount={userAccount}\n                dirtyFields={dirtyFields}\n                locations={locations}\n                roles={roles}\n                setForcePassword={setForcePassword}\n                forcePassword={forcePassword}\n                isEdit={!!person}\n              />\n            </div>\n            <div className=\"buttons mt-5 pb-5\">\n              <div className=\"d-inline\">\n                <Button className=\"cancel\" onClick={onReturn} data-testid=\"returnButton\">\n                  <FormattedMessage id=\"common.return\" />\n                </Button>\n              </div>\n              <div className=\"d-inline pull-right confirm-button-container\">\n                <Button className=\"save\" onClick={onSave} data-testid=\"saveButton\">\n                  <FormattedMessage id=\"common.save\" />\n                </Button>\n              </div>\n            </div>\n          </Form>\n        </>\n      )}\n    </div>\n  );\n};\n\nconst mapStateToProps = ({ role, location, user, settings, cflPerson }: IStore) => ({\n  userLoading: !personId ? user.loading : isNil(cflPerson.person),\n  locations: location.locations,\n  roles: role.roles,\n  users: user.users,\n  currentUser: user.currentUser,\n  settings: settings.settings,\n  loadingSettings: settings.loading,\n  person: cflPerson.person,\n  success: user.success\n});\n\nconst mapDispatchToProps = {\n  searchLocations,\n  getRoles,\n  getUsers,\n  getUserByPersonId,\n  getSettings,\n  getPerson,\n  saveUser,\n  deleteUser\n};\n\ntype StateProps = ReturnType<typeof mapStateToProps>;\ntype DispatchProps = typeof mapDispatchToProps;\n\nexport default connect(mapStateToProps, mapDispatchToProps)(injectIntl(withRouter(UserAccount)));\n","export const DRUG_DOSING_UNITS_SETTING_KEY = 'order.drugDosingUnitsConceptUuid';\nexport const DRUG_ORDER_TYPE_JAVA_CLASS_NAME = 'org.openmrs.DrugOrder';\nexport const DRUG_ORDER_TEMPLATE_TYPE = 'cfl.drug.order.json';\nexport const DRUGS = 'drugs';\nexport const REGIMEN_NAME = 'regimenName';\nexport const DELETE_REGIMEN_MODAL = 'deleteRegimenModal';\nexport const DELETE_DRUG_MODAL = 'deleteDrugModal';\nexport const DOSE = 'dose';\nexport const DRUG_DETAILS = 'drugDetails';\nexport const ORDER_TYPE_CUSTOM_V = 'name,uuid,javaClassName';\nexport const ORDER_SET_CUSTOM_V = 'display,uuid,orderSetMembers';\nexport const ORDER_FREQUENCY_CUSTOM_V = 'display,uuid';\nexport const DRUGS_LIST_CUSTOM_V = 'display,uuid,abbreviation,concept';\nexport const CONCEPT_CUSTOM_V = 'uuid,setMembers';\nexport const REGIMEN_TO_SAVE_DESCRIPTION = 'Manage regimens with drugs';\nexport const RETURN_LOCATION = '/openmrs/adminui/metadata/configureMetadata.page';\nexport const OPERATOR_ALL = 'ALL';\nexport const FIELD_REQUIRED_ERROR_MESSAGE = 'common.error.required';\nexport const UNIQUE_REGIMEN_NAME_ERROR_MESSAGE = 'manageRegimens.error.regimenNameUnique';\nexport const CLOSED_MODAL_CONFIGURATION = { open: false, type: DELETE_REGIMEN_MODAL };\nexport const DEFAULT_OPTION_CONFIGURATION = { label: '', value: '', isValid: true };\nexport const DEFAULT_DRUG_CONFIGURATION = {\n  drugDetails: { ...DEFAULT_OPTION_CONFIGURATION, abbreviation: '' },\n  doseUnits: DEFAULT_OPTION_CONFIGURATION,\n  dose: '1',\n  frequency: DEFAULT_OPTION_CONFIGURATION\n};\nexport const DEFAULT_MANAGE_REGIMEN_CONFIGURATION = {\n  regimenName: '',\n  uuid: '',\n  isValid: true,\n  drugs: [DEFAULT_DRUG_CONFIGURATION]\n};\nexport const INITIAL_REGIMEN_VALUE = {\n  regimenUuid: '',\n  regimenIdx: null\n};\nexport const INITIAL_DRUG_VALUE = {\n  ...INITIAL_REGIMEN_VALUE,\n  drugUuid: '',\n  drugIdx: null\n};\n","import { AnyAction } from 'redux';\nimport { IConfirmationModal, IDrugToDelete, IManageRegimensState, IRegimen, IRegimenToDelete } from '../../shared/models/manage-regimens';\nimport {\n  INITIAL_DRUG_VALUE,\n  DEFAULT_MANAGE_REGIMEN_CONFIGURATION,\n  CLOSED_MODAL_CONFIGURATION,\n  INITIAL_REGIMEN_VALUE\n} from '../../shared/constants/manage-regimens';\n\nconst ACTION_TYPES = {\n  SET_REGIMENS: 'manage-regimens/SET_REGIMENS',\n  SET_EDITED_REGIMENS: 'manage-regimens/SET_EDITED_REGIMENS',\n  SET_REGIMEN_TO_DELETE: 'manage-regimens/SET_REGIMEN_TO_DELETE',\n  SET_DRUG_TO_DELETE: 'manage-regimens/SET_DRUG_TO_DELETE',\n  SET_CONFIRMATION_MODAL: 'manage-regimens/SET_CONFIRMATION_MODAL'\n};\n\nconst initialState: IManageRegimensState = {\n  regimens: [DEFAULT_MANAGE_REGIMEN_CONFIGURATION],\n  editedRegimens: [],\n  regimenToDelete: INITIAL_REGIMEN_VALUE,\n  drugToDelete: INITIAL_DRUG_VALUE,\n  confirmationModal: CLOSED_MODAL_CONFIGURATION\n};\n\nconst reducer = (state = initialState, action: AnyAction) => {\n  switch (action.type) {\n    case ACTION_TYPES.SET_REGIMENS: {\n      return {\n        ...state,\n        regimens: action.data\n      };\n    }\n    case ACTION_TYPES.SET_EDITED_REGIMENS: {\n      return {\n        ...state,\n        editedRegimens: action.data\n      };\n    }\n    case ACTION_TYPES.SET_REGIMEN_TO_DELETE: {\n      return {\n        ...state,\n        regimenToDelete: action.data\n      };\n    }\n    case ACTION_TYPES.SET_DRUG_TO_DELETE: {\n      return {\n        ...state,\n        drugToDelete: action.data\n      };\n    }\n    case ACTION_TYPES.SET_CONFIRMATION_MODAL: {\n      return {\n        ...state,\n        confirmationModal: action.data\n      };\n    }\n    default:\n      return state;\n  }\n};\n\nexport default reducer;\n\nexport const setRegimens = (regimens: IRegimen[]) => ({\n  type: ACTION_TYPES.SET_REGIMENS,\n  data: regimens\n});\n\nexport const setEditedRegimens = (editedRegimens: string) => ({\n  type: ACTION_TYPES.SET_EDITED_REGIMENS,\n  data: editedRegimens\n});\n\nexport const setRegimenToDelete = (regimenToDelete: IRegimenToDelete) => ({\n  type: ACTION_TYPES.SET_REGIMEN_TO_DELETE,\n  data: regimenToDelete\n});\n\nexport const setDrugToDelete = (drugToDelete: IDrugToDelete) => ({\n  type: ACTION_TYPES.SET_DRUG_TO_DELETE,\n  data: drugToDelete\n});\n\nexport const setConfirmationModal = (configuration: IConfirmationModal) => ({\n  type: ACTION_TYPES.SET_CONFIRMATION_MODAL,\n  data: configuration\n});\n","import React, { useCallback, useMemo } from 'react';\nimport ValidationError from '../common/form/ValidationError';\nimport cx from 'classnames';\nimport { connect } from 'react-redux';\nimport { injectIntl, IntlShape } from 'react-intl';\nimport { InputWithPlaceholder, SelectWithPlaceholder } from '../common/form/withPlaceholder';\nimport { PlusMinusButtons } from '../common/form/PlusMinusButtons';\nimport { selectDefaultTheme } from '../../shared/util/form-util';\nimport { IDrug, OnChangeHandler } from '../../shared/models/manage-regimens';\nimport { IConcept } from '../../shared/models/concept';\nimport { IDrugListItem } from '../../shared/models/drugs';\nimport { IFrequency } from '../../shared/models/order-frequency';\nimport { setEditedRegimens, setRegimens, setDrugToDelete, setConfirmationModal } from '../../redux/reducers/manage-regimens';\nimport { cloneDeep, uniq } from 'lodash';\nimport { extractEventValue } from '../../shared/util/form-util';\nimport {\n  DEFAULT_DRUG_CONFIGURATION,\n  DELETE_DRUG_MODAL,\n  DOSE,\n  DRUGS,\n  DRUG_DETAILS,\n  FIELD_REQUIRED_ERROR_MESSAGE\n} from '../../shared/constants/manage-regimens';\nimport { EMPTY_STRING } from '../../shared/constants/input';\n\nexport interface IDrugProps extends StateProps, DispatchProps {\n  intl: IntlShape;\n  drugsList: IDrugListItem[];\n  frequencies: IFrequency[];\n  conceptDoseTypes: IConcept;\n  regimenUuid: string;\n  regimenIdx: number;\n  drug: IDrug;\n  drugIdx: number;\n}\n\nexport const Drug = ({\n  intl,\n  drugsList,\n  frequencies,\n  conceptDoseTypes,\n  regimens,\n  editedRegimens,\n  regimenUuid,\n  regimenIdx,\n  drug: { drugDetails, doseUnits, dose, frequency: drugFrequency, uuid: drugUuid },\n  drugIdx,\n  setRegimens,\n  setEditedRegimens,\n  setConfirmationModal,\n  setDrugToDelete\n}: IDrugProps) => {\n  const { formatMessage } = intl;\n  const getOptions = useMemo(\n    () => (options: { display: string; uuid: string }[] = []) => options.map(option => ({ label: option?.display, value: option?.uuid })),\n    []\n  );\n  const getValue = (value: { label: string }) => (value.label ? value : null);\n  const onChangeHandler: OnChangeHandler = useCallback(\n    (regimenIdx, regimenUuid, name, drugIdx) => event => {\n      const clonedRegimens = cloneDeep(regimens);\n      const extractedValue = extractEventValue(event);\n\n      clonedRegimens[regimenIdx][DRUGS][drugIdx][name] = extractedValue;\n\n      if (name === DRUG_DETAILS) {\n        const { abbreviation } = drugsList.find(({ uuid }) => uuid === extractedValue.value);\n        clonedRegimens[regimenIdx][DRUGS][drugIdx][name].abbreviation = abbreviation ?? EMPTY_STRING;\n      }\n\n      if (name !== DOSE) {\n        clonedRegimens[regimenIdx][DRUGS][drugIdx][name].isValid = !!extractedValue;\n      }\n\n      setRegimens(clonedRegimens);\n      regimenUuid && setEditedRegimens(uniq([...editedRegimens, regimenUuid]));\n    },\n    [regimens, setRegimens, setEditedRegimens, editedRegimens, drugsList]\n  );\n\n  const onAddDrugHandler = useCallback(() => {\n    const clonedRegimens = cloneDeep(regimens);\n    clonedRegimens[regimenIdx][DRUGS].push(DEFAULT_DRUG_CONFIGURATION);\n    setRegimens(clonedRegimens);\n  }, [regimenIdx, regimens, setRegimens]);\n\n  const onRemoveDrugHandler = useCallback(() => {\n    setDrugToDelete({ regimenUuid, regimenIdx, drugUuid, drugIdx });\n    setConfirmationModal({ open: true, type: DELETE_DRUG_MODAL });\n  }, [setDrugToDelete, regimenUuid, regimenIdx, drugUuid, drugIdx, setConfirmationModal]);\n\n  return (\n    <div key={`${regimenUuid}-${drugIdx}`} className=\"manage-regimen-row\">\n      <div className=\"input-container flex-2\" data-testid=\"drugNameSelect\">\n        <SelectWithPlaceholder\n          placeholder={formatMessage({ id: 'manageRegimens.drugName' })}\n          showPlaceholder={!!getValue(drugDetails)}\n          value={getValue(drugDetails)}\n          onChange={onChangeHandler(regimenIdx, regimenUuid, 'drugDetails', drugIdx)}\n          options={getOptions(drugsList)}\n          wrapperClassName={cx({ invalid: !drugDetails.isValid })}\n          classNamePrefix=\"default-select\"\n          theme={selectDefaultTheme}\n        />\n        {!drugDetails.isValid && <ValidationError message={FIELD_REQUIRED_ERROR_MESSAGE} />}\n      </div>\n      <div className=\"input-container\">\n        <InputWithPlaceholder\n          placeholder={formatMessage({ id: 'manageRegimens.drugAbbreviation' })}\n          showPlaceholder={!!drugDetails.abbreviation}\n          value={drugDetails.abbreviation}\n          disabled\n          data-testid=\"abbreviationInput\"\n        />\n      </div>\n      <div className=\"input-container\" data-testid=\"doseUnitsSelect\">\n        <SelectWithPlaceholder\n          placeholder={formatMessage({ id: 'manageRegimens.doseUnitType' })}\n          showPlaceholder={!!getValue(doseUnits)}\n          value={getValue(doseUnits)}\n          onChange={onChangeHandler(regimenIdx, regimenUuid, 'doseUnits', drugIdx)}\n          options={getOptions(conceptDoseTypes?.setMembers)}\n          wrapperClassName={cx({ invalid: !doseUnits.isValid })}\n          classNamePrefix=\"default-select\"\n          theme={selectDefaultTheme}\n        />\n        {!doseUnits.isValid && <ValidationError message={FIELD_REQUIRED_ERROR_MESSAGE} />}\n      </div>\n      <div className=\"input-container\">\n        <InputWithPlaceholder\n          placeholder={formatMessage({ id: 'manageRegimens.numberOfUnits' })}\n          showPlaceholder={!!dose}\n          value={dose}\n          onChange={onChangeHandler(regimenIdx, regimenUuid, 'dose', drugIdx)}\n          type=\"number\"\n          pattern=\"[1-9]\"\n          min={1}\n          className={cx({ invalid: !Number(dose) })}\n          data-testid=\"doseInput\"\n        />\n        {!Number(dose) && <ValidationError message={FIELD_REQUIRED_ERROR_MESSAGE} />}\n      </div>\n      <div className=\"input-container\" data-testid=\"frequencySelect\">\n        <SelectWithPlaceholder\n          placeholder={formatMessage({ id: 'manageRegimens.frequency' })}\n          showPlaceholder={!!getValue(drugFrequency)}\n          value={getValue(drugFrequency)}\n          onChange={onChangeHandler(regimenIdx, regimenUuid, 'frequency', drugIdx)}\n          options={getOptions(frequencies)}\n          wrapperClassName={cx({ invalid: !drugFrequency.isValid })}\n          classNamePrefix=\"default-select\"\n          theme={selectDefaultTheme}\n        />\n        {!drugFrequency.isValid && <ValidationError message={FIELD_REQUIRED_ERROR_MESSAGE} />}\n      </div>\n      <PlusMinusButtons\n        intl={intl}\n        onPlusClick={onAddDrugHandler}\n        onMinusClick={onRemoveDrugHandler}\n        isPlusButtonVisible={drugIdx === regimens[regimenIdx][DRUGS].length - 1}\n      />\n    </div>\n  );\n};\n\nconst mapStateToProps = ({\n  manageRegimens: { regimens, editedRegimens },\n  concept: { concept: conceptDoseTypes },\n  drugs: { drugsList },\n  orderFrequency: { frequencies }\n}) => ({\n  drugsList,\n  frequencies,\n  conceptDoseTypes,\n  regimens,\n  editedRegimens\n});\n\nconst mapDispatchToProps = {\n  setRegimens,\n  setEditedRegimens,\n  setDrugToDelete,\n  setConfirmationModal\n};\n\ntype StateProps = ReturnType<typeof mapStateToProps>;\ntype DispatchProps = typeof mapDispatchToProps;\n\nexport default connect(mapStateToProps, mapDispatchToProps)(injectIntl(Drug));\n","import React, { useCallback } from 'react';\nimport Drug from './Drug';\nimport ValidationError from '../common/form/ValidationError';\nimport ExpandableSection from '../common/expandable-section/ExpandableSection';\nimport cx from 'classnames';\nimport { connect } from 'react-redux';\nimport { injectIntl, IntlShape } from 'react-intl';\nimport { InputWithPlaceholder } from '../common/form/withPlaceholder';\nimport { IRegimen, OnChangeHandler } from '../../shared/models/manage-regimens';\nimport {\n  DEFAULT_DRUG_CONFIGURATION,\n  DELETE_REGIMEN_MODAL,\n  DRUGS,\n  FIELD_REQUIRED_ERROR_MESSAGE,\n  REGIMEN_NAME,\n  UNIQUE_REGIMEN_NAME_ERROR_MESSAGE\n} from '../../shared/constants/manage-regimens';\nimport { extractEventValue } from '../../shared/util/form-util';\nimport { cloneDeep, uniq } from 'lodash';\nimport { setEditedRegimens, setRegimens, setRegimenToDelete, setConfirmationModal } from '../../redux/reducers/manage-regimens';\nimport { EMPTY_STRING } from '../../shared/constants/input';\n\ninterface IRegimenProps extends StateProps, DispatchProps {\n  intl: IntlShape;\n  regimen: IRegimen;\n  regimens: IRegimen[];\n  regimenIdx: number;\n  isAllSectionsExpanded: boolean;\n}\n\nconst Regimen = ({\n  intl: { formatMessage },\n  regimen: { regimenName, drugs, uuid: regimenUuid, isValid: isRegimenValid, errorMessage },\n  regimens,\n  editedRegimens,\n  regimenIdx,\n  isAllSectionsExpanded,\n  setConfirmationModal,\n  setRegimens,\n  setEditedRegimens,\n  setRegimenToDelete\n}: IRegimenProps) => {\n  if (!drugs.length) {\n    const clonedRegimens = cloneDeep(regimens);\n    clonedRegimens[regimenIdx][DRUGS].push(DEFAULT_DRUG_CONFIGURATION);\n    setRegimens(clonedRegimens);\n  }\n\n  const onChangeHandler: OnChangeHandler = useCallback(\n    (regimenIdx, regimenUuid) => event => {\n      const clonedRegimens = cloneDeep(regimens);\n      const extractedValue = extractEventValue(event);\n      const isRegimenNameUnique = clonedRegimens.every(({ regimenName }) => regimenName.toLowerCase() !== extractedValue.toLowerCase());\n\n      clonedRegimens[regimenIdx][REGIMEN_NAME] = extractedValue;\n      clonedRegimens[regimenIdx].isValid = !!extractedValue;\n      clonedRegimens[regimenIdx].errorMessage = EMPTY_STRING;\n\n      if (!extractedValue) {\n        clonedRegimens[regimenIdx].errorMessage = FIELD_REQUIRED_ERROR_MESSAGE;\n      } else if (!isRegimenNameUnique) {\n        clonedRegimens[regimenIdx].isValid = false;\n        clonedRegimens[regimenIdx].errorMessage = UNIQUE_REGIMEN_NAME_ERROR_MESSAGE;\n      }\n\n      setRegimens(clonedRegimens);\n      regimenUuid && setEditedRegimens(uniq([...editedRegimens, regimenUuid]));\n    },\n    [regimens, setRegimens, setEditedRegimens, editedRegimens]\n  );\n\n  const onRemoveRegimenHandler = useCallback(() => {\n    setRegimenToDelete({ regimenUuid, regimenIdx });\n    setConfirmationModal({ open: true, type: DELETE_REGIMEN_MODAL });\n  }, [regimenUuid, regimenIdx, setRegimenToDelete, setConfirmationModal]);\n\n  const headerComponent = (disabled: boolean = false) => (\n    <div className=\"input-container\">\n      <InputWithPlaceholder\n        placeholder={formatMessage({ id: 'manageRegimens.regimenName' })}\n        showPlaceholder={!!regimenName}\n        value={regimenName}\n        onChange={onChangeHandler(regimenIdx, regimenUuid)}\n        className={cx({ invalid: !isRegimenValid })}\n        disabled={disabled}\n        data-testid=\"regimenHeaderInput\"\n      />\n      {!isRegimenValid && <ValidationError message={errorMessage} />}\n    </div>\n  );\n\n  const bodyComponent = drugs.map((drug, drugIdx) => (\n    <Drug key={`${drug.uuid}-${drugIdx}`} drug={drug} drugIdx={drugIdx} regimenUuid={regimenUuid} regimenIdx={regimenIdx} />\n  ));\n\n  return (\n    <ExpandableSection\n      key={`${regimenUuid}-${regimenIdx}`}\n      headerComponent={headerComponent()}\n      disabledHeaderComponent={headerComponent(true)}\n      bodyComponent={bodyComponent}\n      isRemovable={true}\n      onRemove={onRemoveRegimenHandler}\n      isExpandTriggered={isAllSectionsExpanded}\n    />\n  );\n};\n\nconst mapStateToProps = ({ manageRegimens: { regimens, editedRegimens } }) => ({\n  regimens,\n  editedRegimens\n});\n\nconst mapDispatchToProps = {\n  setRegimens,\n  setEditedRegimens,\n  setRegimenToDelete,\n  setConfirmationModal\n};\n\ntype StateProps = ReturnType<typeof mapStateToProps>;\ntype DispatchProps = typeof mapDispatchToProps;\n\nexport default connect(mapStateToProps, mapDispatchToProps)(injectIntl(Regimen));\n","import axios from 'axios';\nimport { AnyAction } from 'redux';\nimport { IOrderSetPayload, IOrderSetState } from '../../shared/models/order-set';\nimport { REQUEST, SUCCESS } from '../action-type.util';\n\nconst ACTION_TYPES = {\n  GET_ORDER_SET: 'order-set/GET_ORDER_SET',\n  SAVE_ORDER_SET: 'order-set/SAVE_ORDER_SET',\n  DELETE_ORDER_SET: 'order-set/DELETE_ORDER_SET',\n  DELETE_ORDER_SET_MEMBER: 'order-set/DELETE_ORDER_SET_MEMBER'\n};\n\nconst initialState: IOrderSetState = {\n  loading: false,\n  orderSet: [],\n  success: {\n    deletedOrderSet: false,\n    deletedOrderSetMember: false,\n    savedOrderSet: false\n  }\n};\n\nconst reducer = (state = initialState, action: AnyAction) => {\n  switch (action.type) {\n    case REQUEST(ACTION_TYPES.GET_ORDER_SET):\n      return {\n        ...state,\n        loading: true\n      };\n    case REQUEST(ACTION_TYPES.SAVE_ORDER_SET):\n      return {\n        ...state,\n        success: {\n          ...state.success,\n          savedOrderSet: false\n        }\n      };\n    case REQUEST(ACTION_TYPES.DELETE_ORDER_SET):\n      return {\n        ...state,\n        success: {\n          ...state.success,\n          deletedOrderSet: false\n        }\n      };\n    case REQUEST(ACTION_TYPES.DELETE_ORDER_SET_MEMBER):\n      return {\n        ...state,\n        success: {\n          ...state.success,\n          deletedOrderSetMember: false\n        }\n      };\n    case SUCCESS(ACTION_TYPES.GET_ORDER_SET):\n      return {\n        ...state,\n        loading: false,\n        orderSet: action.payload.data.results\n      };\n    case SUCCESS(ACTION_TYPES.SAVE_ORDER_SET):\n      return {\n        ...state,\n        success: {\n          ...state.success,\n          savedOrderSet: true\n        }\n      };\n    case SUCCESS(ACTION_TYPES.DELETE_ORDER_SET):\n      return {\n        ...state,\n        success: {\n          ...state.success,\n          deletedOrderSet: true\n        }\n      };\n    case SUCCESS(ACTION_TYPES.DELETE_ORDER_SET_MEMBER):\n      return {\n        ...state,\n        success: {\n          ...state.success,\n          deletedOrderSetMember: true\n        }\n      };\n    default:\n      return state;\n  }\n};\n\nexport default reducer;\n\nexport const getOrderSet = (custom?: string) => ({\n  type: ACTION_TYPES.GET_ORDER_SET,\n  payload: axios.get(`/openmrs/ws/rest/v1/orderset?v=${custom ? `custom:(${custom})` : 'full'}`)\n});\n\nexport const deleteOrderSet = (uuid: string) => ({\n  type: ACTION_TYPES.DELETE_ORDER_SET,\n  payload: axios.delete(`/openmrs/ws/rest/v1/orderset/${uuid}`)\n});\n\nexport const saveOrderSet = (orderSet: IOrderSetPayload, uuid?: string) => ({\n  type: ACTION_TYPES.SAVE_ORDER_SET,\n  payload: axios.post(`/openmrs/ws/rest/v1/orderset/${uuid && uuid}`, orderSet)\n});\n\nexport const deleteOrderSetMember = (orderSetUuid: string, orderSetMemberUuid: string) => ({\n  type: ACTION_TYPES.DELETE_ORDER_SET_MEMBER,\n  payload: axios.delete(`/openmrs/ws/rest/v1/orderset/${orderSetUuid}/ordersetmember/${orderSetMemberUuid}`)\n});\n","import axios from 'axios';\nimport { AnyAction } from 'redux';\nimport { REQUEST, SUCCESS } from '../action-type.util';\nimport { IDrugsState } from '../../shared/models/drugs';\n\nconst ACTION_TYPES = {\n  GET_DRUGS_LIST: 'drugs/GET_DRUGS_LIST'\n};\n\nconst initialState: IDrugsState = {\n  loading: false,\n  drugsList: []\n};\n\nconst reducer = (state = initialState, action: AnyAction) => {\n  switch (action.type) {\n    case REQUEST(ACTION_TYPES.GET_DRUGS_LIST):\n      return {\n        ...state,\n        loading: true\n      };\n    case SUCCESS(ACTION_TYPES.GET_DRUGS_LIST):\n      return {\n        ...state,\n        loading: false,\n        drugsList: action.payload.data.results\n      };\n    default:\n      return state;\n  }\n};\n\nexport default reducer;\n\nexport const getDrugsList = (custom?: string) => ({\n  type: ACTION_TYPES.GET_DRUGS_LIST,\n  payload: axios.get(`/openmrs/ws/rest/v1/drug?v=${custom ? `custom:(${custom})` : 'full'}`)\n});\n","import axios from 'axios';\nimport { AnyAction } from 'redux';\nimport { REQUEST, SUCCESS } from '../action-type.util';\nimport { IOrderFrequencyState } from '../../shared/models/order-frequency';\n\nconst ACTION_TYPES = {\n  GET_ORDER_FREQUENCIES: 'order-frequency/GET_ORDER_FREQUENCIES'\n};\n\nconst initialState: IOrderFrequencyState = {\n  loading: false,\n  frequencies: []\n};\n\nconst reducer = (state = initialState, action: AnyAction) => {\n  switch (action.type) {\n    case REQUEST(ACTION_TYPES.GET_ORDER_FREQUENCIES):\n      return {\n        ...state,\n        loading: true\n      };\n    case SUCCESS(ACTION_TYPES.GET_ORDER_FREQUENCIES):\n      return {\n        ...state,\n        loading: false,\n        frequencies: action.payload.data.results\n      };\n    default:\n      return state;\n  }\n};\n\nexport default reducer;\n\nexport const getFrequencies = (custom?: string) => ({\n  type: ACTION_TYPES.GET_ORDER_FREQUENCIES,\n  payload: axios.get(`/openmrs/ws/rest/v1/orderfrequency?v=${custom ? `custom:(${custom})` : 'full'}`)\n});\n","import axios from 'axios';\nimport { AnyAction } from 'redux';\nimport { REQUEST, SUCCESS } from '../action-type.util';\nimport { IOrderTypeState } from '../../shared/models/order-type';\n\nconst ACTION_TYPES = {\n  GET_ORDER_TYPE: 'order-type/GET_ORDER_TYPE'\n};\n\nconst initialState: IOrderTypeState = {\n  loading: false,\n  orderTypes: []\n};\n\nconst reducer = (state = initialState, action: AnyAction) => {\n  switch (action.type) {\n    case REQUEST(ACTION_TYPES.GET_ORDER_TYPE):\n      return {\n        ...state,\n        loading: true\n      };\n    case SUCCESS(ACTION_TYPES.GET_ORDER_TYPE):\n      return {\n        ...state,\n        loading: false,\n        orderTypes: action.payload.data.results\n      };\n    default:\n      return state;\n  }\n};\n\nexport default reducer;\n\nexport const getOrderType = (custom?: string) => ({\n  type: ACTION_TYPES.GET_ORDER_TYPE,\n  payload: axios.get(`/openmrs/ws/rest/v1/ordertype?v=${custom ? `custom:(${custom})` : 'full'}`)\n});\n","import React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport Regimen from './Regimen';\nimport { connect } from 'react-redux';\nimport { FormattedMessage, injectIntl, IntlShape } from 'react-intl';\nimport { Button, Spinner } from 'reactstrap';\nimport {\n  DRUG_DOSING_UNITS_SETTING_KEY,\n  DEFAULT_MANAGE_REGIMEN_CONFIGURATION,\n  DEFAULT_DRUG_CONFIGURATION,\n  DRUGS,\n  DRUG_ORDER_TEMPLATE_TYPE,\n  INITIAL_REGIMEN_VALUE,\n  INITIAL_DRUG_VALUE,\n  DELETE_REGIMEN_MODAL,\n  DELETE_DRUG_MODAL,\n  CLOSED_MODAL_CONFIGURATION,\n  DRUG_ORDER_TYPE_JAVA_CLASS_NAME,\n  ORDER_TYPE_CUSTOM_V,\n  ORDER_SET_CUSTOM_V,\n  ORDER_FREQUENCY_CUSTOM_V,\n  DRUGS_LIST_CUSTOM_V,\n  CONCEPT_CUSTOM_V,\n  REGIMEN_TO_SAVE_DESCRIPTION,\n  RETURN_LOCATION,\n  OPERATOR_ALL,\n  FIELD_REQUIRED_ERROR_MESSAGE,\n  UNIQUE_REGIMEN_NAME_ERROR_MESSAGE\n} from '../../shared/constants/manage-regimens';\nimport { getSettings } from '../../redux/reducers/setttings';\nimport {\n  setRegimens,\n  setEditedRegimens,\n  setRegimenToDelete,\n  setDrugToDelete,\n  setConfirmationModal\n} from '../../redux/reducers/manage-regimens';\nimport { getOrderSet, deleteOrderSet, saveOrderSet, deleteOrderSetMember } from '../../redux/reducers/order-set';\nimport { getConcept } from '../../redux/reducers/concept';\nimport { getDrugsList } from '../../redux/reducers/drugs';\nimport { getFrequencies } from '../../redux/reducers/order-frequency';\nimport { getOrderType } from '../../redux/reducers/order-type';\nimport { cloneDeep, uniq, without } from 'lodash';\nimport '../Inputs.scss';\nimport './ManageRegimens.scss';\nimport { ConfirmationModal } from '../common/form/ConfirmationModal';\nimport { successToast, errorToast } from '@bit/soldevelo-omrs.cfl-components.toast-handler';\nimport { IDrugToDelete, IRegimenToDelete, IManageRegimensState, IRegimen } from '../../shared/models/manage-regimens';\nimport { IOrderSetState } from '../../shared/models/order-set';\nimport { IConceptState } from '../../shared/models/concept';\nimport { IDrugsState } from '../../shared/models/drugs';\nimport { IOrderFrequencyState } from '../../shared/models/order-frequency';\nimport { IOrderTypeState } from '../../shared/models/order-type';\nimport { EMPTY_STRING } from '../../shared/constants/input';\n\ninterface IStore {\n  manageRegimens: IManageRegimensState;\n  orderSet: IOrderSetState;\n  concept: IConceptState;\n  drugs: IDrugsState;\n  orderFrequency: IOrderFrequencyState;\n  orderType: IOrderTypeState;\n  settings: {\n    loading: boolean;\n    settings: {\n      property: string;\n      value: string;\n    }[];\n  };\n}\n\nexport interface IMangeRegimensProps extends StateProps, DispatchProps {\n  intl: IntlShape;\n}\n\nexport const ManageRegimens = ({\n  intl: { formatMessage },\n  isRegimensLoading,\n  settingsLoading,\n  orderSet,\n  drugsList,\n  drugDosingUnitsConcept,\n  drugOrderType,\n  success: { deletedOrderSet, deletedOrderSetMember, savedOrderSet },\n  regimens,\n  editedRegimens,\n  regimenToDelete,\n  drugToDelete,\n  confirmationModal,\n  getOrderSet,\n  deleteOrderSet,\n  saveOrderSet,\n  deleteOrderSetMember,\n  getSettings,\n  getDrugsList,\n  getFrequencies,\n  getConcept,\n  getOrderType,\n  setRegimens,\n  setEditedRegimens,\n  setRegimenToDelete,\n  setDrugToDelete,\n  setConfirmationModal\n}: IMangeRegimensProps) => {\n  const [isAllSectionsExpanded, setIsAllSectionsExpanded] = useState(false);\n  const onReturn = useCallback(() => (window.location.href = RETURN_LOCATION), []);\n  const memoOrderSetList = useMemo(\n    () =>\n      orderSet.map(regimen => {\n        const { display, orderSetMembers, uuid: regimenUuid } = regimen;\n        const activeOrderSetMembers = orderSetMembers.filter(({ retired }) => !retired);\n        const parseDrugs = activeOrderSetMembers.map(({ orderTemplate, uuid: drugUuid }) => {\n          const parsedOrderSetMember = JSON.parse(orderTemplate);\n          const { drug, doseUnits, dose, frequency } = parsedOrderSetMember;\n\n          return {\n            uuid: drugUuid,\n            drugDetails: {\n              label: drug.display,\n              value: drug.uuid,\n              abbreviation: drug.abbreviation,\n              isValid: true\n            },\n            doseUnits: {\n              label: doseUnits.display,\n              value: doseUnits.uuid,\n              isValid: true\n            },\n            dose,\n            frequency: {\n              label: frequency.display,\n              value: frequency.uuid,\n              isValid: true\n            }\n          };\n        });\n\n        return {\n          regimenName: display,\n          isValid: true,\n          uuid: regimenUuid,\n          drugs: parseDrugs\n        };\n      }),\n    [orderSet]\n  );\n\n  useEffect(() => {\n    getSettings(DRUG_DOSING_UNITS_SETTING_KEY);\n    getOrderSet(ORDER_SET_CUSTOM_V);\n    getOrderType(ORDER_TYPE_CUSTOM_V);\n    getDrugsList(DRUGS_LIST_CUSTOM_V);\n    getFrequencies(ORDER_FREQUENCY_CUSTOM_V);\n  }, [getDrugsList, getFrequencies, getOrderSet, getOrderType, getSettings]);\n\n  useEffect(() => {\n    !settingsLoading && drugDosingUnitsConcept?.value && getConcept(drugDosingUnitsConcept.value, CONCEPT_CUSTOM_V);\n  }, [settingsLoading, drugDosingUnitsConcept?.value, getConcept]);\n\n  useEffect(() => {\n    orderSet.length && setRegimens(memoOrderSetList);\n  }, [orderSet, memoOrderSetList, setRegimens]);\n\n  useEffect(() => {\n    deletedOrderSet && successToast(formatMessage({ id: 'manageRegimens.regimenDeleted' }));\n  }, [deletedOrderSet, formatMessage]);\n\n  useEffect(() => {\n    deletedOrderSetMember && successToast(formatMessage({ id: 'manageRegimens.drugDeleted' }));\n  }, [deletedOrderSetMember, formatMessage]);\n\n  useEffect(() => {\n    savedOrderSet && onReturn();\n  }, [savedOrderSet, onReturn]);\n\n  const isRegimenNameUnique = useCallback(\n    (regimenNameReceived, regimenIdxReceived, regimensReceived = regimens) =>\n      regimensReceived.every(({ regimenName }, regimenIdx) =>\n        regimenIdx !== regimenIdxReceived ? regimenName !== regimenNameReceived : true\n      ),\n    [regimens]\n  );\n\n  const onRemoveRegimenHandler = useCallback(\n    ({ regimenUuid, regimenIdx }: IRegimenToDelete) => {\n      const clonedRegimens = cloneDeep(regimens);\n      clonedRegimens.splice(regimenIdx, 1);\n\n      if (!clonedRegimens.length) {\n        clonedRegimens.push(DEFAULT_MANAGE_REGIMEN_CONFIGURATION);\n      }\n\n      clonedRegimens.forEach(({ regimenName: clonedRegimenName }, clonedRegimenIdx) => {\n        const otherRegimens = regimens.filter(({ uuid }, idx) => (regimenUuid ? uuid !== regimenUuid : idx !== regimenIdx));\n\n        if (isRegimenNameUnique(clonedRegimenName, clonedRegimenIdx, otherRegimens)) {\n          clonedRegimens[clonedRegimenIdx].isValid = true;\n          clonedRegimens[clonedRegimenIdx].errorMessage = EMPTY_STRING;\n        }\n      });\n\n      setRegimens(clonedRegimens);\n\n      if (regimenUuid) {\n        setEditedRegimens(without(editedRegimens, regimenUuid));\n        deleteOrderSet(regimenUuid);\n      }\n    },\n    [regimens, setRegimens, isRegimenNameUnique, setEditedRegimens, editedRegimens, deleteOrderSet]\n  );\n\n  const onRemoveDrugHandler = useCallback(\n    ({ regimenUuid, regimenIdx, drugUuid, drugIdx }: IDrugToDelete) => {\n      const clonedRegimens = cloneDeep(regimens);\n      clonedRegimens[regimenIdx][DRUGS].splice(drugIdx, 1);\n      regimenUuid && setEditedRegimens(uniq([...editedRegimens, regimenUuid]));\n\n      if (!clonedRegimens[regimenIdx][DRUGS].length) {\n        clonedRegimens[regimenIdx][DRUGS].push(DEFAULT_DRUG_CONFIGURATION);\n      }\n\n      setRegimens(clonedRegimens);\n      drugUuid && deleteOrderSetMember(regimenUuid, drugUuid);\n    },\n    [regimens, setEditedRegimens, editedRegimens, setRegimens, deleteOrderSetMember]\n  );\n\n  const onAddRegimenHandler = useCallback(() => {\n    const clonedRegimens = cloneDeep(regimens);\n    clonedRegimens.push(DEFAULT_MANAGE_REGIMEN_CONFIGURATION);\n    setRegimens(clonedRegimens);\n  }, [regimens, setRegimens]);\n\n  const validateEmptyFields = useCallback(() => {\n    const clonedRegimens = cloneDeep(regimens);\n    let isFormValid = true;\n\n    clonedRegimens.forEach((regimen, regimenIdx) => {\n      const { regimenName, drugs, isValid } = regimen;\n\n      clonedRegimens[regimenIdx].errorMessage = EMPTY_STRING;\n      clonedRegimens[regimenIdx].isValid = true;\n\n      if (!regimenName || (!isValid && !isRegimenNameUnique(regimenName, regimenIdx))) {\n        clonedRegimens[regimenIdx].isValid = false;\n        isFormValid = false;\n        clonedRegimens[regimenIdx].errorMessage = !regimenName ? FIELD_REQUIRED_ERROR_MESSAGE : UNIQUE_REGIMEN_NAME_ERROR_MESSAGE;\n      }\n\n      drugs.forEach((drug, drugIdx) => {\n        const { doseUnits, drugDetails, frequency, dose } = drug;\n\n        if (!Number(dose)) {\n          isFormValid = false;\n        }\n\n        if (!doseUnits.value) {\n          clonedRegimens[regimenIdx][DRUGS][drugIdx].doseUnits.isValid = false;\n          isFormValid = false;\n        }\n\n        if (!drugDetails.value) {\n          clonedRegimens[regimenIdx][DRUGS][drugIdx].drugDetails.isValid = false;\n          isFormValid = false;\n        }\n\n        if (!frequency.value) {\n          clonedRegimens[regimenIdx][DRUGS][drugIdx].frequency.isValid = false;\n          isFormValid = false;\n        }\n      });\n    });\n\n    setRegimens(clonedRegimens);\n    return isFormValid;\n  }, [isRegimenNameUnique, regimens, setRegimens]);\n\n  const onSave = useCallback(() => {\n    const isFormValid = validateEmptyFields();\n\n    if (!isFormValid) {\n      return errorToast(formatMessage({ id: 'manageRegimens.regimensNotSaved' }));\n    }\n\n    const newRegimens = regimens.filter(({ uuid }) => !uuid);\n    const regimensToSave = editedRegimens.map(editedRegimen => regimens.find(({ uuid }) => editedRegimen === uuid)).concat(newRegimens);\n\n    const getDrugs = (regimen: IRegimen) =>\n      regimen.drugs.map(drug => {\n        const { drugDetails, doseUnits, dose, frequency } = drug;\n        const foundConcept = drugsList.find(drugList => drugList.uuid === drug.drugDetails.value);\n        const orderTemplate = {\n          drug: {\n            display: drugDetails.label,\n            uuid: drugDetails.value,\n            abbreviation: drugDetails.abbreviation\n          },\n          doseUnits: {\n            display: doseUnits.label,\n            uuid: doseUnits.value\n          },\n          dose,\n          frequency: {\n            display: frequency.label,\n            uuid: frequency.value\n          }\n        };\n\n        return {\n          orderType: drugOrderType,\n          orderTemplate: JSON.stringify(orderTemplate),\n          orderTemplateType: DRUG_ORDER_TEMPLATE_TYPE,\n          concept: foundConcept.concept.uuid\n        };\n      });\n\n    const regimenToSave = (regimen: IRegimen) => ({\n      operator: OPERATOR_ALL,\n      name: regimen.regimenName,\n      description: REGIMEN_TO_SAVE_DESCRIPTION,\n      orderSetMembers: getDrugs(regimen)\n    });\n\n    regimensToSave.length && regimensToSave.forEach(regimen => saveOrderSet(regimenToSave(regimen), regimen?.uuid));\n  }, [drugsList, editedRegimens, formatMessage, drugOrderType, regimens, saveOrderSet, validateEmptyFields]);\n\n  const onNoHandler = useCallback(() => setConfirmationModal(CLOSED_MODAL_CONFIGURATION), [setConfirmationModal]);\n  const onYesHandler = useCallback(() => {\n    switch (confirmationModal.type) {\n      case DELETE_REGIMEN_MODAL:\n        onRemoveRegimenHandler(regimenToDelete);\n        setRegimenToDelete(INITIAL_REGIMEN_VALUE);\n        break;\n      case DELETE_DRUG_MODAL:\n        onRemoveDrugHandler(drugToDelete);\n        setDrugToDelete(INITIAL_DRUG_VALUE);\n        break;\n    }\n    setConfirmationModal(CLOSED_MODAL_CONFIGURATION);\n  }, [\n    confirmationModal.type,\n    drugToDelete,\n    regimenToDelete,\n    onRemoveDrugHandler,\n    onRemoveRegimenHandler,\n    setConfirmationModal,\n    setDrugToDelete,\n    setRegimenToDelete\n  ]);\n\n  return (\n    <div id=\"manage-regimens\">\n      <ConfirmationModal\n        header={{ id: `manageRegimens.${confirmationModal.type}.header` }}\n        body={{ id: `manageRegimens.${confirmationModal.type}.body` }}\n        onYes={onYesHandler}\n        onNo={onNoHandler}\n        isOpen={confirmationModal.open}\n      />\n      <div className=\"title\">\n        <FormattedMessage id=\"manageRegimens.title\" tagName=\"h2\" />\n        {!isRegimensLoading && (\n          <Button\n            onClick={() => setIsAllSectionsExpanded(!isAllSectionsExpanded)}\n            className=\"cancel\"\n            data-testid=\"allSectionExpandedButton\"\n          >\n            <FormattedMessage id={`notificationTemplates.button.${isAllSectionsExpanded ? 'collapse' : 'expand'}`} />\n          </Button>\n        )}\n      </div>\n      {isRegimensLoading ? (\n        <div className=\"spinner\" data-testid=\"spinner\">\n          <Spinner />\n        </div>\n      ) : (\n        <>\n          <div className=\"section\">\n            {regimens.map((regimen, regimenIdx) => (\n              <Regimen\n                key={`${regimen.uuid}-${regimenIdx}`}\n                regimen={regimen}\n                regimenIdx={regimenIdx}\n                isAllSectionsExpanded={isAllSectionsExpanded}\n              />\n            ))}\n            <div className=\"d-flex justify-content-end mt-4 mb-2\">\n              <Button className=\"btn btn-primary\" onClick={onAddRegimenHandler} data-testid=\"addNewRegimenButton\">\n                <FormattedMessage id=\"manageRegimens.addNewRegimen\" />\n              </Button>\n            </div>\n          </div>\n          <div className=\"mt-5 pb-5\">\n            <div className=\"d-inline\">\n              <Button className=\"cancel\" onClick={onReturn} data-testid=\"returnButton\">\n                <FormattedMessage id=\"common.return\" />\n              </Button>\n            </div>\n            <div className=\"d-inline pull-right confirm-button-container\">\n              <Button className=\"save\" onClick={onSave} data-testid=\"saveButton\">\n                <FormattedMessage id=\"common.save\" />\n              </Button>\n            </div>\n          </div>\n        </>\n      )}\n    </div>\n  );\n};\n\nconst mapStateToProps = ({\n  manageRegimens: { regimens, editedRegimens, regimenToDelete, drugToDelete, confirmationModal },\n  orderSet: { loading: orderSetLoading, orderSet, success },\n  concept: {\n    loading: { concept: conceptDoseTypesLoading }\n  },\n  drugs: { loading: drugsLoading, drugsList },\n  orderFrequency: { loading: frequencyLoading },\n  orderType: { loading: orderTypeLoading, orderTypes },\n  settings: { settings = [], loading: settingsLoading }\n}: IStore) => {\n  const isRegimensLoading = [\n    orderSetLoading,\n    conceptDoseTypesLoading,\n    drugsLoading,\n    frequencyLoading,\n    orderTypeLoading,\n    settingsLoading\n  ].some(value => value);\n  return {\n    isRegimensLoading,\n    drugDosingUnitsConcept: settings.find(({ property }) => property === DRUG_DOSING_UNITS_SETTING_KEY),\n    settingsLoading,\n    orderSet,\n    drugsList,\n    success,\n    drugOrderType: orderTypes.find(({ javaClassName = EMPTY_STRING }) => javaClassName === DRUG_ORDER_TYPE_JAVA_CLASS_NAME),\n    regimens,\n    editedRegimens,\n    regimenToDelete,\n    drugToDelete,\n    confirmationModal\n  };\n};\n\nconst mapDispatchToProps = {\n  getOrderSet,\n  deleteOrderSet,\n  saveOrderSet,\n  deleteOrderSetMember,\n  getDrugsList,\n  getFrequencies,\n  getConcept,\n  getSettings,\n  getOrderType,\n  setRegimens,\n  setEditedRegimens,\n  setRegimenToDelete,\n  setDrugToDelete,\n  setConfirmationModal\n};\n\ntype StateProps = ReturnType<typeof mapStateToProps>;\ntype DispatchProps = typeof mapDispatchToProps;\n\nexport default connect(mapStateToProps, mapDispatchToProps)(injectIntl(ManageRegimens));\n","import { AnyAction } from 'redux';\nimport { DEFAULT_COLUMNS } from '../../shared/constants/columns-configuration';\nimport { IColumnConfiguration, IColumnsConfigurationState } from '../../shared/models/columns-configuration';\n\nconst ACTION_TYPES = {\n  SET_POSSIBLE_COLUMN_LIST: 'columns-configuration/SET_POSSIBLE_COLUMN_LIST',\n  SET_COLUMNS_CONFIGURATION: 'columns-configuration/SET_COLUMNS_CONFIGURATION'\n};\n\nconst initialState: IColumnsConfigurationState = {\n  allPossibleColumns: [],\n  columnsConfiguration: DEFAULT_COLUMNS\n};\n\nconst reducer = (state = initialState, action: AnyAction) => {\n  switch (action.type) {\n    case ACTION_TYPES.SET_POSSIBLE_COLUMN_LIST:\n      return {\n        ...state,\n        allPossibleColumns: action.data\n      };\n    case ACTION_TYPES.SET_COLUMNS_CONFIGURATION:\n      return {\n        ...state,\n        columnsConfiguration: action.data\n      };\n    default:\n      return state;\n  }\n};\n\nexport default reducer;\n\nexport const setAllPossibleColumns = (data: IColumnConfiguration[]) => ({\n  type: ACTION_TYPES.SET_POSSIBLE_COLUMN_LIST,\n  data\n});\nexport const setColumnsConfiguration = (data: IColumnConfiguration[]) => ({\n  type: ACTION_TYPES.SET_COLUMNS_CONFIGURATION,\n  data\n});\n","import React, { FormEvent, useCallback } from 'react';\nimport cx from 'classnames';\nimport { connect } from 'react-redux';\nimport { injectIntl, IntlShape } from 'react-intl';\nimport { cloneDeep, differenceWith, isEqual } from 'lodash';\nimport { SelectWithPlaceholder } from '../common/form/withPlaceholder';\nimport { PlusMinusButtons } from '../common/form/PlusMinusButtons';\nimport { extractEventValue, selectDefaultTheme } from '../../shared/util/form-util';\nimport { IColumnConfiguration } from '../../shared/models/columns-configuration';\nimport { setColumnsConfiguration } from '../../redux/reducers/columns-configuration';\nimport { DEFAULT_COLUMN_CONFIGURATION } from '../../shared/constants/columns-configuration';\nimport { swapPositions } from '../../shared/util/array-util';\nimport ValidationError from '../common/form/ValidationError';\n\ninterface IStore {\n  findPatientColumnsConfiguration: {\n    allPossibleColumns: IColumnConfiguration[];\n    columnsConfiguration: IColumnConfiguration[];\n  };\n}\n\nexport interface IColumnRowProps extends StateProps, DispatchProps {\n  intl: IntlShape;\n  column: IColumnConfiguration;\n  columnIdx: number;\n}\n\nexport const ColumnRow = ({\n  intl,\n  allPossibleColumns,\n  columnsConfiguration,\n  column,\n  columnIdx,\n  setColumnsConfiguration\n}: IColumnRowProps) => {\n  const { formatMessage } = intl;\n  const columnValue = column.value ? column : null;\n  const getOptions = useCallback(() => differenceWith(allPossibleColumns, columnsConfiguration, isEqual), [\n    allPossibleColumns,\n    columnsConfiguration\n  ]);\n\n  const onSwapPositionsHandler = (offset: number) => {\n    const clonedColumnsConfiguration = cloneDeep(columnsConfiguration);\n    const swappedColumnsPosition = swapPositions(clonedColumnsConfiguration, columnIdx, offset);\n\n    setColumnsConfiguration(swappedColumnsPosition);\n  };\n\n  const onChangeHandler = useCallback(\n    (event: FormEvent) => {\n      const clonedColumnsConfiguration = cloneDeep(columnsConfiguration);\n      const extractedValue = extractEventValue(event);\n\n      clonedColumnsConfiguration[columnIdx] = extractedValue;\n      clonedColumnsConfiguration[columnIdx].isValid = true;\n\n      setColumnsConfiguration(clonedColumnsConfiguration);\n    },\n    [columnIdx, columnsConfiguration, setColumnsConfiguration]\n  );\n\n  const addColumnHandler = useCallback(() => {\n    const clonedColumnsConfiguration = cloneDeep(columnsConfiguration);\n\n    clonedColumnsConfiguration.push(DEFAULT_COLUMN_CONFIGURATION);\n\n    setColumnsConfiguration(clonedColumnsConfiguration);\n  }, [columnsConfiguration, setColumnsConfiguration]);\n\n  const removeColumnHandler = useCallback(() => {\n    const clonedColumnsConfiguration = cloneDeep(columnsConfiguration);\n\n    clonedColumnsConfiguration.splice(columnIdx, 1);\n\n    if (!clonedColumnsConfiguration.length) {\n      clonedColumnsConfiguration.push(DEFAULT_COLUMN_CONFIGURATION);\n    }\n\n    setColumnsConfiguration(clonedColumnsConfiguration);\n  }, [columnIdx, columnsConfiguration, setColumnsConfiguration]);\n\n  return (\n    <>\n      <div className=\"column-row inline-fields\" data-testid=\"columnRow\">\n        <div className=\"d-flex flex-column order-icons\">\n          <span\n            className={cx('glyphicon glyphicon-chevron-up', { disabled: !columnIdx })}\n            title={formatMessage({ id: 'common.moveUp' })}\n            aria-hidden=\"true\"\n            onClick={() => onSwapPositionsHandler(-1)}\n            data-testid=\"moveUpButton\"\n          />\n          <span\n            className={cx('glyphicon glyphicon-chevron-down', { disabled: columnIdx === columnsConfiguration.length - 1 })}\n            title={formatMessage({ id: 'common.moveDown' })}\n            aria-hidden=\"true\"\n            onClick={() => onSwapPositionsHandler(1)}\n            data-testid=\"moveDownButton\"\n          />\n        </div>\n        <SelectWithPlaceholder\n          placeholder={formatMessage({ id: 'findPatientColumnsConfiguration.columnName' })}\n          showPlaceholder={!!columnValue}\n          value={columnValue}\n          onChange={onChangeHandler}\n          options={getOptions()}\n          wrapperClassName={cx({ invalid: !columnValue && !column.isValid })}\n          classNamePrefix=\"default-select\"\n          theme={selectDefaultTheme}\n          data-testid=\"columnSelect\"\n        />\n        <PlusMinusButtons\n          intl={intl}\n          onPlusClick={addColumnHandler}\n          onMinusClick={removeColumnHandler}\n          isPlusButtonVisible={columnIdx === columnsConfiguration.length - 1}\n        />\n      </div>\n      {!columnValue && !column.isValid && <ValidationError message={'findPatientColumnsConfiguration.emptyColumnsConfiguration'} />}\n    </>\n  );\n};\n\nconst mapStateToProps = ({ findPatientColumnsConfiguration: { allPossibleColumns, columnsConfiguration } }: IStore) => ({\n  allPossibleColumns,\n  columnsConfiguration\n});\n\nconst mapDispatchToProps = {\n  setColumnsConfiguration\n};\n\ntype StateProps = ReturnType<typeof mapStateToProps>;\ntype DispatchProps = typeof mapDispatchToProps;\n\nexport default connect(mapStateToProps, mapDispatchToProps)(injectIntl(ColumnRow));\n","import React, { useCallback, useEffect, useState } from 'react';\nimport ColumnRow from './ColumnRow';\nimport { connect } from 'react-redux';\nimport { FormattedMessage, injectIntl, IntlShape } from 'react-intl';\nimport { Button, Spinner } from 'reactstrap';\nimport { uniqWith, isEqual, cloneDeep } from 'lodash';\nimport { setAllPossibleColumns, setColumnsConfiguration } from '../../redux/reducers/columns-configuration';\nimport { createSetting, getSettingByQuery, updateSetting } from '../../redux/reducers/setttings';\nimport { IRegistrationStep } from '../../shared/models/registration-steps';\nimport {\n  ADJACENT_LOWER_AND_UPPER_LETTERS_REGEX,\n  COLUMNS_CONFIGURATION_SETTING_KEY,\n  FIRST_COLUMN_NAME_LETTERS_REGEX,\n  FIXED_COLUMNS,\n  RETURN_LOCATION\n} from '../../shared/constants/columns-configuration';\nimport { IColumnConfiguration } from '../../shared/models/columns-configuration';\nimport { EMPTY_STRING } from '../../shared/constants/input';\nimport { ConfirmationModal } from '../common/form/ConfirmationModal';\nimport { successToast, errorToast } from '@bit/soldevelo-omrs.cfl-components.toast-handler';\nimport '../Inputs.scss';\nimport './FindPatientColumnsConfiguration.scss';\n\ninterface IStore {\n  apps: {\n    loading: boolean;\n    patientRegistrationSteps: IRegistrationStep[];\n  };\n  findPatientColumnsConfiguration: {\n    columnsConfiguration: IColumnConfiguration[];\n  };\n  settings: {\n    success: boolean;\n    isSettingExist: { value: boolean };\n    setting: {\n      uuid: string;\n      value: string;\n    } | null;\n  };\n}\n\ninterface IFindPatientColumnsConfigurationProps extends StateProps, DispatchProps {\n  intl: IntlShape;\n}\n\nconst FindPatientColumnsConfiguration = ({\n  intl: { formatMessage },\n  isAppLoading,\n  patientRegistrationSteps,\n  columnsConfiguration,\n  isSettingExist,\n  settingUuid,\n  settingValue,\n  settingsSaved,\n  setAllPossibleColumns,\n  setColumnsConfiguration,\n  getSettingByQuery,\n  createSetting,\n  updateSetting\n}: IFindPatientColumnsConfigurationProps) => {\n  useEffect(() => {\n    getSettingByQuery(COLUMNS_CONFIGURATION_SETTING_KEY);\n  }, [getSettingByQuery]);\n  useEffect(() => {\n    settingValue && setColumnsConfiguration(JSON.parse(settingValue));\n  }, [setColumnsConfiguration, settingValue]);\n  useEffect(() => {\n    settingsSaved && successToast(formatMessage({ id: 'findPatientColumnsConfiguration.configurationSaved' }));\n  }, [formatMessage, settingsSaved]);\n  useEffect(() => {\n    if (patientRegistrationSteps) {\n      const columns = [...FIXED_COLUMNS];\n\n      patientRegistrationSteps.map(({ fields }) =>\n        fields.forEach(({ name: fieldName }) => {\n          if (fieldName) {\n            const capitalizedFirstColumnNameLetter = fieldName.replace(\n              FIRST_COLUMN_NAME_LETTERS_REGEX,\n              str => str.charAt(0).toUpperCase() + str.substring(1)\n            );\n            const name = capitalizedFirstColumnNameLetter.replace(ADJACENT_LOWER_AND_UPPER_LETTERS_REGEX, '$1 $2');\n\n            columns.push({ label: name, value: fieldName });\n          }\n        })\n      );\n\n      setAllPossibleColumns(uniqWith(columns, isEqual));\n    }\n  }, [patientRegistrationSteps, setAllPossibleColumns]);\n\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const onReturnHandler = useCallback(() => (window.location.href = RETURN_LOCATION), []);\n  const onSaveHandler = useCallback(() => setIsModalOpen(true), []);\n  const markConfigurationAsInvalid = useCallback(() => {\n    const clonedColumnsConfiguration = cloneDeep(columnsConfiguration);\n\n    clonedColumnsConfiguration[0].isValid = false;\n\n    errorToast(formatMessage({ id: 'findPatientColumnsConfiguration.configurationNotSaved' }));\n    setColumnsConfiguration(clonedColumnsConfiguration);\n    setIsModalOpen(false);\n  }, [columnsConfiguration, formatMessage, setColumnsConfiguration]);\n  const onNoHandler = useCallback(() => setIsModalOpen(false), []);\n  const onYesHandler = useCallback(() => {\n    const omittedEmptyColumnsConfiguration = columnsConfiguration.filter(({ value }) => value);\n\n    if (!omittedEmptyColumnsConfiguration.length) {\n      return markConfigurationAsInvalid();\n    }\n\n    const config = omittedEmptyColumnsConfiguration.map(column => ({ label: column.label, value: column.value }));\n    const configJson = JSON.stringify(config);\n\n    if (isSettingExist) {\n      updateSetting({ uuid: settingUuid, value: configJson });\n    } else {\n      createSetting(COLUMNS_CONFIGURATION_SETTING_KEY, configJson);\n    }\n\n    setIsModalOpen(false);\n  }, [columnsConfiguration, createSetting, isSettingExist, settingUuid, updateSetting, markConfigurationAsInvalid]);\n\n  return (\n    <div id=\"find-patient-columns-configuration\" data-testid=\"findPatientColumnsConfiguration\">\n      <ConfirmationModal\n        header={{ id: 'findPatientColumnsConfiguration.modal.header' }}\n        body={{ id: 'findPatientColumnsConfiguration.modal.body' }}\n        onYes={onYesHandler}\n        onNo={onNoHandler}\n        isOpen={isModalOpen}\n      />\n      <div className=\"title\">\n        <FormattedMessage id=\"findPatientColumnsConfiguration.title\" tagName=\"h2\" />\n      </div>\n      {isAppLoading ? (\n        <div className=\"spinner\" data-testid=\"spinner\">\n          <Spinner />\n        </div>\n      ) : (\n        <>\n          <div className=\"section\">\n            <div className=\"title\">\n              <FormattedMessage id=\"findPatientColumnsConfiguration.configureColumns\" tagName=\"h4\" />\n            </div>\n            <div className=\"columns\">\n              {columnsConfiguration.map((column, idx) => (\n                <ColumnRow key={`${column.value}-${idx}`} column={column} columnIdx={idx} />\n              ))}\n            </div>\n          </div>\n          <div className=\"mt-5 pb-5\">\n            <div className=\"d-inline\">\n              <Button className=\"cancel\" onClick={onReturnHandler} data-testid=\"returnButton\">\n                <FormattedMessage id=\"common.return\" />\n              </Button>\n            </div>\n            <div className=\"d-inline pull-right confirm-button-container\">\n              <Button className=\"save\" onClick={onSaveHandler} data-testid=\"saveButton\">\n                <FormattedMessage id=\"common.save\" />\n              </Button>\n            </div>\n          </div>\n        </>\n      )}\n    </div>\n  );\n};\n\nconst mapStateToProps = ({\n  apps: { loading: isAppLoading, patientRegistrationSteps },\n  findPatientColumnsConfiguration: { columnsConfiguration },\n  settings: {\n    success: settingsSaved,\n    isSettingExist: { value: isSettingExist },\n    setting\n  }\n}: IStore) => ({\n  isAppLoading,\n  settingsSaved,\n  patientRegistrationSteps,\n  columnsConfiguration,\n  isSettingExist,\n  settingUuid: setting?.uuid ?? EMPTY_STRING,\n  settingValue: setting?.value ?? EMPTY_STRING\n});\n\nconst mapDispatchToProps = {\n  setAllPossibleColumns,\n  setColumnsConfiguration,\n  getSettingByQuery,\n  createSetting,\n  updateSetting\n};\n\ntype StateProps = ReturnType<typeof mapStateToProps>;\ntype DispatchProps = typeof mapDispatchToProps;\n\nexport default connect(mapStateToProps, mapDispatchToProps)(injectIntl(FindPatientColumnsConfiguration));\n","import Condition from '../../components/conditions/Condition';\nimport FindPatient from '../../components/find-patient/FindPatient';\nimport { PRIVILEGES } from './privilege';\nimport FindCaregiver from '../../components/find-caregiver/FindCaregiver';\nimport RegisterPatient from '../../components/register/RegisterPatient';\nimport RegisterCaregiver from '../../components/register/RegisterCaregiver';\nimport Dashboard from '../../components/dashboard/Dashboard';\nimport Conditions from '../../components/conditions/Conditions';\nimport VmpConfig from '../../components/vmp-config/VmpConfig';\nimport VmpVaccinationSchedule from '../../components/vmp-vaccination-schedule/VmpVaccinationSchedule';\nimport AddressData from '../../components/address-data/AddressData';\nimport VmpTranslations from '../../components/vmp-translations/VmpTranslations';\nimport NotificationConfiguration from '../../components/notification-configuration/NotificationConfiguration';\nimport NotificationTemplates from '../../components/notification-templates/NotificationTemplates';\nimport Location from '../../components/locations/Location';\nimport UserAccount from '../../components/user-account/UserAccount';\nimport ManageRegimens from '../../components/manage-regimens/ManageRegimens';\nimport FindPatientColumnsConfiguration from '../../components/find-patient-columns-configuration/FindPatientColumnsConfiguration';\n\nexport const routeConfig = [\n  {\n    path: '/patient-record-columns-configuration',\n    component: FindPatientColumnsConfiguration,\n    breadcrumb: 'findPatientColumnsConfiguration.title'\n  },\n  {\n    path: '/regimens',\n    component: ManageRegimens,\n    breadcrumb: 'manageRegimens.title'\n  },\n  {\n    path: '/locations/edit-location/:locationId',\n    component: Location,\n    breadcrumb: 'locations.location.edit.title'\n  },\n  {\n    path: '/locations/create-location',\n    component: Location,\n    breadcrumb: 'locations.location.create.title'\n  },\n  {\n    path: '/user-account',\n    component: UserAccount,\n    breadcrumb: 'userAccount.title'\n  },\n  {\n    path: '/conditions/:patientUuid/manage',\n    component: Condition,\n    breadcrumb: 'manageCondition.title'\n  },\n  {\n    path: '/conditions/:patientUuid',\n    component: Conditions,\n    breadcrumb: 'conditions.title'\n  },\n  {\n    path: '/vmp-config',\n    component: VmpConfig,\n    breadcrumb: 'vmpConfig.title'\n  },\n  {\n    path: '/vmp-vaccination-schedule',\n    component: VmpVaccinationSchedule,\n    breadcrumb: 'vmpVaccinationSchedule.title'\n  },\n  {\n    path: '/address-data',\n    component: AddressData,\n    breadcrumb: 'addressData.title'\n  },\n  {\n    path: '/vmp-translations',\n    component: VmpTranslations,\n    breadcrumb: 'vmpTranslations.title'\n  },\n  {\n    path: '/notification-configuration',\n    component: NotificationConfiguration,\n    breadcrumb: 'notificationConfiguration.title'\n  },\n  {\n    path: '/notification-templates',\n    component: NotificationTemplates,\n    breadcrumb: 'notificationTemplates.title'\n  },\n  {\n    path: '/find-patient',\n    component: FindPatient,\n    breadcrumb: 'findPatient.title',\n    requiredPrivilege: PRIVILEGES.GET_PATIENTS\n  },\n  {\n    path: '/find-caregiver',\n    component: FindCaregiver,\n    breadcrumb: 'findCaregiver.title',\n    requiredPrivilege: PRIVILEGES.GET_PEOPLE\n  },\n  {\n    path: '/register-patient',\n    component: RegisterPatient,\n    breadcrumb: 'registerPatient.title',\n    requiredPrivilege: PRIVILEGES.ADD_PATIENTS\n  },\n  {\n    path: '/edit-patient/:id',\n    component: RegisterPatient,\n    breadcrumb: 'editPatient.title',\n    requiredPrivilege: PRIVILEGES.EDIT_PATIENTS\n  },\n  {\n    path: '/register-caregiver',\n    component: RegisterCaregiver,\n    breadcrumb: 'registerCaregiver.title',\n    requiredPrivilege: PRIVILEGES.ADD_PATIENTS\n  },\n  {\n    path: '/edit-caregiver/:id',\n    component: RegisterCaregiver,\n    breadcrumb: 'editCaregiver.title',\n    requiredPrivilege: PRIVILEGES.EDIT_PATIENTS\n  },\n  {\n    path: '/',\n    component: Dashboard,\n    breadcrumb: 'home.title'\n  }\n];\n","import React from 'react';\nimport { RouteComponentProps, withRouter } from 'react-router-dom';\nimport withBreadcrumbs from 'react-router-breadcrumbs-hoc';\nimport './Breadcrumbs.scss';\nimport { FormattedMessage } from 'react-intl';\nimport { nameParamVal, redirectUrl } from '../../shared/util/url-util';\nimport { ROOT_URL } from '../../shared/constants/openmrs';\nimport { connect } from 'react-redux';\nimport { routeConfig } from '../../shared/constants/routes';\nimport { IBreadcrumb } from '../../shared/models/breadcrumb';\n\nconst separator = (showArrows = true) => <span className=\"separator\">{showArrows && '>>'}</span>;\n\nexport interface IBreadcrumbsProps extends StateProps, DispatchProps, RouteComponentProps {\n  breadcrumbs: any[];\n}\n\nclass Breadcrumbs extends React.Component<IBreadcrumbsProps> {\n  routeBreadcrumbs = () => {\n    const breadcrumbs = this.props.breadcrumbs;\n    return breadcrumbs\n      .map(({ match, key, breadcrumb }, i) => {\n        const id = breadcrumb && breadcrumb['props'] && breadcrumb['props'].children;\n        const breadcrumbDef = { labelId: id, order: i, url: `#${match.url}` } as IBreadcrumb;\n        if (i === 0) {\n          breadcrumbDef.url = ROOT_URL;\n        }\n        if (id.indexOf('.') !== -1) {\n          return breadcrumbDef;\n        }\n        return null;\n      })\n      .filter(breadcrumb => !!breadcrumb);\n  };\n\n  render() {\n    let breadcrumbs = this.routeBreadcrumbs();\n    const urlParam = redirectUrl(this.props.location.search);\n    const nameParam = nameParamVal(this.props.location.search);\n    if (urlParam && nameParam) {\n      breadcrumbs.push({\n        url: urlParam,\n        label: nameParam,\n        order: 1\n      });\n    }\n    breadcrumbs = breadcrumbs.concat(this.props.additionalBreadcrumbs).sort((b1, b2) => b1.order - b2.order);\n    return (\n      <div className=\"breadcrumbs\">\n        {breadcrumbs.map(({ url, labelId, label }, i) => (\n          <>\n            {i === breadcrumbs.length - 1 ? (\n              <span>{label || <FormattedMessage id={labelId} />}</span>\n            ) : (\n              <a href={url}>{label || <FormattedMessage id={labelId} />}</a>\n            )}\n            {separator(i !== breadcrumbs.length - 1)}\n          </>\n        ))}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = ({ breadcrumbs }) => ({\n  additionalBreadcrumbs: breadcrumbs.additionalBreadcrumbs\n});\n\nconst mapDispatchToProps = {};\n\ntype StateProps = ReturnType<typeof mapStateToProps>;\ntype DispatchProps = typeof mapDispatchToProps;\n\nexport default connect(mapStateToProps, mapDispatchToProps)(withBreadcrumbs(routeConfig)(withRouter(Breadcrumbs)));\n","import React from 'react';\nimport './Header.scss';\nimport { Header as OpenMRSHeader } from '@openmrs/react-components';\n\nconst Header = () => <OpenMRSHeader />;\n\nexport default Header;\n","import React from 'react';\n\nclass ErrorBoundary extends React.Component {\n  state = {\n    hasError: false\n  };\n\n  static getDerivedStateFromError(error) {\n    return { hasError: true };\n  }\n\n  render() {\n    if (this.state.hasError) {\n      // fallback\n      return <h1>Something went wrong.</h1>;\n    }\n\n    return this.props.children;\n  }\n}\n\nexport default ErrorBoundary;\n","import React from 'react';\nimport './Unauthorized.scss';\n\nconst Unauthorized = () => (\n  <div className=\"page-container unauthorized\">\n    <div className=\"page danger\">\n      <div className=\"page-content\">\n        <span className=\"toast-item-image toast-item-image-alert\" />\n        <div className=\"message\">\n          <span>You are not authorized to see this page.</span>\n        </div>\n      </div>\n    </div>\n  </div>\n);\n\nexport default Unauthorized;\n","import React from 'react';\nimport { HashRouter as Router, Route, Switch } from 'react-router-dom';\nimport Breadcrumbs from './common/Breadcrumbs';\nimport _ from 'lodash';\nimport Header from './common/Header';\nimport ErrorBoundary from './common/ErrorBoundary';\nimport { connect } from 'react-redux';\nimport Unauthorized from './common/Unauthorized';\nimport { Spinner } from 'reactstrap';\nimport Customize from '@bit/soldevelo-cfl.omrs-components.customize';\nimport { routeConfig } from '../shared/constants/routes';\n\nexport interface IRoutesProps extends StateProps, DispatchProps {}\n\nclass Routes extends React.Component<IRoutesProps> {\n  renderComponent = route => {\n    const { authenticated, privileges, loading } = this.props;\n    if (route.requiredPrivilege) {\n      if (loading) {\n        return <Spinner />;\n      } else if (!authenticated || !privileges.includes(route.requiredPrivilege)) {\n        return <Unauthorized />;\n      }\n    }\n    const Component = route.component;\n    return <Component {...this.props} />;\n  };\n\n  render = () => (\n    <Router>\n      <Customize />\n      <Header />\n      <div className=\"content\">\n        <Breadcrumbs />\n        <ErrorBoundary>\n          <Switch>\n            {_.map(routeConfig, route => (\n              <Route path={route.path} key={route.path}>\n                {this.renderComponent(route)}\n              </Route>\n            ))}\n          </Switch>\n        </ErrorBoundary>\n      </div>\n    </Router>\n  );\n}\n\nconst mapStateToProps = ({ session }) => ({\n  authenticated: session.authenticated,\n  loading: session.loading,\n  privileges: session.privileges\n});\n\nconst mapDispatchToProps = {};\n\ntype StateProps = ReturnType<typeof mapStateToProps>;\ntype DispatchProps = typeof mapDispatchToProps;\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Routes);\n","import axios from 'axios';\n\nimport { FAILURE, REQUEST, SUCCESS } from '../action-type.util';\n\nexport const ACTION_TYPES = {\n  GET_SESSION: 'session/GET_SESSION',\n  GET_LOGIN_LOCATIONS: 'session/GET_LOGIN_LOCATIONS',\n  SET_LOGIN_LOCATION: 'session/SET_LOGIN_LOCATION',\n  RESET_SESSION: 'session/RESET_SESSION'\n};\n\nconst initialState = {\n  loading: false,\n  errorMessage: null,\n  session: null,\n  loginLocations: [],\n  authenticated: false,\n  privileges: []\n};\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case REQUEST(ACTION_TYPES.GET_SESSION):\n    case REQUEST(ACTION_TYPES.GET_LOGIN_LOCATIONS):\n    case REQUEST(ACTION_TYPES.SET_LOGIN_LOCATION):\n      return {\n        ...state,\n        loading: true\n      };\n    case FAILURE(ACTION_TYPES.GET_SESSION):\n      return {\n        ...initialState,\n        errorMessage: action.payload.message\n      };\n    case FAILURE(ACTION_TYPES.GET_LOGIN_LOCATIONS):\n    case FAILURE(ACTION_TYPES.SET_LOGIN_LOCATION):\n      return {\n        ...state,\n        errorMessage: action.payload.message\n      };\n    case SUCCESS(ACTION_TYPES.GET_SESSION):\n      const authenticated = action.payload.data.authenticated;\n      return {\n        ...initialState,\n        authenticated,\n        privileges: authenticated ? action.payload.data.user.privileges.map((p: any) => (p.name ? p.name : p.display)) : [],\n        session: action.payload.data\n      };\n    case SUCCESS(ACTION_TYPES.GET_LOGIN_LOCATIONS):\n      return {\n        ...state,\n        loginLocations: action.payload.data,\n        loading: false,\n        errorMessage: null\n      };\n    case SUCCESS(ACTION_TYPES.SET_LOGIN_LOCATION):\n      return {\n        ...state,\n        loading: false,\n        errorMessage: null\n      };\n    case ACTION_TYPES.RESET_SESSION:\n      return {\n        ...initialState\n      };\n    default:\n      return state;\n  }\n};\n\n// actions\nexport const getSession = () => {\n  const requestUrl = `/openmrs/ws/rest/v1/appui/session`;\n  return {\n    type: ACTION_TYPES.GET_SESSION,\n    payload: axios.get(requestUrl)\n  };\n};\n\nexport const getLoginLocations = () => {\n  const requestUrl = `/openmrs/appui/session/getLoginLocations.action`;\n  return {\n    type: ACTION_TYPES.GET_LOGIN_LOCATIONS,\n    payload: axios.get(requestUrl)\n  };\n};\n\nexport const setLoginLocation = locationId => {\n  const requestUrl = `/openmrs/appui/session/setLocation.action?locationId=${locationId}`;\n  return {\n    type: ACTION_TYPES.SET_LOGIN_LOCATION,\n    payload: axios.post(requestUrl)\n  };\n};\n\nexport const reset = () => ({\n  type: ACTION_TYPES.RESET_SESSION\n});\n\nexport default reducer;\n","export const getAppConfig = (apps, appName) => {\n  const app = getApp(apps, appName);\n  return app && app.config;\n};\n\nexport const getApp = (apps, uuid) => apps && apps.find(app => app.uuid === uuid);\n","export const APP_PREFIX = 'cflui.';\nexport const FIND_PATIENT_APP = APP_PREFIX + 'findPatient';\nexport const FIND_CAREGIVER_APP = APP_PREFIX + 'findCaregiver';\nexport const REGISTER_PATIENT_APP = APP_PREFIX + 'registerPatient';\nexport const REGISTER_CAREGIVER_APP = APP_PREFIX + 'registerCaregiver';\nexport const CONFIGURE_METADATA_APPS = APP_PREFIX + 'configureMetadataApps';\n","import axios from 'axios';\n\nimport { FAILURE, REQUEST, SUCCESS } from '../action-type.util';\nimport { getAppConfig } from '../../shared/util/app-util';\nimport {\n  FIND_CAREGIVER_APP,\n  FIND_PATIENT_APP,\n  REGISTER_CAREGIVER_APP,\n  REGISTER_PATIENT_APP,\n  CONFIGURE_METADATA_APPS\n} from '../../shared/constants/app';\n\nexport const ACTION_TYPES = {\n  GET_APPS: 'settings/GET_APPS'\n};\n\nconst initialState = {\n  loading: false,\n  errorMessage: null,\n  apps: [],\n  findPatientTableColumns: null,\n  findCaregiverTableColumns: null,\n  patientRegistrationSteps: null,\n  caregiverRegistrationSteps: null,\n  vmpSyncScopes: null,\n  vmpAuthSteps: null,\n  vmpDosingVisitTypes: null,\n  vmpRegimenUpdatePermitted: null\n};\n\nexport const getAppsState = apps => ({\n  apps,\n  findPatientTableColumns: getAppConfig(apps, FIND_PATIENT_APP)?.tableColumns,\n  findCaregiverTableColumns: getAppConfig(apps, FIND_CAREGIVER_APP)?.tableColumns,\n  patientRegistrationSteps: getAppConfig(apps, REGISTER_PATIENT_APP)?.steps,\n  caregiverRegistrationSteps: getAppConfig(apps, REGISTER_CAREGIVER_APP)?.steps,\n  vmpSyncScopes: getAppConfig(apps, CONFIGURE_METADATA_APPS)?.syncScopes,\n  vmpAuthSteps: getAppConfig(apps, CONFIGURE_METADATA_APPS)?.authSteps,\n  vmpDosingVisitTypes: getAppConfig(apps, CONFIGURE_METADATA_APPS)?.dosingVisitTypes,\n  vmpRegimenUpdatePermitted: getAppConfig(apps, CONFIGURE_METADATA_APPS)?.regimenUpdatePermitted\n});\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case REQUEST(ACTION_TYPES.GET_APPS):\n      return {\n        ...state,\n        loading: true,\n        errorMessage: null\n      };\n    case FAILURE(ACTION_TYPES.GET_APPS):\n      return {\n        ...state,\n        loading: false,\n        errorMessage: action.payload.message\n      };\n    case SUCCESS(ACTION_TYPES.GET_APPS):\n      return {\n        ...initialState,\n        ...getAppsState(action.payload.data.results)\n      };\n    default:\n      return state;\n  }\n};\n\n// actions\nexport const getApps = () => {\n  const requestUrl = `/openmrs/ws/rest/v1/app?v=default`;\n  return {\n    type: ACTION_TYPES.GET_APPS,\n    payload: axios.get(requestUrl)\n  };\n};\n\nexport default reducer;\n","import React from 'react';\nimport './App.scss';\nimport Routes from './Routes';\nimport { connect } from 'react-redux';\nimport { getSession } from '../redux/reducers/session';\nimport { TinyButton as ScrollUpButton } from 'react-scroll-up-button';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport 'bootstrap-3/dist/css/bootstrap.min.css';\nimport 'bootstrap-icons/font/bootstrap-icons.css';\nimport '../assets/css/font-awesome-3.0.2.min.css';\nimport { getApps } from '../redux/reducers/apps';\nimport '@openmrs/style-referenceapplication/lib/referenceapplication.css';\nimport { toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\n\ntoast.configure();\n\nexport interface IAppProps extends StateProps, DispatchProps {}\n\nclass App extends React.Component<IAppProps> {\n  componentDidMount() {\n    this.props.getSession();\n    this.props.getApps();\n  }\n\n  render() {\n    return (\n      <div id=\"app\" className=\"app\">\n        <Routes />\n        <ScrollUpButton />\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = ({ session }) => ({\n  session: session.session\n});\n\nconst mapDispatchToProps = { getSession, getApps };\n\ntype StateProps = ReturnType<typeof mapStateToProps>;\ntype DispatchProps = typeof mapDispatchToProps;\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import { combineReducers } from 'redux';\nimport cflPatient from './patient';\nimport cflPerson from './person';\nimport cflPeople from './cfl-people';\nimport session from './session';\nimport settings from './setttings';\nimport location from './location';\nimport relationshipType from './relationship-type';\nimport registration from './registration';\nimport { reducers as openmrsReducers } from '@openmrs/react-components';\nimport { reducer as reduxFormReducer } from 'redux-form';\nimport customizeReducer from '@bit/soldevelo-cfl.omrs-components.customize/customize.reducer';\nimport person from '@bit/soldevelo-omrs.cfl-components.person-header/person-header/person.reducer';\nimport patient from '@bit/soldevelo-omrs.cfl-components.person-header/person-header/patient.reducer';\nimport personStatus from '@bit/soldevelo-cfl.omrs-components.person-status/person-status/person-status.reducer';\nimport apps from './apps';\nimport concept from './concept';\nimport condition from './condition';\nimport breadcrumbs from './breadcrumbs';\nimport visit from './visit';\nimport addressData from './address-data';\nimport provider from './provider';\nimport messages from './messages';\nimport role from './role';\nimport user from './user';\nimport manageRegimens from './manage-regimens';\nimport orderSet from './order-set';\nimport drugs from './drugs';\nimport orderFrequency from './order-frequency';\nimport orderType from './order-type';\nimport findPatientColumnsConfiguration from './columns-configuration';\n\nexport default combineReducers({\n  cflPatient,\n  cflPerson,\n  cflPeople,\n  session,\n  settings,\n  location,\n  relationshipType,\n  registration,\n  apps,\n  concept,\n  condition,\n  breadcrumbs,\n  person,\n  patient,\n  personStatus,\n  role,\n  user,\n  customizeReducer,\n  visit,\n  addressData,\n  provider,\n  messages,\n  manageRegimens,\n  orderSet,\n  drugs,\n  orderFrequency,\n  orderType,\n  findPatientColumnsConfiguration,\n  openmrs: openmrsReducers,\n  form: reduxFormReducer\n});\n","import { applyMiddleware, compose, createStore } from 'redux';\nimport promiseMiddleware from 'redux-promise-middleware';\nimport thunkMiddleware from 'redux-thunk';\nimport rootReducer from './reducers';\nimport createSagaMiddleware from 'redux-saga';\nimport { sagas as openmrsSagas } from '@openmrs/react-components';\n\nconst sagaMiddleware = createSagaMiddleware();\n\nconst defaultMiddlewares = [thunkMiddleware, promiseMiddleware, sagaMiddleware];\n\nconst composedMiddlewares = middlewares => compose(applyMiddleware(...defaultMiddlewares, ...middlewares));\n\nconst initialize = (initialState?, middlewares = []) => {\n  const store = createStore(rootReducer, initialState, composedMiddlewares(middlewares));\n  sagaMiddleware.run(openmrsSagas);\n  return store;\n};\n\nexport default initialize;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './components/App';\nimport reportWebVitals from './reportWebVitals';\nimport { Provider } from 'react-redux';\nimport initStore from './redux/store';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport { IntlProvider } from 'react-intl';\nimport en from './lang/en.json';\nimport flatten from 'flat';\n\nconst store = initStore();\nconst messages = flatten(en);\nconst locale = 'en';\n\n// @ts-ignore\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <IntlProvider locale={locale} messages={messages}>\n        <App />\n      </IntlProvider>\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}