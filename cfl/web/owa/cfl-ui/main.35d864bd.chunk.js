(this["webpackJsonpcfl-ui"]=this["webpackJsonpcfl-ui"]||[]).push([[0],{1006:function(e){e.exports=JSON.parse('{"home":{"title":"Home"},"table":{"enterSearch":"For the search results to appear, enter at least 3 characters.","noRecords":"No records.","recordsFound":"records found."},"dashboard":{"findPatient":"Find Patient Record","registerPatient":"CFL Register Patient","findCaregiver":"Find Caregiver Record"},"findPatient":{"title":"Find Patient Record","searchInputPlaceholder":"Search by Id, name or phone number"},"findCaregiver":{"title":"Find Caregiver Record","searchInputPlaceholder":"Search by Id, name or phone number"},"dropzone":{"openFileDialog":"Open File Dialog","acceptedFile":"Accepted File:","rejectedFile":"Rejected File:"},"vmpConfig":{"title":"Manage Configuration","syncScope":"Sync Scope","syncScopeTooltip":"Defines if the tablet will sync data for the specific site or the whole country (depends on the size of the study).","operatorCredentialsOfflineRetentionTime":"Operator Credentials Offline Retention Time","operatorCredentialsOfflineRetentionTimeTooltip":"Duration for which the operator credentials will be stored on the local tablet while offline. Once this expires, the operator needs to be online to log in again.","operatorSessionTimeout":"Operator Session Timeout","operatorSessionTimeoutTooltip":"Duration for which an operator session is active. After this time, the operator is requested to log in again.","manufacturers":"Manufacturers","manufacturersTooltip":"Vaccine manufacturers. A regular expression may be defined for the vial barcode format. If a scanned vial barcode matches this regular expression, this manufacturer will be pre-selected in the app.","vaccine":"Regimen","regimenTooltip":"Dosing regimens that participants can follow. The expected manufacturer for each dose should be listed. All regimens must be configured on the Manage Vaccination Schedule page.","canUseDifferentManufacturers":"Overruling Prescribed Manufacturer","canUseDifferentManufacturersTooltip":"Indicate whether the operator is allowed to administer a vaccine from a different manufacturer than is specified in the regimen.","personLanguages":"Languages","personLanguagesTooltip":"Possible languages in which participants can receive their messages from the application.","authSteps":"Identification Steps","authStepsTooltip":"Methods used to identify the participants. Order can be changed, as well as whether the step is mandatory for all participants.","irisScore":"Iris Quality Threshold Score","irisScoreTooltip":"Minimum iris quality (in percent) to accept when performing an iris scan. Operator will be asked to rescan the iris if below this quality.","addressFields":"Address Fields","addressFieldsTooltip":"For each country, define which address fields should be shown in the app, as well as what they should be displayed as. E.g.: Address 1, display as \'Street\'.","allowManualParticipantIDEntry":"Manual Participant ID Entry","allowManualParticipantIDEntryTooltip":"Indicate whether the operator is allowed to manually enter a participant ID.","enableBiometricOnlySearchWithoutPhone":"Enable Biometric Only Search Without Phone","enableBiometricOnlySearchWithoutPhoneTooltip":"If enabled and only biometric identification criteria are specified, local biometric search will only be done for participants without a phone number. If disabled, the local biometric search for only biometric identification criteria will done for all participants.","participantIDRegex":"Participant ID Regex","manufacturersName":"Name","barcodeRegex":"Barcode Regex","regimenName":"Name","mandatoryField":"Mandatory","authStepType":"Type","country":"Country","addressField":"Field","addressName":"Name","days":"Days","minutes":"Minutes","regimen":"Regimen","addNewCountry":"Add new Country","delete":"Delete","success":"Configuration saved successfully!","addNew":"Add new","error":{"header":"Error","configurationInvalid":"Some fields are not entered correctly. Please check the configuration.","nameRequired":"Name is a mandatory field","nameDuplicate":"Name already exists","manufacturerAssigned":"To delete this manufacturer, please first remove it from the defined regimen.","regimenLinked":"This regimen is already in use and cannot be removed.","barcodeRegexInvalid":"Invalid Barcode Regex","regimenManufacturersEmpty":"At least one manufacturer for each dose should be listed"},"warning":{"header":"Warning","deleteManufacturer":"Are you sure you want to delete this manufacturer?","deleteRegimen":"Are you sure you want to delete this regimen?"}},"vmpVaccinationSchedule":{"title":"Manage Vaccination Schedule","regimen":"Regimen Name","visitType":"Visit Type","midPointWindow":"Days from Last Dose","doseNumber":"Dose","lowWindow":"Before","upWindow":"After","addNew":"Add new","addRegimenConfig":"Add new Regimen","delete":"Delete","dosesCountValidationError":"Please configure all dosing visits.","dosesTooltip":"Dosing that is configured for selected regimen","success":"Configuration saved successfully!","submit":{"header":"Submit Vaccination Schedule","body":{"regimenAllConfigured":"Are you sure you want to submit Vaccination Schedule?","regimenPartlyConfigured":"You have configured {configuredRegimen} out of {allRegimen} Regimens.{br}Are you sure you want to submit Vaccination Schedule?"}},"deleteRegimenConfig":{"header":"Delete Regimen","body":"Are you sure you want to delete `{regimenName}`?"},"changeRegimen":{"header":"Change Regimen","body":"Changing the Regimen will affect current configuration.{br}Do you want to proceed?"}},"addressData":{"title":"Manage Address Data","upload":{"title":"Upload Address Data","instruction1":"Please upload file in <b>.csv</b> or <b>.txt</b> format. The file should contain <b>comma delimiter</b>.","instruction2":"Download file samples here:","overwriteAddressData":{"true":{"radioLabel":"Overwrite existing address data","modalHeader":"Overwriting existing data","modalBody":"Are you sure you want to overwrite existing data?"},"false":{"radioLabel":"Add to existing address data","modalHeader":"Adding new data to existing file","modalBody":"Are you sure you want to add new data to existing file?"}},"success":"Address data uploaded successfully","addressDataEmpty":"There is no file to be displayed yet","button":"Upload file"},"dropzone":{"instruction":"Drag and drop Address Data file here. The file should be in .csv or .txt format."},"table":{"title":"Uploaded File"},"download":{"csvFileSample":"csv file sample","txtFileSample":"txt file sample","button":"Download file"}},"vmpTranslations":{"title":"Manage Translations","dropzone":{"instruction":"Drag and drop Translation file here. The file should be in .csv format."},"upload":{"title":"Upload File","instruction1":"Please upload file in <b>.csv</b> format. The file should contain <b>comma delimiter</b>.","modalHeader":"Uploading new file","modalBody":"Are you sure you want to overwrite existing data?","button":"Upload file"},"table":{"defaultLanguage":"Default","defaultValue":"default","filter":{"phrase":"Search by phrase","language":"Search by language"},"empty":"There is no file to be displayed yet"},"addLanguage":{"title":"Add language","selectPlaceholder":"Select language","add":"Add"},"save":{"success":"Translations saved successfully"},"return":{"modalHeader":"Warning","modalBody":"The changes you made will not be saved.{br}Are you sure you want to continue?"},"download":{"modalHeader":"Warning","modalBody":"You haven\u2019t saved the changes. The downloaded file might not be complete.{br}Do you want to continue?","button":"Download file"}},"conditions":{"title":"Manage Conditions","success":"Condition saved successfully","set":"SET","active":"Active","inactive":"Inactive","addNew":"Add new Condition","remove":"Remove Condition","removeConfirmation":"Are you sure you want to remove condition for this patient?","yes":"Yes","no":"No","condition":"Condition","onsetDate":"Onset Date","actions":"Actions"},"manageCondition":{"title":"Condition","editCondition":"Edit Condition","addNewCondition":"Add New Condition","conditions":"Conditions","condition":"Condition","onsetDate":"Onset Date","endDate":"End date","cancel":"Cancel"},"columnNames":{"patientIdentifier":"Identifier","personIdentifier":"Identifier","givenName":"First Name","middleName":"Middle Name","familyName":"Last Name","display":"Name","gender":"Gender","age":"Age","birthdate":"Birthdate","birthdateEstimated":"Is birthdate estimated","birthtime":"Birth time","causeOfDeath":"Cause of death","dead":"Is dead","deathDate":"Death date","deathDateEstimated":"Is death date estimated","preferredAddress":"Preferred address","phoneNumber":"Phone number","uuid":"ID","personLanguage":"Language","field1":"Field 1","field2":"Field 2","field3":"Field 3","field4":"Field 4","field5":"Field 5","field6":"Field 6","field7":"Field 7"},"editPatient":{"title":"Patient Profile","subtitle":"Please edit Patient profile below","success":{"subtitle":"The Patient has been saved successfully."}},"editCaregiver":{"title":"Caregiver Profile","subtitle":"Please edit Caregiver profile below"},"registerCaregiver":{"title":"Register a Caregiver","subtitle":"Please register a caregiver below","steps":{"confirm":{"title":"Person Demographics","subtitle":"Confirm the person details are correct."}}},"registerPatient":{"title":"Register a Patient","subtitle":"Please register a patient below","steps":{"name":{"label":"Name","title":"Patient Demographics","subtitle":"What\'s the patient\'s name?"},"gender":{"label":"Gender","title":"Patient Demographics","subtitle":"What\'s the patient\'s gender?","male":"Male","female":"Female"},"birthdate":{"label":"Birthdate","title":"Patient Demographics","subtitle":"What\'s the patient\'s birth date?","or":"Or"},"address":{"label":"Address","title":"Patient Demographics","subtitle":"What\'s the patient\'s address?"},"language":{"label":"Language","title":"Patient Demographics","subtitle":"What language does the patient prefer?"},"phoneNumber":{"label":"Phone Number","title":"Patient Demographics","subtitle":"What\'s the patient\'s phone number?"},"patientLocation":{"label":"Patient Location","title":"Patient Demographics","subtitle":"What\'s the patient\'s location?"},"aadharNumber":{"label":"Aadhar Number","title":"Patient Demographics","subtitle":"What\'s the patient\'s Aadhar Number?"},"artNumber":{"label":"ART Number","title":"Patient Demographics","subtitle":"What\'s the patient\'s ART Number?"},"relatives":{"label":"Relatives","title":"Patient Demographics","subtitle":"Who is the patient related to?"},"confirm":{"label":"Confirm","title":"Patient Demographics","subtitle":"Confirm the patient details are correct.","estimated":"Estimated","years":"Year(s)","months":"Month(s)"}},"fields":{"givenName":"Given Name","middleName":"Middle Name","familyName":"Family Name","gender":"Gender","birthdateDay":"Day","birthdateMonth":"Month","birthdateYear":"Year","birthdateYears":"Estimated Years","birthdateMonths":"Estimated Months","address1":"Address 1","address2":"Address 2","cityVillage":"City/Village","stateProvince":"State/Province","country":"Country","postalCode":"Postal Code","personLanguage":"Language","Telephone Number":"Phone Number","patientLocation":"Location","Aadhar Number":"AADHAR Number","ART Number":"ART Number","relationshipType":"Relationship Type","otherPerson":"Person\'s Name","LocationAttribute":"Location","relatives":"Relatives","language":"Language","name":"Name","birthdate":"Birthdate","address":"Address","location":"Location","required":"(Required)"},"success":{"title":"Success","subtitle":"The Patient has been successfully registered.","editSubtitle":"The Patient has been saved successfully.","goBack":"Go back"},"unknown":"Unknown","required":"Required","invalid":"Invalid","previous":"Previous","next":"Next","confirm":"Confirm","invalidPhoneNumber":"Please provide a valid phone number including the country code. Example: +1 555 555 1234"},"notificationConfiguration":{"title":"Manage Notification Configuration","configureSettings":"Configure Settings","defaultCountry":"Default Country","country":"Country","smsSettings":"SMS / WhatsApp settings:","callSettings":"Call settings:","provider":"Provider","uponRegistration":"Upon registration","allowedNotificationWindow":{"label":"Allowed notification window:","from":"From","to":"To"},"bestContactTime":{"label":"Best contact time:","placeholder":"Best contact time"},"visitReminder":{"label":"Visit reminder (days before visit):","placeholder":"Days before visit","switch":"Visit reminder"},"button":{"expand":"Expand all","collapse":"Collapse all","addNewCountry":"Add new Country"},"confirmationModal":{"header":"Submit Notification Configuration","body":"Are you sure you want to submit Notification Configuration?"},"success":"Configuration saved successfully!"},"notificationTemplates":{"title":"Manage Notification Templates","notificationTemplate":"Notification Template","injectedServices":{"label":"Injected Services","tooltip":"Values which represent the map of services which should be injected into the messaging notification template.","key":"Key","value":"Value"},"template":{"customTemplateName":{"label":"Custom Template Name","tooltip":"When creating a custom template, use only lowercase letters and \u2018-\u2019 with no spaces.","invalid":"The Template Name should only contain lowercase letters, and \u2018-\u2019, no spaces"},"description":"Description","text":"SMS Text"},"button":{"expand":"Expand all","collapse":"Collapse all","addNewTemplate":"Add new Template"},"saveModal":{"header":"Submit Notification Templates","body":"Are you sure you want to submit Notification Templates?"},"removeTemplateModal":{"header":"Delete Notification Template","body":"Are you sure you want to delete {templateName}?"},"success":"Configuration saved successfully!"},"locations":{"location":{"create.title":"Add New Location","edit.title":"Edit Location","name":"Location Name","description":"Description","address1":"Address (line 1)","address2":"Address (line 2)","cityVillage":"City/Village","stateProvince":"State/Province","postalCode":"Postal Code","country":"Country","delete":"Delete Location"}},"common":{"yes":"Yes","no":"No","ok":"Ok","cancel":"Cancel","moveUp":"Move up","moveDown":"Move down","ordinalSuffix":{"st":"st","nd":"nd","rd":"rd","th":"th"},"required":"(Required)","error":{"required":"Required","nameUnique":"The name should be unique. Please try again.","nameInvalid":"Username is invalid. It must be between 2 and 50 characters. Only letters, digits, \'.\', \'-\', and \'_\' are allowed.","invalidEmail":"The email address is invalid. Please correct it.","invalidPassword":"Your entered password does not match the needed complexity. It should be minimum 8 characters long and contain at least: one upper and one lower case characters, one digit. Please try again.","confirmPassword":"Your entered passwords do not match. Please try again."},"switch":{"on":"on","off":"off"},"return":"Return","save":"Save","true":"True","false":"False"},"userAccount":{"title":"User Account","add":"Add New Account","edit":"Edit Account","accountNotSaved":"Not all fields have been filled in correctly. Please try again.","auditInfo":{"title":"Audit info","created":"Created By {creator} On {date}","changedBy":"Changed By {changedBy} On {date}"},"personDetails":{"title":"Person Details","familyName":"Family Name","givenName":"Given Name","phone":"Phone","email":"Email"},"userAccountDetails":{"title":"User Account Details","username":"Username","locations":"Locations","userRole":"User Role","password":"Password","confirmPassword":"Confirm Password","forcePasswordChange":"Force Password Change"},"deleteAccount":{"label":"Delete Account","confirmationModal":{"header":"Warning","body":"Are you sure you want to delete this account?"}}},"manageRegimens":{"title":"Manage Regimens","regimenName":"Regimen Name","drugName":"Drug Name","drugAbbreviation":"Drug Abbreviation","doseUnitType":"Dose Unit Type","numberOfUnits":"Number Of Units","frequency":"Frequency","addNewRegimen":"Add New Regimen","deleteRegimenModal":{"header":"Warning","body":"Are you sure you want to delete this regimen?"},"deleteDrugModal":{"header":"Warning","body":"Are you sure you want to delete this drug?"},"regimenDeleted":"The regimen has been deleted.","drugDeleted":"The drug has been deleted.","regimensNotSaved":"The regimens have not been saved. Please try again.","regimensSaved":"The regimens have been saved.","error":{"regimenNameUnique":"The regimen name should be unique. Please try again."}},"findPatientColumnsConfiguration":{"title":"Manage Patient\'s Record Columns Configuration","columnName":"Column Name","configureColumns":"Configure Columns","configurationNotSaved":"The columns configuration has not been saved.","emptyColumnsConfiguration":"Please configure at least one column.","configurationSaved":"The columns configuration has been saved.","modal":{"header":"Submit Columns Configuration","body":"Are you sure you want to submit Columns Configuration for the Patient\'s Record?"}}}')},1025:function(e,t,n){},1030:function(e,t,n){},1108:function(e,t,n){},1109:function(e,t,n){},1110:function(e,t,n){},1111:function(e,t,n){},1112:function(e,t,n){},1121:function(e,t,n){},1126:function(e,t,n){},1355:function(e,t){},1366:function(e,t){},1370:function(e,t){},1393:function(e,t){},144:function(e,t,n){},1700:function(e,t){},1916:function(e,t,n){},1917:function(e,t,n){},1918:function(e,t,n){},1921:function(e,t,n){},1922:function(e,t,n){},1923:function(e,t,n){},1924:function(e,t,n){},1925:function(e,t,n){},1926:function(e,t,n){},1928:function(e,t,n){},1930:function(e,t,n){},1931:function(e,t,n){},1932:function(e,t,n){},1933:function(e,t,n){},1937:function(e,t,n){},1938:function(e,t,n){},1939:function(e,t,n){},1940:function(e,t,n){},1941:function(e,t,n){},1942:function(e,t,n){},1943:function(e,t,n){},1965:function(e,t,n){},1968:function(e,t,n){"use strict";n.r(t);var a=n(1),i=n.n(a),s=n(31),o=n.n(s),r=n(33),c=n(41),l=n(36),d=n(35),u=(n(1025),n(4)),p=n(84),m=n(65),f=n(952),g=(n(1030),n(1989)),h=n(231),b=n.n(h),j="/openmrs/",v="/openmrs/coreapps/clinicianfacing/patient.page",O=function(e){return(b.a.parse(e).redirect||j).toString()},x=n(17),y=n(29),C=n.n(y),N=function(e){return"".concat(e,"_PENDING")},S=function(e){return"".concat(e,"_FULFILLED")},w=function(e){return"".concat(e,"_REJECTED")},T="concept/SEARCH_CONCEPTS",P="concept/RESET_CONCEPTS",A="concept/GET_CONCEPT",D={loading:{concepts:!1,concept:!1},query:"",concepts:[],concept:{uuid:"",setMembers:[]},errorMessage:""},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N(T):return Object(u.a)(Object(u.a)({},e),{},{loading:Object(u.a)(Object(u.a)({},e.loading),{},{concepts:!0})});case N(A):return Object(u.a)(Object(u.a)({},e),{},{loading:Object(u.a)(Object(u.a)({},e.loading),{},{concept:!0})});case w(T):return Object(u.a)(Object(u.a)({},e),{},{loading:Object(u.a)(Object(u.a)({},e.loading),{},{concepts:!1}),errorMessage:t.payload.message});case w(A):return Object(u.a)(Object(u.a)({},e),{},{loading:Object(u.a)(Object(u.a)({},e.loading),{},{concept:!1}),errorMessage:t.payload.message});case S(T):return Object(u.a)(Object(u.a)({},e),{},{loading:Object(u.a)(Object(u.a)({},e.loading),{},{concepts:!1}),query:t.meta.q,concepts:t.payload.data.results});case S(A):return Object(u.a)(Object(u.a)({},e),{},{loading:Object(u.a)(Object(u.a)({},e.loading),{},{concept:!1}),concept:t.payload.data});case P:return Object(u.a)({},D);default:return e}},R=n(18),E=n.n(R),V=n(1990),I=n(1991),L=(n(641),n(429)),k="settings/GET_SETTING",F="settings/GET_SETTINGS",U="settings/CREATE_SETTING",B="settings/DELETE_SETTING",q={loading:!1,errorMessage:null,settings:[],setting:null,success:!1,isSettingExist:{settingPropertyUrl:null,value:!1}},W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t="/openmrs/ws/rest/v1/systemsetting?q=".concat(e,"&v=full");return{type:F,payload:C.a.get(t)}},G=function(e){var t="/openmrs/ws/rest/v1/systemsetting?q=".concat(e,"&v=full");return{type:k,payload:C.a.get(t)}},H=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a="/openmrs/ws/rest/v1/systemsetting",i={property:e,description:n};return t&&(i.value=t),{type:U,payload:C.a.post(a,i)}},Y=function(e){var t="/openmrs/ws/rest/v1/systemsetting/".concat(e.uuid);return{type:U,payload:C.a.post(t,e)}},Q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N(k):case N(F):case N(U):case N(B):return Object(u.a)(Object(u.a)({},e),{},{loading:!0,success:!1,errorMessage:null});case w(k):case w(F):case w(U):case w(B):return Object(u.a)(Object(u.a)({},e),{},{loading:!1,success:!1,errorMessage:t.payload.message});case S(F):return Object(u.a)(Object(u.a)({},q),{},{settings:t.payload.data.results});case S(k):var n=t.payload.data.results,a=!!n&&n.length>0;return Object(u.a)(Object(u.a)({},e),{},{loading:!1,errorMessage:null,isSettingExist:{settingPropertyUrl:t.payload.config.url,value:a},setting:a?n[0]:e.setting});case S(U):case S(B):return Object(u.a)(Object(u.a)({},e),{},{loading:!1,errorMessage:null,success:!0});default:return e}},z=n(954),K=(n(97),"dd MMM yyyy"),Z=function(e,t){return new Intl.DateTimeFormat("en-GB",{day:"2-digit",month:"short",year:"numeric"}).format(t)},J=function(e){return e?e.toISOString().split("T")[0]:null},X=n(341),_=n.n(X),$="condition/GET_CONDITION",ee="condition/CONDITION_HISTORY",te="condition/SAVE_CONDITION",ne="condition/RESET_CONDITION",ae={loading:!1,q:"",condition:null,conditions:[],errorMessage:"",conditionUpdated:!1},ie=function(e){return{type:te,payload:C.a.post("/openmrs/ws/rest/emrapi/condition",[se(e)])}},se=function(e){return Object(u.a)(Object(u.a)({},e),{},{conditionNonCoded:e.conditionNonCoded||null})},oe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N($):case N(ee):case N(te):return Object(u.a)(Object(u.a)({},e),{},{loading:!0,conditionUpdated:!1});case w($):case w(te):return Object(u.a)(Object(u.a)({},ae),{},{errorMessage:t.payload.message});case S($):return Object(u.a)(Object(u.a)({},ae),{},{condition:t.payload.data&&t.payload.data[0]});case S(ee):return Object(u.a)(Object(u.a)({},ae),{},{conditions:t.payload.data});case S(te):return Object(u.a)(Object(u.a)({},e),{},{loading:!1,conditionUpdated:!0});case ne:return Object(u.a)({},ae);default:return e}},re="breadcrumbs/ADD",ce="breadcrumbs/RESET",le={additionalBreadcrumbs:[]},de=function(e){return{type:re,meta:{breadcrumbs:e}}},ue=function(){return{type:ce}},pe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:le,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case re:return Object(u.a)(Object(u.a)({},e),{},{additionalBreadcrumbs:e.additionalBreadcrumbs.concat(t.meta.breadcrumbs)});case ce:return Object(u.a)({},le);default:return e}},me="ACTIVE",fe="INACTIVE",ge=n(51),he=50,be=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:he;return e?e.slice(t*n,(t+1)*n):[]},je="patient/SEARCH_PATIENTS",ve="patient/GET_PATIENT",Oe="patient/RESET_PATIENTS",xe="patient/GET_PATIENT_RELATIONSHIPS",ye="patient/GET_PATIENT_LINKED_REGIMENS",Ce={loading:!1,patients:[],patient:null,patientRelationships:null,errorMessage:"",currentPage:0,totalCount:0,hasNext:!1,hasPrev:!1,q:"",patientLinkedRegimens:[]},Ne=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:he,a="/openmrs/ws/rest/v1/patient?q=".concat(e||"","&startIndex=").concat(t*n,"&limit=").concat(n,"&v=full&totalCount=true");return{type:je,payload:C.a.get(a),meta:{q:e,currentPage:t}}},Se=function(e){var t="/openmrs/ws/rest/v1/patient/".concat(e,"?v=custom:(").concat("patientId,uuid,identifiers,person:(gender,age,birthdate,birthdateEstimated,preferredAddress,preferredName,attributes),attributes:(value,attributeType:(name))",")");return{type:ve,payload:C.a.get(t)}},we=function(){return{type:Oe}},Te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ce,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N(xe):return Object(u.a)(Object(u.a)({},e),{},{patientRelationships:null});case N(je):return Object(u.a)(Object(u.a)({},e),{},{loading:!0,q:t.meta.q});case w(je):return Object(u.a)(Object(u.a)({},Ce),{},{errorMessage:t.payload.message});case S(je):var n=t.payload.data.links,a=t.meta.currentPage||0,i=t.payload.data.results||[];return t.meta.q===e.q?Object(u.a)(Object(u.a)({},Ce),{},{patients:0===a?i:[].concat(Object(ge.a)(e.patients),Object(ge.a)(i)),hasNext:n&&!!n.find((function(e){return"next"===e.rel})),hasPrev:n&&!!n.find((function(e){return"prev"===e.rel})),totalCount:t.payload.data.totalCount,currentPage:t.meta.currentPage}):Object(u.a)({},e);case S(ve):return Object(u.a)(Object(u.a)({},e),{},{patient:t.payload.data});case S(xe):return Object(u.a)(Object(u.a)({},e),{},{patientRelationships:t.payload.data.results});case S(ye):return Object(u.a)(Object(u.a)({},e),{},{patientLinkedRegimens:t.payload.data});case Oe:return Object(u.a)({},Ce);default:return e}},Pe=n(64),Ae=n(2),De=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).state={conceptQuery:"",concept:null,conceptInput:"",onsetDate:null,endDate:null,active:!0},e.loadOptions=E.a.debounce((function(){e.searchConcepts()}),500),e.setConceptInput=function(t){e.setState({conceptQuery:t,conceptInput:t}),e.loadOptions()},e.onConceptChange=function(t){e.setState({concept:t})},e.conditionId=function(){return b.a.parse(e.props.location.search).conditionId},e.searchConcepts=function(){e.state.conceptInput.length>0&&e.state.conceptInput!==e.props.conceptQuery&&e.props.searchConcepts(e.state.conceptInput,e.props.conceptListClasses)},e.onConceptFocus=function(){var t=e.state.concept;t&&e.setConceptInput(t.label)},e.onQueryChange=function(t){e.setConceptInput(t),e.loadOptions()},e.conceptOptions=function(){return e.props.concepts.map((function(e){return{value:e.concept.uuid,label:e.display}}))},e.onOnsetDateChange=function(t){e.setState({onsetDate:t})},e.onEndDateChange=function(t){e.setState({endDate:t})},e.onActiveChange=function(t){return function(){e.setState({active:t})}},e.cancel=function(){e.props.history.push("/conditions/".concat(e.props.match.params.patientUuid))},e.save=function(){if(e.state.concept){var t,n=e.conditionId()?Object(u.a)({},e.props.condition):{};n.status=e.state.active?me:fe,n.patientUuid=e.props.match.params.patientUuid,(null===(t=e.state.concept)||void 0===t?void 0:t.__isNew__)?(n.concept={uuid:"",name:"",shortName:""},n.conditionNonCoded=e.state.concept.label):n.concept=Object(u.a)(Object(u.a)({},n.concept||{}),{},{uuid:e.state.concept.value}),n.onSetDate=J(e.state.onsetDate||new Date),n.endDate=e.state.active?"":J(e.state.endDate),n.voided=!1,n.additionalDetail||(n.additionalDetail=""),n.endReason||(n.endReason={shortName:""}),e.props.saveCondition(n)}},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.props.reset(),this.props.getSettingByQuery("coreapps.conditionListClasses");var e=this.conditionId();e&&this.props.getCondition(e);var t=this.props.match.params.patientUuid;this.props.getPatient(t)}},{key:"componentDidUpdate",value:function(e,t,n){var a=this.props,i=a.condition,s=a.patient,o=a.match,r=a.conditionUpdated,c=a.conceptListClasses,l=o.params.patientUuid;if(e.condition!==i&&i){var d=i.concept,u=i.status,p=i.onSetDate,m=i.endDate;this.setState({concept:d&&{label:d.name,value:d.uuid},active:u===me,onsetDate:p&&new Date(p),endDate:m&&new Date(m)})}e.conceptListClasses!==c&&this.props.searchConcepts("",c),s&&s!==e.patient&&(this.props.resetBreadcrumbs(),this.props.addBreadcrumbs([{label:s.person.preferredName.display,url:"".concat(v,"?patientId=").concat(l),order:1}])),r&&!e.conditionUpdated&&(Object(Pe.b)(this.props.intl.formatMessage({id:"conditions.success"})),this.props.history.push("/conditions/".concat(this.props.match.params.patientUuid)))}},{key:"render",value:function(){var e=this.props.intl,t=this.conditionId();return Object(Ae.jsxs)("div",{className:"condition",children:[Object(Ae.jsx)("h2",{children:Object(Ae.jsx)(g.a,{id:t?"manageCondition.editCondition":"manageCondition.addNewCondition"})}),Object(Ae.jsx)("div",{className:"error",children:this.props.error}),Object(Ae.jsxs)("div",{className:"inner-content",children:[Object(Ae.jsx)("div",{className:"d-flex",children:Object(Ae.jsx)("div",{className:"col-12 mt-3",children:Object(Ae.jsxs)("div",{className:"input-container",children:[Object(Ae.jsx)(z.a,{options:this.conceptOptions(),onInputChange:this.onQueryChange,onChange:this.onConceptChange,className:"flex-fill concept",classNamePrefix:"default-select",placeholder:e.formatMessage({id:"manageCondition.condition"}),value:this.state.concept,inputValue:this.state.conceptInput,onFocus:this.onConceptFocus,isDisabled:!!t}),this.state.concept&&Object(Ae.jsx)("span",{className:"placeholder",children:e.formatMessage({id:"manageCondition.condition"})})]})})}),Object(Ae.jsxs)("div",{className:"d-flex flex-wrap",children:[Object(Ae.jsx)("div",{className:this.state.active?"col-12":"col-12 col-sm-6",children:Object(Ae.jsxs)("div",{className:"input-container",children:[Object(Ae.jsx)(_.a,{placeholderText:e.formatMessage({id:"manageCondition.onsetDate"}),selected:this.state.onsetDate,className:"form-control",onChange:this.onOnsetDateChange,peekNextMonth:!0,showMonthDropdown:!0,showYearDropdown:!0,dropdownMode:"select",dateFormat:K}),this.state.onsetDate&&Object(Ae.jsx)("span",{className:"placeholder",children:e.formatMessage({id:"manageCondition.onsetDate"})})]})}),Object(Ae.jsx)("div",{className:"col-12 col-sm-6",children:!1===this.state.active&&Object(Ae.jsxs)("div",{className:"input-container",children:[Object(Ae.jsx)(_.a,{placeholderText:e.formatMessage({id:"manageCondition.endDate"}),selected:this.state.endDate,className:"form-control",onChange:this.onEndDateChange,peekNextMonth:!0,showMonthDropdown:!0,showYearDropdown:!0,dropdownMode:"select",dateFormat:K}),this.state.onsetDate&&Object(Ae.jsx)("span",{className:"placeholder",children:e.formatMessage({id:"manageCondition.endDate"})})]})})]}),Object(Ae.jsx)("div",{children:Object(Ae.jsxs)("div",{className:"col-12",children:[Object(Ae.jsx)(V.a,{check:!0,inline:!0,className:"mb-2",children:Object(Ae.jsx)(I.a,{onClick:this.onActiveChange(!0),className:"select-button w-100 ".concat(!0===this.state.active?"active":""),children:Object(Ae.jsx)("span",{children:e.formatMessage({id:"conditions.active"})})})},"button-active"),Object(Ae.jsx)(V.a,{check:!0,inline:!0,className:"mb-2",children:Object(Ae.jsx)(I.a,{onClick:this.onActiveChange(!1),className:"select-button w-100 ".concat(!1===this.state.active?"active":""),children:Object(Ae.jsx)("span",{children:e.formatMessage({id:"conditions.inactive"})})})},"button-inactive")]})})]}),Object(Ae.jsxs)("div",{className:"mt-5",children:[Object(Ae.jsx)("div",{className:"d-inline",children:Object(Ae.jsx)(I.a,{className:"cancel",onClick:this.cancel,children:Object(Ae.jsx)("span",{children:e.formatMessage({id:"manageCondition.cancel"})})})}),Object(Ae.jsx)("div",{className:"d-inline pull-right confirm-button-container",children:Object(Ae.jsx)(I.a,{className:"save",onClick:this.save,disabled:!this.state.concept,children:Object(Ae.jsx)(g.a,{id:"common.save"})})})]})]})}}]),n}(i.a.Component),Me={searchConcepts:function(e,t){var n="/openmrs/ws/rest/v1/conceptsearch?conceptClasses=".concat(t).concat(e?"&q="+e:"");return{type:T,payload:C.a.get(n),meta:{q:e}}},reset:function(){return{type:P}},getSettingByQuery:G,getCondition:function(e){var t="/openmrs/ws/rest/emrapi/condition?conditionUuid=".concat(e);return{type:$,payload:C.a.get(t)}},addBreadcrumbs:de,resetBreadcrumbs:ue,getPatient:Se,saveCondition:ie},Re=Object(x.connect)((function(e){var t,n=e.concept,a=e.settings,i=e.condition,s=e.cflPatient;return{concepts:n.concepts,error:n.errorMessage,conceptListClasses:null===(t=a.setting)||void 0===t?void 0:t.value,conceptQuery:n.query,condition:i.condition,conditionUpdated:i.conditionUpdated,patient:s.patient}}),Me)(Object(L.c)(Object(m.withRouter)(De))),Ee=n(1994),Ve=n(1995),Ie=n(1992),Le=(n(1108),"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABHNCSVQICAgIfAhkiAAAAjpJREFUOI2l1M9LKlEUwPGv907iMAmpkAudchUYuGiXQwtpduFfK25cFKJEbaKWQmGBUoRI+GtmGrXb4r3x6Rvr+egs59774Zxzz52IUkqxFEopHh8fub+/x/d9lFJIKdnd3aVQKBCLxfguIstgp9Ph7u6O8Xi8drMQAtM0OT4+RgjxPdhqtbi9vQVga2uLXC5HIpFASonjODw/P9Pr9QDY2dnBtm2i0eh6sNvt0mw2ATBNE8uy1mbQ6XS4vr5mNpuRTqcplUqhfUIptcgsm81ycnLyZTmmaVIulxFC8Pr6ytPTU7gt7Xab8XiMpmlYlrUWWg5d1zk4OCBoUwh8eHgAIJfLIaX8JwhwdHSElJLBYBC6QOH7PgCJRGIjLIhgfIbD4SoYTM2m2S0O/u7zfD5f/R5AjuP8FxhUpuv6KphKpQB4eXnZGOv3+7y/v6NpWqhVolAoIISg1+vR7XY3Ai8vLwHY398PtUoYhkEmkwHg6uoK13W/xZrNJpPJBIB8Ph9aFwDFYpF4PM5sNqNSqXBzc8Nf/wze3t6oVCqLKqSUax/A4i17nkej0aDf7y8OxGIxhBBMp1M8z/uThRB8fHyg6zq2bROPx8Mg/BqBdrtNq9UKDayUkr29PfL5PJFIhPPzczzPwzAMTk9P2d7eDoPLMRgMGI1GzOdzdF0nmUyiadrKer1ex3EcDMPAtm0Mw/ga3CRGoxEXFxc4jkM0GuXs7OxnYIDWajWm0ymapv0cBHBdl2q1yuHhIZ/WPwvNTaPpawAAAABJRU5ErkJggg=="),ke="patientIdentifier",Fe="display",Ue="gender",Be="birthdate",qe="deathDate",We="phoneNumber",Ge="personLanguage",He="personIdentifier",Ye="givenName",Qe="familyName",ze="Telephone Number",Ke="personLanguage",Ze="".concat(ke,",").concat(Fe,",").concat(Ue,",").concat("age",",").concat(Be,",").concat(We),Je={M:"Male",F:"Female"},Xe="",_e=function(e){return e?Array.isArray(e)?e[0].display||Xe:"object"===typeof e?e.display||Xe:e:Xe},$e=function(e,t){if(!e)return Xe;var n=e.attributes&&e.attributes.find((function(e){return e.attributeType.display.toLowerCase()===t.toLowerCase()}));return n&&n.value||Xe},et=n(95),tt=function(e){return e&&"+"+e},nt=function(e,t,n){var a=e.person,i=a.preferredAddress,s=a.preferredName,o=$e(a,t),r=a[t];return o?t===ze&&Object(et.b)(tt(o))?tt(o):o:r?t===Be?Z(0,new Date(r)):r:(null===s||void 0===s?void 0:s[t])||(null===i||void 0===i?void 0:i[t])||function(e,t){if(!e)return Xe;var n=e.identifiers&&e.identifiers.find((function(e){return e.identifierType.display.toLowerCase()===t.toLowerCase()}));return n&&n.identifier||Xe}(e,t)},at=function(e){var t=e.person||e,n=t.preferredName,a=t.preferredAddress,i=t.gender,s=t.uuid,o=t.personId,r=n.givenName,c=n.middleName,l=n.familyName,d=a||{},p=d.address1,m=d.address2,f=d.cityVillage,g=d.stateProvince,h=d.country,b=d.postalCode;return Object(u.a)(Object(u.a)({patientId:e.patientId||s,uuid:e.uuid,personId:o,givenName:r,middleName:c,familyName:l,gender:i,birthdate:t.birthdate?new Date(t.birthdate):null,address1:p,address2:m,cityVillage:f,stateProvince:g,country:h,postalCode:b},function(e){var t={};return e&&e.attributes&&e.attributes.forEach((function(e){return t[e.attributeType.display]=e.value||Xe})),t}(t)),function(e){var t={};return e&&e.identifiers&&e.identifiers.forEach((function(e){return t[e.identifierType.display]=e.identifier||Xe})),t}(e))},it=500,st="",ot="HH:mm",rt="true",ct="false",lt=function(e,t,n){return n>0?Object(Ae.jsxs)("span",{children:[n," ",Object(Ae.jsx)(g.a,{id:"table.recordsFound"})]}):e.length<3?Object(Ae.jsx)(g.a,{id:"table.enterSearch"}):t||0!==n?void 0:Object(Ae.jsx)(g.a,{id:"table.noRecords"})},dt=(n(1109),n(1110),n(956)),ut=n(1993),pt=n(958),mt=function(e){var t,n=Object(dt.a)(),a=(null===(t=e.columns[0])||void 0===t?void 0:t.constructor)===Object;return Object(Ae.jsx)(pt.a,{dataLength:e.entities.length,next:function(){return e.switchPage(e.currentPage+1)},hasMore:e.hasNext,loader:Object(Ae.jsx)("div",{className:"spinner",children:Object(Ae.jsx)(Ie.a,{})}),children:Object(Ae.jsxs)(ut.a,{borderless:!0,striped:!0,responsive:!0,className:"table",children:[Object(Ae.jsx)("thead",{children:Object(Ae.jsx)("tr",{children:E.a.map(e.columns,(function(e,t){return Object(Ae.jsx)("th",{children:a?e.label:Object(Ae.jsx)(g.a,{id:"columnNames.".concat(e)})},t)}))})}),Object(Ae.jsx)("tbody",{children:E.a.map(e.entities,(function(t,i){return Object(Ae.jsx)("tr",{onClick:function(){return function(t){e.getRecordLink&&(window.location.href=e.getRecordLink(t))}(t)},children:E.a.map(e.columns,(function(i){var s=a?i.value:i;return Object(Ae.jsx)("td",{className:e.getRecordLink?"td-clickable":void 0,children:e.columnContent(t,s,n)},s)}))},i)}))})]})})},ft="cflui.findPatientColumnsConfiguration",gt={label:"",value:"",isValid:!0},ht=/\w\S*/g,bt=/([a-z])([A-Z])/g,jt=[{label:"Identifier",value:"OpenMRS ID"},{label:"Name",value:Fe},{label:"Age",value:"age"}],vt=[].concat(jt,[{label:"Gender",value:Ue},{label:"Birthdate",value:Be},{label:ze,value:ze}]),Ot=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).state={query:"",page:0},e.searchAfterDelay=E.a.debounce((function(){e.state.query.length>=3&&e.props.search(e.state.query,e.state.page)}),it),e.search=function(){e.state.query.length>=3&&e.props.search(e.state.query,e.state.page)},e.onQueryChange=function(t){e.setState({query:t.target.value,page:0}),e.searchAfterDelay()},e.onSearchClick=function(t){t.preventDefault(),e.searchAfterDelay.cancel(),e.setState({page:0}),e.search()},e.switchPage=function(t){return e.setState({page:t},e.search)},e.getRecordLink=function(e){return"".concat(v,"?patientId=").concat(e.uuid)},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.props.reset(),this.props.getSettingByQuery(ft)}},{key:"render",value:function(){return Object(Ae.jsxs)("div",{className:"find-patient",children:[Object(Ae.jsx)("h2",{children:Object(Ae.jsx)(g.a,{id:"findPatient.title"})}),Object(Ae.jsx)("div",{className:"error",children:this.props.error}),Object(Ae.jsxs)("div",{className:"search-section",children:[Object(Ae.jsx)(Ee.a,{onSubmit:this.onSearchClick,children:Object(Ae.jsxs)(V.a,{className:"patient-search",children:[Object(Ae.jsx)("img",{src:Le,alt:"search",className:"search-icon"}),Object(Ae.jsx)(Ve.a,{id:"search-patient",placeholder:this.props.intl.formatMessage({id:"findPatient.searchInputPlaceholder"}),value:this.state.query,onChange:this.onQueryChange,className:"search-input"})]})}),Object(Ae.jsxs)("div",{className:"patient-table",children:[Object(Ae.jsx)("div",{className:"helper-text",children:this.props.loading?Object(Ae.jsx)(Ie.a,{color:"dark",size:"sm"}):lt(this.state.query,this.props.loading,this.props.totalCount)}),this.props.totalCount>0&&Object(Ae.jsx)(mt,{columns:this.props.tableColumns,entities:this.props.patients,columnContent:nt,hasNext:this.props.hasNext,currentPage:this.props.currentPage,switchPage:this.switchPage,getRecordLink:this.getRecordLink})]})]})]})}}]),n}(i.a.Component),xt={search:Ne,reset:we,getSettingByQuery:G},yt=Object(x.connect)((function(e){var t=e.cflPatient,n=e.settings.setting;return{patients:t.patients,loading:t.loading,error:t.errorMessage,hasNext:t.hasNext,hasPrev:t.hasPrev,currentPage:t.currentPage,totalCount:t.totalCount,tableColumns:(null===n||void 0===n?void 0:n.value)?JSON.parse(n.value):vt}}),xt)(Object(L.c)(Ot)),Ct="Edit Patients",Nt="Get People",St="Get Patients",wt="Add Patients",Tt="cfl-people/SEARCH_PEOPLE",Pt="cfl-people/RESET_PEOPLE",At={loading:!1,people:[],errorMessage:"",totalCount:0,q:""},Dt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:At,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N(Tt):return Object(u.a)(Object(u.a)({},e),{},{loading:!0,q:t.meta.q});case w(Tt):return Object(u.a)(Object(u.a)({},At),{},{errorMessage:t.payload.message});case S(Tt):var n=t.payload.data.results;return t.meta.q===e.q?Object(u.a)(Object(u.a)({},At),{},{people:n,totalCount:n.length}):Object(u.a)({},e);case Pt:return Object(u.a)({},At);default:return e}},Mt=(n(1111),function(e,t){if(!e)return Xe;var n=e.attributes&&e.attributes.find((function(e){return e.name.toLowerCase()===t.toLowerCase()}));return n&&n.value||Xe}),Rt=function(e,t,n){var a=e.personName&&e.personName.split(" ");switch(t){case Be:return e&&e.birthdate&&Z(0,new Date(e.birthdate));case qe:return e&&e.deathDate&&Z(0,new Date(e.deathDate));case Ye:return a&&a[0];case Qe:return a&&(a.length>1?a[1]:Xe);case Fe:return e.personName;case He:case ke:return e&&(e.patientIdentifier||e.personIdentifier);case We:var i=Mt(e,ze);return Object(et.b)(tt(i))||i;case Ge:return Mt(e,Ke);case Ue:return e&&(Je[e.gender]||e.gender);default:return _e(e&&e[t])}},Et=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).state={query:"",page:0},e.searchAfterDelay=E.a.debounce((function(t){e.state.query.length>=3&&e.props.search(e.state.query)}),it),e.search=function(){e.state.query.length>=3&&e.props.search(e.state.query)},e.onQueryChange=function(t){e.setState({query:t.target.value,page:0}),e.searchAfterDelay()},e.onSearchClick=function(t){t.preventDefault(),e.searchAfterDelay.cancel(),e.setState({page:0}),e.search()},e.switchPage=function(t){return e.setState({page:t})},e.getRecordLink=function(e){return"".concat(v,"?patientId=").concat(e.uuid,"&dashboard=person")},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.props.reset()}},{key:"render",value:function(){return Object(Ae.jsxs)("div",{className:"find-caregiver",children:[Object(Ae.jsx)("h2",{children:Object(Ae.jsx)(g.a,{id:"findCaregiver.title"})}),Object(Ae.jsx)("div",{className:"error",children:this.props.error}),Object(Ae.jsxs)("div",{className:"search-section",children:[Object(Ae.jsx)(Ee.a,{onSubmit:this.onSearchClick,children:Object(Ae.jsxs)(V.a,{className:"caregiver-search",children:[Object(Ae.jsx)("img",{src:Le,alt:"search",className:"search-icon"}),Object(Ae.jsx)(Ve.a,{id:"search-caregiver",placeholder:this.props.intl.formatMessage({id:"findCaregiver.searchInputPlaceholder"}),value:this.state.query,onChange:this.onQueryChange,className:"search-input"})]})}),Object(Ae.jsxs)("div",{className:"caregiver-table",children:[Object(Ae.jsx)("div",{className:"helper-text",children:this.props.loading?Object(Ae.jsx)(Ie.a,{color:"dark",size:"sm"}):lt(this.state.query,this.props.loading,this.props.totalCount)}),this.props.totalCount>0&&Object(Ae.jsx)(mt,{columns:this.props.tableColumns.split(","),entities:be(this.props.caregivers,this.state.page),columnContent:Rt,hasNext:this.props.totalCount>(this.state.page+1)*he,currentPage:this.state.page,switchPage:this.switchPage,getRecordLink:this.getRecordLink})]})]})]})}}]),n}(i.a.Component),Vt={search:function(e){var t="/openmrs/ws/cfl/people?query=".concat(e||"");return{type:Tt,payload:C.a.get(t),meta:{q:e}}},reset:function(){return{type:Pt}}},It=Object(x.connect)((function(e){var t=e.cflPeople,n=e.apps;return{caregivers:t.people,loading:t.loading,error:t.errorMessage,hasNext:t.hasNext,hasPrev:t.hasPrev,currentPage:t.currentPage,totalCount:t.totalCount,tableColumns:n.findCaregiverTableColumns&&n.findCaregiverTableColumns||Ze}}),Vt)(Object(L.c)(Et)),Lt=(n(1112),n(1997)),kt=n(1998),Ft=n(1999),Ut=n(2e3),Bt=n.p+"check.1ac181e2.svg",qt=n.p+"check-circle.6e017b8a.svg",Wt=n(959),Gt=n.n(Wt),Ht="Server error, please try again later.",Yt="registration/REGISTER",Qt="registration/UPDATE_RELATIONSHIPS",zt="registration/UPDATE_PROFILE",Kt="registration/GET_PATIENT_IDENTIFIER_TYPE",Zt={loading:!1,success:!1,message:null,errors:[],id:null,patientIdentifierTypes:[]},Jt=function(e){var t,n=null===(t=e.relatives)||void 0===t?void 0:t.filter((function(e){return!!e.relationshipType&&!!e.otherPerson})),a=null===n||void 0===n?void 0:n.map((function(e){return{relationshipType:e.relationshipType,otherPersonUuid:e.otherPerson.value}})),i=Object(u.a)(Object(u.a)({},e),{},{relationships:a});return i.birthdate?(i.birthdateEstimated=!1,i.birthdate=i.birthdate.toISOString().split("T")[0]):i.birthdate=null,i},Xt=function(){var e,t,n,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zt,i=arguments.length>1?arguments[1]:void 0;switch(i.type){case N(Yt):case N(zt):case N(Kt):return Object(u.a)(Object(u.a)({},a),{},{loading:!0});case w(Yt):case w(zt):var s=null===(e=i.payload.response.data)||void 0===e?void 0:e.error,o=null===s||void 0===s?void 0:s.message;return o=(null===(t=o)||void 0===t||null===(n=t.split("reason: ")[1])||void 0===n?void 0:n.replace("]",""))||o,Object(u.a)(Object(u.a)({},Zt),{},{success:!1,loading:!1,errors:o?[o]:[Ht]});case S(Yt):case S(zt):var r=i.payload.data;return Object(u.a)(Object(u.a)({},a),{},{success:!0,loading:!1,id:r});case S(Kt):return Object(u.a)(Object(u.a)({},a),{},{patientIdentifierTypes:i.payload.data.results,loading:!1});default:return a}},_t="patient/SEARCH_PEOPLE",$t="patient/RESET_PEOPLE",en="patient/GET_PERSON",tn="patient/GET_PERSON_RELATIONSHIPS",nn={loading:!1,people:[],errorMessage:"",hasNext:!1,hasPrev:!1,currentPage:0,totalCount:0,person:null,personRelationships:null},an=function(e){var t="/openmrs/ws/rest/v1/person/".concat(e,"?v=custom:(").concat("personId,gender,age,birthdate,birthdateEstimated,preferredAddress,preferredName,attributes,uuid",")");return{type:en,payload:C.a.get(t)}},sn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N(_t):return Object(u.a)(Object(u.a)({},e),{},{loading:!0});case N(tn):return Object(u.a)(Object(u.a)({},e),{},{personRelationships:null});case w(_t):return Object(u.a)(Object(u.a)({},nn),{},{errorMessage:t.payload.message});case S(_t):var n=t.payload.data.links,a=t.meta.currentPage||0,i=t.payload.data.results||[];return Object(u.a)(Object(u.a)({},nn),{},{people:0===a?i:[].concat(Object(ge.a)(e.people),Object(ge.a)(i)),hasNext:n&&!!n.find((function(e){return"next"===e.rel})),hasPrev:n&&!!n.find((function(e){return"prev"===e.rel})),totalCount:t.payload.data.totalCount,currentPage:t.meta.currentPage});case S(en):return Object(u.a)(Object(u.a)({},e),{},{person:t.payload.data});case S(tn):return Object(u.a)(Object(u.a)({},e),{},{personRelationships:t.payload.data.results});case $t:return Object(u.a)({},nn);default:return e}},on=n(960),rn=n(961),cn=function(e,t,n,a){var i=t||e.formatMessage({id:"registerPatient.fields."+n})||n;return a&&(i=[i,e.formatMessage({id:"registerPatient.fields.required"})].join(" ")),i},ln=function(e,t){var n=e.field,a=e.isInvalid,i=e.isDirty,s=e.value,o=e.onChange,r=e.patient,c=e.onPatientChange,l=e.onKeyDown,d=n.name,u=n.required,p=n.type;return{name:d,id:d,placeholder:t,value:null!=s?s:r[d],onChange:o||un(r,d,c),required:u,className:"form-control "+(i&&a?"invalid":""),type:p||"text",onKeyDown:!!l&&l}},dn=function(e,t,n,a){e[t]=a,n(e)},un=function(e,t,n){return function(a){return dn(e,t,n,a&&a.target?a.target.value:a)}},pn=function(e){var t=e.options,n=e.entity,a=e.fieldName,i=e.onKeyDown,s=e.onChange,o=function(e){return function(t){return s(e)}};return Object(Ae.jsx)(Ae.Fragment,{children:E.a.map(t||[],(function(e,s){var r=void 0!==e.value?e.value:e,c=void 0!==e.label?e.label:e;return Object(Ae.jsx)(V.a,{check:!0,inline:!0,className:"mb-2",children:Object(Ae.jsx)(I.a,Object(u.a)(Object(u.a)({onClick:o(r),className:"select-button w-100 ".concat(n[a]===r?"active":"")},!!i&&s===t.length-1&&{onKeyDown:i}),{},{children:c}))},"button-".concat(r))}))})},mn=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).onChange=function(t){return dn(e.props.patient,e.props.field.name,e.props.onPatientChange,t)},e.render=function(){var t=e.props,n=t.intl,a=t.field,i=t.isInvalid,s=t.className,o=t.patient,r=t.isDirty,c=t.onKeyDown,l=a.options,d=!!o[a.name];return Object(Ae.jsxs)("div",{className:"".concat(s),children:[Object(Ae.jsx)(pn,{options:l,entity:o,fieldName:a.name,onChange:e.onChange,onKeyDown:c}),r&&i&&Object(Ae.jsx)("span",{className:"error field-error",children:n.formatMessage({id:d?a.errorMessage||"registerPatient.invalid":"registerPatient.required"})})]})},e}return n}(i.a.Component),fn=Object(x.connect)((function(){return{}}),{})(Object(L.c)(mn));var gn=Object(L.c)((function(e){var t=e.intl,n=e.hasValue,a=e.message,i=e.field;return Object(Ae.jsx)("span",{className:"error field-error",children:t.formatMessage({id:a||(n?i.errorMessage||"registerPatient.invalid":"registerPatient.required")})})})),hn=n(962),bn=n.n(hn),jn=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).isDisabled=function(e,t){return!!ta.includes(t)&&!!e[ea]},e.render=function(){var t=e.props,n=t.intl,a=t.field,i=t.isInvalid,s=t.isDirty,o=t.className,r=t.value,c=t.patient,l=t.message,d=a.name,p=a.required,m=a.type,f=a.label,g=a.mask,h=!!r||!!c[a.name],b=cn(n,f,d,p),j=ln(e.props,b);return j.disabled=e.isDisabled(c,d),j["data-testid"]=e.props["data-testid"]||d,"number"===m&&(j.pattern="[1-9]"),Object(Ae.jsxs)("div",{className:"".concat(o," input-container"),children:[Object(Ae.jsx)(bn.a,Object(u.a)(Object(u.a)({},j),{},{mask:g,maskChar:null,value:j.value,onChange:j.onChange})),h&&Object(Ae.jsx)("span",{className:"placeholder",children:b}),s&&i&&Object(Ae.jsx)(gn,{hasValue:h,field:a,message:l})]})},e}return n}(i.a.Component),vn=Object(x.connect)((function(){return{}}),{})(Object(L.c)(jn)),On=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).setDirty=function(t){e.setState({isDirty:!0}),t()},e.getSelectOptions=function(t,n){var a=e.props.selectOptions,i=t.options,s=a||i;if(s)return Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsx)("option",{value:"",disabled:!0,selected:!0,hidden:!0,children:n}),s.map((function(e){return Object(Ae.jsx)("option",{value:e.value||e,children:e.label||e},"option-".concat(e.value||e))}))]})},e.render=function(){var t=e.props,n=t.field,a=t.isInvalid,i=t.isDirty,s=t.className,o=t.value,r=t.patient,c=t.intl,l=n.name,d=n.required,p=n.label,m=!!o||!!r[n.name],f=cn(c,p,l,d),g=ln(e.props,f),h=e.props["data-testid"]||l;return Object(Ae.jsxs)("div",{className:"".concat(s," input-container"),children:[Object(Ae.jsx)(Ve.a,Object(u.a)(Object(u.a)({},g),{},{className:"form-control "+(i&&a?"invalid ":" ")+(o||r[l]?"":"placeholder"),type:"select","data-testid":h,children:e.getSelectOptions(n,f)})),m&&Object(Ae.jsx)("span",{className:"placeholder",children:f}),i&&a&&Object(Ae.jsx)(gn,{hasValue:m,field:n})]})},e}return n}(i.a.Component),xn=Object(x.connect)((function(){return{}}),{})(Object(L.c)(On)),yn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAABHNCSVQICAgIfAhkiAAAAaxJREFUWIXtmDFLw0AYht/7EkxCq2lVDC4Wd1EQ/AmCXR2Lc4sO4lJ/RhEHFzsUHHRy8ie4CII/QcdKpCVNtaXt3TmIIMJdq6lNkTxrXpInx/HmuzAppQzfOqg3AwghMWmIGLyMi7mUAzN866B8fonr23twISYuYxAhv7WBk/09mPVmgOvbe/hBOHGRT27uHnC0uwMSQsayIl/hXIALDorV4huJjIrIMsQYluczMI3o7xX5Do41g0qpgGw6Fb8MA7CUdWHQFKzMOElkVCQyKqZKxtRdJMbgWDNgmkzasWEQQ8q2kLYtZU4C6Pb62o+yVsbLuqiUCljKusqMQQzrqyuolYvoDbgy12i1cVy9wmPd/52MH7RweHahLbSUbaFWLuLgtKadiYSUaLTausfpZQZcDB260raF3oDDD0LUm4E2O4yp2sCJjIpERsX/kpH4KDQho59GI8t0e30cV6+GFtooaEtvFLgQ2or/Cf9rz4yT6ZIhYmM5ZkTBMAjEGEwv4yK/tYGbuwdwHsP/GYOwvbmGnLcIJqWUzfAVT88v4EI9HP0VxBhy3iIW5mbxDlBljlt+hWQJAAAAAElFTkSuQmCC",Cn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAABHNCSVQICAgIfAhkiAAAAU1JREFUWIXt2LFLQlEUx/HfOZjVlhgFOiiUe+DiIgjlVtDm5hr1F7Q1t9VfkIubf4GBxHu8ySkeFI8GNYM0LWiy90BPgw0OXXg95L2G+53P8OHcCxcuiYh8eR4aZhu94RizmSCsmAnpZAKVUgHrq3HQxHXl+OIKhu1gOpsCoNAwgICJkc9lcXt5jljDbMOwHUw8L0TEYlNYD0+otyxwbzj+2Ui0dQYj8PyOhHk0vycCcNSIxTRGlcao0hhVGqNKY1TF/AztpraRSm6AKNgbNvj4hPPyuhzM6eE+zo4OwBwMU2saOLm+WQ6m1jRxd/+IgIvB89u7rzlfGLvbh93tB5P8oX91gTVGlcao0hhVGqNKY1Tx/CUO7xtEFRHA6WQCTNEvKLO1Ca6UCsjnspFC9nYyqJaLIBGRieuh3rLQGYwgIZ4Y0Xwj1XIRa/EVfAPyGGP3JFBJygAAAABJRU5ErkJggg==",Nn="relationshipType/GET_RELATIONSHIP_TYPES",Sn="relationshipType/RESET_RELATIONSHIP_TYPES",wn={loading:!1,relationshipTypes:[],errorMessage:""},Tn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N(Nn):return Object(u.a)(Object(u.a)({},e),{},{loading:!0});case w(Nn):return Object(u.a)(Object(u.a)({},wn),{},{errorMessage:t.payload.message});case S(Nn):return Object(u.a)(Object(u.a)({},wn),{},{relationshipTypes:t.payload.data.results});case Sn:return Object(u.a)({},wn);default:return e}},Pn=n(196),An="otherPersonInput",Dn={name:"relationshipType",required:!1,type:"select"},Mn={name:"otherPerson",required:!1},Rn=[Dn,Mn],En={relationshipType:"",otherPerson:null,otherPersonInput:""},Vn=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).state={invalidFields:[],relatives:[],otherPersonInput:""},e.loadOptions=E.a.debounce((function(t){e.props.search(e.state.otherPersonInput)}),500),e.addRelative=function(){var t=e.state.relatives;t.push(Object(u.a)({},En)),e.setState({relatives:t})},e.relationshipTypeOptions=function(){return e.props.relationshipTypes.filter((function(e){return!e.retired})).flatMap((function(e){return[{value:e.uuid+"-A",label:e.displayAIsToB},{value:e.uuid+"-B",label:e.displayBIsToA}]}))},e.removeRelative=function(t){return function(){var n=e.state.relatives;n.length>1&&n.splice(t,1),e.setState({relatives:n})}},e.onChangeEvent=function(t,n){return function(a){return e.onChange(t,n)(a.target.value)}},e.setOtherPersonInput=function(t,n,a){a[t].otherPersonInput=n,e.setState({relatives:a,otherPersonInput:n})},e.onChange=function(t,n){return function(a){var i=e.state.relatives,s=e.props,o=s.patient,r=s.onPatientChange;n===An?(e.setOtherPersonInput(t,a,i),e.loadOptions()):(i[t][n]=a,e.setState({relatives:i})),o.relatives=i,r(o)}},e.onFocus=function(t){return function(n){var a=e.state.relatives,i=a[t][Mn.name];i&&(e.setOtherPersonInput(t,i.label,a),e.props.search(i.label))}},e.patientOptions=function(t){var n=e.state.relatives[t].otherPersonInput;return n&&n.length>=3?e.props.patients.map((function(e){return{value:e.uuid,label:e.person.display}})):[]},e.relative=function(t,n){var a=e.props.intl.formatMessage({id:"registerPatient.fields.otherPerson"});return Object(Ae.jsxs)(V.a,{className:"d-flex flex-row flex-wrap w-100",children:[Rn.includes(Dn)&&Object(Ae.jsx)(Gn,Object(u.a)(Object(u.a)({},e.props),{},{field:Dn,selectOptions:e.relationshipTypeOptions(),value:t[Dn.name],onChange:e.onChangeEvent(n,Dn.name),onKeyDown:null})),Rn.includes(Mn)&&Object(Ae.jsxs)("div",{className:"input-container flex-fill",children:[Object(Ae.jsx)(Pn.a,{options:e.patientOptions(n),onInputChange:e.onChange(n,An),onChange:e.onChange(n,Mn.name),className:"flex-fill other-person",classNamePrefix:"default-select",placeholder:a,value:t.otherPerson,inputValue:t.otherPersonInput,onKeyDown:n+1===e.state.relatives.length?e.props.onKeyDown:null,onFocus:e.onFocus(n),isFocused:!0}),(!!t.otherPerson||!!t.otherPersonInput)&&Object(Ae.jsx)("span",{className:"placeholder",children:a})]}),Object(Ae.jsxs)("div",{className:"align-items-center justify-content-center d-flex",children:[Object(Ae.jsx)("img",{src:yn,alt:"add",className:"mx-2",onClick:e.addRelative}),Object(Ae.jsx)("img",{src:Cn,alt:"remove",onClick:e.removeRelative(n)})]})]})},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.props.getRelationshipTypes(),this.props.reset()}},{key:"componentDidUpdate",value:function(e,t,n){var a=this.props.patient;e.patient!==a&&a&&this.setState({relatives:a.relatives&&a.relatives.length>0?a.relatives:[Object(u.a)({},En)]})}},{key:"render",value:function(){var e=this;return Object(Ae.jsx)(Ae.Fragment,{children:E.a.map(this.state.relatives,(function(t,n){return e.relative(t,n)}))})}}]),n}(i.a.Component),In={getRelationshipTypes:function(){return{type:Nn,payload:C.a.get("/openmrs/ws/rest/v1/relationshiptype?v=full")}},search:Ne,reset:we},Ln=Object(x.connect)((function(e){var t=e.relationshipType,n=e.cflPatient;return{relationshipTypes:t.relationshipTypes,patients:n.patients||[]}}),In)(Object(L.c)(Vn)),kn=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).render=function(){var t=e.props,n=t.intl,a=t.field,i=t.isInvalid,s=t.isDirty,o=t.className,r=t.value,c=t.patient,l=a.name,d=a.required,p=a.label,m=!!r||!!c[a.name],f=cn(n,p,l,d),g=Object(u.a)(Object(u.a)({},ln(e.props,f)),{},{placeholderText:f,selected:null!=r?r:c[l]});return Object(Ae.jsxs)("div",{className:"".concat(o," input-container"),children:[Object(Ae.jsx)(_.a,Object(u.a)(Object(u.a)({},g),{},{peekNextMonth:!0,showMonthDropdown:!0,showYearDropdown:!0,dropdownMode:"select",dateFormat:K})),m&&Object(Ae.jsx)("span",{className:"placeholder",children:f}),s&&i&&Object(Ae.jsx)(gn,{hasValue:m,field:a})]})},e}return n}(i.a.Component),Fn=Object(x.connect)((function(){return{}}),{})(Object(L.c)(kn)),Un=(n(468),function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).inputRef=i.a.createRef(),e.getErrorMessage=function(e){if(e.length>0&&!Object(et.c)(e))return"registerPatient.invalidPhoneNumber"},e.removePlusSign=function(e){return e&&e.substring(1)},e.render=function(){var t=e.props,n=t.intl,a=t.field,i=t.isInvalid,s=t.isDirty,o=t.className,r=t.value,c=t.patient,l=a.name,d=a.required,p=a.label,m=tt(r||c[a.name]||""),f=cn(n,p,l,d),g=ln(e.props,f),h=e.getErrorMessage(m),b=e.props["data-testid"]||l;return Object(Ae.jsxs)("div",{className:"".concat(o," input-container"),children:[Object(Ae.jsx)(et.a,Object(u.a)(Object(u.a)({},g),{},{value:m,onChange:function(t){return g.onChange(e.removePlusSign(t))},ref:e.inputRef,international:!0,numberInputProps:{className:g.className},className:null,"data-testid":b})),m.length>0&&Object(Ae.jsx)("span",{className:"placeholder",children:f}),(s&&i||h)&&Object(Ae.jsx)(gn,{hasValue:m.length>0,message:h,field:a})]})},e}return n}(i.a.Component)),Bn=Object(x.connect)((function(){return{}}),{})(Object(L.c)(Un)),qn=vn,Wn={buttons:fn,select:xn,number:vn,text:vn,phone:Bn,date:Fn,relatives:Ln};var Gn=function(e){var t=e.field.type||"text",n=Wn[t]||qn;return Object(Ae.jsx)(n,Object(u.a)({},e))},Hn="location/SEARCH_LOCATIONS",Yn="location/GET_LOCATION",Qn="location/GET_LOCATION_ATTRIBUTE_TYPES",zn="location/POST_LOCATION",Kn={loadingLocations:!1,locations:[],errorMessage:"",locationAttributeTypes:[],loadingLocationAttributeTypes:!1,success:!1,loadingLocation:!1,location:null},Zn=function(e){var t="/openmrs/ws/rest/v1/location".concat(e?"?q="+e:"");return{type:Hn,payload:C.a.get(t)}},Jn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N(Hn):return Object(u.a)(Object(u.a)({},e),{},{loadingLocations:!0});case N(Yn):return Object(u.a)(Object(u.a)({},e),{},{loadingLocation:!0});case N(Qn):return Object(u.a)(Object(u.a)({},e),{},{loadingLocationAttributeTypes:!0});case w(Hn):return Object(u.a)(Object(u.a)({},e),{},{errorMessage:t.payload.message});case S(Hn):return Object(u.a)(Object(u.a)({},e),{},{loadingLocations:!1,locations:t.payload.data.results});case S(Yn):return Object(u.a)(Object(u.a)({},e),{},{loadingLocation:!1,location:t.payload.data.results[0]});case S(Qn):return Object(u.a)(Object(u.a)({},e),{},{loadingLocationAttributeTypes:!1,locationAttributeTypes:t.payload.data.results});case S(zn):return Object(u.a)(Object(u.a)({},e),{},{success:!0});default:return e}},Xn="locations",_n="relatives",$n="phone",ea="birthdate",ta=["birthdateYears","birthdateMonths"],na=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).state={invalidFields:[],dirtyFields:[]},e.fetchOptionSources=function(){var t=e.props.stepDefinition;(t.fields?t.fields.map((function(e){return e.optionSource})).filter((function(e){return!!e})):[]).includes(Xn)&&e.props.searchLocations()},e.getOptions=function(t){var n,a=t.optionSource,i=void 0===a?st:a,s=e.props.locations,o=t.options,r=void 0===o?[]:o;return i===Xn&&s?s.map((function(e){return{value:e.uuid,label:e.display}})):((null===(n=e.props[i])||void 0===n?void 0:n.length)&&(r=e.props[i]),r)},e.getClassName=function(t){var n=e.props.stepDefinition,a=n.columns&&n.columns.toString();return"1"===a?"col-sm-12":"2"===a?"col-sm-6":"3"===a?"col-sm-4":"4"===a?"col-sm-3":"buttons"===t.type?"col-sm-12":"col-sm-4"},e.validateField=function(t){var n=e.props.patient[t.name],a=e.getPatientIdentifierType(t),i=t.regex||(null===a||void 0===a?void 0:a.format),s=t.required&&!n;if(t.type===$n&&n&&(s=!Object(et.c)(tt(n))),i){var o=new RegExp(i);s=!(!(t.required||a.required)&&!n)&&!o.test(n)}if((ea===t.name||ta.includes(t.name))&&ta.every((function(t){return!!e.props.patient[t]})))return!1;return s},e.isFieldNonEmpty=function(t){return!!e.props.patient[t.name]},e.validate=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.props.stepDefinition.fields,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:E.a.filter(t,e.isFieldNonEmpty),a=E.a.filter(t,e.validateField),i=[].concat(Object(ge.a)(e.state.dirtyFields),Object(ge.a)(n));e.setState({invalidFields:a,dirtyFields:i});var s=0===a.length,o=i.length>0;return e.props.setValidity(s,o),s},e.handleLastFieldKeyDown=function(t){var n=e.props.stepDefinition.fields;if("Tab"===t.key)if(t.shiftKey)e.props.stepNumber>0&&e.props.setStep(e.props.stepNumber-1);else{var a=e.validate(n,n);t.preventDefault(),a&&e.props.setStep(e.props.stepNumber+1)}},e.getPatientIdentifierType=function(t){return e.props.patientIdentifierTypes.find((function(e){return e.name===t.name&&e.format}))},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.fetchOptionSources(),this.validate()}},{key:"componentDidUpdate",value:function(e,t,n){e.stepDefinition!==this.props.stepDefinition&&this.fetchOptionSources(),e.patient!==this.props.patient&&this.validate()}},{key:"render",value:function(){var e=this,t=this.props,n=t.stepDefinition,i=t.patient,s=this.state,o=s.invalidFields,r=s.dirtyFields;return Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsxs)("div",{className:"step-fields",children:[Object(Ae.jsxs)("div",{className:"step-title",children:[Object(Ae.jsx)("h2",{children:n.title}),Object(Ae.jsx)("p",{children:n.subtitle})]}),Object(Ae.jsx)(V.a,{className:"d-flex flex-row flex-wrap",children:E.a.map(n.fields,(function(t,s){var c=e.getOptions(t),l={},d=e.getPatientIdentifierType(t);return(s===n.fields.length-1||t.name===ea&&i[ea])&&(l.onKeyDown=e.handleLastFieldKeyDown),d&&(l.message=d.formatDescription),"separator"===t.type?Object(Ae.jsx)("p",{className:t.class||"col-7 offset-5 col-sm-10 offset-sm-2 mb-5 mt-5",children:t.label},"field-".concat(s)):Object(a.createElement)(Gn,Object(u.a)(Object(u.a)({},e.props),{},{field:t,isInvalid:!!o.find((function(e){return e.name===t.name})),isDirty:!!r.find((function(e){return e.name===t.name})),className:e.getClassName(t),selectOptions:c,key:"field-".concat(s),"data-testid":t.name},l))}))})]},n.name),this.props.stepButtons(0===o.length)]})}}]),n}(i.a.Component),aa={searchLocations:Zn},ia=Object(x.connect)((function(e){return{locations:e.location.locations}}),aa)(Object(L.c)(na)),sa=(n(1121),n(1996)),oa=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).state={},e.validate=function(){return!0},e.birthdate=function(t){var n=e.props.intl;if(t.birthdate)return Z(0,new Date(t.birthdate));if(t.birthdateYears||t.birthdateMonths){var a=!!t.birthdateYears&&t.birthdateYears+" "+n.formatMessage({id:"registerPatient.steps.confirm.years"}),i=!!t.birthdateMonths&&t.birthdateMonths+" "+n.formatMessage({id:"registerPatient.steps.confirm.months"});return[n.formatMessage({id:"registerPatient.steps.confirm.estimated"}),a,i].filter(Boolean).join(" ")}},e.location=function(t,n){var a,i=t[n];if(i)return null===(a=e.props.locations.find((function(e){return e.uuid===i})))||void 0===a?void 0:a.display},e.relationshipType=function(t){var n=e.props.relationshipTypes.find((function(e){return t.indexOf(e.uuid)>=0}));return n&&(t.endsWith("-A")?n.displayAIsToB:n.displayBIsToA)},e.relatives=function(t){return t.relatives&&t.relatives.filter((function(e){return!!e.relationshipType&&!!e.otherPerson})).map((function(t){return[e.relationshipType(t.relationshipType),t.otherPerson.label].join(" - ")})).join(", ")},e.getFieldLabel=function(t){return t.label?t.label:e.props.intl.formatMessage({id:"registerPatient.fields."+t.name,defaultMessage:t.name})},e.getFieldValue=function(e,t){var n=e[t.name];if(t.options){var a=t.options.find((function(e){return e.value===n||e===n}));if(a)return a.label||a}return"phone"===t.type&&n?Object(et.b)(tt(n)):n},e.sections=function(t){var n=e.props.steps,a=[];return n.forEach((function(n){var i,s=n.fields.find((function(e){return e.optionSource===Xn}));if(n.fields.find((function(e){return ea===e.name||ta.includes(e.name)})))i=e.birthdate(t);else if(n.fields.find((function(e){return e.type===_n})))i=e.relatives(t);else{if(!s)return n.fields.filter((function(n){return!!n.name&&!!e.getFieldValue(t,n)})).forEach((function(n){a.push({label:e.getFieldLabel(n),value:e.getFieldValue(t,n)})})),a;i=e.location(t,s.name)}a.push({label:n.label,value:i})})),a},e.renderField=function(e){return Object(Ae.jsxs)("div",{className:"mb-3 col-confirm",children:[Object(Ae.jsx)("div",{className:"col-sm-4 col-confirm-label",children:Object(Ae.jsxs)("span",{className:"helper-text",children:[e.label,":"]})}),Object(Ae.jsx)("div",{className:"col-sm-8",children:Object(Ae.jsx)("span",{children:e.value})})]},"field-".concat(e.label))},e.errors=function(e){return e&&E.a.map(e,(function(e){return Object(Ae.jsx)(sa.a,{color:"danger",children:e&&e.replace(/<\/?[^>]+(>|$)/g,"")})}))},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.sections(this.props.patient),n=Math.floor(t.length/2),a=this.props.errors;return Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsxs)("div",{className:"step-fields",children:[this.errors(a),Object(Ae.jsxs)("div",{className:"step-title",children:[Object(Ae.jsx)("h2",{children:Object(Ae.jsx)(g.a,{id:(this.props.isCaregiver?"registerCaregiver":"registerPatient")+".steps.confirm.title"})}),Object(Ae.jsx)("p",{children:Object(Ae.jsx)(g.a,{id:(this.props.isCaregiver?"registerCaregiver":"registerPatient")+".steps.confirm.subtitle"})})]}),Object(Ae.jsxs)("div",{className:"row",children:[Object(Ae.jsx)("div",{className:"col-sm-6",children:t.slice(0,n).map((function(t){return e.renderField(t)}))}),Object(Ae.jsx)("div",{className:"col-sm-6",children:t.slice(n).map((function(t){return e.renderField(t)}))})]})]}),this.props.stepButtons(this.validate)]})}}]),n}(i.a.Component),ra=Object(x.connect)((function(e){var t=e.relationshipType,n=e.location,a=e.registration;return{relationshipTypes:t.relationshipTypes,locations:n.locations,errors:a.errors}}),{})(Object(L.c)(oa)),ca=n(963),la="biometric.api.config.main",da={fields:[{}]},ua=E.a.sortBy(Object(ca.getData)(),"name").map((function(e){var t=e.name;return{label:t,value:t}})),pa=["field","type","name","displayOrder"],ma=[{value:"country",label:"Country"},{value:"site",label:"Site"},{value:"cluster",label:"Cluster"}],fa=[{value:"id_card",label:"ID Card"},{value:"phone",label:"Phone"},{value:"iris_scan",label:"Iris Scan"}],ga={syncScope:ma[0].value,operatorCredentialsRetentionTime:6048e5,operatorOfflineSessionTimeout:432e5,vaccine:[{}],canUseDifferentManufacturers:!0,allowManualParticipantIDEntry:!0,manufacturers:[{}],personLanguages:[],authSteps:[{}],irisScore:null,addressFields:[],participantIDRegex:"",isBiometricOnlySearchWithoutPhone:!0},ha=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).state={step:0,patient:{},stepValidity:{},visitedSteps:[0],success:!1},e.entityName=e.props.isCaregiver?"Caregiver":"Patient",e.steps=function(){return e.props.isCaregiver?e.props.caregiverSteps:e.props.patientSteps},e.patient=function(){return e.props.isCaregiver?e.props.person:e.props.patient},e.formName=function(){return e.isEdit()?"edit".concat(e.entityName):"register".concat(e.entityName)},e.setStep=function(t){var n=Math.max(t,Math.max.apply(Math,e.state.visitedSteps));e.setState({step:t,visitedSteps:Object(ge.a)(Array(n+1)).map((function(e,t){return t}))})},e.canVisitStep=function(t){return Math.max.apply(Math,e.state.visitedSteps)>=t||!!Object(ge.a)(Array(t)).every((function(t,n){var a;return null===(a=e.state.stepValidity[n])||void 0===a?void 0:a.isValid}))},e.onStepClick=function(t){return function(n){e.canVisitStep(t)&&e.setStep(t)}},e.stepList=function(){var t=e.state,n=t.stepValidity,a=t.visitedSteps,i=e.steps().length===e.state.step;return Object(Ae.jsxs)(Lt.a,{children:[E.a.map(e.steps(),(function(t,i){var s,o=null===(s=n[i])||void 0===s?void 0:s.isValid,r=a.indexOf(i)>=0,c=i===e.state.step,l=o?c?qt:Bt:null;return Object(Ae.jsxs)(kt.a,{active:i===e.state.step,onClick:e.onStepClick(i),className:o&&r?"valid":"",children:[l&&Object(Ae.jsx)("img",{src:l,alt:"step",className:"step-icon"}),t.label]},"step-".concat(i))})),Object(Ae.jsx)(kt.a,{active:i,onClick:e.onStepClick(e.steps().length),children:Object(Ae.jsx)(g.a,{id:"registerPatient.steps.confirm.label"})},"step-".concat(e.steps().length))]})},e.stepForm=function(){var t,n,a=[];if(null===(t=e.props.settings)||void 0===t||null===(n=t.setting)||void 0===n?void 0:n.value){var i=JSON.parse(e.props.settings.setting.value).vaccine;a=i.map((function(e){return e.name}))}return Object(Ae.jsxs)(Ee.a,{className:"h-100 w-100",children:[E.a.map(e.steps(),(function(t,n){return Object(Ae.jsx)("div",{className:"step-content ".concat(n===e.state.step?"":"d-none"),children:Object(Ae.jsx)(ia,{patient:e.state.patient,onPatientChange:e.onPatientChange,stepButtons:e.stepButtons(n),stepDefinition:t,patientIdentifierTypes:e.props.patientIdentifierTypes,setValidity:e.setValidity(n),setStep:e.setStep,stepNumber:n,regimens:a})},"step-".concat(n))})),Object(Ae.jsx)("div",{className:"step-content ".concat(e.steps().length===e.state.step?"":"d-none"),children:Object(Ae.jsx)(ra,{patient:e.state.patient,onPatientChange:e.onPatientChange,stepButtons:e.stepButtons(e.steps().length),steps:e.steps(),isCaregiver:e.props.isCaregiver})},"step-".concat(e.steps().length))]})},e.onNextClick=function(t){return function(n){t&&e.setStep(e.state.step+1)}},e.isFormValid=function(){return E.a.isEmpty(E.a.pickBy(e.state.stepValidity,(function(e){return!e.isValid})))},e.onConfirmClick=function(t){!e.props.loading&&e.isFormValid()&&(e.isEdit()?e.props.isCaregiver?(e.props.updateRelationships(e.state.patient),e.props.editPerson(e.state.patient)):e.props.editPatient(e.state.patient):e.props.isCaregiver?e.props.registerPerson(e.state.patient):e.props.register(e.state.patient))},e.stepButtons=function(t){return function(n){var a=e.props.isCaregiver?"caregiver":"patient",i=e.steps().length;return Object(Ae.jsxs)("div",{className:"step-buttons",children:[t>0?Object(Ae.jsx)(I.a,{id:"".concat(a,"-previous-button"),onClick:function(){return e.setStep(t-1)},children:Object(Ae.jsx)(g.a,{id:"registerPatient.previous"})}):Object(Ae.jsx)("div",{}),t<i?Object(Ae.jsx)(I.a,{id:"".concat(a,"-next-button"),onClick:e.onNextClick(n),disabled:!n||t>=i+1,className:"next",children:Object(Ae.jsx)(g.a,{id:"registerPatient.next"})}):Object(Ae.jsx)(I.a,{id:"".concat(a,"-confirm-button"),onClick:e.onConfirmClick,className:"next",disabled:e.props.loading||!e.isFormValid(),children:Object(Ae.jsx)(g.a,{id:"registerPatient.confirm"})})]})}},e.onPatientChange=function(t){return e.setState({patient:Object(u.a)({},t)})},e.setValidity=function(t){return function(n,a){var i=e.state.stepValidity;i[t]={isValid:n,isDirty:a},e.setState({stepValidity:i})}},e.success=function(){var t=e.props,n=t.location,a=t.id;return window.location.href=a?"".concat(v,"?patientId=").concat(a).concat(e.props.isCaregiver?"&dashboard=person":""):b.a.stringifyUrl({url:O(n.search)}),Object(Ae.jsx)(Ie.a,{})},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.props.getPatientIdentifierTypes(),this.props.getSettingByQuery(la),this.isEdit()&&(this.props.getPersonRelationships(this.props.match.params.id),this.props.isCaregiver?this.props.getPerson(this.props.match.params.id):this.props.getPatient(this.props.match.params.id))}},{key:"componentDidUpdate",value:function(e,t,n){var a,i;if(this.isEdit())if((this.props.isCaregiver?e.person:e.patient)!==this.patient()&&this.patient()){var s,o=Object(u.a)({relatives:(null===(s=this.state.patient)||void 0===s?void 0:s.relatives)||[]},at(this.patient()));this.setState({patient:o,stepValidity:{},visitedSteps:E.a.map(this.steps(),(function(e,t){return t}))})}else if(e.personRelationships!==this.props.personRelationships&&null!=this.props.personRelationships){var r=Object(u.a)(Object(u.a)({},this.state.patient),{},{relatives:(a=this.props.match.params.id,i=this.props.personRelationships,i.map((function(e){var t=e.personA,n=e.personB,i=e.relationshipType,s=t.uuid===a;return{relationshipType:s?i.uuid+"-B":i.uuid+"-A",otherPerson:{label:s?n.display:t.display,value:s?n.uuid:t.uuid}}})))});this.setState({patient:r})}!e.success&&this.props.success&&this.setState({success:!0})}},{key:"isEdit",value:function(){var e=this.props.match;return e&&e.params.id}},{key:"render",value:function(){if(this.props.settingsLoading)return Object(Ae.jsx)(Ie.a,{});var e=this.formName();return Object(Ae.jsx)("div",{className:"register-patient",children:this.state.success?this.success():Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsx)("h1",{children:Object(Ae.jsx)(g.a,{id:"".concat(e,".title")})}),Object(Ae.jsx)("div",{className:"helper-text",children:Object(Ae.jsx)(g.a,{id:"".concat(e,".subtitle")})}),Object(Ae.jsxs)(Ft.a,{className:"mt-2",children:[Object(Ae.jsx)(Ut.a,{xs:4,sm:3,className:"step-list",children:this.stepList()}),Object(Ae.jsx)(Ut.a,{xs:8,sm:9,className:"step",children:this.stepForm()})]})]})})}}]),n}(i.a.Component),ba={register:function(e){var t=Jt(e);return{type:Yt,payload:C.a.post("/openmrs/ws/cfl/patientRegistration",t)}},registerPerson:function(e){var t=Jt(e);return{type:Yt,payload:C.a.post("/openmrs/ws/cfl/caregiverRegistration",t)}},getPatient:Se,getPerson:an,editPatient:function(e){var t=Jt(e);return{type:zt,payload:C.a.put("/openmrs/ws/cfl/patientRegistration",t)}},editPerson:function(e){var t=Jt(e);return{type:zt,payload:C.a.put("/openmrs/ws/cfl/caregiverRegistration",t)}},updateRelationships:function(e){var t=Jt(e);return{type:Qt,payload:C.a.post("/openmrs/cfl/field/personRelationship/updateRelationships.action",Gt.a.stringify(t))}},getPersonRelationships:function(e){var t="/openmrs/ws/rest/v1/relationship?v=default&person=".concat(e);return{type:tn,payload:C.a.get(t)}},getPatientIdentifierTypes:function(){return{type:Kt,payload:C.a.get("/openmrs/ws/rest/v1/patientidentifiertype?v=default")}},getSettingByQuery:G},ja=Object(x.connect)((function(e){var t=e.registration,n=e.cflPatient,a=e.cflPerson,i=e.apps,s=e.settings;return{loading:t.loading,success:t.success,message:t.message,id:t.id,patientIdentifierTypes:t.patientIdentifierTypes,patient:n.patient,person:a.person,personRelationships:a.personRelationships,patientSteps:i.patientRegistrationSteps||on,caregiverSteps:i.caregiverRegistrationSteps||rn,settingsLoading:i.loading||t.loading,settings:s}}),ba)(Object(L.c)(Object(m.withRouter)(ha))),va=function(){return Object(Ae.jsx)(ja,{isCaregiver:!1})},Oa=function(){return Object(Ae.jsx)(ja,{isCaregiver:!0})},xa=(n(1126),function(){return Object(Ae.jsxs)("div",{className:"dashboard",children:[Object(Ae.jsx)("h2",{className:"title",children:Object(Ae.jsx)(g.a,{id:"home.title"})}),Object(Ae.jsxs)("div",{className:"items",children:[Object(Ae.jsx)(p.b,{to:"/find-patient",className:"item",children:Object(Ae.jsxs)("div",{className:"item-content",children:[Object(Ae.jsx)("div",{className:"item-icon",children:Object(Ae.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEoAAABBCAYAAAB2FzKyAAAABHNCSVQICAgIfAhkiAAAABl0RVh0U29mdHdhcmUAZ25vbWUtc2NyZWVuc2hvdO8Dvz4AAAAndEVYdENyZWF0aW9uIFRpbWUAY3p3LCA0IG1hciAyMDIxLCAxNDoxMjowOZ1ZZcIAAAixSURBVHic7ZvbU9tGFIc/yZJtGTu+xUAMtECgEOh0QkJCkoem7UvzmD82j5lpJ5NLJzADJSVXMCFAwOC7pdiSLakPHRxoE/BFFk2Gb4ZhYKyz65/27O45Z1ewbdvmjBMRT7sDXwpnQjXJmVBNciZUk0in1bBt25imiaqqFItFCoUCmqZRq9WwLAuPx4OiKEQiEWKxGKFQCFmWEQThVPp7KkJZloWqqrx8+ZK9vT2KxSL5fB5VVTEMoyFUIBAgGo0Sj8fp6+tjeHiYRCKBx+Nxvc+C29sD0zTJ5XKsrKzw9OlTPnz40NRzgUCA7777jqmpKQYGBujp6elyT4/iqlCmaZLNZpmfn2d5eRld11t63uPxcOHCBa5evcrk5CSKonSpp//FVdfTNI2VlRUWFhZo5/2YpsnW1haCIBAIBJiYmOhCLz+Na6tevV5nZ2eHv/76qy2RDrOzs8Pr16+pVqsO9e5kXBOqVCqRSqXIZrMd26rX66TTaTY3Nx3oWXO4JlShUGBjY8Mxe7lcjnfv3jlm7yRcEcq2bTRNI5/PO2ZT13VUVe3YjZvFFaEMw0BV1ZZXueMwTRNd16nX647ZPA7XhKpUKo7brdfrjop/HF90rCeKIrIsu9OWG434/X6CwaCjNkVRxOfz4fV6HbX72fbcaESSJBRFcfRLybKM3+93LUh2RShBEPD7/YRCIcftuoVrc5QgCI5H/W7G864J5fF4HJ14JUnC5/M5Zu8kXBPK7/dz7tw5x+wFAgFisZhj9k7CNaFCoRCDg4OOTOiCIBCLxRgYGHCgZ83hmlCKojA8PMzo6GjHtiKRCMPDw0SjUQd61hyuzlGxWMwRoXp7exkZGUGS3Eunuboz93q9JBIJzp8/37aNc+fO8c0337g6P4HLQnk8HhKJBJcvX25rrpIkidHRUcbHx13bkR/geqzX09PDxMQEvb29LT8bj8cZHx9v69lOcV0oQRCQZbkt94vFYq5O4Ic5lezBQeGzVTRNQ9O0LvToZFwXyjAMMpkMmUym5WcLhQLZbNa1ZN1hXBPKsiw+fPjAxsYGjx8/plAotGyjXC6zsbHB5uYmmqZhmmYXevppuloAtW0by7IwDINiscjq6irLy8vs7e11ZDcWizE1NcXk5CTRaBRZlpEkCVHs3nvvilC2bVOv16lUKuTzeVKpFC9evGB/f9+xiF8QBILBICMjI4yNjdHX10c4HMbr9XZFMMeEsm27MYJ0XefVq1csLCywu7uLZVlONHEsfr+fyclJfvrpJ4LBYCOl41TOyjGhLMtibW2N5eVl3r5962op6TCKojA+Ps7t27eJxWL/L6Gq1SpPnz5lcXGRYrHoygg6joOiw48//siVK1ccSRk7ItRvv/3G0tISpVLpVEbR5/B6vUxOTvLrr792fEyo4/D7/fv3rK6uUi6X/xciybJMMpmkt7eXYDBIIBAA/plDOxlVHQllGAa///47e3t7p+puByvg2NgY09PTeL3eRhVZEAQKhQKmadLT09N23r4joXZ3d0mn09RqtU7MdIQoiiSTSW7fvo2iKDx79ozt7W3q9Xrj5Ymi2DiEduPGDeLxeMujqyOhnj171pVSebOIosjAwADXr19H13UWFhbY3Nz87HHHbDZLPp/n+++/Z2xsrKXyWdtC5XI5UqnUqY0mURQZHBxkdnaWWq3G/Pw86XT62CmgWq2yvr5OsVhE13Wmp6ebFqttodbW1k5trwT/5LVGR0cJh8Pcv3+fnZ0d4ONK9+2331KtVnn16hXb29uNuNCyLDKZDIuLi0QiESYmJppyw7aFevfunatB6b9JJBLE43FevHjB+/fvgX9KWLOzs4yPj+PxeBAEgUQiwfPnz3n58uWRo4z7+/s8f/6cSCRCf3//ie21HRRlMplTW+n8fj+9vb1YlsXKygqmaeLz+ZiYmOCHH35gc3OTBw8e8Mcff2CaJrOzs/T19R1Z8Q4iibdv3zY1fbQ8omzbRtd1SqXSqQkVCoUIh8Nomka5XAYgGAwyMzNDsVjk8ePHjcSgqqrcvXuX/v5+0un0ES/QNI1sNkulUjmxit3yiLJtm1wuh2EYrT7qGIqi4PP5jriSLMtEo1FKpdKR7Gkul2uMuE9lFXRdb+owWluu59Ypt88hSRKSJB0ZHbqus7OzQzwe5/z5841jQclkEkmSqFQqn/QA0zSbmmtbdr2DcrbP5zu1rYFlWf8JSTRNY3FxkV9++YVbt26xvb2NJElMTU3h9/s/uzoLgtCdVU8QBMLhMKOjo2xtbVEqlVzPYR+4y+HTLIZhsL6+zp9//smlS5cYGhrCsixqtRqlUomxsTGy2SxbW1tHXrDX622qRtj29uDnn38mlUrx+vVr8vl84wrZ4dChW5TLZVRVJRwOI8ty44tXq1WePHnCmzdvCIfD1Ot1CoUCQ0NDzM3NMTc3h23bbG1tUa/XkSSJUCjUCJyPo22hotEoV69e5cqVK2xvb7O+vs7e3h6lUglN06hUKl073nywWvX39zM8PMzq6mrDtUzTJJ1Ok06nG5/P5XLYts3c3BzT09OoqkomkyGZTDI0NNTUOauO0yyCIDA4OMjg4CDwcVVMpVKsra2xv7/fuIN3OF18+O/DP5+yf/BbEAREUUQQBPL5PIZhcPPmTXZ3dxvbhM+xvLxMrVYjGAximiaBQICZmRkuXrzY3Pfs9jW0Wq3WKFxWKhU0TUNVVcrlcuN/1WoVXdcxDAPTNBuCiaKIJEnIsozP50NRFHp6eggGg0QiEZLJJMFgkMXFRR4+fNj0lkWWZWZmZrh+/XrTFWvXLzZ2A03TWFpa4tGjRydelPT7/czMzHDt2rWWTsR8FUIduG2xWOTevXusra198nMDAwPcuXOHZDLZcOFm+SqEgo9i6bpOPp8nl8s1du4+n49IJEI0GkVRlJZFgq9IqAP+vVgAjUWgHYEO+OqE6hZf9KUhNzkTqknOhGqSM6Ga5G/krU8+wK6gGQAAAABJRU5ErkJggg==",alt:"icon"})}),Object(Ae.jsx)("div",{className:"item-label",children:Object(Ae.jsx)(g.a,{id:"dashboard.findPatient"})})]})}),Object(Ae.jsx)(p.b,{to:"/find-caregiver",className:"item",children:Object(Ae.jsxs)("div",{className:"item-content",children:[Object(Ae.jsx)("div",{className:"item-icon",children:Object(Ae.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAA3CAYAAAC/+UKPAAAABHNCSVQICAgIfAhkiAAACTxJREFUaIHlmtlPFNkXxz/VNBRN2yCL3YgIAoK70bjNxMm4xBDFB5fEJYa4xATejL76T/BkAj65x8QtOGSwJT0Pg8sYcA9EwaYRVKQFGuhukKWrfg891FDSzXQVZXT8fZ/oW/fcc7/33nPuOeciyLIs838Gs1EDybLMwMAAfr+fsbExTCYTFouF1NRUEhISjFJjCAwh7fP5uHr1Kt3d3VMVmM1s3bqVn3/+GUEQjFA3YwgzOd4jIyPU1tby8uVLQqFQdCWCQEZGBiUlJeTl5elVZxh0kx4ZGeHy5ct0dHTELGM2m9m7dy9Lly7Vo9IwmPQIjY+PU1VVpYnwhNzNmzfp7e3Vo9YwaN7pnp4ebty4wcePH9FrGaIosmXLFn766Sdd8jOF5p12uVx0dXXpJgxh07h79y79/f26x5gJNJPu6+szRLEkSXR2dhoyllZoJj02NmaY8qGhIcPG0gLNpKe7mrTCyAXUAs2kjQwwvlWwopl0fHy8YcqTkpIMG0sLNJOOi4szTPm3isk1kX7+/DkfP340THl9fb2hPiJWaCL9119/Gaq8r6/v+yf9o6TemkivX7/eUOWpqamG+ohYoYn06tWrKSwsNESxxWKhuLj4m5DWnHDIskxDQwO1tbW6j3tycjLl5eVYrVZd8jOFruBkwYIFM9qhoqKib0YYdObTs2fP1h2kCILA6tWrdckaBV2kExISWLNmjS6FqampOBwOXbJGQRdpgG3btmGxWDTLFRUVYTYbVoTVBd2kQfsVlp6ezqZNm2ai0hDMiPTmzZtZsmRJTNlSYmIiu3fv1nU6jMaMSsAQvsJqa2tpaGiIeoXNnj2b8vLy74IwaCA9PDxMS0sLHR0dFBYWsnjxYtX3rq4u3G43nZ2dDA0NYTabycjIID8/n/z8fERRVPWvra3FarVSUFDAvHnzjGMUA6YlHQqFeP/+PTk5OdTV1XH//n0A0tLSKCsrIzExcYrM2NgYr169wuFwYLfbp3yXZRmXy8W9e/eUtlOnThEfH08oFMJmsxnBa1pEtelAIEBVVRW3bt0CUNW4+/r6uHr16hSZvr4+KioquHHjBpWVlcoiTca7d+94+PChqs3n8+H1eqmoqODZs2e6ycSKiKSbmpqorKzE6/WSmZkJMKVA397eTlNTk/K7sbGRs2fPKsU+SZKoq6vj/PnzSJIEhEu/v/3225R0cmhoCFEUEQSB27dvc/Pmza+ack65MJubm1VKbTYbsiwzOjqKIAgqZ3Xnzh1yc3OZNWsWKSkpESdqs9kwmcJr63K58Hq9U/qMjo4SHx+PIAiEQiFevHiB3+/n4MGDKl8QCATw+XwEAgHGx8cRRRGbzUZ6erqmKoyKdH9/P9evX1d2JiEhgcLCQgRB4PTp0zx+/Bin08n4+DgAfr+f6upqDh06RGFhIdu3b6empkZZGFEU2blzJxA+KY2NjTFPzOPx0NvbS1ZWFgDV1dU8ffo0Yl9RFCkuLo45SlQdb5fLpRCeM2cO5eXlFBQU0NLSgsfjYe3atRw+fFi1+h6PRznmK1euZNasWeGBTSaOHz+OKIoEAgEuXLigjB1p0mNjY8piWSwWjh07RlZWFq2trVRUVEQlDP+Yzblz5/D5fP9KWtlpWZZpa2tTPhQXF5OYmMiZM2cUe87KyqK0tJQdO3Zw+/ZtJElSHuXmzp1LXFwcnz9/BsI23dbWht1up76+nsHBwaiTSE5OJhgMIkkSgiDwyy+/kJuby6tXr7h27ZpiNqIokpmZid1ux2KxMDAwQHd3N16vF0mSaG9v5/Llyxw5cmTaW0Ah3dnZSTAYVD7k5OTw9OlTlQP78OED9+7dY+vWrdy9e1fltJxOJ0VFRcrRB3A6nYiiyKNHj6JOQBAE5syZQ319PbIsM2/ePDZu3IgkSVRXVyuE7XY7R48ejVg29ng8XLp0iVAoRE9PD2fPnuXkyZNR01/leL99+1ZptFgsiKKI2+2eIvDkyRMkSWLz5s2q9tbWVlwul8rRybLM77//HlFxUlIS69evZ9euXZjNZl68eAHAhg0bkGWZK1euMDw8DIRPWDTCAHl5eZSXl5OcnAyEfU1zc3PEvirSXV1dSuNELB0IBKYIfP78mdevX7NmzRpVtiTLsjLJyYj0dGMymTh8+DAlJSWsWrWKT58+4ff7AcjNzaWnp4f29nYArFYrpaWl//owYLfb+fXXX5XfDQ0NUfsqpCf/v8jQ0BChUChixAXQ0tJCXFwcKSkp004kGjIzM5X7H8DhcJCRkUFSUhIpKSl4vV7lWOfl5cX8ErJ27VrFkXZ0dETcNPibtCRJKnsGGBgYIDs7O6LQxI7qzYsHBwdVnjwUChEMBpUYfPKDf0FBgaaxFy5cqPwd7WHCBOHg4MsQvLu7m8WLF09xBjabjSVLliDLsu6n1kAgwMOHD/H7/QwODuJ0OgkGg0rdbLKZTNhprJjcP5K5wd/ee/IdOYHHjx9TWlrKnj17ePDgAR8+fABg37595OTk4HQ6FTvUg7q6Ourq6lRtE9fd5OhK68JO7v9lZjcBM4SP15ek3W43f/zxB1u2bGH58uVcvHgRt9uN0+nEZDLx7t07TZOJBRMLm5mZqYS8bW1trFixIiZ5WZaVG0cQhKi1ODMQMVKSZZk///yTxsZGRFFUIp33799rZxMjBgcH8fv9OBwO4uLiGB8fp62tjeHh4ZgKEE1NTco8HQ5HVEdrhrBDys7OVgUWX2LCK35t9Pf3M3/+fNLT0+nu7mZgYIALFy5QVlY2bVlKlmWVuUxXv5txuehrob+/n6qqKsUZLVq0iJKSkoi75/F4qKmpUUWPJ06cIC0tLeLY3y1pCAcYk7M6URRZtmwZ+fn5JCQkEAgEaG5uxu12T/FJixYtYs+ePRFjje+aNITz+8nprhbMnz+fY8eOKfn8BL570hAOMh48eEBTU1PEQoXVamXdunWkpaVRU1PD6Ogo8M+72/79+1WO8D9BegLBYJDW1la8Xi+jo6MkJSWRnZ1NQUGBEkS9efOGa9euMTIyosh9edT/U6RjRW9vL5WVlapkJycnh6NHj2IymWb2wvG9Ij09nX379qleVjs7O5Wc+4ckDeGHwgMHDigh7UR05/P5flzSEM64ysrKlB23Wq2kpqb+mDb9JbxerxLpWSwW/gczcD3JKiM8AgAAAABJRU5ErkJggg==",alt:"icon"})}),Object(Ae.jsx)("div",{className:"item-label",children:Object(Ae.jsx)(g.a,{id:"dashboard.findCaregiver"})})]})}),Object(Ae.jsx)(p.b,{to:"/register-patient",className:"item",children:Object(Ae.jsxs)("div",{className:"item-content",children:[Object(Ae.jsx)("div",{className:"item-icon",children:Object(Ae.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAABHNCSVQICAgIfAhkiAAAB4NJREFUaIHtW89PE1sYPdN2an9QWmpFoGBLLIaGqFQDKMFWg2KMC10YNZGVMW50Y1z4T7gzcUeiLgxGozEmVjBC/FlFJFCqUYnSUEq1rRRoaUunnXkLQx99QJl27vCS5zurZubec8/JnfvNvd83pTiO4/AHQfJvC1hv/G/4vw7ZegzCMAwCgQDGx8fh9XoRDAaRTCbBcRwUCgUMBgNqa2thsVhQUVEBmqZF00KJHbR8Ph+6u7sxPz/Pq71Wq0VnZyc2bdokih7RDGcyGfT09GB4eBipVKqgvgqFAvv378eePXuI6xJlDXMch/7+fgwMDBRsFgCSySSePHmCoaEh4tpEMezxePDq1SvBPI8ePcL09DQBRX9DFMNv374lwsNxHHp7e4lwLYK44VgshkAgQIzP6/Uik8kQ4yNueHh4GCzLEuNLJpMYHR0lxkfc8NjYGGlKjIyMEOMivvH45+NcVlYGg8EAmqYRiUQwNzeHRCIBlmUhkUigVCqh0+kglUoRj8cRiUQgl8uRSCSyHD6fj5g+oobj8XjOa8hqteLkyZOgKGpZW4ZhIJPJlt3z+/0YGhqCz+dDMBgEAKTTaaRSKcjlcsEaiRpeOitGoxGnTp1ate1q20ej0YiqqirE43Fcu3YNyWSSpESya3jp49zS0lI0D0VRUKvVMJlM2Wt8t6Zrgahhp9P5m1QiQUNDg2C+bdu2ZX+73W7BfABBwwzDZGfh/PnzkEqlgjltNlt2WczMzAjmAwgalkqlWZNqtZoIp0QigUajAQAiAQsgaFgikaC8vBzA79kmhcWgtcgtFETX8Pbt2wGQfW8url2j0UiEj6jhhoYGaDQa9Pb2YnBwUDBfT08PPB4PGhsbUVFRQUAhYcNarRaXL1+GTCbDixcvBHH9+PEDLpcLZrMZx48fJ6RQpONhXV0dotEo3r9/X1T/TCaDe/fuAQCam5tJShPHcGtrK2iahtPpxOzsbMH9v3//jnA4jC1btqC+vp6oNlEM6/V6OBwOsCyL/v7+gvqm02k8fPgQAHDgwAHi2kTLS9tsNpSUlMDtdsPlcvHu9+DBA8RiMTQ1NeVsLUlBNMMqlQrnzp2DSqVCX18fPB5P3sRAMpnE/fv38fHjR9TU1ODo0aOQSMjLEz0v7fV6cfPmTXAcB6vVihMnTizbdk5PT+PWrVuYmZmBTqfDhQsXREvGi24YAMbHx3Hnzh0kk0mo1WpUV1ejtLQUmUwGv379wtTUFNLpNMxmM44dOwadTiealnUxDACpVApOpxNjY2OIxWJ/C6Ao6PV62Gw2tLW1ia5DNMOLKZyV4Pf7MTU1BZqmUVdXt+phIx9HsRBkOBKJwO12Y2pqCtFoFIlEAgzDIJVKQSaT4ezZszAYDEVxh8Nh3LhxI5vaoWkaCoUCpaWlqKysxI4dO6DX6wvmLcpwKpXCu3fv8PLly7ylFKlUisOHD8NqtWaPeWshFovhy5cvePz4cd58NE3TcDgcaG5uLujoWJTh7u5ufP78mf8gFIWamhrs2rULFosFJSUlOffn5+fx7ds3DA4OwufzoRBJdXV1OHPmDH8thRp++vQpXr9+XUiX3AEpCjKZDDLZ7/xhOp1GOp0uyOQ/0dLSgiNHjvBqW1BECIVCGBgYKErUIjiOA8MwSCQS2TUvNG4ODQ0hHA7zasvbMMuy6OrqIprNIAWGYdDV1cWrxMM7L+33+wXniBsaGtDY2AiVSpW9xnEcEokERkdHBWUmE4kExsfHsXXr1rzteBsWUt+RSCRobW1Fe3v7ilUIALBYLNBoNHC5XEUX4zwez5qGeT3SLMsKMrxx40YcPHgQFEWB4ziEQiEEg0EEg0GEQiGwLAuKonDo0CFs3ry56HHWOqAAPGd4cnJS0NotKyvL/r579y4+ffqUc7++vh6nT58GABgMhqLrywzDYGJiAmazedU2vGZYaKBauj1cKZouvSY0gb+WVl4zXFVVlX0c+aKkpARNTU1QqVQ5M7wWdu7cCaPRiHg8jg8fPmBubo53X4qiUF1dnbcNL8NKpRJ2ux3Pnz/nNbDdbse+ffuKOtPW1taitrYWwO/cmMvlQl9fH6++e/fuhVKpzNuGd5S22+1gGAYjIyN5K3nl5eVwOByQSqVIp9M5JVQAKwYVlmURjUZzrimVStA0jba2NoyOjiIUCq06plKphM1mQ3t7+5o+Ct5aZjIZPHv2DG/evFnxfmdnJywWCxYWFnD16tWi179cLselS5egVCrx9etX3L59e8V2LS0t6Ojo4L32Cy6IS6VSdHR0wG634+fPnwgEApiYmEAgEMDMzAy0Wi0AYHZ2VlCwS6VSmJ6ehtFohE6nA0VR0Gq1qKqqQk1NDSorK1FRUQGFQlEQb9FfACgUCphMJphMpuwnggsLC9lDAcm8gl6vx5UrVwo2txKIfvKwYcMGknRZLD1dCYVoaVoSqRkx0rSifS+t1+uxe/duRCKRnOuTk5PLsiRyuXzZ+7OsrIxYTXgp1i1ruYjr169nP0dahMFgwMWLF9dl/D/uLwD/G/6vY90NW63WnCQARVHEa8D5sO5B69/GH/dI/wUPvQtkvpNkBgAAAABJRU5ErkJggg==",alt:"icon"})}),Object(Ae.jsx)("div",{className:"item-label",children:Object(Ae.jsx)(g.a,{id:"dashboard.registerPatient"})})]})})]})]})}),ya=n(2008),Ca=n(2001),Na=n(2002),Sa=n(2003),wa=n(1013),Ta=n(1008),Pa=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).state={active:!0,conditionToDelete:null},e.redirectUrl=function(){return"".concat(v,"?patientId=").concat(e.props.match.params.patientUuid)},e.cancel=function(){e.props.history.goBack()},e.editCondition=function(t){return function(){e.props.history.push("/conditions/".concat(e.props.match.params.patientUuid,"/manage/?conditionId=").concat(t))}},e.setConditionToDelete=function(t){return function(){e.setState({conditionToDelete:t})}},e.switchConditionActive=function(t){return function(){t.status=t.status===me?fe:me,e.props.saveCondition(t)}},e.renderConditionRow=function(t,n){var a,i=e.props.intl,s=t.conditions[t.conditions.length-1],o=s.status===me;if(o===e.state.active)return Object(Ae.jsxs)("tr",{children:[Object(Ae.jsx)("td",{children:null===(a=s.concept)||void 0===a?void 0:a.name}),Object(Ae.jsx)("td",{children:s.onSetDate&&Z(0,new Date(s.onSetDate))}),Object(Ae.jsxs)("td",{children:[Object(Ae.jsx)("i",{className:"icon-pencil edit-action",onClick:e.editCondition(s.uuid)}),Object(Ae.jsx)("i",{className:"icon-remove delete-action",onClick:e.setConditionToDelete(t)}),Object(Ae.jsx)("button",{className:"btn-small set-status-button",onClick:e.switchConditionActive(s),children:"".concat(i.formatMessage({id:"conditions.set"})," ").concat(o?fe:me)})]})]})},e.switchActive=function(){e.setState({active:!e.state.active})},e.voidCondition=function(){var t=e.state.conditionToDelete;t.conditions.forEach((function(e){e.voided=!0,e.endDate=(new Date).toISOString()})),e.props.saveConditions(t.conditions),e.setState({conditionToDelete:null})},e.renderDeleteModal=function(){return Object(Ae.jsxs)(ya.a,{isOpen:!0,fade:!1,children:[Object(Ae.jsx)(Ca.a,{closeButton:!0,children:Object(Ae.jsx)(g.a,{id:"conditions.remove"})}),Object(Ae.jsx)(Na.a,{children:Object(Ae.jsx)("p",{children:Object(Ae.jsx)(g.a,{id:"conditions.removeConfirmation"})})}),Object(Ae.jsxs)(Sa.a,{children:[Object(Ae.jsx)("button",{className:"btn cancel",onClick:e.setConditionToDelete(null),children:Object(Ae.jsx)(g.a,{id:"conditions.no"})}),Object(Ae.jsx)("button",{className:"btn btn-primary",onClick:e.voidCondition,children:Object(Ae.jsx)(g.a,{id:"conditions.yes"})})]})]})},e.renderConditionTable=function(){return Object(Ae.jsxs)(ut.a,{borderless:!0,striped:!0,responsive:!0,className:"table",children:[Object(Ae.jsx)("thead",{children:Object(Ae.jsxs)("tr",{children:[Object(Ae.jsx)("th",{children:Object(Ae.jsx)(g.a,{id:"conditions.condition"})}),Object(Ae.jsx)("th",{children:Object(Ae.jsx)(g.a,{id:"conditions.onsetDate"})}),Object(Ae.jsx)("th",{children:Object(Ae.jsx)(g.a,{id:"conditions.actions"})})]})}),Object(Ae.jsx)("tbody",{children:e.props.conditions.map((function(t,n){return e.renderConditionRow(t,n)}))})]})},e.loading=function(){return Object(Ae.jsx)("div",{className:"px-5 py-3",children:Object(Ae.jsx)(Ie.a,{})})},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.match.params.patientUuid;this.props.getConditionHistory(e),this.props.getPatient(e)}},{key:"componentDidUpdate",value:function(e,t,n){var a=this.props,i=a.patient,s=a.match,o=a.conditionUpdated,r=s.params.patientUuid;i&&i!==e.patient&&(this.props.resetBreadcrumbs(),this.props.addBreadcrumbs([{label:i.person.preferredName.display,url:"".concat(v,"?patientId=").concat(r),order:1}])),o&&!e.conditionUpdated&&(this.props.getConditionHistory(r),Object(Pe.b)(this.props.intl.formatMessage({id:"conditions.success"})))}},{key:"render",value:function(){var e=Object(u.a)(Object(u.a)({},this.props),{},{patientUuid:this.props.match.params.patientUuid,dashboardType:"PATIENT",redirectUrl:this.redirectUrl(),displayTelephone:!0});return Object(Ae.jsxs)("div",{className:"conditions",children:[Object(Ae.jsx)(wa.a,Object(u.a)(Object(u.a)({},e),{},{children:Object(Ae.jsx)(Ta.a,{patientUuid:e.patientUuid})})),!!this.state.conditionToDelete&&this.renderDeleteModal(),Object(Ae.jsx)("h2",{children:Object(Ae.jsx)(g.a,{id:"conditions.title"})}),Object(Ae.jsxs)("div",{className:"inner-content",children:[Object(Ae.jsx)("div",{className:"error",children:this.props.error}),Object(Ae.jsxs)("ul",{className:"nav nav-tabs",children:[Object(Ae.jsx)("li",{className:"nav-item",children:Object(Ae.jsx)("div",{className:"nav-link ".concat(this.state.active&&"active"),onClick:this.switchActive,children:Object(Ae.jsx)(g.a,{id:"conditions.active"})})}),Object(Ae.jsx)("li",{className:"nav-item",children:Object(Ae.jsx)("div",{className:"nav-link ".concat(!this.state.active&&"active"),onClick:this.switchActive,children:Object(Ae.jsx)(g.a,{id:"conditions.inactive"})})})]}),this.props.loading&&0===this.props.conditions.length?this.loading():this.renderConditionTable()]}),Object(Ae.jsxs)("div",{className:"mt-5",children:[Object(Ae.jsx)("div",{className:"d-inline",children:Object(Ae.jsx)("a",{href:this.redirectUrl(),className:"cancel btn",children:Object(Ae.jsx)(g.a,{id:"common.return"})})}),Object(Ae.jsx)("div",{className:"d-inline pull-right confirm-button-container",children:Object(Ae.jsx)(p.b,{to:this.props.location.pathname+"/manage",className:"save btn",children:Object(Ae.jsx)(g.a,{id:"conditions.addNew"})})})]})]})}}]),n}(i.a.Component),Aa={saveCondition:ie,saveConditions:function(e){return{type:te,payload:C.a.post("/openmrs/ws/rest/emrapi/condition",null===e||void 0===e?void 0:e.map((function(e){return se(e)})))}},getConditionHistory:function(e){var t="/openmrs/ws/rest/emrapi/conditionhistory?patientUuid=".concat(e);return{type:ee,payload:C.a.get(t)}},addBreadcrumbs:de,resetBreadcrumbs:ue,getPatient:Se},Da=Object(x.connect)((function(e){var t=e.condition,n=e.cflPatient,a=e.cflPerson;return{error:t.errorMessage,conditions:t.conditions,loading:t.loading,conditionUpdated:t.conditionUpdated,patient:n.patient,person:a.person}}),Aa)(Object(L.c)(Object(m.withRouter)(Pa))),Ma=(n(144),"cfl.vaccines"),Ra=["Dosing"],Ea={doseNumber:0,nameOfDose:"",numberOfFutureVisit:0,lowWindow:0,midPointWindow:0,upWindow:0},Va={name:null},Ia=[Va],La=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e?JSON.parse(e):t},ka=function(e){var t,n;return(null===e||void 0===e?void 0:e.target)?"checkbox"===(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.type)?e.target.checked:null===e||void 0===e||null===(n=e.target)||void 0===n?void 0:n.value:e},Fa=function(e){if(e)try{return new RegExp(e),!0}catch(t){return!1}return!0},Ua=function(e){var t=e%10,n=e%100;return 1===t&&11!==n?"common.ordinalSuffix.st":2===t&&12!==n?"common.ordinalSuffix.nd":3===t&&13!==n?"common.ordinalSuffix.rd":"common.ordinalSuffix.th"},Ba=function(e){return Object(u.a)(Object(u.a)({},e),{},{colors:Object(u.a)(Object(u.a)({},e.colors),{},{primary:"#00455c",primary25:"#e4e7e7",primary50:"#e4e7e7"})})},qa=function(e,t,n){var a=e.formatMessage({id:t});return n&&(a=[a,e.formatMessage({id:"common.required"})].join(" ")),a},Wa=function(e){return[{label:e.formatMessage({id:"common.yes"}),value:!0},{label:e.formatMessage({id:"common.no"}),value:!1}]},Ga=(n(942),function(e){var t=e.header,n=e.body,a=e.onYes,i=e.onNo,s=e.isOpen,o=!!t&&!!t.values&&t.values,r=!!n&&!!n.values&&n.values;return Object(Ae.jsxs)(ya.a,{isOpen:s,fade:!1,children:[Object(Ae.jsx)(Ca.a,{children:Object(Ae.jsx)(g.a,{id:!!t&&!!t.id&&t.id,values:Object(u.a)(Object(u.a)({},o),{},{br:Object(Ae.jsx)("br",{})})})}),Object(Ae.jsx)(Na.a,{children:Object(Ae.jsx)("p",{children:Object(Ae.jsx)(g.a,{id:!!n&&!!n.id&&n.id,values:Object(u.a)(Object(u.a)({},r),{},{br:Object(Ae.jsx)("br",{})})})})}),Object(Ae.jsxs)(Sa.a,{className:"".concat(i?"":"justify-content-end"),children:[!!i&&Object(Ae.jsx)(I.a,{className:"btn cancel",onClick:i,"data-testid":"cancelModalButton",children:Object(Ae.jsx)(g.a,{id:"common.no"})}),!!a&&Object(Ae.jsx)(I.a,{className:"btn btn-primary",onClick:a,"data-testid":"confirmModalButton",children:Object(Ae.jsx)(g.a,{id:"".concat(i?"common.yes":"common.ok")})})]})]})}),Ha=n(2004);function Ya(e){var t=e.intl,n=e.config,a=e.syncScopes,i=e.onValueChange;return Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsxs)(Ha.a,{className:"mr-5 mb-0",children:[Object(Ae.jsx)(g.a,{id:"vmpConfig.syncScope"}),Object(Ae.jsx)("span",{className:"glyphicon glyphicon-info-sign ml-2","aria-hidden":"true",title:t.formatMessage({id:"vmpConfig.syncScopeTooltip"})})]}),Object(Ae.jsx)(pn,{options:a,entity:n,fieldName:"syncScope",onChange:i("syncScope")})]})}var Qa=n(37),za=n(465),Ka=function(e,t,n){var a=t+n;if(a>=0&&a<e.length){var i=[e[a],e[t]];e[t]=i[0],e[a]=i[1]}return e},Za="none",Ja=Object(za.b)((function(e){var t=Object(u.a)(Object(u.a)({},e.innerProps),{},{onMouseDown:function(e){e.preventDefault(),e.stopPropagation()}});return Object(Ae.jsx)(Qa.l.MultiValue,Object(u.a)(Object(u.a)({},e),{},{innerProps:t}))})),Xa=Object(za.c)((function(e){return Object(Ae.jsx)(Qa.l.MultiValueLabel,Object(u.a)({},e))})),_a=Object(za.a)(Pn.a),$a=function(e){return Object(Ae.jsx)(_a,Object(u.a)(Object(u.a)({useDragHandle:!0,axis:"xy",onSortEnd:function(t){var n=t.oldIndex,a=t.newIndex,i=Ka(e.value,n,a-n);e.onChange(i)},distance:4,getHelperDimensions:function(e){return e.node.getBoundingClientRect()}},e),{},{isMulti:!0,components:{MultiValue:Ja,MultiValueLabel:Xa},closeMenuOnSelect:!1},e.isDisabled&&{styles:Object(u.a)(Object(u.a)({},e.styles),{},{indicatorsContainer:function(e){return Object(u.a)(Object(u.a)({},e),{},{display:Za})},multiValueLabel:function(e){return Object(u.a)(Object(u.a)({},e),{},{paddingRight:6})},multiValueRemove:function(e){return Object(u.a)(Object(u.a)({},e),{},{display:Za})}})}))},ei=n(279),ti=(n(1916),function(e){return Object(Ae.jsx)("div",{onChange:e.onChange,className:"input-container radio-buttons",children:e.options.map((function(t){return Object(Ae.jsxs)("div",{className:"radio-button-wrapper",children:[Object(Ae.jsx)("input",{type:"radio",id:"".concat(t.value,"-").concat(e.name),name:e.name,value:t.value,className:"radio-button",checked:e.value===t.value}),Object(Ae.jsx)("label",{htmlFor:"".concat(t.value,"-").concat(e.name),children:t.label})]},t.label)}))})}),ni=function(e){return function(t){Object(l.a)(a,t);var n=Object(d.a)(a);function a(){return Object(r.a)(this,a),n.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){return Object(Ae.jsxs)("div",{className:"input-container ".concat(this.props.wrapperClassName||""),children:[Object(Ae.jsx)(e,Object(u.a)(Object(u.a)({},this.props),{},{placeholder:this.props.placeholder||"",styles:{menu:function(e){return Object(u.a)(Object(u.a)({},e),{},{zIndex:9999})}}})),!!this.props.showPlaceholder&&Object(Ae.jsx)("span",{className:"placeholder",children:this.props.placeholder||""})]})}}]),a}(i.a.Component)},ai=ni(Ve.a),ii=ni(Pn.a),si=ni($a),oi=(ni(ei.a),ni(ti));function ri(e){var t=e.intl,n=e.config,a=e.getPlaceholder,i=e.onNumberValueChange,s=n.operatorCredentialsRetentionTime;return Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsxs)(Ha.a,{children:[Object(Ae.jsx)(g.a,{id:"vmpConfig.operatorCredentialsOfflineRetentionTime"}),Object(Ae.jsx)("span",{className:"glyphicon glyphicon-info-sign ml-2","aria-hidden":"true",title:t.formatMessage({id:"vmpConfig.operatorCredentialsOfflineRetentionTimeTooltip"})})]}),Object(Ae.jsx)(ai,{placeholder:a(t,"vmpConfig.days",!0),showPlaceholder:!!s,value:s,onChange:i("operatorCredentialsRetentionTime",1),type:"number",pattern:"[1-9]",min:1,"data-testid":"operatorCredentialsOfflineRetentionTimeInput"})]})}function ci(e){var t=e.intl,n=e.config,a=e.getPlaceholder,i=e.onNumberValueChange,s=n.operatorOfflineSessionTimeout;return Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsxs)(Ha.a,{children:[Object(Ae.jsx)(g.a,{id:"vmpConfig.operatorSessionTimeout"}),Object(Ae.jsx)("span",{className:"glyphicon glyphicon-info-sign ml-2","aria-hidden":"true",title:t.formatMessage({id:"vmpConfig.operatorSessionTimeoutTooltip"})})]}),Object(Ae.jsx)(ai,{placeholder:a(t,"vmpConfig.minutes",!0),showPlaceholder:!!s,value:s,onChange:i("operatorOfflineSessionTimeout",1),type:"number",pattern:"[1-9]",min:1,"data-testid":"operatorOfflineSessionTimeoutInput"})]})}var li=Object(L.c)((function(e){var t=e.intl,n=e.message,a=e.required;return Object(Ae.jsx)("span",{className:"error field-error","data-testid":"fieldError",children:t.formatMessage({id:a?"common.error.required":n})})}));function di(e){var t=e.intl,n=e.onPlusClick,a=e.onMinusClick,i=e.isPlusButtonVisible,s=void 0===i||i;return Object(Ae.jsx)("div",{className:"align-items-center justify-content-center d-flex action-icons",children:Object(Ae.jsxs)("div",{className:"action-icons-inner",children:[Object(Ae.jsx)("img",{src:Cn,title:t.formatMessage({id:"vmpConfig.delete"}),alt:"remove",className:"remove-item",onClick:a,"data-testid":"removeItem"}),s&&Object(Ae.jsx)("img",{src:yn,title:t.formatMessage({id:"vmpConfig.addNew"}),alt:"add",className:"mx-2 add-item",onClick:n,"data-testid":"addItem"})]})})}var ui={name:"",barcodeRegex:""};function pi(e){var t=e.intl,n=e.config,a=e.onValueChange;return Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsxs)(Ha.a,{className:"mr-4 mb-0",children:[Object(Ae.jsx)(g.a,{id:"vmpConfig.canUseDifferentManufacturers"}),Object(Ae.jsx)("span",{className:"glyphicon glyphicon-info-sign ml-2","aria-hidden":"true",title:t.formatMessage({id:"vmpConfig.canUseDifferentManufacturersTooltip"})})]}),Object(Ae.jsx)(pn,{options:Wa(t),entity:n,fieldName:"canUseDifferentManufacturers",onChange:a("canUseDifferentManufacturers")})]})}function mi(e){var t=e.intl,n=e.config,a=e.showValidationErrors,i=e.openModal,s=e.closeModal,o=e.onValueChange,r=n.manufacturers||[],c=n.vaccine||[],l=function(e){var t=r[e].name;c.some((function(e){return!!e.manufacturers&&e.manufacturers.includes(t)}))?i("vmpConfig.error.header","vmpConfig.error.manufacturerAssigned"):i("vmpConfig.warning.header","vmpConfig.warning.deleteManufacturer",(function(){return function(e){var t=r[e].name;r.splice(e,1),0===r.length&&d(),o("manufacturers")(r),c.forEach((function(e){e.manufacturers&&(e.manufacturers=e.manufacturers.filter((function(e){return e!==t})))})),o("vaccine")(c)}(e)}),s)},d=function(){r.push(E.a.clone(ui)),o("manufacturers")(r)},u=function(e,t){return function(n){var a=ka(n);if("name"===t){var i=r[e].name;c.forEach((function(e){e.manufacturers&&e.manufacturers.length&&(e.manufacturers=e.manufacturers.map((function(e){return e===i?a:e})))})),o("vaccine")(c)}r[e][t]=a,o("manufacturers")(r)}};return Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsxs)(Ha.a,{children:[Object(Ae.jsx)(g.a,{id:"vmpConfig.manufacturers"}),Object(Ae.jsx)("span",{className:"glyphicon glyphicon-info-sign ml-2","aria-hidden":"true",title:t.formatMessage({id:"vmpConfig.manufacturersTooltip"})})]}),(r||[]).map((function(e,n){var i=!e.name,s=!Fa(e.barcodeRegex)||!e.barcodeRegex;return Object(Ae.jsxs)("div",{className:"inline-fields",children:[Object(Ae.jsxs)("div",{className:"flex-1 input-container",children:[Object(Ae.jsx)(ai,{placeholder:t.formatMessage({id:"vmpConfig.manufacturersName"}),showPlaceholder:!!e.name,value:e.name,onChange:u(n,"name"),className:a&&i?"invalid":""}),a&&i&&Object(Ae.jsx)(li,{message:"vmpConfig.error.nameRequired"})]}),Object(Ae.jsxs)("div",{className:"flex-2 input-container",children:[Object(Ae.jsx)(ai,{placeholder:t.formatMessage({id:"vmpConfig.barcodeRegex"}),showPlaceholder:!!e.barcodeRegex,value:e.barcodeRegex,onChange:u(n,"barcodeRegex"),className:a&&s?"invalid":""}),a&&s&&Object(Ae.jsx)(li,{message:"vmpConfig.error.barcodeRegexInvalid"})]}),Object(Ae.jsx)(di,{intl:t,onPlusClick:d,onMinusClick:function(){return l(n)},isPlusButtonVisible:n===r.length-1})]},"manufacturers-".concat(n))}))]})}var fi={name:"",manufacturers:[]};function gi(e){var t=e.intl,n=e.config,a=e.vaccinationSchedule,i=e.savedRegimen,s=e.patientLinkedRegimens,o=e.showValidationErrors,r=e.isRegimenNameDuplicated,c=e.readOnly,l=void 0!==c&&c,d=e.openModal,u=e.closeModal,p=e.onValueChange,m=e.onVaccinationScheduleChange,f=n.vaccine,h=n.manufacturers,b=function(e,t,n){return function(a){f[e][t]=n?a.map((function(e){return e.label})):ka(a),p("vaccine")(f)}},j=function(e){var t=f[e]?f[e].name:null,n=t?s.find((function(e){return e.regimenName===t})):null;n&&n.anyPatientLinkedWithRegimen?d("vmpConfig.error.header","vmpConfig.error.regimenLinked"):d("vmpConfig.warning.header","vmpConfig.warning.deleteRegimen",(function(){return function(e){m(a.filter((function(t){return t.name!==f[e].name}))),f.splice(e,1),0===f.length&&v(),p("vaccine")(f)}(e)}),u)},v=function(){f.push(E.a.clone(fi)),p("vaccine")(f)};return Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsxs)(Ha.a,{children:[Object(Ae.jsx)(g.a,{id:"vmpConfig.regimen"}),Object(Ae.jsx)("span",{className:"glyphicon glyphicon-info-sign ml-2","aria-hidden":"true",title:t.formatMessage({id:"vmpConfig.regimenTooltip"})})]}),(f||[]).map((function(e,n){var a=!e.name,s=r(f,e,n),c=!e.manufacturers.length;return Object(Ae.jsxs)("div",{className:"inline-fields",children:[Object(Ae.jsxs)("div",{className:"flex-1 input-container",children:[Object(Ae.jsx)(ai,{placeholder:t.formatMessage({id:"vmpConfig.regimenName"}),showPlaceholder:!!e.name,value:e.name,onChange:b(n,"name",!1),readOnly:!!e.name&&i.includes(e),className:o&&(a||s)?"invalid":""}),o&&(a?Object(Ae.jsx)(li,{message:"vmpConfig.error.nameRequired"}):s&&Object(Ae.jsx)(li,{message:"vmpConfig.error.nameDuplicate"}))]}),Object(Ae.jsxs)("div",{className:"flex-2 default-select-multi input-container",children:[Object(Ae.jsx)(si,{placeholder:t.formatMessage({id:"vmpConfig.manufacturers"}),showPlaceholder:!!e.manufacturers&&e.manufacturers.length,value:e.manufacturers&&e.manufacturers.map((function(e,t){return{label:e,value:t}})),onChange:b(n,"manufacturers",!0),options:(h||[]).map((function(e){return{label:e.name,value:e.name}})),className:o&&c?"default-select invalid":"default-select",classNamePrefix:"default-select",isMulti:!0,isOptionSelected:function(){return!1},theme:Ba,isDisabled:i.includes(e)&&l}),o&&c&&Object(Ae.jsx)(li,{message:"vmpConfig.error.regimenManufacturersEmpty"})]}),Object(Ae.jsx)(di,{intl:t,onPlusClick:v,onMinusClick:function(){return j(n)},isPlusButtonVisible:n===f.length-1})]},"regimen-".concat(n))}))]})}var hi=n(342),bi=hi.a.getAllNames().map((function(e){return{label:e,value:e}}));function ji(e){var t,n=e.intl,a=e.config,i=e.onValueChange,s=a.personLanguages||[];return Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsxs)(Ha.a,{"data-testid":"personLanguagesLabel",children:[Object(Ae.jsx)(g.a,{id:"vmpConfig.personLanguages"}),Object(Ae.jsx)("span",{className:"glyphicon glyphicon-info-sign ml-2","aria-hidden":"true",title:n.formatMessage({id:"vmpConfig.personLanguagesTooltip"})})]}),Object(Ae.jsx)(ii,{placeholder:n.formatMessage({id:"vmpConfig.personLanguages"}),showPlaceholder:!!s&&s.length>0,value:s.map((function(e){return{label:e.name,value:e.name}})),onChange:(t="personLanguages",function(e){i(t)(e.map((function(e){return{name:e.value}})))}),options:bi,classNamePrefix:"default-select",wrapperClassName:"default-select-multi",isMulti:!0,theme:Ba})]})}function vi(e){var t=e.intl,n=e.config,a=e.options,i=e.onValueChange,s=n.authSteps,o=function(e,t,n){return function(a){s[e][t]=n?a.value:ka(a),i("authSteps")(s)}},r=function(){s.push({mandatory:!1}),i("authSteps")(s)},c=function(e,t){return function(){Ka(s,e,t),i("authSteps")(s)}};return Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsxs)(Ha.a,{children:[Object(Ae.jsx)(g.a,{id:"vmpConfig.authSteps"}),Object(Ae.jsx)("span",{className:"glyphicon glyphicon-info-sign ml-2","aria-hidden":"true",title:t.formatMessage({id:"vmpConfig.authStepsTooltip"})})]}),(s||[]).map((function(e,n){return Object(Ae.jsxs)("div",{className:"inline-fields",children:[Object(Ae.jsxs)("div",{className:"d-flex flex-column order-icons",children:[Object(Ae.jsx)("span",{className:"glyphicon glyphicon-chevron-up ".concat(0===n?"disabled":""),title:t.formatMessage({id:"common.moveUp"}),"aria-hidden":"true",onClick:c(n,-1)}),Object(Ae.jsx)("span",{className:"glyphicon glyphicon-chevron-down ".concat(n===s.length-1?"disabled":""),title:t.formatMessage({id:"common.moveDown"}),"aria-hidden":"true",onClick:c(n,1)})]}),Object(Ae.jsx)("div",{className:"input-container d-flex align-items-center justify-content-center",children:Object(Ae.jsxs)(Ha.a,{children:[Object(Ae.jsx)(Ve.a,{checked:e.mandatory,onClick:function(){return o(n,"mandatory",!1)(!e.mandatory)},type:"checkbox"}),Object(Ae.jsx)("span",{children:Object(Ae.jsx)(g.a,{id:"vmpConfig.mandatoryField"})})]})}),Object(Ae.jsx)(ii,{placeholder:t.formatMessage({id:"vmpConfig.authStepType"}),showPlaceholder:!!e.type,value:a.find((function(t){return t.value===e.type}))||null,onChange:o(n,"type",!0),options:a.filter((function(e){return!s.find((function(t){return t.type===e.value}))})),wrapperClassName:"flex-2",classNamePrefix:"default-select",theme:Ba}),Object(Ae.jsx)(di,{intl:t,onPlusClick:r,onMinusClick:function(){return e=n,s.splice(e,1),0===s.length&&r(),void i("authSteps")(s);var e},isPlusButtonVisible:n===s.length-1})]},"authStep-".concat(n))}))]})}function Oi(e){var t=e.intl,n=e.config,a=e.onNumberValueChange,i=n.irisScore;return Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsxs)(Ha.a,{className:"mr-4 mb-0",children:[Object(Ae.jsx)(g.a,{id:"vmpConfig.irisScore"}),Object(Ae.jsx)("span",{className:"glyphicon glyphicon-info-sign ml-2","aria-hidden":"true",title:t.formatMessage({id:"vmpConfig.irisScoreTooltip"})})]}),Object(Ae.jsx)("div",{className:"d-inline-block",children:Object(Ae.jsx)(ai,{placeholder:t.formatMessage({id:"vmpConfig.irisScore"}),showPlaceholder:null!==i,value:i,onChange:a("irisScore",0,100),type:"number",pattern:"[1-9]",className:"iris-score",min:0,max:100,"data-testid":"irisScoreInput"})})]})}var xi="DROPDOWN",yi="FREE_INPUT",Ci=["countyDistrict","stateProvince","cityVillage","postalCode","address1","address2"],Ni={countyDistrict:xi,stateProvince:xi,cityVillage:xi,postalCode:xi,address1:yi,address2:yi};function Si(e){var t=e.intl,n=e.config,a=e.onValueChange,i=n.addressFields||[],s=function(e,t,n,s){return function(o){var r=s?o.value:ka(o);n?i[e].fields[t][n]=r:i[e].countryName=r,a("addressFields")(i)}},o=function(e,t){return function(n){var s=n.value;i[e].fields[t].field=s,i[e].fields[t].type=Ni[s],a("addressFields")(i)}},r=function(e,t,n){return function(){var s;Ka(null===(s=i[e])||void 0===s?void 0:s.fields,t,n),a("addressFields")(i)}},c=function(){i.push(E.a.cloneDeep(da)),a("addressFields")(i)},l=function(e,t){var n=(i[e].fields||[]).filter((function(e,n){return n!==t})).map((function(e){return e.field}));return Ci.filter((function(e){return!n.includes(e)})).map((function(e){return{label:e,value:e}}))};return Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsxs)(Ha.a,{className:"mb-3",children:[Object(Ae.jsx)(g.a,{id:"vmpConfig.addressFields"}),Object(Ae.jsx)("span",{className:"glyphicon glyphicon-info-sign ml-2","aria-hidden":"true",title:t.formatMessage({id:"vmpConfig.addressFieldsTooltip"})})]}),i.map((function(e,n){var d,u=e.fields||[];return u.sort((function(e,t){return e.displayOrder||0>t.displayOrder||0})),Object(Ae.jsxs)("div",{className:"country","data-testid":"country",children:[Object(Ae.jsx)("div",{className:"delete-button-container d-flex justify-content-end",children:Object(Ae.jsx)("button",{className:"btn btn-primary",onClick:(d=n,function(){i.splice(d,1),0===i.length&&c(),a("addressFields")(i)}),children:Object(Ae.jsx)(g.a,{id:"vmpConfig.delete"})})}),Object(Ae.jsxs)("div",{className:"inline-fields",children:[Object(Ae.jsx)("div",{className:"order-icons"}),Object(Ae.jsx)(ii,{placeholder:t.formatMessage({id:"vmpConfig.country"}),showPlaceholder:!!e.countryName,value:e.countryName&&{value:e.countryName,label:e.countryName},onChange:s(n,null,null,!0),options:ua,wrapperClassName:"flex-1",classNamePrefix:"default-select",theme:Ba}),Object(Ae.jsx)(ai,{placeholder:t.formatMessage({id:"vmpConfig.country"}),showPlaceholder:!!e.countryName,value:e.countryName,onChange:s(n,null,null,!1),wrapperClassName:"flex-1"}),Object(Ae.jsx)("div",{className:"action-icons"})]}),u.map((function(e,c){var d=e.name,p=e.field;return Object(Ae.jsxs)("div",{className:"inline-fields",children:[Object(Ae.jsxs)("div",{className:"d-flex flex-column order-icons",children:[Object(Ae.jsx)("span",{className:"glyphicon glyphicon-chevron-up ".concat(0===c?"disabled":""),title:t.formatMessage({id:"common.moveUp"}),"aria-hidden":"true",onClick:r(n,c,-1),"data-testid":"up-button"}),Object(Ae.jsx)("span",{className:"glyphicon glyphicon-chevron-down ".concat(c===u.length-1?"disabled":""),title:t.formatMessage({id:"common.moveDown"}),"aria-hidden":"true",onClick:r(n,c,1),"data-testid":"down-button"})]}),Object(Ae.jsx)(ii,{placeholder:t.formatMessage({id:"vmpConfig.addressField"}),showPlaceholder:!!p,value:p?{value:p,label:p}:null,onChange:o(n,c),options:l(n,c),wrapperClassName:"flex-1",classNamePrefix:"default-select",theme:Ba}),Object(Ae.jsx)(ai,{placeholder:t.formatMessage({id:"vmpConfig.addressName"}),showPlaceholder:!!d,value:d||"",onChange:s(n,c,"name",!1),wrapperClassName:"flex-1"}),Object(Ae.jsx)(di,{intl:t,onPlusClick:function(){return function(e){i[e].fields.push({}),a("addressFields")(i)}(n)},onMinusClick:function(){return function(e,t){var n=i[e].fields;n.splice(t,1),0===n.length&&n.push({}),a("addressFields")(i)}(n,c)},isPlusButtonVisible:c===u.length-1})]},"addressField-".concat(n,"-").concat(c))}))]},"addressField-".concat(n))})),Object(Ae.jsx)("div",{className:"d-flex justify-content-end mt-2 mb-2",children:Object(Ae.jsx)("button",{className:"btn btn-primary",onClick:c,children:Object(Ae.jsx)(g.a,{id:"vmpConfig.addNewCountry"})})})]})}function wi(e){var t=e.intl,n=e.config,a=e.onValueChange,i=n.participantIDRegex;return Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsx)(Ha.a,{className:"mr-4 mb-0",children:Object(Ae.jsx)(g.a,{id:"vmpConfig.participantIDRegex"})}),Object(Ae.jsx)("div",{className:"d-inline-block",children:Object(Ae.jsx)(ai,{placeholder:t.formatMessage({id:"vmpConfig.participantIDRegex"}),showPlaceholder:!!i,value:i,onChange:a("participantIDRegex"),className:Fa(i)?"id-regex":"invalid id-regex"})})]})}function Ti(e){var t=e.intl,n=e.config,a=e.onValueChange;return Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsxs)(Ha.a,{className:"mr-4",children:[Object(Ae.jsx)(g.a,{id:"vmpConfig.allowManualParticipantIDEntry"}),Object(Ae.jsx)("span",{className:"glyphicon glyphicon-info-sign ml-2","aria-hidden":"true",title:t.formatMessage({id:"vmpConfig.allowManualParticipantIDEntryTooltip"})})]}),Object(Ae.jsx)(pn,{options:Wa(t),entity:n,fieldName:"allowManualParticipantIDEntry",onChange:a("allowManualParticipantIDEntry")})]})}function Pi(e){var t=e.intl,n=e.config,a=e.onValueChange;return Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsxs)(Ha.a,{className:"mr-4",children:[Object(Ae.jsx)(g.a,{id:"vmpConfig.enableBiometricOnlySearchWithoutPhone"}),Object(Ae.jsx)("span",{className:"glyphicon glyphicon-info-sign ml-2","aria-hidden":"true",title:t.formatMessage({id:"vmpConfig.enableBiometricOnlySearchWithoutPhoneTooltip"})})]}),Object(Ae.jsx)(pn,{options:Wa(t),entity:n,fieldName:"isBiometricOnlySearchWithoutPhone",onChange:a("isBiometricOnlySearchWithoutPhone")})]})}var Ai=function(){return window.scrollTo({top:0,behavior:"smooth"})},Di=6e4,Mi=864e5,Ri=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).state={vmpConfig:{},vmpConfigSetting:{uuid:null,value:null},vmpVaccinationSchedule:[],vmpVaccinationScheduleSetting:{uuid:null,value:null},savedRegimen:[],showValidationErrors:!1,isModalOpen:!1,modalHeader:{id:"",values:{}},modalBody:{id:"",values:{}},onModalConfirm:null,onModalCancel:null},e.extractConfigData=function(){var t,n,a=La(e.props.config);if((null===(t=e.props.setting)||void 0===t?void 0:t.property)===la){var i=(a=E.a.defaults(a,ga)).addressFields;a.addressFields=Object.keys(i).map((function(e){return{countryName:e,fields:i[e]}})),a.operatorCredentialsRetentionTime=a.operatorCredentialsRetentionTime/Mi,a.operatorOfflineSessionTimeout=a.operatorOfflineSessionTimeout/Di,e.setState({vmpConfig:a,vmpConfigSetting:e.props.setting,savedRegimen:E.a.clone(a.vaccine),showValidationErrors:!1})}else(null===(n=e.props.setting)||void 0===n?void 0:n.property)===Ma&&e.setState({vmpVaccinationSchedule:a,vmpVaccinationScheduleSetting:e.props.setting})},e.generateConfig=function(){var t=E.a.cloneDeep(e.state.vmpConfig);return t.addressFields=t.addressFields?t.addressFields.reduce((function(e,t){return t.countryName&&(e[t.countryName]=(t.fields||[]).map((function(e,t){return e.displayOrder=t+1,pa.reduce((function(t,n){return t[n]=e[n],t}),{})}))),e}),{}):{},t.operatorCredentialsRetentionTime&&(t.operatorCredentialsRetentionTime=t.operatorCredentialsRetentionTime*Mi),t.operatorOfflineSessionTimeout&&(t.operatorOfflineSessionTimeout=t.operatorOfflineSessionTimeout*Di),t.manufacturers&&(t.manufacturers=t.manufacturers.filter((function(e){return!!e.name}))),t.vaccine&&(t.vaccine=t.vaccine.filter((function(e){return!!e.name})),t.vaccine.forEach((function(e){e.name=e.name.trim(),e.manufacturers=e.manufacturers?e.manufacturers.filter((function(e){return!!e})):[]}))),t.personLanguages&&(t.personLanguages=t.personLanguages.filter((function(e){return!!e.name}))),t.authSteps&&(t.authSteps=t.authSteps.filter((function(e){return!!e.type}))),t},e.onValueChange=function(t){return function(n){var a=e.state.vmpConfig;a[t]=ka(n),e.setState({vmpConfig:a})}},e.onVaccinationScheduleChange=function(t){return e.setState({vmpVaccinationSchedule:t})},e.onNumberValueChange=function(t,n,a){return function(i){var s=e.state.vmpConfig,o=ka(i),r=o?Number.parseInt(o,10):n||0;if(Number.isInteger(r)){if(null!==n&&r<n||null!==a&&r>a)return;s[t]=r,e.setState({vmpConfig:s})}}},e.return=function(){window.location.href=j},e.isFormValid=function(){var t=e.state.vmpConfig,n=t.manufacturers,a=t.vaccine;return!n.some((function(e){return!e.name||!Fa(e.barcodeRegex)||!e.barcodeRegex}))&&!a.some((function(e){return!e.name||!e.manufacturers.length}))&&!a.some((function(t,n){return e.isRegimenNameDuplicated(a,t,n)}))},e.save=function(){var t=e.state,n=t.vmpVaccinationSchedule,a=t.vmpConfigSetting,i=t.vmpVaccinationScheduleSetting;if(e.isFormValid()){var s=e.generateConfig(),o=JSON.stringify(s);(null===a||void 0===a?void 0:a.uuid)?(a.value=o,e.props.updateSetting(a)):e.props.createSetting(la,o),(null===i||void 0===i?void 0:i.uuid)&&(i.value=JSON.stringify(n),e.props.updateSetting(i))}else e.setState({isModalOpen:!0,modalHeader:{id:"vmpConfig.error.header"},modalBody:{id:"vmpConfig.error.configurationInvalid"},onModalConfirm:function(){e.closeModal(),Ai()},onModalCancel:null,showValidationErrors:!0})},e.isRegimenNameDuplicated=function(t,n,a){return!!n.name&&!e.state.savedRegimen.includes(n)&&!!t.find((function(e,t){return a!==t&&e.name===n.name}))},e.modal=function(){return Object(Ae.jsx)(Ga,{header:e.state.modalHeader,body:e.state.modalBody,onYes:e.state.onModalConfirm,onNo:e.state.onModalCancel,isOpen:e.state.isModalOpen})},e.openModal=function(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e.setState({isModalOpen:!0,modalHeader:{id:t},modalBody:{id:n},onModalConfirm:function(){a&&a(),e.closeModal()},onModalCancel:i})},e.closeModal=function(){return e.setState({isModalOpen:!1})},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.props.getSettingByQuery(la),this.props.getSettingByQuery(Ma),this.props.getPatientLinkedRegimens()}},{key:"componentDidUpdate",value:function(e,t,n){var a=this.props,i=a.intl,s=a.config,o=a.loading,r=a.success,c=a.error;e.config!==s&&this.extractConfigData(),!e.success&&r?Object(Pe.b)(i.formatMessage({id:"vmpConfig.success"})):e.error===this.props.error||o||Object(Pe.a)(c)}},{key:"render",value:function(){var e=this.props,t=e.intl,n=e.appError,a=e.appLoading,i=e.loading,s=e.patientLinkedRegimens,o=e.syncScopes,r=e.authSteps,c=e.regimenUpdatePermitted,l=this.state,d=l.vmpConfig,u=l.vmpVaccinationSchedule,p=l.savedRegimen,m=l.showValidationErrors;return Object(Ae.jsxs)("div",{className:"vmp-config",children:[this.modal(),Object(Ae.jsx)("h2",{children:Object(Ae.jsx)(g.a,{id:"vmpConfig.title"})}),Object(Ae.jsx)("div",{className:"error",children:n}),Object(Ae.jsx)("div",{className:"inner-content",children:a||i&&!d?Object(Ae.jsx)(Ie.a,{}):Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsx)("div",{className:"section","data-testid":"syncScopeSection",children:Object(Ae.jsx)(Ya,{intl:t,syncScopes:o,config:d,onValueChange:this.onValueChange})}),Object(Ae.jsxs)("div",{className:"inline-sections",children:[Object(Ae.jsx)("div",{className:"section","data-testid":"operatorCredentialsOfflineRetentionTimeSection",children:Object(Ae.jsx)(ri,{intl:t,config:d,getPlaceholder:qa,onNumberValueChange:this.onNumberValueChange})}),Object(Ae.jsx)("div",{className:"section","data-testid":"operatorSessionTimeoutSection",children:Object(Ae.jsx)(ci,{intl:t,config:d,getPlaceholder:qa,onNumberValueChange:this.onNumberValueChange})})]}),Object(Ae.jsx)("div",{className:"section","data-testid":"manufacturersSection",children:Object(Ae.jsx)(mi,{intl:t,config:d,showValidationErrors:m,openModal:this.openModal,closeModal:this.closeModal,onValueChange:this.onValueChange})}),Object(Ae.jsx)("div",{className:"section","data-testid":"regimenSection",children:Object(Ae.jsx)(gi,{intl:t,config:d,vaccinationSchedule:u,savedRegimen:p,patientLinkedRegimens:s,showValidationErrors:m,isRegimenNameDuplicated:this.isRegimenNameDuplicated,readOnly:!c,openModal:this.openModal,closeModal:this.closeModal,onValueChange:this.onValueChange,onVaccinationScheduleChange:this.onVaccinationScheduleChange})}),Object(Ae.jsx)("div",{className:"section","data-testid":"canUseDifferentManufacturersSection",children:Object(Ae.jsx)(pi,{intl:t,config:d,onValueChange:this.onValueChange})}),Object(Ae.jsx)("div",{className:"section","data-testid":"personLanguagesSection",children:Object(Ae.jsx)(ji,{intl:t,config:d,onValueChange:this.onValueChange})}),Object(Ae.jsx)("div",{className:"section","data-testid":"authStepsSection",children:Object(Ae.jsx)(vi,{intl:t,config:d,options:r,onValueChange:this.onValueChange})}),Object(Ae.jsx)("div",{className:"section","data-testid":"allowManualParticipantIDEntrySection",children:Object(Ae.jsx)(Ti,{intl:t,config:d,onValueChange:this.onValueChange})}),Object(Ae.jsx)("div",{className:"section","data-testid":"enableBiometricOnlySearchWithoutPhoneSection",children:Object(Ae.jsx)(Pi,{intl:t,config:d,onValueChange:this.onValueChange})}),Object(Ae.jsx)("div",{className:"section","data-testid":"participantIDRegexSection",children:Object(Ae.jsx)(wi,{intl:t,config:d,onValueChange:this.onValueChange})}),Object(Ae.jsx)("div",{className:"section","data-testid":"irisScoreSection",children:Object(Ae.jsx)(Oi,{intl:t,config:d,onNumberValueChange:this.onNumberValueChange})}),Object(Ae.jsx)("div",{className:"section","data-testid":"addressFieldsSection",children:Object(Ae.jsx)(Si,{intl:t,config:d,onValueChange:this.onValueChange})}),Object(Ae.jsxs)("div",{className:"mt-5 pb-5",children:[Object(Ae.jsx)("div",{className:"d-inline",children:Object(Ae.jsx)(I.a,{className:"cancel",onClick:this.return,"data-testid":"cancelButton",children:Object(Ae.jsx)(g.a,{id:"common.return"})})}),Object(Ae.jsx)("div",{className:"d-inline pull-right confirm-button-container",children:Object(Ae.jsx)(I.a,{className:"save",onClick:this.save,disabled:i,"data-testid":"saveButton",children:Object(Ae.jsx)(g.a,{id:"common.save"})})})]})]})})]})}}]),n}(i.a.Component),Ei={getSettingByQuery:G,updateSetting:Y,createSetting:H,getPatientLinkedRegimens:function(){return{type:ye,payload:C.a.get("/openmrs/ws/cfl/regimens/patient-info")}}},Vi=Object(x.connect)((function(e){var t,n,a,i,s,o=e.apps,r=e.settings,c=e.cflPatient;return{syncScopes:null!==(t=null===o||void 0===o?void 0:o.vmpSyncScopes)&&void 0!==t?t:ma,authSteps:null!==(n=null===o||void 0===o?void 0:o.vmpAuthSteps)&&void 0!==n?n:fa,regimenUpdatePermitted:null===(a=null===o||void 0===o?void 0:o.vmpRegimenUpdatePermitted)||void 0===a||a,appError:o.errorMessage,appLoading:o.loading,error:o.errorMessage,loading:r.loading,success:r.success,config:(null===(i=r.setting)||void 0===i?void 0:i.value)&&(null===(s=r.setting)||void 0===s?void 0:s.value),setting:r.setting,patientLinkedRegimens:c.patientLinkedRegimens}}),Ei)(Object(L.c)(Object(m.withRouter)(Ri))),Ii=(n(1917),"visit/GET_VISIT_TYPES"),Li={visitTypes:[]},ki=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Li,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N(Ii):case w(Ii):return Object(u.a)({},e);case S(Ii):return Object(u.a)(Object(u.a)({},e),{},{visitTypes:t.payload.data.results});default:return e}},Fi=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).state={vmpConfig:{},vmpVaccinationSchedule:[],savedVmpVaccinationSchedule:[],vmpVaccinationScheduleSetting:{uuid:null,value:null},isModalOpen:!1,modalHeader:{id:"",values:{}},modalBody:{id:"",values:{}},onModalConfirm:null,onModalCancel:null},e.extractConfigData=function(){var t,n,a=La(e.props.config);a&&0!==a.length||(a=E.a.cloneDeep(Ia)),(null===(t=e.props.setting)||void 0===t?void 0:t.property)===Ma?e.setState({vmpVaccinationSchedule:a,vmpVaccinationScheduleSetting:e.props.setting,savedVmpVaccinationSchedule:E.a.clone(a)}):(null===(n=e.props.setting)||void 0===n?void 0:n.property)===la&&e.setState({vmpConfig:a})},e.generateConfig=function(){var t=E.a.cloneDeep(e.state.vmpVaccinationSchedule);return t&&(t=t.filter((function(e){return!!e.name}))).forEach((function(e){e.visits=e.visits?e.visits.filter((function(e){return!!e.nameOfDose})):[]})),t},e.onValueChange=function(t){var n=E.a.cloneDeep(e.state.vmpVaccinationSchedule);n=ka(t),e.setState({vmpVaccinationSchedule:n})},e.return=function(){window.location.href=j},e.getVaccineByRegimenIndex=function(t){var n=e.state,a=n.vmpConfig,i=n.vmpVaccinationSchedule;return a&&a.vaccine&&a.vaccine.find((function(e){return e.name===i[t].name}))?a.vaccine.find((function(e){return e.name===i[t].name})):null},e.save=function(){var t=e.state.vmpVaccinationScheduleSetting,n=e.generateConfig(),a=JSON.stringify(n);t&&t.uuid?(t.value=a,e.props.updateSetting(t)):e.props.createSetting(Ma,a)},e.onSave=function(){var t=!!e.state.vmpConfig&&!!e.state.vmpConfig.vaccine&&e.state.vmpConfig.vaccine.length,n=!!e.state.vmpVaccinationSchedule&&e.state.vmpVaccinationSchedule.length;e.setState({isModalOpen:!0,modalHeader:{id:"vmpVaccinationSchedule.submit.header"},modalBody:e.isAllRegimenConfigured()?{id:"vmpVaccinationSchedule.submit.body.regimenAllConfigured"}:{id:"vmpVaccinationSchedule.submit.body.regimenPartlyConfigured",values:{allRegimen:t,configuredRegimen:n}},onModalConfirm:function(){e.save(),e.closeModal()},onModalCancel:e.closeModal})},e.deleteRegimenConfig=function(t){var n=e.state.vmpVaccinationSchedule;n.splice(t,1),0===n.length&&e.addRegimenConfig(),e.onValueChange(n)},e.onDeleteRegimenConfig=function(t){var n=e.state.vmpVaccinationSchedule,a=n&&n[t]?n[t].name:null;a?e.setState({isModalOpen:!0,modalHeader:{id:"vmpVaccinationSchedule.deleteRegimenConfig.header"},modalBody:{id:"vmpVaccinationSchedule.deleteRegimenConfig.body",values:{regimenName:a}},onModalConfirm:function(){e.deleteRegimenConfig(t),e.closeModal()},onModalCancel:e.closeModal}):e.deleteRegimenConfig(t)},e.addRegimenConfig=function(){var t=e.state.vmpVaccinationSchedule;t.push(E.a.cloneDeep(Va)),e.onValueChange(t)},e.recalculateNumberOfFutureVisit=function(t){var n=0;return t.reverse().forEach((function(t){e.props.dosingVisitTypes.includes(t.nameOfDose)?(t.numberOfFutureVisit=n,n=0):t.numberOfFutureVisit=0,n+=1})),t.reverse()},e.regimenOptions=function(t){var n=e.state,a=n.vmpConfig,i=n.vmpVaccinationSchedule,s=i?i.filter((function(e,n){return n!==t})).map((function(e){return e.name})):[];return a&&a.vaccine?a.vaccine.filter((function(e){return!s.includes(e.name)})).map((function(e){return{label:e.name,value:e.name}})):[]},e.onRegimenChange=function(t){return function(n){var a=e.state,i=a.vmpConfig,s=a.vmpVaccinationSchedule,o=n.value,r=!!i&&!!i.vaccine&&i.vaccine.find((function(e){return e.name===o})),c={name:o,numberOfDose:r&&r.manufacturers?r.manufacturers.length:0,visits:[Ea]};s&&s[t]&&s[t].visits&&s[t].visits.some((function(e){return!!e.nameOfDose}))?e.setState({isModalOpen:!0,modalHeader:{id:"vmpVaccinationSchedule.changeRegimen.header"},modalBody:{id:"vmpVaccinationSchedule.changeRegimen.body"},onModalConfirm:function(){s[t]=c,e.onValueChange(s),e.closeModal()},onModalCancel:e.closeModal}):(s[t]=c,e.onValueChange(s))}},e.addVisit=function(t,n){var a=e.state.vmpVaccinationSchedule;a[t].visits.splice(n+1,0,Ea),e.onValueChange(a)},e.removeVisit=function(t,n){var a=e.state.vmpVaccinationSchedule,i=a[t].visits;i.splice(n,1),0===i.length&&i.push({}),i=e.recalculateNumberOfFutureVisit(i),e.onValueChange(a)},e.visitTypeOptions=function(t){var n=e.props,a=n.visitTypes,i=n.dosingVisitTypes;return e.isAllDosesConfigured(t)&&i?a.filter((function(e){return!i.includes(e.display)})).map((function(e){return{label:e.display,value:e.display}})):a.map((function(e){return{label:e.display,value:e.display}}))},e.onVisitTypeChange=function(t,n){return function(a){var i=e.state.vmpVaccinationSchedule,s=e.props.dosingVisitTypes,o=a.value,r=1;s&&s.includes(o)&&i[t].visits.forEach((function(e,t){s.includes(e.nameOfDose)&&t<n&&(r+=1)})),i[t].visits[n]=Object(u.a)(Object(u.a)({},i[t].visits[n]),{},{nameOfDose:o,doseNumber:r}),i[t].visits=e.recalculateNumberOfFutureVisit(i[t].visits),e.onValueChange(i)}},e.onWindowChange=function(t,n,a){return function(i){var s=e.state.vmpVaccinationSchedule;s[t].visits[n][a]=parseInt(i.target.value,10),e.onValueChange(s)}},e.doseManufacturer=function(t,n){var a=e.getVaccineByRegimenIndex(t);return a&&a.manufacturers&&a.manufacturers[n-1]?a.manufacturers[n-1]:""},e.vaccineManufacturers=function(t){var n=e.state.vmpVaccinationSchedule,a=e.props,i=a.intl,s=a.dosingVisitTypes,o=e.getVaccineByRegimenIndex(t),r=!!n&&!!n[t]&&!!n[t].visits&&!!s&&n[t].visits.filter((function(e){return s.includes(e.nameOfDose)})).length;return!!o&&!!o.manufacturers&&o.manufacturers.map((function(e,n){return Object(Ae.jsx)("span",{className:n<r?"vaccine-manufacturer-configured":"vaccine-manufacturer",title:i.formatMessage({id:"vmpVaccinationSchedule.dosesTooltip"}),children:e},"manufacturer-".concat(t,"-").concat(n))}))},e.isAllRegimenConfigured=function(){var t=e.state,n=t.vmpConfig,a=t.vmpVaccinationSchedule;return!!a&&!!n&&!!n.vaccine&&a.length===n.vaccine.length},e.isAllDosesConfigured=function(t){var n=e.state.vmpVaccinationSchedule,a=e.props.dosingVisitTypes;return!(n&&n[t]&&n[t].visits&&n[t].numberOfDose&&a)||n[t].numberOfDose===n[t].visits.filter((function(e){return a.includes(e.nameOfDose)})).length},e.canSave=function(){return e.state.vmpVaccinationSchedule.every((function(t,n){return e.isAllDosesConfigured(n)}))},e.closeModal=function(){return e.setState({isModalOpen:!1})},e.regimenConfig=function(){var t=e.props,n=t.intl,a=t.dosingVisitTypes,i=t.regimenUpdatePermitted,s=e.state.vmpVaccinationSchedule||[];return Object(Ae.jsxs)(Ae.Fragment,{children:[s.map((function(t,s){var o=t.visits||[],r=e.state.savedVmpVaccinationSchedule.includes(t)&&!i;return Object(Ae.jsxs)("div",{className:"regimen",children:[Object(Ae.jsx)("div",{className:"delete-button-container d-flex justify-content-end",children:Object(Ae.jsx)("button",{className:"btn btn-primary",onClick:function(){return e.onDeleteRegimenConfig(s)},children:Object(Ae.jsx)(g.a,{id:"vmpVaccinationSchedule.delete"})})}),Object(Ae.jsxs)("div",{className:"d-flex",children:[Object(Ae.jsxs)("div",{className:"inline-fields",children:[Object(Ae.jsx)("div",{className:"col-lg-3 col-xs-12 regimen-visit",children:Object(Ae.jsx)(ii,{placeholder:n.formatMessage({id:"vmpVaccinationSchedule.regimen"}),showPlaceholder:!!t.name,value:t.name&&{value:t.name,label:t.name},onChange:e.onRegimenChange(s),options:e.regimenOptions(s),wrapperClassName:"flex-1",classNamePrefix:"default-select",theme:Ba,isDisabled:r})}),Object(Ae.jsxs)("div",{className:"col-lg-9 col-xs-12 regimen-visit justify-content-start",children:[e.vaccineManufacturers(s),!e.isAllDosesConfigured(s)&&Object(Ae.jsx)("span",{className:"validation-error",children:Object(Ae.jsx)(g.a,{id:"vmpVaccinationSchedule.dosesCountValidationError"})})]})]}),Object(Ae.jsx)("div",{className:"action-icons"})]}),o.map((function(t,i){var o=t.doseNumber,c=t.nameOfDose,l=t.lowWindow,d=t.midPointWindow,u=t.upWindow;return Object(Ae.jsxs)("div",{className:"d-flex",children:[Object(Ae.jsxs)("div",{className:"inline-fields",children:[Object(Ae.jsxs)("div",{className:"col-lg-6 col-sm-12 regimen-visit",children:[Object(Ae.jsx)(ii,{placeholder:n.formatMessage({id:"vmpVaccinationSchedule.visitType"}),showPlaceholder:!!c,value:c?{value:c,label:c}:null,onChange:e.onVisitTypeChange(s,i),options:e.visitTypeOptions(s),wrapperClassName:"flex-1",classNamePrefix:"default-select",theme:Ba,isDisabled:r}),Object(Ae.jsx)(ai,{type:"number",placeholder:n.formatMessage({id:"vmpVaccinationSchedule.midPointWindow"}),showPlaceholder:!0,value:d||0,onChange:e.onWindowChange(s,i,"midPointWindow"),wrapperClassName:"flex-1",min:0,readOnly:r})]}),!!a&&a.includes(c)&&Object(Ae.jsxs)("div",{className:"col-lg-6 col-sm-12 regimen-visit",children:[Object(Ae.jsx)(ai,{placeholder:"".concat(o).concat(n.formatMessage({id:Ua(o)})," ").concat(n.formatMessage({id:"vmpVaccinationSchedule.doseNumber"})),showPlaceholder:!0,value:e.doseManufacturer(s,o),wrapperClassName:"flex-1",disabled:!0}),Object(Ae.jsx)(ai,{type:"number",placeholder:n.formatMessage({id:"vmpVaccinationSchedule.lowWindow"}),showPlaceholder:!0,value:l||0,onChange:e.onWindowChange(s,i,"lowWindow"),wrapperClassName:"flex-1",min:0,readOnly:r}),Object(Ae.jsx)(ai,{type:"number",placeholder:n.formatMessage({id:"vmpVaccinationSchedule.upWindow"}),showPlaceholder:!0,value:u||0,onChange:e.onWindowChange(s,i,"upWindow"),wrapperClassName:"flex-1",min:0,readOnly:r})]})]}),!r&&Object(Ae.jsx)(di,{intl:n,onPlusClick:function(){return e.addVisit(s,i)},onMinusClick:function(){return e.removeVisit(s,i)}})]},"addressField-".concat(s,"-").concat(i))}))]},"regimen-".concat(s))})),Object(Ae.jsx)("div",{className:"d-flex justify-content-end mt-2 mb-2",children:Object(Ae.jsx)("button",{className:"btn btn-primary",onClick:e.addRegimenConfig,disabled:e.isAllRegimenConfigured(),children:Object(Ae.jsx)(g.a,{id:"vmpVaccinationSchedule.addRegimenConfig"})})})]})},e.renderConfirmationModal=function(){return Object(Ae.jsx)(Ga,{header:e.state.modalHeader,body:e.state.modalBody,onYes:e.state.onModalConfirm,onNo:e.state.onModalCancel,isOpen:e.state.isModalOpen})},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.props.getSettingByQuery(la),this.props.getSettingByQuery(Ma),this.props.getVisitTypes(),this.extractConfigData()}},{key:"componentDidUpdate",value:function(e,t,n){var a=this.props,i=a.intl,s=a.config,o=a.loading,r=a.success,c=a.error;e.config!==s&&this.extractConfigData(),!e.success&&r?(Object(Pe.b)(i.formatMessage({id:"vmpVaccinationSchedule.success"})),this.props.getSettingByQuery(Ma)):e.error===this.props.error||o||Object(Pe.a)(c)}},{key:"render",value:function(){var e=this.props,t=e.appError,n=e.appLoading,a=e.loading,i=e.config;return Object(Ae.jsxs)("div",{className:"vmp-vaccination-schedule",children:[this.renderConfirmationModal(),Object(Ae.jsx)("h2",{children:Object(Ae.jsx)(g.a,{id:"vmpVaccinationSchedule.title"})}),Object(Ae.jsx)("div",{className:"error",children:t}),Object(Ae.jsx)("div",{className:"inner-content",children:n||a&&!i?Object(Ae.jsx)(Ie.a,{}):Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsx)("div",{className:"section",children:this.regimenConfig()}),Object(Ae.jsxs)("div",{className:"mt-5 pb-5",children:[Object(Ae.jsx)("div",{className:"d-inline",children:Object(Ae.jsx)(I.a,{className:"cancel",onClick:this.return,children:Object(Ae.jsx)(g.a,{id:"common.return"})})}),Object(Ae.jsx)("div",{className:"d-inline pull-right confirm-button-container",children:Object(Ae.jsx)(I.a,{className:"save",onClick:this.onSave,disabled:a||!this.canSave(),children:Object(Ae.jsx)(g.a,{id:"common.save"})})})]})]})})]})}}]),n}(i.a.Component),Ui={getSettingByQuery:G,updateSetting:Y,createSetting:H,getVisitTypes:function(){var e="".concat("/openmrs/ws","/rest/v1"),t="".concat(e,"/visittype");return{type:Ii,payload:C.a.get(t)}}},Bi=Object(x.connect)((function(e){var t,n,a,i,s=e.apps,o=e.settings,r=e.visit;return{dosingVisitTypes:null!==(t=null===s||void 0===s?void 0:s.vmpDosingVisitTypes)&&void 0!==t?t:Ra,regimenUpdatePermitted:null===(n=null===s||void 0===s?void 0:s.vmpRegimenUpdatePermitted)||void 0===n||n,appError:s.errorMessage,appLoading:s.loading,error:s.errorMessage,loading:o.loading,success:o.success,config:(null===(a=o.setting)||void 0===a?void 0:a.value)&&(null===(i=o.setting)||void 0===i?void 0:i.value),setting:o.setting,visitTypes:r.visitTypes}}),Ui)(Object(L.c)(Object(m.withRouter)(Fi))),qi=(n(1918),["field1","field2","field3","field4","field5","field6","field7"]),Wi="address-data.csv",Gi="addressData/GET_ADDRESS_DATA",Hi="addressData/GET_ADDRESS_DATA_PAGE",Yi="addressData/POST_ADDRESS_DATA",Qi={addressData:[],currentPage:1,hasNextPage:!1,totalCount:0,loadingAddressData:!1,downloadableAddressData:[],errorMessage:null,addressDataUploading:!1},zi=function(){return{type:Gi,payload:C.a.get("/openmrs/ws/cfl/address-data")}},Ki=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qi,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N(Gi):case N(Hi):return Object(u.a)(Object(u.a)({},e),{},{loadingAddressData:!0});case w(Gi):case w(Hi):return Object(u.a)({},e);case S(Gi):return Object(u.a)(Object(u.a)({},e),{},{loadingAddressData:!1,downloadableAddressData:t.payload.data.content?t.payload.data.content.map((function(e){return e.content})):[]});case S(Hi):var n=t.payload.data.content?t.payload.data.content.map((function(e){return e.content})):[],a=t.payload.data.pageNumber;return Object(u.a)(Object(u.a)({},e),{},{addressData:1===a?n:[].concat(Object(ge.a)(e.addressData),Object(ge.a)(n)),hasNextPage:t.payload.data.nextPage,currentPage:a,totalCount:t.payload.data.totalCount,loadingAddressData:!1});case N(Yi):return Object(u.a)(Object(u.a)({},e),{},{addressData:[],currentPage:1,hasNextPage:!1,totalCount:0,loadingAddressData:!0,addressDataUploaded:!1,addressDataUploading:!0});case w(Yi):return Object(u.a)(Object(u.a)({},e),{},{errorMessage:t.payload.response.data});case S(Yi):return Object(u.a)(Object(u.a)({},e),{},{addressDataUploaded:!0,loadingAddressData:!1,errorMessage:null,addressDataUploading:!1});default:return e}},Zi=n(448),Ji=n.n(Zi),Xi=n(76),_i=n(1012);n(1921);function $i(e){var t=e.acceptedFileExt,n=e.instructionMessageId,a=e.onFileAccepted,s=i.a.useState(!1),o=Object(Xi.a)(s,2),r=o[0],c=o[1],l=i.a.useState(null),d=Object(Xi.a)(l,2),p=d[0],m=d[1],f=i.a.useState(null),h=Object(Xi.a)(f,2),b=h[0],j=h[1];return Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsx)(_i.a,{accept:t,multiple:!1,onDropAccepted:function(e){m(e.find(Boolean)),j(null),c(!1),a(e.find(Boolean))},onDropRejected:function(e){m(null),j(e.find(Boolean)),c(!1),a(null)},onDragEnter:function(){return c(!0)},onDragLeave:function(){return c(!1)},children:function(e){var t=e.getRootProps,a=e.getInputProps;return Object(Ae.jsx)("section",{children:Object(Ae.jsxs)("div",Object(u.a)(Object(u.a)({},t({className:r?"dropzone dropzone-active":"dropzone"})),{},{children:[Object(Ae.jsx)("input",Object(u.a)({},a())),Object(Ae.jsx)("div",{className:"dropzone-instruction",children:Object(Ae.jsx)(g.a,{id:n})}),Object(Ae.jsx)(I.a,{children:Object(Ae.jsx)(g.a,{id:"dropzone.openFileDialog"})})]}))})}}),Object(Ae.jsx)("div",{className:"drop-result",children:(!!p||!!b)&&Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsx)("div",{className:"d-inline ".concat(p?"accepted-file":"rejected-file"),children:Object(Ae.jsx)(g.a,{id:"dropzone.".concat(p?"acceptedFile":"rejectedFile"),values:{b:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Object(Ae.jsx)("b",{children:t})}}})}),Object(Ae.jsx)("p",{className:"d-inline ml-2",children:p?p.name:b.file.name})]})})]})}var es=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).state={isModalOpen:!1,modalHeader:{id:"",values:{}},modalBody:{id:"",values:{}},onModalConfirm:null,onModalCancel:null,isDragActive:!1,acceptedFile:null,rejectedFile:null,isOverwriteAddressData:!1,page:0,isDownloadableAddressDataValid:!1},e.return=function(){window.location.href=j},e.onUpload=function(){var t=e.state,n=t.acceptedFile,a=t.isOverwriteAddressData;e.setState({isModalOpen:!0,modalHeader:{id:"addressData.upload.overwriteAddressData.".concat(a,".modalHeader")},modalBody:{id:"addressData.upload.overwriteAddressData.".concat(a,".modalBody")},onModalConfirm:function(){e.props.postAddressData(n,a),e.closeModal()},onModalCancel:e.closeModal})},e.closeModal=function(){return e.setState({isModalOpen:!1})},e.onOverwriteAddressDataChange=function(t){return e.setState({isOverwriteAddressData:t.target.value===rt})},e.switchPage=function(t){return e.setState({page:t},(function(){return e.props.getAddressDataPage(e.state.page)}))},e.columnContent=function(e,t){return e[qi.indexOf(t)]},e.triggerAddressDataDownload=function(){return Ji()(e.props.downloadableAddressData,null,Wi)},e.downloadAddressData=function(){return e.state.isDownloadableAddressDataValid?e.triggerAddressDataDownload():e.props.getAddressData()},e.confirmationModal=function(){return Object(Ae.jsx)(Ga,{header:e.state.modalHeader,body:e.state.modalBody,onYes:e.state.onModalConfirm,onNo:e.state.onModalCancel,isOpen:e.state.isModalOpen})},e.instructions=function(){return Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsx)("p",{children:Object(Ae.jsx)(g.a,{id:"addressData.upload.instruction1",values:{b:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Object(Ae.jsx)("b",{children:t})}}})}),Object(Ae.jsx)("p",{className:"d-inline",children:Object(Ae.jsx)(g.a,{id:"addressData.upload.instruction2"})}),Object(Ae.jsx)("a",{href:"".concat(j,"owa/cfl-ui/address-data/address-data-sample-file.csv"),download:!0,className:"ml-2",children:Object(Ae.jsx)(g.a,{id:"addressData.download.csvFileSample"})}),Object(Ae.jsx)("a",{href:"".concat(j,"owa/cfl-ui/address-data/address-data-sample-file.txt"),download:!0,className:"ml-2",children:Object(Ae.jsx)(g.a,{id:"addressData.download.txtFileSample"})})]})},e.overwriteAddressDataRadioButtons=function(){return Object(Ae.jsxs)("div",{onChange:e.onOverwriteAddressDataChange,className:"my-2",children:[Object(Ae.jsxs)("div",{className:"radio-button-wrapper",children:[Object(Ae.jsx)("input",{type:"radio",id:"overwrite-false",value:ct,name:"overwriteAddressData",className:"radio-button",defaultChecked:!0}),Object(Ae.jsx)("label",{htmlFor:"overwrite-false",children:Object(Ae.jsx)(g.a,{id:"addressData.upload.overwriteAddressData.false.radioLabel"})})]}),Object(Ae.jsxs)("div",{className:"radio-button-wrapper",children:[Object(Ae.jsx)("input",{type:"radio",id:"overwrite-true",value:rt,name:"overwriteAddressData",className:"radio-button"}),Object(Ae.jsx)("label",{htmlFor:"overwrite-true",children:Object(Ae.jsx)(g.a,{id:"addressData.upload.overwriteAddressData.true.radioLabel"})})]})]})},e.uploadButton=function(){return Object(Ae.jsxs)("div",{className:"upload-button-wrapper",children:[Object(Ae.jsxs)("div",{className:"upload-button",children:[e.props.addressDataUploading&&Object(Ae.jsx)("div",{className:"spinner",children:Object(Ae.jsx)(Ie.a,{})}),Object(Ae.jsx)(I.a,{onClick:e.onUpload,disabled:e.props.addressDataUploading||!e.state.acceptedFile,className:"pull-right",children:Object(Ae.jsx)(g.a,{id:"addressData.upload.button"})})]}),Object(Ae.jsx)("p",{className:"upload-error pull-right",children:e.props.uploadError})]})},e.downloadButton=function(t){return Object(Ae.jsx)(I.a,{onClick:e.downloadAddressData,disabled:t||!e.props.totalCount,className:"cancel",children:Object(Ae.jsx)(g.a,{id:"addressData.download.button"})})},e.uploadedFileTable=function(){var t=e.state.page,n=e.props,a=n.totalCount,i=n.addressDataLoading,s=n.addressDataUploading,o=n.addressData,r=n.hasNextPage,c=a>0,l=i&&(!c||s);return Object(Ae.jsxs)("div",{className:"section table-section",children:[Object(Ae.jsxs)("div",{className:"title-section",children:[Object(Ae.jsx)("h2",{children:Object(Ae.jsx)(g.a,{id:"addressData.table.title"})}),e.downloadButton(l)]}),l?Object(Ae.jsx)("div",{className:"spinner",children:Object(Ae.jsx)(Ie.a,{})}):c?Object(Ae.jsx)(mt,{columns:qi,entities:o,columnContent:e.columnContent,hasNext:r,currentPage:t,switchPage:e.switchPage}):Object(Ae.jsx)("p",{className:"address-data-empty",children:Object(Ae.jsx)(g.a,{id:"addressData.upload.addressDataEmpty"})})]})},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.props.getAddressDataPage(this.state.page)}},{key:"componentDidUpdate",value:function(e,t,n){var a=this,i=this.props,s=i.intl,o=i.error,r=i.addressDataUploaded,c=i.downloadableAddressData;!e.addressDataUploaded&&r?(Object(Pe.b)(s.formatMessage({id:"addressData.upload.success"})),this.setState({page:0,isDownloadableAddressDataValid:!1},(function(){return a.props.getAddressDataPage(a.state.page)}))):e.downloadableAddressData!==c?this.setState({isDownloadableAddressDataValid:!0},this.triggerAddressDataDownload):e.error!==o&&Object(Pe.a)(o)}},{key:"render",value:function(){var e=this,t=this.props,n=t.appError,a=t.appLoading;return Object(Ae.jsxs)("div",{id:"address-data",children:[this.confirmationModal(),Object(Ae.jsx)("h2",{children:Object(Ae.jsx)(g.a,{id:"addressData.title"})}),Object(Ae.jsx)("div",{className:"error",children:n}),Object(Ae.jsx)("div",{className:"inner-content",children:a?Object(Ae.jsx)("div",{className:"spinner",children:Object(Ae.jsx)(Ie.a,{})}):Object(Ae.jsxs)("div",{className:"section",children:[Object(Ae.jsx)("h2",{children:Object(Ae.jsx)(g.a,{id:"addressData.upload.title"})}),this.instructions(),Object(Ae.jsx)($i,{acceptedFileExt:".txt,.csv",instructionMessageId:"addressData.dropzone.instruction",onFileAccepted:function(t){return e.setState({acceptedFile:t})}}),this.overwriteAddressDataRadioButtons(),this.uploadButton(),this.uploadedFileTable()]})})]})}}]),n}(i.a.Component),ts={getAddressDataPage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:he,n="/openmrs/ws/cfl/address-data";return{type:Hi,payload:C.a.get(n,{params:{page:e+1,rows:t}})}},getAddressData:zi,postAddressData:function(e,t){var n=new FormData;return n.append("file",e),n.append("delimeter",","),n.append("userGeneratedIdDelimiter","false"),n.append("overwrite","".concat(t)),{type:Yi,payload:C.a.post("/openmrs/ws/cfl/address-data/upload",n,{headers:{"Content-Type":"multipart/form-data"}})}}},ns=Object(x.connect)((function(e){var t=e.apps,n=e.addressData;return{appError:t.errorMessage,appLoading:t.loading,error:t.errorMessage,addressDataLoading:n.loadingAddressData,addressDataUploading:n.addressDataUploading,addressDataUploaded:n.addressDataUploaded,addressData:n.addressData,hasNextPage:n.hasNextPage,totalCount:n.totalCount,uploadError:n.errorMessage,downloadableAddressData:n.downloadableAddressData}}),ts)(Object(L.c)(Object(m.withRouter)(es))),as=n(457),is=n(57),ss=n(990),os=n.n(ss),rs="biometric.api.config.localization",cs="locale.allowed.list",ls=hi.a.getAllCodes().map((function(e){return{label:hi.a.getName(e),value:e}})),ds={localization:{}},us="translations.csv";function ps(e){var t=e.intl,n=e.languages,i=e.isOpen,s=e.onYes,o=e.onNo,r=Object(a.useState)(null),c=Object(Xi.a)(r,2),l=c[0],d=c[1];return Object(Ae.jsxs)(ya.a,{isOpen:i,fade:!1,children:[Object(Ae.jsx)(Ca.a,{children:Object(Ae.jsx)(g.a,{id:"vmpTranslations.addLanguage.title"})}),Object(Ae.jsx)(Na.a,{children:Object(Ae.jsx)(ii,{placeholder:t.formatMessage({id:"vmpTranslations.addLanguage.selectPlaceholder"}),showPlaceholder:!!l,value:ls.find((function(e){return e.value===l}))||null,onChange:function(e){return d(e.value)},options:ls.filter((function(e){return n.includes(e.value)})),wrapperClassName:"flex-2",classNamePrefix:"default-select",theme:Ba})}),Object(Ae.jsxs)(Sa.a,{children:[Object(Ae.jsx)(I.a,{className:"btn cancel",onClick:function(){o(),d(null)},children:Object(Ae.jsx)(g.a,{id:"common.cancel"})}),Object(Ae.jsx)(I.a,{className:"btn btn-primary",onClick:function(){s(l),d(null)},children:Object(Ae.jsx)(g.a,{id:"vmpTranslations.addLanguage.add"})})]})]})}n(1922);var ms=function(e){var t=e.intl,n=e.value,a=e.placeholderId,i=e.onChange;return Object(Ae.jsxs)("div",{className:"filter-input-wrapper",children:[Object(Ae.jsx)("img",{src:Le,alt:"search",className:"search-icon"}),Object(Ae.jsx)(Ve.a,{value:n,onChange:i,placeholder:t.formatMessage({id:a}),className:"filter-input"})]})},fs=(n(1923),function(e){var t=e.intl,n=e.value,a=e.options,i=e.placeholderId,s=e.onChange;return Object(Ae.jsx)(Pn.a,{placeholder:t.formatMessage({id:i}),value:n,onChange:s,options:a,classNamePrefix:"filter-select",className:"filter-select",theme:Ba})}),gs=(n(1924),{label:st,value:null}),hs="default",bs=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).state={isConfirmationModalOpen:!1,confirmationModalHeader:{id:st},confirmationModalBody:{id:st},onConfirmationModalConfirm:null,onConfirmationModalCancel:null,isDragActive:!1,acceptedFile:null,rejectedFile:null,translations:{},downloadableTranslations:{},translationsTableLanguages:[],vmpTranslationsSetting:null,languagesAllowed:[],isAddLanguageModalOpen:!1,phraseFilterValue:st,languageFilterValue:null,isDirty:!1},e.loadTranslations=function(){e.props.getSettingByQuery(rs),e.props.getAddressData(),e.props.searchLocations()},e.isRequestedSettingNotExist=function(e,t){return e.loading&&!t.loading&&!!t.isSettingExist&&!t.isSettingExist.value},e.extractTranslations=function(){var t,n,a;if((null===(t=e.props.setting)||void 0===t?void 0:t.property)===rs||e.props.isSettingExist.settingPropertyUrl.includes(rs)){var i=e.props.isSettingExist&&e.props.isSettingExist.value?La(e.props.config):ds;i=i&&i.localization?i.localization:[];var s=Object.keys(i).sort(),o={};Object.keys(i).forEach((function(t){Object.keys(i[t]).forEach((function(n){o[n]=Object(u.a)(Object(u.a)(Object(u.a)({},e.emptyTranslation(s)),o[n]),{},Object(is.a)({},t,i[t][n]))}))})),e.setState({translations:o,downloadableTranslations:E.a.cloneDeep(o),translationsTableLanguages:s,vmpTranslationsSetting:e.props.setting,isDirty:!1},(function(){e.props.getSettingByQuery(la),e.props.getSettingByQuery(cs)}))}else(null===(n=e.props.setting)||void 0===n?void 0:n.property)===la?e.extractConfigTranslations():(null===(a=e.props.setting)||void 0===a?void 0:a.property)===cs&&e.setState((function(t){return{languagesAllowed:e.props.config?e.props.config.split(",").map((function(e){return e.trim()})).filter((function(e){return!t.translationsTableLanguages.includes(e)})):[]}}))},e.extractAddressDataTranslations=function(){var t=e.state,n=t.translations,a=t.translationsTableLanguages,i=[];Array.isArray(e.props.addressData)&&(e.props.addressData.forEach((function(e){return e.forEach((function(e){e&&!i.includes(e)&&isNaN(e)&&i.push(e)}))})),i.filter((function(e){return!n[e]})).forEach((function(t){return n[t]=e.emptyTranslation(a)})),e.setState({translations:n,downloadableTranslations:E.a.cloneDeep(n)}))},e.extractConfigTranslations=function(){var t=e.state,n=t.translations,a=t.translationsTableLanguages,i=[],s=La(e.props.config);s.vaccine.forEach((function(e){return!!e.name&&!i.includes(e.name)&&i.push(e.name)})),s.manufacturers.forEach((function(e){return!!e.name&&!i.includes(e.name)&&i.push(e.name)})),s.personLanguages.forEach((function(e){return!!e.name&&!i.includes(e.name)&&i.push(e.name)})),Object.keys(s.addressFields).forEach((function(e){return s.addressFields[e].forEach((function(e){return!!e.name&&!i.includes(e.name)&&i.push(e.name)}))})),i.filter((function(e){return!n[e]})).forEach((function(t){return n[t]=e.emptyTranslation(a)})),e.setState({translations:n,downloadableTranslations:E.a.cloneDeep(n)})},e.extractLocationsTranslations=function(){var t=e.state,n=t.translations,a=t.translationsTableLanguages,i=e.props.locations;Array.isArray(i)&&(i.filter((function(e){return!!e.display&&!n[e.display]})).forEach((function(t){return n[t.display]=e.emptyTranslation(a)})),e.setState({translations:n,downloadableTranslations:E.a.cloneDeep(n)}))},e.emptyTranslation=function(e){var t={};return e.forEach((function(e){return t[e]=st})),t},e.sortTranslationsAlphabetically=function(e){return Object.keys(e).sort().reduce((function(t,n){return t[n]=e[n],t}),{})},e.onValueChange=function(t,n){return function(a){var i=e.state.translations;i[t][n]=ka(a),e.setState({translations:i,isDirty:!0})}},e.save=function(){var t=e.state,n=t.vmpTranslationsSetting,a=t.translations,i=t.translationsTableLanguages,s=ds;i.forEach((function(e){return s.localization[e]={}})),Object.keys(a).forEach((function(e){return Object.keys(a[e]).forEach((function(t){return s.localization[t][e]=a[e][t]}))}));var o=JSON.stringify(s);n&&n.uuid?(n.value=o,e.props.updateSetting(n)):e.props.createSetting(rs,o),e.resetState()},e.resetState=function(){return e.setState({acceptedFile:null,rejectedFile:null})},e.onReturn=function(){e.setState({isConfirmationModalOpen:!0,confirmationModalHeader:{id:"vmpTranslations.return.modalHeader"},confirmationModalBody:{id:"vmpTranslations.return.modalBody"},onConfirmationModalConfirm:e.return,onConfirmationModalCancel:e.closeConfirmationModal})},e.return=function(){window.location.href=j},e.addLanguageModal=function(){var t=e.state,n=t.languagesAllowed,a=t.translationsTableLanguages,i=t.isAddLanguageModalOpen;return Object(Ae.jsx)(ps,{intl:e.props.intl,languages:n.filter((function(e){return!a.includes(e)})),isOpen:i,onYes:function(t){return e.addLanguage(t)},onNo:function(){return e.setState({isAddLanguageModalOpen:!1})}})},e.confirmationModal=function(){return Object(Ae.jsx)(Ga,{header:e.state.confirmationModalHeader,body:e.state.confirmationModalBody,onYes:e.state.onConfirmationModalConfirm,onNo:e.state.onConfirmationModalCancel,isOpen:e.state.isConfirmationModalOpen})},e.closeConfirmationModal=function(){return e.setState({isConfirmationModalOpen:!1})},e.instructions=function(){return Object(Ae.jsx)("p",{children:Object(Ae.jsx)(g.a,{id:"vmpTranslations.upload.instruction1",values:{b:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Object(Ae.jsx)("b",{children:t})}}})})},e.uploadButton=function(){return Object(Ae.jsx)("div",{className:"upload-button-wrapper",children:Object(Ae.jsx)(I.a,{onClick:e.onUpload,disabled:!e.state.acceptedFile,className:"pull-right",children:Object(Ae.jsx)(g.a,{id:"vmpTranslations.upload.button"})})})},e.onUpload=function(){var t=e.state.acceptedFile;e.setState({isConfirmationModalOpen:!0,confirmationModalHeader:{id:"vmpTranslations.upload.modalHeader"},confirmationModalBody:{id:"vmpTranslations.upload.modalBody"},onConfirmationModalConfirm:function(){e.uploadTranslationFile(t),e.closeConfirmationModal()},onConfirmationModalCancel:e.closeConfirmationModal})},e.uploadTranslationFile=function(t){var n=e.state.translations;os.a.parse(t,{delimiter:",",header:!0,complete:function(t){t&&t.data&&t.data.forEach((function(e){var t=e.default,a=Object(as.a)(e,["default"]);n[t]=a}));var a=t.meta.fields?t.meta.fields.filter((function(e){return e!==hs})):[];e.setState((function(e){return{translations:n,translationsTableLanguages:Array.from(new Set([].concat(Object(ge.a)(e.translationsTableLanguages),Object(ge.a)(a)))),isDirty:!0}}))}})},e.downloadButton=function(){return Object(Ae.jsx)(I.a,{onClick:e.onDownloadTranslations,disabled:!e.props.config,className:"cancel",children:Object(Ae.jsx)(g.a,{id:"vmpTranslations.download.button"})})},e.onDownloadTranslations=function(){e.state.isDirty?e.setState({isConfirmationModalOpen:!0,confirmationModalHeader:{id:"vmpTranslations.download.modalHeader"},confirmationModalBody:{id:"vmpTranslations.download.modalBody"},onConfirmationModalConfirm:function(){e.downloadTranslations(),e.closeConfirmationModal()},onConfirmationModalCancel:e.closeConfirmationModal}):e.downloadTranslations()},e.downloadTranslations=function(){var t=e.state,n=t.downloadableTranslations,a=t.translationsTableLanguages,i=[];Object.keys(e.sortTranslationsAlphabetically(n)).forEach((function(e){return i.push(Object(u.a)({default:e},n[e]))})),Ji()(i,[hs].concat(Object(ge.a)(a)),us)},e.filters=function(){var t=e.props.intl,n=e.state,a=n.translationsTableLanguages,i=n.phraseFilterValue,s=n.languageFilterValue;return Object(Ae.jsxs)("div",{className:"pb-3 d-flex",children:[Object(Ae.jsx)(ms,{intl:t,value:i,placeholderId:"vmpTranslations.table.filter.phrase",onChange:function(t){return e.setState({phraseFilterValue:ka(t)})}}),Object(Ae.jsx)(fs,{intl:t,value:ls.find((function(e){return e.value===s}))||null,options:[gs].concat(Object(ge.a)(ls.filter((function(e){return a.includes(e.value)})))),placeholderId:"vmpTranslations.table.filter.language",onChange:function(t){return e.setState({languageFilterValue:t.value})}})]})},e.addLanguageButton=function(){return Object(Ae.jsx)(I.a,{onClick:e.onAddLanguage,disabled:0===Object.keys(e.state.translations).length,className:"cancel mb-3",children:Object(Ae.jsx)(g.a,{id:"vmpTranslations.addLanguage.title"})})},e.languageColumnLabel=function(e){var t=ls.find((function(t){return t.value===e}));return!!t&&!!t.label&&t.label},e.onAddLanguage=function(){return e.setState({isAddLanguageModalOpen:!0})},e.addLanguage=function(t){var n=e.state.translationsTableLanguages;n.unshift(t),e.setState({translationsTableLanguages:n,isAddLanguageModalOpen:!1})},e.filteredTableColumns=function(){var t=e.state,n=t.translationsTableLanguages,a=t.languageFilterValue;return n.filter((function(e){return!a||e===a}))},e.filteredTableRows=function(){var t=e.state,n=t.translations,a=t.phraseFilterValue;return Object.keys(e.sortTranslationsAlphabetically(n)).filter((function(e){return e.toLowerCase().includes(a.toLowerCase())||Object.keys(n[e]).some((function(t){return n[e][t].toLowerCase().includes(a.toLowerCase())}))}))},e.uploadedFileTable=function(){var t=e.props.intl,n=e.state.translations;return Object(Ae.jsxs)("div",{className:"section table-section",children:[Object(Ae.jsx)("div",{className:"title-section",children:e.downloadButton()}),e.filters(),e.addLanguageButton(),Object.keys(n).length?Object(Ae.jsxs)(ut.a,{borderless:!0,striped:!0,responsive:!0,className:"table",children:[Object(Ae.jsx)("thead",{children:Object(Ae.jsxs)("tr",{children:[Object(Ae.jsx)("th",{children:Object(Ae.jsx)(g.a,{id:"vmpTranslations.table.defaultLanguage"})},"id"),e.filteredTableColumns().map((function(t){return Object(Ae.jsx)("th",{children:e.languageColumnLabel(t)},t)}))]})}),Object(Ae.jsx)("tbody",{children:e.filteredTableRows().map((function(a,i){return Object(Ae.jsxs)("tr",{children:[Object(Ae.jsx)("td",{className:"px-3",children:a}),e.filteredTableColumns().map((function(i,s){return Object(Ae.jsx)("td",{children:Object(Ae.jsx)(ei.a,{value:n[a][i],onChange:e.onValueChange(a,i),className:"translation-input",placeholder:t.formatMessage({id:"vmpTranslations.table.defaultValue"})})},"".concat(i).concat(s))}))]},"".concat(a).concat(i))}))})]}):Object(Ae.jsx)("p",{className:"data-empty",children:Object(Ae.jsx)(g.a,{id:"vmpTranslations.table.empty"})})]})},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.loadTranslations()}},{key:"componentDidUpdate",value:function(e,t,n){var a=this.props,i=a.intl,s=a.config,o=a.addressData,r=a.locations,c=a.loading,l=a.success,d=a.error;e.config!==s||this.isRequestedSettingNotExist(e,this.props)?this.extractTranslations():e.addressData!==o?this.extractAddressDataTranslations():e.locations!==r&&this.extractLocationsTranslations(),!e.success&&l?(Object(Pe.b)(i.formatMessage({id:"vmpTranslations.save.success"})),this.loadTranslations()):e.error===this.props.error||c||Object(Pe.a)(d)}},{key:"render",value:function(){var e=this,t=this.props,n=t.appError,a=t.appLoading,i=t.loading,s=t.loadingAddressData,o=t.loadingLocations;return Object(Ae.jsxs)("div",{className:"vmp-translations",children:[this.confirmationModal(),this.addLanguageModal(),Object(Ae.jsx)("h2",{children:Object(Ae.jsx)(g.a,{id:"vmpTranslations.title"})}),Object(Ae.jsx)("div",{className:"error",children:n}),Object(Ae.jsx)("div",{className:"inner-content",children:a||i||s||o?Object(Ae.jsx)(Ie.a,{}):Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsxs)("div",{className:"section",children:[Object(Ae.jsx)("h2",{children:Object(Ae.jsx)(g.a,{id:"vmpTranslations.upload.title"})}),this.instructions(),Object(Ae.jsx)($i,{acceptedFileExt:".csv",instructionMessageId:"vmpTranslations.dropzone.instruction",onFileAccepted:function(t){return e.setState({acceptedFile:t})}}),this.uploadButton(),this.uploadedFileTable()]}),Object(Ae.jsxs)("div",{className:"mt-5 pb-5",children:[Object(Ae.jsx)("div",{className:"d-inline",children:Object(Ae.jsx)(I.a,{className:"cancel",onClick:this.onReturn,children:Object(Ae.jsx)(g.a,{id:"common.return"})})}),Object(Ae.jsx)("div",{className:"d-inline pull-right confirm-button-container",children:Object(Ae.jsx)(I.a,{className:"save",onClick:this.save,disabled:i,children:Object(Ae.jsx)(g.a,{id:"common.save"})})})]})]})})]})}}]),n}(i.a.Component),js={getSettingByQuery:G,getAddressData:zi,createSetting:H,updateSetting:Y,searchLocations:Zn},vs=Object(x.connect)((function(e){var t,n,a=e.apps,i=e.settings,s=e.addressData,o=e.location;return{appError:a.errorMessage,appLoading:a.loading,error:a.errorMessage,loading:i.loading,success:i.success,config:(null===(t=i.setting)||void 0===t?void 0:t.value)&&(null===(n=i.setting)||void 0===n?void 0:n.value),setting:i.setting,isSettingExist:i.isSettingExist,loadingAddressData:s.loadingAddressData,addressData:s.downloadableAddressData,locations:o.locations,loadingLocations:o.loadingLocations}}),js)(Object(L.c)(Object(m.withRouter)(bs))),Os="provider/GET_SMS_PROVIDERS",xs="provider/GET_CALLFLOWS_PROVIDERS",ys={loading:!1,smsProviders:[],callflowsProviders:[],errorMessage:null},Cs=function(){return{type:Os,payload:C.a.get("/openmrs/ws/sms/configs")}},Ns=function(){return{type:xs,payload:C.a.get("/openmrs/ws/callflows/configs")}},Ss=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ys,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N(Os):case N(xs):return Object(u.a)(Object(u.a)({},e),{},{loading:!0});case w(Os):case w(xs):return Object(u.a)(Object(u.a)({},e),{},{errorMessage:t.payload.message});case S(Os):return Object(u.a)(Object(u.a)({},e),{},{loading:!1,smsProviders:t.payload.data&&t.payload.data.configs?t.payload.data.configs:[]});case S(xs):return Object(u.a)(Object(u.a)({},e),{},{loading:!1,callflowsProviders:t.payload.data?t.payload.data:[]});default:return e}};n(1925);function ws(e){var t=e.headerComponent,n=e.disabledHeaderComponent,i=void 0===n?t:n,s=e.bodyComponent,o=e.isRemovable,r=void 0!==o&&o,c=e.onRemove,l=void 0===c?null:c,d=e.isExpandTriggered,u=void 0!==d&&d,p=Object(a.useState)(!1),m=Object(Xi.a)(p,2),f=m[0],g=m[1],h=Object(a.useRef)(),b=Object(a.useRef)();Object(a.useEffect)((function(){h.current=u,b.current=f}));var j=u!==h.current,v=f!==b.current;!v&&j&&f!==u&&g(u);var O=v?f:j?u:f;return Object(Ae.jsxs)("div",{className:"expandable-section",children:[Object(Ae.jsxs)("div",{className:"expandable-section-header",children:[Object(Ae.jsx)("div",{className:"inline-fields col-6 pl-0",children:O?t:i}),Object(Ae.jsxs)("div",{className:"icon-buttons col-6",children:[r&&!!l&&Object(Ae.jsx)(I.a,{className:"icon-button",onClick:l,"data-testid":"removeExpandableSectionButton",children:Object(Ae.jsx)("i",{className:"bi bi-trash"})}),Object(Ae.jsx)(I.a,{className:"icon-button",onClick:function(){return g(!O)},"data-testid":"expandableSectionButton",children:Object(Ae.jsx)("i",{className:"bi ".concat(O?"bi-arrows-collapse":"bi-arrows-expand")})})]})]}),O&&Object(Ae.jsx)("div",{className:"expandable-section-body",children:s})]})}var Ts=n(991),Ps=(n(1926),n(1927),function(e){var t=e.id,n=e.intl,a=e.onChange,i=e.checkedTranslationId,s=e.uncheckedTranslationId,o=e.labelTranslationId,r=e.checked,c=void 0!==r&&r,l=e.disabled,d=void 0!==l&&l;return Object(Ae.jsxs)("div",{className:"inline-fields switch-with-label",children:[Object(Ae.jsx)("label",{htmlFor:t,children:Object(Ae.jsx)(g.a,{id:o})}),Object(Ae.jsx)(Ts.a,{id:t,onChange:a,onClick:a,disabled:d,checked:c,checkedChildren:n.formatMessage({id:i}),unCheckedChildren:n.formatMessage({id:s})})]})});n(1928);function As(){return Object(Ae.jsx)("hr",{})}var Ds,Ms,Rs=n(2005),Es=(n(1929),n(1930),function(e){var t=e.format,n=void 0===t?ot:t,a=e.placeholder,i=void 0===a?null:a,s=e.showPlaceholder,o=void 0!==s&&s,r=e.showNow,c=void 0!==r&&r,l=e.value,d=e.onChange;return Object(Ae.jsxs)("div",{className:"input-container",children:[Object(Ae.jsx)(Rs.a,{format:n,placeholder:i,showNow:c,value:l,onChange:d,className:"default-time-picker"}),!!o&&Object(Ae.jsx)("span",{className:"placeholder",children:i||st})]})}),Vs=n(96),Is=n.n(Vs),Ls=(n(1931),"cfl.countrySettingsMap"),ks="default",Fs=Object(is.a)({},ks,{}),Us="name",Bs="SMS",qs="CALL",Ws="performCallOnPatientRegistration",Gs="sendSmsOnPatientRegistration",Hs="shouldSendReminderViaCall",Ys="shouldSendReminderViaSms",Qs="patientNotificationTimeWindowFrom",zs="patientNotificationTimeWindowTo",Ks="message.bestContactTime.default",Zs="message.daysToCallBeforeVisit.default",Js=(Ds={},Object(is.a)(Ds,Us,""),Object(is.a)(Ds,Bs,""),Object(is.a)(Ds,qs,""),Object(is.a)(Ds,Ws,!1),Object(is.a)(Ds,Gs,!1),Object(is.a)(Ds,Hs,!1),Object(is.a)(Ds,Ys,!1),Object(is.a)(Ds,"shouldCreateFirstVisit",!1),Object(is.a)(Ds,"shouldCreateFutureVisit",!1),Object(is.a)(Ds,Qs,null),Object(is.a)(Ds,zs,null),Object(is.a)(Ds,Ks,null),Object(is.a)(Ds,Zs,[0]),Ds),Xs=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).state={notificationConfiguration:[],isAllSectionsExpanded:!1,isConfirmationModalOpen:!1},e.extractConfigData=function(){var t=La(e.props.config);t=t[0]?t[0]:E.a.cloneDeep(Fs);var n=[];Object.keys(t).forEach((function(e){var a=e?t[e]:null;a&&(a.name=e,a.hasOwnProperty(Qs)&&(a.patientNotificationTimeWindowFrom=Is()(a.patientNotificationTimeWindowFrom,ot)),a.hasOwnProperty(zs)&&(a.patientNotificationTimeWindowTo=Is()(a.patientNotificationTimeWindowTo,ot)),a.hasOwnProperty(Ks)&&(a[Ks]=Is()(a[Ks],ot)),a.hasOwnProperty(Zs)&&Array.isArray(a[Zs])&&a[Zs].length||(a[Zs]=[0]),n.push(a))})),e.setState({notificationConfiguration:n})},e.isSaveDisabled=function(){return e.props.loading||e.state.notificationConfiguration.some((function(e){return!e.name}))},e.onSave=function(){return e.setState({isConfirmationModalOpen:!0})},e.save=function(){var t=e.props.setting,n=e.state.notificationConfiguration,a=[{}];n.forEach((function(e){var t=e.name,n=Object(as.a)(e,["name"]);Is.a.isMoment(n.patientNotificationTimeWindowFrom)&&(n.patientNotificationTimeWindowFrom=n.patientNotificationTimeWindowFrom.format(ot)),Is.a.isMoment(n.patientNotificationTimeWindowTo)&&(n.patientNotificationTimeWindowTo=n.patientNotificationTimeWindowTo.format(ot)),Is.a.isMoment(n[Ks])&&(n[Ks]=n[Ks].format(ot)),a[0][t]=n}));var i=JSON.stringify(a);t&&t.uuid?(t.value=i,e.props.updateSetting(t)):e.props.createSetting(Ls,i)},e.return=function(){window.location.href=j},e.closeModal=function(){return e.setState({isConfirmationModalOpen:!1})},e.confirmationModal=function(){return Object(Ae.jsx)(Ga,{header:{id:"notificationConfiguration.confirmationModal.header"},body:{id:"notificationConfiguration.confirmationModal.body"},onYes:function(){e.save(),e.closeModal()},onNo:e.closeModal,isOpen:e.state.isConfirmationModalOpen})},e.onChange=function(t,n){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(i){var s=e.state.notificationConfiguration,o=s[t],r=a?i.value:ka(i);o||s.push(Object(is.a)({},Us,o.name)),o[n]=r,e.setState({notificationConfiguration:s})}},e.selectTextOption=function(e){return{label:e,value:e}},e.smsSettings=function(t){var n=e.props,a=n.intl,i=n.smsProviders,s=e.state.notificationConfiguration[t],o=i.map((function(e){return{label:e.name,value:e.name}})),r=(null===s||void 0===s?void 0:s.SMS)?e.selectTextOption(s.SMS):null,c=!!(null===s||void 0===s?void 0:s.sendSmsOnPatientRegistration),l=!!(null===s||void 0===s?void 0:s.shouldSendReminderViaSms);return Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsxs)("div",{className:"py-3",children:[Object(Ae.jsx)(Ha.a,{children:Object(Ae.jsx)(g.a,{id:"notificationConfiguration.smsSettings"})}),Object(Ae.jsxs)("div",{className:"inline-fields",children:[Object(Ae.jsx)("div",{className:"col-6 pl-0",children:Object(Ae.jsx)(ii,{placeholder:a.formatMessage({id:"notificationConfiguration.provider"}),showPlaceholder:!!r,value:r,onChange:e.onChange(t,Bs,!0),options:o,wrapperClassName:"flex-1",classNamePrefix:"default-select",theme:Ba})}),Object(Ae.jsxs)("div",{className:"col-6 px-5",children:[Object(Ae.jsx)(Ps,{id:"sms-upon-registration-switch-".concat(t),intl:a,labelTranslationId:"notificationConfiguration.uponRegistration",checked:c,checkedTranslationId:"common.switch.on",uncheckedTranslationId:"common.switch.off",onChange:e.onChange(t,Gs)}),Object(Ae.jsx)(Ps,{id:"sms-visit-reminder-switch-".concat(t),intl:a,labelTranslationId:"notificationConfiguration.visitReminder.switch",checked:l,checkedTranslationId:"common.switch.on",uncheckedTranslationId:"common.switch.off",onChange:e.onChange(t,Ys)})]})]})]}),Object(Ae.jsx)(As,{})]})},e.callSettings=function(t){var n=e.props,a=n.intl,i=n.callflowsProviders,s=e.state.notificationConfiguration[t],o=i.map((function(e){return{label:e.name,value:e.name}})),r=(null===s||void 0===s?void 0:s.CALL)?e.selectTextOption(s.CALL):null,c=!!(null===s||void 0===s?void 0:s.performCallOnPatientRegistration),l=!!(null===s||void 0===s?void 0:s.shouldSendReminderViaCall);return Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsxs)("div",{className:"py-3",children:[Object(Ae.jsx)(Ha.a,{children:Object(Ae.jsx)(g.a,{id:"notificationConfiguration.callSettings"})}),Object(Ae.jsxs)("div",{className:"inline-fields",children:[Object(Ae.jsx)("div",{className:"col-6 pl-0",children:Object(Ae.jsx)(ii,{placeholder:a.formatMessage({id:"notificationConfiguration.provider"}),showPlaceholder:!!r,value:r,onChange:e.onChange(t,qs,!0),options:o,wrapperClassName:"flex-1",classNamePrefix:"default-select",theme:Ba})}),Object(Ae.jsxs)("div",{className:"col-6 px-5",children:[Object(Ae.jsx)(Ps,{id:"call-upon-registration-switch-".concat(t),intl:a,labelTranslationId:"notificationConfiguration.uponRegistration",checked:c,checkedTranslationId:"common.switch.on",uncheckedTranslationId:"common.switch.off",onChange:e.onChange(t,Ws)}),Object(Ae.jsx)(Ps,{id:"call-visit-reminder-switch-".concat(t),intl:a,labelTranslationId:"notificationConfiguration.visitReminder.switch",checked:l,checkedTranslationId:"common.switch.on",uncheckedTranslationId:"common.switch.off",onChange:e.onChange(t,Hs)})]})]})]}),Object(Ae.jsx)(As,{})]})},e.notificationWindowAndBestContactTime=function(t){var n=e.props.intl,a=e.state.notificationConfiguration[t],i=(null===a||void 0===a?void 0:a.patientNotificationTimeWindowFrom)?a.patientNotificationTimeWindowFrom:null,s=(null===a||void 0===a?void 0:a.patientNotificationTimeWindowTo)?a.patientNotificationTimeWindowTo:null,o=(null===a||void 0===a?void 0:a[Ks])?a[Ks]:null;return Object(Ae.jsxs)("div",{className:"inline-fields py-3",children:[Object(Ae.jsxs)("div",{className:"col-6 pl-0",children:[Object(Ae.jsx)(Ha.a,{children:Object(Ae.jsx)(g.a,{id:"notificationConfiguration.allowedNotificationWindow.label"})}),Object(Ae.jsxs)("div",{className:"inline-fields",children:[Object(Ae.jsx)(Es,{placeholder:n.formatMessage({id:"notificationConfiguration.allowedNotificationWindow.from"}),showPlaceholder:!!i,value:i,onChange:e.onChange(t,Qs)}),Object(Ae.jsx)(Es,{placeholder:n.formatMessage({id:"notificationConfiguration.allowedNotificationWindow.to"}),showPlaceholder:!!s,value:s,onChange:e.onChange(t,zs)})]})]}),Object(Ae.jsxs)("div",{className:"col-6 pl-5",children:[Object(Ae.jsx)(Ha.a,{children:Object(Ae.jsx)(g.a,{id:"notificationConfiguration.bestContactTime.label"})}),Object(Ae.jsx)(Es,{placeholder:n.formatMessage({id:"notificationConfiguration.bestContactTime.placeholder"}),showPlaceholder:!!o,value:o,onChange:e.onChange(t,Ks)})]})]})},e.onVisitReminderChange=function(t,n){return function(a){var i=e.state.notificationConfiguration,s=ka(a),o=s?Number.parseInt(s,10):0;Number.isInteger(o)&&o>=0&&(i[t][Zs][n]=o,e.setState({notificationConfiguration:i}))}},e.addVisitReminder=function(t){var n=e.state.notificationConfiguration;n[t][Zs].push(0),e.setState({notificationConfiguration:n})},e.removeVisitReminder=function(t,n){var a=e.state.notificationConfiguration,i=a[t];i[Zs].splice(n,1),i[Zs].length||i[Zs].push(0),e.setState({notificationConfiguration:a})},e.visitReminder=function(t){var n=e.props.intl,a=e.state.notificationConfiguration[t],i=(null===a||void 0===a?void 0:a[Zs])?a[Zs]:[0];return Object(Ae.jsxs)("div",{className:"pt-5",children:[Object(Ae.jsx)(Ha.a,{children:Object(Ae.jsx)(g.a,{id:"notificationConfiguration.visitReminder.label"})}),i.map((function(s,o){return Object(Ae.jsxs)("div",{className:"inline-fields py-1",children:[Object(Ae.jsx)(ai,{placeholder:n.formatMessage({id:"notificationConfiguration.visitReminder.placeholder"}),showPlaceholder:!0,value:s,onChange:e.onVisitReminderChange(t,o),type:"number",pattern:"[1-9]",min:0}),Object(Ae.jsx)(di,{intl:n,onPlusClick:function(){return e.addVisitReminder(t)},onMinusClick:function(){return e.removeVisitReminder(t,o)},isPlusButtonVisible:o===i.length-1})]},"".concat(a,"-").concat(t,"-reminder-").concat(o))}))]})},e.onCountryChange=function(t){return function(n){var a=e.state.notificationConfiguration;a[t].name=n.value,e.setState({notificationConfiguration:a})}},e.addNewCountryConfiguration=function(){var t=e.state.notificationConfiguration;t.push(E.a.cloneDeep(Js)),e.setState({notificationConfiguration:t})},e.removeCountryConfiguration=function(t){var n=e.state.notificationConfiguration;n.splice(t,1),e.setState({notificationConfiguration:n})},e.countryConfiguration=function(t,n){var a=e.props.intl,i=e.state,s=i.isAllSectionsExpanded,o=i.notificationConfiguration,r=t.name,c=r===ks,l=ua.filter((function(e){return!o.map((function(e){return e.name})).includes(e.value)})),d=c?Object(Ae.jsx)(Ha.a,{children:Object(Ae.jsx)(g.a,{id:"notificationConfiguration.defaultCountry"})}):Object(Ae.jsxs)("div",{className:"flex-1",children:[Object(Ae.jsx)(ii,{placeholder:a.formatMessage({id:"notificationConfiguration.country"}),showPlaceholder:!!r,value:!!r&&ua.find((function(e){return e.value===r})),onChange:e.onCountryChange(n),options:l,wrapperClassName:r?"":"invalid",classNamePrefix:"default-select",theme:Ba}),!r&&Object(Ae.jsx)(li,{message:"common.error.required"})]}),u=c?d:Object(Ae.jsx)(ai,{placeholder:a.formatMessage({id:"notificationConfiguration.country"}),showPlaceholder:!!r,value:r||"",wrapperClassName:"flex-1",readOnly:!0}),p=[e.smsSettings(n),e.callSettings(n),e.notificationWindowAndBestContactTime(n),e.visitReminder(n)];return Object(Ae.jsx)(ws,{headerComponent:d,disabledHeaderComponent:u,bodyComponent:p,isRemovable:!c,onRemove:function(){return e.removeCountryConfiguration(n)},isExpandTriggered:s},"configuration-".concat(n))},e.expandOrCollapseAllButton=function(){var t=e.state.isAllSectionsExpanded;return Object(Ae.jsx)(I.a,{onClick:function(){return e.setState((function(e){return{isAllSectionsExpanded:!e.isAllSectionsExpanded}}))},className:"cancel",children:Object(Ae.jsx)(g.a,{id:"notificationConfiguration.button.".concat(t?"collapse":"expand")})})},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.props.getSettingByQuery(Ls),this.props.getCallflowsProviders(),this.props.getSmsProviders()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.intl,a=t.config,i=t.loading,s=t.success,o=t.error;e.config!==a&&this.extractConfigData(),!e.success&&s?(Object(Pe.b)(n.formatMessage({id:"notificationConfiguration.success"})),this.setState({isAllSectionsExpanded:!1})):e.error===this.props.error||i||Object(Pe.a)(o)}},{key:"render",value:function(){var e=this,t=this.props,n=t.appError,a=t.appLoading,i=t.loading,s=this.state.notificationConfiguration;return Object(Ae.jsxs)("div",{className:"notification-configuration",children:[this.confirmationModal(),Object(Ae.jsx)("h2",{children:Object(Ae.jsx)(g.a,{id:"notificationConfiguration.title"})}),Object(Ae.jsx)("div",{className:"error",children:n}),Object(Ae.jsx)("div",{className:"inner-content",children:a||i?Object(Ae.jsx)(Ie.a,{}):Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsxs)("div",{className:"section",children:[Object(Ae.jsxs)("div",{className:"title-section",children:[Object(Ae.jsx)("h2",{children:Object(Ae.jsx)(g.a,{id:"notificationConfiguration.configureSettings"})}),this.expandOrCollapseAllButton()]}),s.map((function(t,n){return e.countryConfiguration(t,n)})),Object(Ae.jsx)("div",{className:"d-flex justify-content-end mt-4 mb-2",children:Object(Ae.jsx)(I.a,{className:"btn btn-primary",onClick:this.addNewCountryConfiguration,children:Object(Ae.jsx)(g.a,{id:"notificationConfiguration.button.addNewCountry"})})})]}),Object(Ae.jsxs)("div",{className:"mt-5 pb-5",children:[Object(Ae.jsx)("div",{className:"d-inline",children:Object(Ae.jsx)(I.a,{className:"cancel",onClick:this.return,children:Object(Ae.jsx)(g.a,{id:"common.return"})})}),Object(Ae.jsx)("div",{className:"d-inline pull-right confirm-button-container",children:Object(Ae.jsx)(I.a,{className:"save",onClick:this.onSave,disabled:this.isSaveDisabled(),children:Object(Ae.jsx)(g.a,{id:"common.save"})})})]})]})})]})}}]),n}(i.a.Component),_s={getSettingByQuery:G,createSetting:H,updateSetting:Y,getCallflowsProviders:Ns,getSmsProviders:Cs},$s=Object(x.connect)((function(e){var t,n,a=e.apps,i=e.settings,s=e.provider;return{appError:a.errorMessage,appLoading:a.loading,error:a.errorMessage,loading:i.loading,success:i.success,config:(null===(t=i.setting)||void 0===t?void 0:t.value)&&(null===(n=i.setting)||void 0===n?void 0:n.value),setting:i.setting,isSettingExist:i.isSettingExist,smsProviders:s.smsProviders,callflowsProviders:s.callflowsProviders}}),_s)(Object(L.c)(Object(m.withRouter)(Xs))),eo="messages/GET_MESSAGES_TEMPLATES_GLOBAL_PROPERTIES",to={loading:!1,success:!1,errorMessage:null,messagesTemplatesGlobalProperties:[]},no=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:to,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N(eo):return Object(u.a)(Object(u.a)({},e),{},{loading:!0,success:!1,errorMessage:null});case w(eo):return Object(u.a)(Object(u.a)({},e),{},{loading:!1,success:!1,errorMessage:t.payload.message});case S(eo):return Object(u.a)(Object(u.a)({},to),{},{loading:!1,success:!0,messagesTemplatesGlobalProperties:t.payload.data});default:return e}},ao=(n(1932),"messages.notificationTemplate."),io="injectedServices",so="messages.notificationTemplate.injectedServices",oo="property",ro="description",co="value",lo=/^[^\d\s][a-z-]*$/g,uo=":",po="key",mo="value",fo=(Ms={},Object(is.a)(Ms,po,st),Object(is.a)(Ms,mo,st),Ms),go=(n(1933),ni(ei.a)),ho=function(e){var t=e.value,n=e.placeholder,a=e.showPlaceholder,i=e.minRows,s=void 0===i?void 0:i,o=e.maxRows,r=void 0===o?void 0:o,c=e.isResizable,l=void 0!==c&&c,d=e.className,u=void 0===d?st:d,p=e.onChange;return Object(Ae.jsx)(go,{value:t,onChange:p,placeholder:n,showPlaceholder:a,minRows:s,maxRows:r,className:"form-control default-textarea ".concat(l?"resizable":st," ").concat(u)})},bo=n(995),jo=(n(1934),n(1935),n(1936),n(1937),ni((function(e){var t=e.value,n=e.lineNumbers,a=void 0!==n&&n,i=e.placeholder,s=e.onChange;return Object(Ae.jsx)(bo.UnControlled,{value:t,options:{mode:"velocity",theme:"default",lineNumbers:a,placeholder:i},autoCursor:!1,onChange:function(e,t,n){return s(n)}})}))),vo=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).state={notificationTemplates:[],savedNotificationTemplates:[],isAllSectionsExpanded:!1,isConfirmationModalOpen:!1,unremovableGlobalProperties:[],confirmationModalHeader:{id:st},confirmationModalBody:{id:st},onConfirmationModalConfirm:null,onConfirmationModalCancel:null,dirtyNotificationTemplates:new Set,unifiedSuccessToastDisplayed:!1,isAllRequestsSent:!1},e.isSaveDisabled=function(){return e.props.loading||e.state.notificationTemplates.filter((function(e){return e.property!==io})).some((function(e){var t=new RegExp(lo),n=e.property;return!n||!t.test(n)}))},e.onSave=function(){return e.setState({isConfirmationModalOpen:!0,confirmationModalHeader:{id:"notificationTemplates.saveModal.header"},confirmationModalBody:{id:"notificationTemplates.saveModal.body"},onConfirmationModalConfirm:function(){e.save(),e.closeModal()},onConfirmationModalCancel:e.closeModal})},e.save=function(){var t=E.a.cloneDeep(e.state.notificationTemplates);t.forEach((function(e){return e.property=ao+e.property}));var n=E.a.cloneDeep(e.state.savedNotificationTemplates);n.forEach((function(e){return e.property=ao+e.property}));var a=t.find((function(e){return e.property===so}));a.value=a.value.reduce((function(e,t,n){return e+t.key+uo+t.value+(n===a.value.length-1?st:",")}),st),n.filter((function(e){return!t.find((function(t){return t.uuid===e.uuid}))})).forEach((function(t){return e.props.deleteSetting(t)})),t.forEach((function(t){t&&t.uuid&&e.state.dirtyNotificationTemplates.has(t.uuid)?e.props.updateSetting(t):t&&!t.uuid&&e.props.createSetting(t.property,t.value,t.description)})),e.setState({isAllRequestsSent:!0})},e.isRemovable=function(t){var n=e.state,a=n.notificationTemplates,i=n.unremovableGlobalProperties,s=a[t].property,o=ao+s;return!s||s&&!i.includes(o.toLowerCase())},e.return=function(){window.location.href=j},e.closeModal=function(){return e.setState({isConfirmationModalOpen:!1})},e.confirmationModal=function(){return Object(Ae.jsx)(Ga,{header:e.state.confirmationModalHeader,body:e.state.confirmationModalBody,onYes:e.state.onConfirmationModalConfirm,onNo:e.state.onConfirmationModalCancel,isOpen:e.state.isConfirmationModalOpen})},e.onChange=function(t,n){return function(a){var i,s=e.state,o=s.notificationTemplates,r=s.dirtyNotificationTemplates,c=o[t],l=ka(a);c[n]=l;var d=null===o||void 0===o||null===(i=o[t])||void 0===i?void 0:i.uuid;r.add(d),e.setState({notificationTemplates:o,dirtyNotificationTemplates:r})}},e.description=function(t,n){return Object(Ae.jsx)("div",{className:"py-2",children:Object(Ae.jsx)(ho,{value:t.description,onChange:e.onChange(n,ro),placeholder:e.props.intl.formatMessage({id:"notificationTemplates.template.description"}),showPlaceholder:t.description})})},e.text=function(t,n){return Object(Ae.jsx)("div",{className:"py-2",children:Object(Ae.jsx)(jo,{value:t.value,lineNumbers:!0,placeholder:e.props.intl.formatMessage({id:"notificationTemplates.template.text"}),showPlaceholder:!!t.value,onChange:e.onChange(n,co)})})},e.addNewTemplate=function(){var t=e.state.notificationTemplates;t.push({}),e.setState({notificationTemplates:t})},e.onRemoveTemplate=function(t){e.setState({isConfirmationModalOpen:!0,confirmationModalHeader:{id:"notificationTemplates.removeTemplateModal.header"},confirmationModalBody:{id:"notificationTemplates.removeTemplateModal.body",values:{templateName:e.state.notificationTemplates[t].property}},onConfirmationModalConfirm:function(){e.removeTemplate(t),e.closeModal()},onConfirmationModalCancel:e.closeModal})},e.removeTemplate=function(t){var n=e.state.notificationTemplates;n.splice(t,1),e.setState({notificationTemplates:n})},e.customTemplateHeader=function(t,n){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e.props.intl,s=t.property,o=!s,r=new RegExp(lo),c=!r.test(s);return Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsxs)("div",{className:"flex-1",children:[Object(Ae.jsx)(ai,{placeholder:i.formatMessage({id:"notificationTemplates.template.customTemplateName.label"}),showPlaceholder:!o,value:s||"",onChange:e.onChange(n,oo),className:a||!o&&!c?"":"invalid",disabled:a}),!a&&(o?Object(Ae.jsx)(li,{message:"common.error.required"}):c&&Object(Ae.jsx)(li,{message:"notificationTemplates.template.customTemplateName.invalid"}))]}),Object(Ae.jsx)(Ha.a,{className:"custom-template-name-tooltip",children:Object(Ae.jsx)("span",{className:"glyphicon glyphicon-info-sign ml-2","aria-hidden":"true",title:i.formatMessage({id:"notificationTemplates.template.customTemplateName.tooltip"})})})]})},e.addInjectedService=function(){var t=e.state.notificationTemplates;t.find((function(e){return e.property===io})).value.push(E.a.clone(fo)),e.setState({notificationTemplates:t})},e.removeInjectedService=function(t){var n=e.state.notificationTemplates,a=n.find((function(e){return e.property===io}));a.value.splice(t,1),a.value.length||a.value.push(E.a.clone(fo)),e.setState({notificationTemplates:n})},e.onInjectedServicePropertyChange=function(t,n){return function(a){var i=e.state,s=i.notificationTemplates,o=i.dirtyNotificationTemplates,r=s.find((function(e){return e.property===io}));r.value[t][n]=ka(a);var c=null===r||void 0===r?void 0:r.uuid;o.add(c),e.setState({notificationTemplates:s,dirtyNotificationTemplates:o})}},e.injectedServicesBody=function(t){var n=e.props.intl,a=t.value;return Object(Ae.jsx)("div",{className:"py-2",children:null===a||void 0===a?void 0:a.map((function(t,i){var s=t.key,o=t.value;return Object(Ae.jsxs)("div",{className:"inline-fields py-1",children:[Object(Ae.jsx)(ai,{placeholder:n.formatMessage({id:"notificationTemplates.injectedServices.key"}),showPlaceholder:!!s,value:s,onChange:e.onInjectedServicePropertyChange(i,po),wrapperClassName:"flex-1"}),Object(Ae.jsx)(ai,{placeholder:n.formatMessage({id:"notificationTemplates.injectedServices.value"}),showPlaceholder:!!o,value:o,onChange:e.onInjectedServicePropertyChange(i,mo),wrapperClassName:"flex-1"}),Object(Ae.jsx)(di,{intl:n,onPlusClick:function(){return e.addInjectedService()},onMinusClick:function(){return e.removeInjectedService(i)},isPlusButtonVisible:i===a.length-1})]},"injectedService-".concat(i))}))})},e.template=function(t,n){var a=e.props.intl,i=e.state,s=i.isAllSectionsExpanded,o=i.savedNotificationTemplates,r=t.property,c=t.uuid,l=r===io,d=o.includes(t),u=l?Object(Ae.jsxs)(Ha.a,{children:[Object(Ae.jsx)(g.a,{id:"notificationTemplates.injectedServices.label"}),Object(Ae.jsx)("span",{className:"glyphicon glyphicon-info-sign ml-2","aria-hidden":"true",title:a.formatMessage({id:"notificationTemplates.injectedServices.tooltip"})})]}):d?Object(Ae.jsx)(Ha.a,{children:r}):e.customTemplateHeader(t,n),p=l||d?u:e.customTemplateHeader(t,n,!0),m=l?e.injectedServicesBody(t):[e.description(t,n),e.text(t,n)];return Object(Ae.jsx)(ws,{headerComponent:u,disabledHeaderComponent:p,bodyComponent:m,isRemovable:e.isRemovable(n)&&!l,onRemove:function(){return e.onRemoveTemplate(n)},isExpandTriggered:s},"template-".concat(n,"-").concat(c))},e.expandOrCollapseAllButton=function(){var t=e.state.isAllSectionsExpanded;return Object(Ae.jsx)(I.a,{onClick:function(){return e.setState((function(e){return{isAllSectionsExpanded:!e.isAllSectionsExpanded}}))},className:"cancel",children:Object(Ae.jsx)(g.a,{id:"notificationTemplates.button.".concat(t?"collapse":"expand")})})},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.props.getMessagesTemplatesGlobalProperties()}},{key:"componentDidUpdate",value:function(e){var t=this,n=this.props,a=n.intl,i=n.settings,s=n.loading,o=n.success,r=n.appError,c=n.unremovableGlobalProperties;if(e.unremovableGlobalProperties!==c)this.setState({unremovableGlobalProperties:c.map((function(e){return e.toLowerCase()}))},(function(){return t.props.getSettings(ao)}));else if(e.settings!==i){var l=[],d=i.find((function(e){return e.property===so})),u=d.value.split(",").map((function(e){var t;return t={},Object(is.a)(t,po,e.split(uo)[0]),Object(is.a)(t,mo,e.split(uo)[1]),t}));d.value=u,l.push(d);var p=i.filter((function(e){return e!==d}));l.push.apply(l,Object(ge.a)(p)),l.forEach((function(e){return e.property=e.property.replace(ao,st)})),this.setState({notificationTemplates:l,savedNotificationTemplates:E.a.clone(l),unifiedSuccessToastDisplayed:!1})}!e.success&&o&&this.state.isAllRequestsSent&&!this.state.unifiedSuccessToastDisplayed?(Object(Pe.b)(a.formatMessage({id:"notificationTemplates.success"})),this.setState({isAllSectionsExpanded:!1,dirtyNotificationTemplates:new Set,isAllRequestsSent:!1,unifiedSuccessToastDisplayed:!0},(function(){return t.props.getSettings(ao)}))):e.appError===this.props.appError||s||Object(Pe.a)(r)}},{key:"render",value:function(){var e=this,t=this.props,n=t.appError,a=t.appLoading,i=t.loadingUnremovableGlobalProperties,s=t.loading,o=this.state.notificationTemplates;return Object(Ae.jsxs)("div",{className:"notification-templates",children:[this.confirmationModal(),Object(Ae.jsx)("h2",{children:Object(Ae.jsx)(g.a,{id:"notificationTemplates.title"})}),Object(Ae.jsx)("div",{className:"error",children:n}),Object(Ae.jsx)("div",{className:"inner-content",children:a||i||s?Object(Ae.jsx)(Ie.a,{}):Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsxs)("div",{className:"section",children:[Object(Ae.jsx)("div",{className:"title-section",children:this.expandOrCollapseAllButton()}),o.map((function(t,n){return e.template(t,n)})),Object(Ae.jsx)("div",{className:"d-flex justify-content-end mt-4 mb-2",children:Object(Ae.jsx)(I.a,{className:"btn btn-primary",onClick:this.addNewTemplate,children:Object(Ae.jsx)(g.a,{id:"notificationTemplates.button.addNewTemplate"})})})]}),Object(Ae.jsxs)("div",{className:"mt-5 pb-5",children:[Object(Ae.jsx)("div",{className:"d-inline",children:Object(Ae.jsx)(I.a,{className:"cancel",onClick:this.return,children:Object(Ae.jsx)(g.a,{id:"common.return"})})}),Object(Ae.jsx)("div",{className:"d-inline pull-right confirm-button-container",children:Object(Ae.jsx)(I.a,{className:"save",onClick:this.onSave,disabled:this.isSaveDisabled(),children:Object(Ae.jsx)(g.a,{id:"common.save"})})})]})]})})]})}}]),n}(i.a.Component),Oo={getSettings:W,createSetting:H,updateSetting:Y,deleteSetting:function(e){return{type:B,payload:C.a.delete("/openmrs/ws/rest/v1/systemsetting/".concat(e.uuid))}},getCallflowsProviders:Ns,getSmsProviders:Cs,getMessagesTemplatesGlobalProperties:function(){return{type:eo,payload:C.a.get("/openmrs/ws/messages/templates/globalProperties")}}},xo=Object(x.connect)((function(e){var t,n,a=e.apps,i=e.settings,s=e.provider,o=e.messages;return{appError:a.errorMessage,appLoading:a.loading,loading:i.loading,success:i.success,config:(null===(t=i.setting)||void 0===t?void 0:t.value)&&(null===(n=i.setting)||void 0===n?void 0:n.value),setting:i.setting,settings:i.settings,isSettingExist:i.isSettingExist,smsProviders:s.smsProviders,callflowsProviders:s.callflowsProviders,loadingUnremovableGlobalProperties:o.loading,unremovableGlobalProperties:o.messagesTemplatesGlobalProperties}}),Oo)(Object(L.c)(Object(m.withRouter)(vo))),yo=(n(1938),n(3)),Co=n.n(yo),No={name:"",description:"",address1:"",address2:"",cityVillage:"",stateProvince:"",country:"",postalCode:"",tags:[],attributes:[]},So={getLocationAttributeTypes:function(){return{type:Qn,payload:C.a.get("/openmrs/ws/rest/v1/locationattributetype?v=full")}},searchLocations:Zn,saveLocation:function(e){return{type:zn,payload:C.a.post("/openmrs/ws/rest/v1/location".concat(e.uuid?"/"+e.uuid:""),e)}},getLocation:function(e){return{type:Yn,payload:C.a.get("/openmrs/ws/rest/v1/location?s=byId&id=".concat(e,"&v=full"))}},getSettingByQuery:G},wo=Object(x.connect)((function(e){var t=e.location,n=t.loadingLocationAttributeTypes,a=t.locationAttributeTypes,i=t.locations,s=t.success,o=t.loadingLocation,r=t.location,c=e.settings,l=c.loading,d=c.setting;return{isLocationLoading:n||o||l,locationAttributeTypes:a.filter((function(e){return!e.retired})),locations:i,success:s,editedLocation:r,settingValue:null===d||void 0===d?void 0:d.value}}),So)(Object(L.c)(Object(m.withRouter)((function(e){var t=Object(a.useState)(No),n=Object(Xi.a)(t,2),i=n[0],s=n[1],o=Object(a.useState)(!1),r=Object(Xi.a)(o,2),c=r[0],l=r[1],d=e.intl.formatMessage,p=e.match.params.locationId;Object(a.useEffect)((function(){e.getLocationAttributeTypes(),e.searchLocations(),e.getSettingByQuery("cflui.location.defaultTag.uuid.list"),p&&e.getLocation(p)}),[]),Object(a.useEffect)((function(){e.editedLocation&&s(e.editedLocation)}),[e.editedLocation]);var m=function(){window.location.href="".concat(j,"adminui/metadata/locations/manageLocations.page")};Object(a.useEffect)((function(){e.success&&m()}),[e.success]);var f=function(e){return function(t){return s(Object(u.a)(Object(u.a)({},i),{},Object(is.a)({},e,ka(t))))}},h=!i.name,b=e.locations.filter((function(e){return e.uuid!==i.uuid})).map((function(e){return e.display.toLowerCase()})).includes(i.name.toLowerCase()),v=!i.country,O=Object(R.chunk)(e.locationAttributeTypes,2),x=function(e){var t,n,a="locationAttribute".concat(e.uuid),o=e.name,r=null===(t=i.attributes.find((function(t){return e.uuid===t.attributeType.uuid})))||void 0===t?void 0:t.value,l=1===e.minOccurs&&!r,p=(n=e.uuid,function(e){var t=i.attributes,a=t.find((function(e){return e.attributeType.uuid===n})),o=ka(e);a?a.value=o:t=[].concat(Object(ge.a)(i.attributes),[{attributeType:{uuid:n},value:o}]),s(Object(u.a)(Object(u.a)({},i),{},{attributes:t}))});switch(e.preferredHandlerClassname){case"org.openmrs.web.attribute.handler.SpecifiedTextOptionsDropdownHandler":var m=e.handlerConfig.split(",").map((function(e){return{label:e,value:e}}));return Object(Ae.jsxs)("div",{className:"input-container",children:[Object(Ae.jsx)(ii,{placeholder:o,showPlaceholder:!!r,value:m.find((function(e){return e.value===r})),onChange:function(e){return p(e.value)},options:m,wrapperClassName:Co()("flex-1",{invalid:c&&l}),classNamePrefix:"default-select",theme:Ba},a),c&&l&&Object(Ae.jsx)(li,{message:"common.error.required"})]});case"org.openmrs.web.attribute.handler.BooleanFieldGenDatatypeHandler":return Object(Ae.jsx)(oi,{name:a,onChange:p,options:[{value:rt,label:d({id:"common.true"})},{value:ct,label:d({id:"common.false"})}],value:null===r||void 0===r?void 0:r.toString(),placeholder:o,showPlaceholder:!0},a);case"org.openmrs.web.attribute.handler.LongFreeTextTextareaHandler":return Object(Ae.jsxs)("div",{className:"input-container",children:[Object(Ae.jsx)(ho,{className:Co()(c&&l),placeholder:o,showPlaceholder:!!r,value:r,onChange:p,isResizable:!0},a),c&&l&&Object(Ae.jsx)(li,{message:"common.error.required"})]});default:return Object(Ae.jsxs)("div",{className:"input-container",children:[Object(Ae.jsx)(ai,{className:Co()({invalid:c&&l}),placeholder:o,showPlaceholder:!!r,value:r,onChange:p},a),c&&l&&Object(Ae.jsx)(li,{message:"common.error.required"})]})}};return Object(Ae.jsxs)("div",{id:"location",children:[Object(Ae.jsx)("h2",{children:Object(Ae.jsx)(g.a,{id:"locations.location.".concat(p?"edit":"create",".title")})}),Object(Ae.jsx)("div",{className:"inner-content",children:e.isLocationLoading?Object(Ae.jsx)("div",{className:"spinner",children:Object(Ae.jsx)(Ie.a,{})}):Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsxs)("div",{className:"section",children:[Object(Ae.jsxs)("div",{className:"inline-fields",children:[Object(Ae.jsxs)("div",{className:"input-container",children:[Object(Ae.jsx)(ai,{placeholder:d({id:"locations.location.name"}),showPlaceholder:!!i.name,value:i.name,onChange:f("name"),className:Co()({invalid:c&&(h||b)}),"data-testid":"locationNameInput"},"locationNameInput"),c&&(h?Object(Ae.jsx)(li,{message:"common.error.required"}):b&&Object(Ae.jsx)(li,{message:"common.error.nameUnique"}))]}),Object(Ae.jsx)(ai,{placeholder:d({id:"locations.location.description"}),showPlaceholder:!!i.description,value:i.description,onChange:f("description"),"data-testid":"locationDescriptionInput"},"locationDescriptionInput")]}),Object(Ae.jsxs)("div",{className:"inline-fields",children:[Object(Ae.jsx)(ai,{placeholder:d({id:"locations.location.address1"}),showPlaceholder:!!i.address1,value:i.address1,onChange:f("address1"),"data-testid":"locationAddress1Input"},"locationAddress1Input"),Object(Ae.jsx)(ai,{placeholder:d({id:"locations.location.address2"}),showPlaceholder:!!i.address2,value:i.address2,onChange:f("address2"),"data-testid":"locationAddress2Input"},"locationAddress2Input")]}),Object(Ae.jsxs)("div",{className:"inline-fields",children:[Object(Ae.jsx)(ai,{placeholder:d({id:"locations.location.cityVillage"}),showPlaceholder:!!i.cityVillage,value:i.cityVillage,onChange:f("cityVillage"),"data-testid":"locationCityVillageInput"},"locationCityVillageInput"),Object(Ae.jsx)(ai,{placeholder:d({id:"locations.location.stateProvince"}),showPlaceholder:!!i.stateProvince,value:i.stateProvince,onChange:f("stateProvince"),"data-testid":"locationStateProvinceInput"},"locationStateProvinceInput")]}),Object(Ae.jsxs)("div",{className:"inline-fields",children:[Object(Ae.jsx)(ai,{placeholder:d({id:"locations.location.postalCode"}),showPlaceholder:!!i.postalCode,value:i.postalCode,onChange:f("postalCode"),"data-testid":"locationPostalCodeInput"},"locationPostalCodeInput"),Object(Ae.jsxs)("div",{className:"input-container",children:[Object(Ae.jsx)(ai,{placeholder:d({id:"locations.location.country"}),showPlaceholder:!!i.country,value:i.country,onChange:f("country"),className:Co()({invalid:c&&v}),"data-testid":"locationCountryInput"},"locationCountryInput"),c&&v&&Object(Ae.jsx)(li,{message:"common.error.required"})]})]}),null===O||void 0===O?void 0:O.map((function(e,t){return Object(Ae.jsx)("div",{className:"inline-fields",children:e.map((function(e){return x(e)}))},"locationAttributeTypesGroup".concat(t))}))]}),Object(Ae.jsxs)("div",{className:"mt-5 pb-5",children:[Object(Ae.jsx)("div",{className:"d-inline",children:Object(Ae.jsx)(I.a,{className:"cancel",onClick:m,"data-testid":"returnButton",children:Object(Ae.jsx)(g.a,{id:"common.return"})})}),Object(Ae.jsx)("div",{className:"d-inline pull-right confirm-button-container",children:Object(Ae.jsx)(I.a,{className:"save",onClick:function(){var t=e.locationAttributeTypes.filter((function(e){return 1===e.minOccurs})).every((function(e){var t=e.uuid;return i.attributes.find((function(e){var n=e.attributeType,a=e.value;return t===n.uuid&&a}))}));if(h||b||v||!t)l(!0),Ai();else{var n=Object(R.cloneDeep)(i),a=e.settingValue?JSON.parse(e.settingValue):[];n.attributes=n.attributes.filter((function(e){return""!==e.value})).map((function(e){return{attributeType:e.attributeType,value:e.value}})),n.tags=Object(R.uniq)([].concat(Object(ge.a)(n.tags),Object(ge.a)(a))),e.saveLocation(n)}},"data-testid":"saveButton",children:Object(Ae.jsx)(g.a,{id:"common.save"})})})]})]})})]})})))),To="personId=",Po=/^(([^<>()\\[\]\\.,;:\s@"]+(\.[^<>()\\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,Ao=/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}$/,Do=/^[\w\d\\_][\w\d\\_.-]{1,49}$/,Mo="cfl.person.attributeType",Ro="".concat(Mo,".telephoneNumberUuid"),Eo="".concat(Mo,".emailAddressUuid"),Vo="xxxxxx",Io="familyName",Lo="givenName",ko="phone",Fo="email",Uo="username",Bo="locations",qo="userRole",Wo="password",Go="confirmPassword",Ho={familyName:{value:"",isValid:!0,error:""},givenName:{value:"",isValid:!0,error:""},phone:{value:"",isValid:!0,error:""},email:{value:"",isValid:!0,error:""},username:{value:"",isValid:!0,error:""},locations:{value:[],isValid:!0,error:""},userRole:{value:null,isValid:!0,error:""},password:{value:"",isValid:!0,error:""},confirmPassword:{value:"",isValid:!0,error:""}},Yo=function(e){var t=e.intl.formatMessage,n=e.onValueChange,a=e.userAccount,i=a.familyName,s=i.value,o=i.isValid,r=i.error,c=a.givenName,l=c.value,d=c.isValid,u=c.error,p=a.phone,m=p.value,f=p.isValid,h=p.error,b=a.email,j=b.value,v=b.isValid,O=b.error;return Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsx)(Ha.a,{className:"mb-3",children:Object(Ae.jsx)(g.a,{id:"userAccount.personDetails.title",tagName:"span"})}),Object(Ae.jsxs)("div",{className:"details",children:[Object(Ae.jsxs)("div",{className:"grid-1",children:[Object(Ae.jsx)(ai,{placeholder:t({id:"userAccount.personDetails.".concat(Io)}),showPlaceholder:!!s,value:s,onChange:n(Io),type:"text",className:Co()({invalid:!o})}),!o&&Object(Ae.jsx)(li,{message:r})]}),Object(Ae.jsxs)("div",{className:"grid-2",children:[Object(Ae.jsx)(ai,{placeholder:t({id:"userAccount.personDetails.".concat(Lo)}),showPlaceholder:!!l,value:l,onChange:n(Lo),type:"text",className:Co()({invalid:!d})}),!d&&Object(Ae.jsx)(li,{message:u})]}),Object(Ae.jsxs)("div",{className:"grid-3 input-container",children:[Object(Ae.jsx)(et.a,{placeholder:t({id:"userAccount.personDetails.".concat(ko)}),onChange:n(ko),value:m,international:!0,numberInputProps:{className:Co()("form-control",{invalid:!f})},type:"tel"}),!!m&&Object(Ae.jsx)("span",{className:"placeholder",children:t({id:"userAccount.personDetails.".concat(ko)})}),!f&&Object(Ae.jsx)(li,{message:h})]}),Object(Ae.jsxs)("div",{className:"grid-4",children:[Object(Ae.jsx)(ai,{placeholder:t({id:"userAccount.personDetails.".concat(Fo)}),showPlaceholder:!!j,value:j,onChange:n(Fo),type:"text",className:Co()({invalid:!v})}),!v&&Object(Ae.jsx)(li,{message:O})]})]})]})},Qo=function(e){var t,n,a=e.intl,i=e.audit,s=function(e){return Is()(e).format("DD.MMM.YYYY, HH:mm:ss")};return Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsx)(Ha.a,{className:"mb-5",children:Object(Ae.jsx)(g.a,{id:"userAccount.auditInfo.title",tagName:"span"})}),Object(Ae.jsx)("p",{className:"pb-3","data-testid":"userAccountCreatedBy",children:a.formatMessage({id:"userAccount.auditInfo.created"},{creator:null===i||void 0===i||null===(t=i.creator)||void 0===t?void 0:t.display,date:s(null===i||void 0===i?void 0:i.dateCreated)})}),Object(Ae.jsx)("p",{className:"pb-3","data-testid":"userAccountChangedBy",children:a.formatMessage({id:"userAccount.auditInfo.changedBy"},{changedBy:null===i||void 0===i||null===(n=i.changedBy)||void 0===n?void 0:n.display,date:s(null===i||void 0===i?void 0:i.dateChanged)})})]})},zo=function(e){var t=e.intl.formatMessage,n=e.onValueChange,a=e.dirtyFields,i=e.roles,s=e.locations,o=e.forcePassword,r=e.setForcePassword,c=e.isEdit,l=e.userAccount,d=l.username,u=d.value,p=d.isValid,m=d.error,f=l.locations,h=f.value,b=f.isValid,j=f.error,v=l.userRole,O=v.value,x=v.isValid,y=v.error,C=l.password,N=C.value,S=C.isValid,w=C.error,T=l.confirmPassword,P=T.value,A=T.isValid,D=T.error,M=function(e){return e.map((function(e){return{label:e.display,value:e.uuid}}))};return Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsx)(Ha.a,{className:"mb-3",children:Object(Ae.jsx)(g.a,{id:"userAccount.userAccountDetails.title",tagName:"span"})}),Object(Ae.jsxs)("div",{className:"details",children:[Object(Ae.jsxs)("div",{className:"grid-1",children:[Object(Ae.jsx)(ai,{placeholder:t({id:"userAccount.userAccountDetails.".concat(Uo)}),showPlaceholder:!!u,value:u,onChange:n(Uo),type:"text",className:Co()({invalid:!p})}),!p&&Object(Ae.jsx)(li,{message:m})]}),Object(Ae.jsxs)("div",{className:"grid-2",children:[Object(Ae.jsx)(ii,{placeholder:t({id:"userAccount.userAccountDetails.".concat(Bo)}),showPlaceholder:!!h.length,value:h,options:M(s),onChange:n(Bo),isMulti:!0,wrapperClassName:Co()({invalid:!b}),classNamePrefix:"default-select-multi",theme:Ba,type:"text"}),!b&&Object(Ae.jsx)(li,{message:j})]}),Object(Ae.jsxs)("div",{className:"grid-3",children:[Object(Ae.jsx)(ii,{placeholder:t({id:"userAccount.userAccountDetails.".concat(qo)}),showPlaceholder:!!O,value:O,options:M(i),onChange:n(qo),wrapperClassName:Co()({invalid:!x}),classNamePrefix:"default-select",theme:Ba,type:"text"}),!x&&Object(Ae.jsx)(li,{message:y})]}),Object(Ae.jsxs)("div",{className:"grid-4",children:[Object(Ae.jsx)(ai,{className:Co()({invalid:!S}),placeholder:t({id:"userAccount.userAccountDetails.".concat(Wo)}),showPlaceholder:!!N,value:N,onChange:n(Wo),type:"password",autoComplete:"off"}),!S&&Object(Ae.jsx)(li,{message:w})]}),Object(Ae.jsxs)("div",{className:"grid-5",children:[Object(Ae.jsx)(ai,{className:Co()({invalid:!A}),placeholder:t({id:"userAccount.userAccountDetails.".concat(Go)}),showPlaceholder:!!P,value:P,onChange:n(Go),type:"password",autoComplete:"off"}),!A&&Object(Ae.jsx)(li,{message:D})]})]}),Object(Ae.jsxs)(Ha.a,{className:Co()("force-password-change",{hide:c&&!a.find((function(e){return e===Wo}))}),children:[Object(Ae.jsx)(Ve.a,{type:"checkbox",onClick:function(){return r(!o)},checked:o}),Object(Ae.jsx)(g.a,{id:"userAccount.userAccountDetails.forcePasswordChange",tagName:"span"})]})]})},Ko="roles/GET_ROLES",Zo="roles/RESET_ROLES",Jo={loading:!1,roles:[],errorMessage:""},Xo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Jo,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N(Ko):return Object(u.a)(Object(u.a)({},e),{},{loading:!0});case w(Ko):return Object(u.a)(Object(u.a)({},Jo),{},{errorMessage:t.payload.message});case S(Ko):return Object(u.a)(Object(u.a)({},Jo),{},{roles:t.payload.data.results});case Zo:return Object(u.a)({},Jo);default:return e}},_o="user/GET_USER",$o="user/GET_USERS",er="user/POST_USER",tr="user/DELETE_USER",nr={loading:!1,users:[],currentUser:{},errorMessage:"",success:!1},ar=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N(_o):case N($o):return Object(u.a)(Object(u.a)({},e),{},{loading:!0});case w(_o):case w($o):return Object(u.a)(Object(u.a)({},e),{},{errorMessage:t.payload.message,loading:!1});case S(_o):var n=Object(Xi.a)(t.payload.data.results,1),a=n[0];return Object(u.a)(Object(u.a)({},e),{},{currentUser:a,loading:!1});case S($o):return Object(u.a)(Object(u.a)({},e),{},{users:t.payload.data.results,loading:!1});case S(tr):case S(er):return Object(u.a)(Object(u.a)({},e),{},{success:!0});default:return e}},ir=(n(1939),window.location.hash),sr=ir.indexOf(To),or=-1!==sr?ir.slice(sr+To.length):null,rr={searchLocations:Zn,getRoles:function(){return{type:Ko,payload:C.a.get("/openmrs/ws/rest/v1/role")}},getUsers:function(){return{type:$o,payload:C.a.get("/openmrs/ws/rest/v1/user")}},getUserByPersonId:function(e){return{type:_o,payload:C.a.get("/openmrs/ws/rest/v1/user?s=byPerson&personId=".concat(e,"&v=full"))}},getSettings:W,getPerson:an,saveUser:function(e,t,n){return{type:er,payload:Promise.all([C.a.post("/openmrs/ws/rest/v1/user/".concat(t||""),e),n&&C.a.post("/openmrs/ws/rest/v1/password/".concat(t),{newPassword:n})])}},deleteUser:function(e){return{type:tr,payload:C.a.delete("/openmrs/ws/rest/v1/user/".concat(e,"?purge=true"))}}},cr=Object(x.connect)((function(e){var t=e.role,n=e.location,a=e.user,i=e.settings,s=e.cflPerson;return{userLoading:or?Object(R.isNil)(s.person):a.loading,locations:n.locations,roles:t.roles,users:a.users,currentUser:a.currentUser,settings:i.settings,loadingSettings:i.loading,person:s.person,success:a.success}}),rr)(Object(L.c)(Object(m.withRouter)((function(e){var t,n,i,s=e.intl,o=e.userLoading,r=e.locations,c=e.roles,l=e.users,d=e.currentUser,p=e.settings,m=e.loadingSettings,f=e.person,h=e.success,b=e.searchLocations,v=e.getRoles,O=e.getUsers,x=e.getUserByPersonId,y=e.getSettings,C=e.getPerson,N=e.saveUser,S=e.deleteUser,w=null===d||void 0===d||null===(t=d.person)||void 0===t?void 0:t.uuid,T=null===p||void 0===p||null===(n=p.find((function(e){return e.property===Eo})))||void 0===n?void 0:n.value,P=null===p||void 0===p||null===(i=p.find((function(e){return e.property===Ro})))||void 0===i?void 0:i.value,A=Object(a.useState)(Ho),D=Object(Xi.a)(A,2),M=D[0],V=D[1],L=Object(a.useState)([]),k=Object(Xi.a)(L,2),F=k[0],U=k[1],B=Object(a.useState)(!0),q=Object(Xi.a)(B,2),W=q[0],G=q[1],H=Object(a.useState)(!1),Y=Object(Xi.a)(H,2),Q=Y[0],z=Y[1];Object(a.useEffect)((function(){h&&Z()}),[h]),Object(a.useEffect)((function(){b(),v(),O(),y(Mo),or&&x(or)}),[]),Object(a.useEffect)((function(){w&&C(w)}),[w,C]),Object(a.useEffect)((function(){if(f){var e,t,n=f.preferredName,a=n.familyName,i=n.givenName,s=f.attributes,o=d.username,c=d.roles,l=d.userProperties.locationUuid,p=Object(Xi.a)(c,1)[0],m=p.display,g=p.uuid,h=null===l||void 0===l?void 0:l.replace(/null/g,""),b=h?h.split(",").map((function(e){return r.find((function(t){var n=t.uuid;return e===n}))})):[];V({familyName:Object(u.a)(Object(u.a)({},M.familyName),{},{value:a}),givenName:Object(u.a)(Object(u.a)({},M.givenName),{},{value:i}),phone:Object(u.a)(Object(u.a)({},M.phone),{},{value:null===(e=s.find((function(e){return e.attributeType.uuid===P})))||void 0===e?void 0:e.value}),email:Object(u.a)(Object(u.a)({},M.email),{},{value:null===(t=s.find((function(e){return e.attributeType.uuid===T})))||void 0===t?void 0:t.value}),username:Object(u.a)(Object(u.a)({},M.username),{},{value:o}),locations:Object(u.a)(Object(u.a)({},M.locations),{},{value:b.map((function(e){return{label:e.display,value:e.uuid}}))}),userRole:Object(u.a)(Object(u.a)({},M.userRole),{},{value:{label:m,value:g}}),password:Object(u.a)(Object(u.a)({},M.password),{},{value:Vo}),confirmPassword:Object(u.a)(Object(u.a)({},M.confirmPassword),{},{value:Vo})}),G(!1)}}),[f,d]);var K=function(e){return function(t){var n=ka(t)||st,a=!0,i="";switch(e){case ko:Object(et.c)(n)||(a=!1,i="registerPatient.invalidPhoneNumber");break;case Fo:Po.test(n)||(a=!1,i="common.error.invalidEmail");break;case Uo:var s=n&&Do.test(n),o=l.filter((function(e){return e.uuid!==d.uuid})).every((function(e){return e.display.toLowerCase()!==n.toLowerCase()}));s?o||(a=!1,i="common.error.nameUnique"):(a=!1,i="common.error.nameInvalid");break;case Wo:n&&Ao.test(n)||(a=!1,i="common.error.invalidPassword"),f&&!W&&G(!0);break;case Go:M.password.value!==n&&(a=!1,i="common.error.confirmPassword")}V(Object(u.a)(Object(u.a)({},M),{},Object(is.a)({},e,Object(u.a)(Object(u.a)({},M[e]),{},{value:n,isValid:a,error:i})))),U(Object(R.uniq)([].concat(Object(ge.a)(F),[e])))}},Z=function(){return window.location.href="".concat(j,"adminui/systemadmin/accounts/manageAccounts.page")};return Object(Ae.jsxs)("div",{id:"user-account",className:Co()({edit:or}),children:[Object(Ae.jsx)(Ga,{header:{id:"userAccount.deleteAccount.confirmationModal.header"},body:{id:"userAccount.deleteAccount.confirmationModal.body"},onYes:function(){S(null===d||void 0===d?void 0:d.uuid),z(!1)},onNo:function(){return z(!1)},isOpen:Q}),Object(Ae.jsx)(g.a,{id:"userAccount.".concat(or?"edit":"add"),tagName:"h2"}),o||m?Object(Ae.jsx)("div",{className:"spinner",children:Object(Ae.jsx)(Ie.a,{})}):Object(Ae.jsxs)(Ae.Fragment,{children:[or&&Object(Ae.jsx)("div",{className:"d-inline pull-right",children:Object(Ae.jsx)(I.a,{className:"delete",onClick:function(){return z(!0)},"data-testid":"deleteAccount",children:Object(Ae.jsx)(g.a,{id:"userAccount.deleteAccount.label"})})}),Object(Ae.jsxs)(Ee.a,{className:Co()({hide:o}),children:[Object(Ae.jsx)("div",{className:"section person",children:Object(Ae.jsx)(Yo,{intl:s,onValueChange:K,userAccount:M})}),or&&Object(Ae.jsx)("div",{className:"section audit",children:Object(Ae.jsx)(Qo,{intl:s,audit:null===d||void 0===d?void 0:d.auditInfo})}),Object(Ae.jsx)("div",{className:"section user",children:Object(Ae.jsx)(zo,{intl:s,onValueChange:K,userAccount:M,dirtyFields:F,locations:r,roles:c,setForcePassword:G,forcePassword:W,isEdit:!!f})}),Object(Ae.jsxs)("div",{className:"buttons mt-5 pb-5",children:[Object(Ae.jsx)("div",{className:"d-inline",children:Object(Ae.jsx)(I.a,{className:"cancel",onClick:Z,"data-testid":"returnButton",children:Object(Ae.jsx)(g.a,{id:"common.return"})})}),Object(Ae.jsx)("div",{className:"d-inline pull-right confirm-button-container",children:Object(Ae.jsx)(I.a,{className:"save",onClick:function(){if(function(){var e=E.a.cloneDeep(M);Object.keys(e).forEach((function(t){var n,a=e[t];a.isValid&&(!a.value||t===Bo&&!a.value.length||t===qo&&!(null===(n=a.value)||void 0===n?void 0:n.value))&&(a.isValid=!1,a.error="common.error.required")})),V(e)}(),Object.values(M).every((function(e){var t=e.value,n=e.isValid;return((null===t||void 0===t?void 0:t.length)||(null===t||void 0===t?void 0:t.value))&&n}))){var e,t,n=F.find((function(e){return e===Wo})),a=[];P&&a.push({attributeType:P,value:M.phone.value}),T&&a.push({attributeType:T,value:M.email.value}),N(Object(u.a)(Object(u.a)({username:M.username.value},!f&&n&&{password:M.password.value}),{},{userProperties:{forcePassword:String(W),locationUuid:null===M||void 0===M?void 0:M.locations.value.map((function(e){return e.value})).join(",")},roles:[{uuid:null===M||void 0===M||null===(e=M.userRole.value)||void 0===e?void 0:e.value,name:null===M||void 0===M||null===(t=M.userRole.value)||void 0===t?void 0:t.label}],person:{gender:"O",attributes:a,names:[{givenName:M.givenName.value,familyName:M.familyName.value}]}}),null===d||void 0===d?void 0:d.uuid,f&&n&&M.password.value)}else Object(Pe.a)(s.formatMessage({id:"userAccount.accountNotSaved"}))},"data-testid":"saveButton",children:Object(Ae.jsx)(g.a,{id:"common.save"})})})]})]})]})]})})))),lr="order.drugDosingUnitsConceptUuid",dr="deleteRegimenModal",ur="deleteDrugModal",pr="common.error.required",mr="manageRegimens.error.regimenNameUnique",fr={open:!1,type:dr},gr={label:"",value:"",isValid:!0},hr={drugDetails:Object(u.a)(Object(u.a)({},gr),{},{abbreviation:""}),doseUnits:gr,dose:"1",frequency:gr},br={regimenName:"",uuid:"",isValid:!0,drugs:[hr]},jr={regimenUuid:"",regimenIdx:null},vr=Object(u.a)(Object(u.a)({},jr),{},{drugUuid:"",drugIdx:null}),Or="manage-regimens/SET_REGIMENS",xr="manage-regimens/SET_EDITED_REGIMENS",yr="manage-regimens/SET_REGIMEN_TO_DELETE",Cr="manage-regimens/SET_DRUG_TO_DELETE",Nr="manage-regimens/SET_CONFIRMATION_MODAL",Sr={regimens:[br],editedRegimens:[],regimenToDelete:jr,drugToDelete:vr,confirmationModal:fr},wr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Sr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Or:return Object(u.a)(Object(u.a)({},e),{},{regimens:t.data});case xr:return Object(u.a)(Object(u.a)({},e),{},{editedRegimens:t.data});case yr:return Object(u.a)(Object(u.a)({},e),{},{regimenToDelete:t.data});case Cr:return Object(u.a)(Object(u.a)({},e),{},{drugToDelete:t.data});case Nr:return Object(u.a)(Object(u.a)({},e),{},{confirmationModal:t.data});default:return e}},Tr=function(e){return{type:Or,data:e}},Pr=function(e){return{type:xr,data:e}},Ar=function(e){return{type:yr,data:e}},Dr=function(e){return{type:Cr,data:e}},Mr=function(e){return{type:Nr,data:e}},Rr={setRegimens:Tr,setEditedRegimens:Pr,setDrugToDelete:Dr,setConfirmationModal:Mr},Er=Object(x.connect)((function(e){var t=e.manageRegimens,n=t.regimens,a=t.editedRegimens,i=e.concept.concept;return{drugsList:e.drugs.drugsList,frequencies:e.orderFrequency.frequencies,conceptDoseTypes:i,regimens:n,editedRegimens:a}}),Rr)(Object(L.c)((function(e){var t=e.intl,n=e.drugsList,i=e.frequencies,s=e.conceptDoseTypes,o=e.regimens,r=e.editedRegimens,c=e.regimenUuid,l=e.regimenIdx,d=e.drug,u=d.drugDetails,p=d.doseUnits,m=d.dose,f=d.frequency,g=d.uuid,h=e.drugIdx,b=e.setRegimens,j=e.setEditedRegimens,v=e.setConfirmationModal,O=e.setDrugToDelete,x=t.formatMessage,y=Object(a.useMemo)((function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map((function(e){return{label:null===e||void 0===e?void 0:e.display,value:null===e||void 0===e?void 0:e.uuid}}))}}),[]),C=function(e){return e.label?e:null},N=Object(a.useCallback)((function(e,t,a,i){return function(s){var c=Object(R.cloneDeep)(o),l=ka(s);if(c[e].drugs[i][a]=l,"drugDetails"===a){var d=n.find((function(e){return e.uuid===l.value})).abbreviation;c[e].drugs[i][a].abbreviation=null!==d&&void 0!==d?d:st}"dose"!==a&&(c[e].drugs[i][a].isValid=!!l),b(c),t&&j(Object(R.uniq)([].concat(Object(ge.a)(r),[t])))}}),[o,b,j,r,n]),S=Object(a.useCallback)((function(){var e=Object(R.cloneDeep)(o);e[l].drugs.push(hr),b(e)}),[l,o,b]),w=Object(a.useCallback)((function(){O({regimenUuid:c,regimenIdx:l,drugUuid:g,drugIdx:h}),v({open:!0,type:ur})}),[O,c,l,g,h,v]);return Object(Ae.jsxs)("div",{className:"manage-regimen-row",children:[Object(Ae.jsxs)("div",{className:"input-container flex-2","data-testid":"drugNameSelect",children:[Object(Ae.jsx)(ii,{placeholder:x({id:"manageRegimens.drugName"}),showPlaceholder:!!C(u),value:C(u),onChange:N(l,c,"drugDetails",h),options:y(n),wrapperClassName:Co()({invalid:!u.isValid}),classNamePrefix:"default-select",theme:Ba}),!u.isValid&&Object(Ae.jsx)(li,{message:pr})]}),Object(Ae.jsx)("div",{className:"input-container",children:Object(Ae.jsx)(ai,{placeholder:x({id:"manageRegimens.drugAbbreviation"}),showPlaceholder:!!u.abbreviation,value:u.abbreviation,disabled:!0,"data-testid":"abbreviationInput"})}),Object(Ae.jsxs)("div",{className:"input-container","data-testid":"doseUnitsSelect",children:[Object(Ae.jsx)(ii,{placeholder:x({id:"manageRegimens.doseUnitType"}),showPlaceholder:!!C(p),value:C(p),onChange:N(l,c,"doseUnits",h),options:y(null===s||void 0===s?void 0:s.setMembers),wrapperClassName:Co()({invalid:!p.isValid}),classNamePrefix:"default-select",theme:Ba}),!p.isValid&&Object(Ae.jsx)(li,{message:pr})]}),Object(Ae.jsxs)("div",{className:"input-container",children:[Object(Ae.jsx)(ai,{placeholder:x({id:"manageRegimens.numberOfUnits"}),showPlaceholder:!!m,value:m,onChange:N(l,c,"dose",h),type:"number",pattern:"[1-9]",min:1,className:Co()({invalid:!Number(m)}),"data-testid":"doseInput"}),!Number(m)&&Object(Ae.jsx)(li,{message:pr})]}),Object(Ae.jsxs)("div",{className:"input-container","data-testid":"frequencySelect",children:[Object(Ae.jsx)(ii,{placeholder:x({id:"manageRegimens.frequency"}),showPlaceholder:!!C(f),value:C(f),onChange:N(l,c,"frequency",h),options:y(i),wrapperClassName:Co()({invalid:!f.isValid}),classNamePrefix:"default-select",theme:Ba}),!f.isValid&&Object(Ae.jsx)(li,{message:pr})]}),Object(Ae.jsx)(di,{intl:t,onPlusClick:S,onMinusClick:w,isPlusButtonVisible:h===o[l].drugs.length-1})]},"".concat(c,"-").concat(h))}))),Vr={setRegimens:Tr,setEditedRegimens:Pr,setRegimenToDelete:Ar,setConfirmationModal:Mr},Ir=Object(x.connect)((function(e){var t=e.manageRegimens;return{regimens:t.regimens,editedRegimens:t.editedRegimens}}),Vr)(Object(L.c)((function(e){var t=e.intl.formatMessage,n=e.regimen,i=n.regimenName,s=n.drugs,o=n.uuid,r=n.isValid,c=n.errorMessage,l=e.regimens,d=e.editedRegimens,u=e.regimenIdx,p=e.isAllSectionsExpanded,m=e.setConfirmationModal,f=e.setRegimens,g=e.setEditedRegimens,h=e.setRegimenToDelete;if(!s.length){var b=Object(R.cloneDeep)(l);b[u].drugs.push(hr),f(b)}var j=Object(a.useCallback)((function(e,t){return function(n){var a=Object(R.cloneDeep)(l),i=ka(n),s=a.every((function(e){return e.regimenName.toLowerCase()!==i.toLowerCase()}));a[e].regimenName=i,a[e].isValid=!!i,a[e].errorMessage=st,i?s||(a[e].isValid=!1,a[e].errorMessage=mr):a[e].errorMessage=pr,f(a),t&&g(Object(R.uniq)([].concat(Object(ge.a)(d),[t])))}}),[l,f,g,d]),v=Object(a.useCallback)((function(){h({regimenUuid:o,regimenIdx:u}),m({open:!0,type:dr})}),[o,u,h,m]),O=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Object(Ae.jsxs)("div",{className:"input-container",children:[Object(Ae.jsx)(ai,{placeholder:t({id:"manageRegimens.regimenName"}),showPlaceholder:!!i,value:i,onChange:j(u,o),className:Co()({invalid:!r}),disabled:e,"data-testid":"regimenHeaderInput"}),!r&&Object(Ae.jsx)(li,{message:c})]})},x=s.map((function(e,t){return Object(Ae.jsx)(Er,{drug:e,drugIdx:t,regimenUuid:o,regimenIdx:u},"".concat(e.uuid,"-").concat(t))}));return Object(Ae.jsx)(ws,{headerComponent:O(),disabledHeaderComponent:O(!0),bodyComponent:x,isRemovable:!0,onRemove:v,isExpandTriggered:p},"".concat(o,"-").concat(u))}))),Lr="order-set/GET_ORDER_SET",kr="order-set/SAVE_ORDER_SET",Fr="order-set/DELETE_ORDER_SET",Ur="order-set/DELETE_ORDER_SET_MEMBER",Br={loading:!1,orderSet:[],success:{deletedOrderSet:!1,deletedOrderSetMember:!1,savedOrderSet:!1}},qr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Br,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N(Lr):return Object(u.a)(Object(u.a)({},e),{},{loading:!0});case N(kr):return Object(u.a)(Object(u.a)({},e),{},{success:Object(u.a)(Object(u.a)({},e.success),{},{savedOrderSet:!1})});case N(Fr):return Object(u.a)(Object(u.a)({},e),{},{success:Object(u.a)(Object(u.a)({},e.success),{},{deletedOrderSet:!1})});case N(Ur):return Object(u.a)(Object(u.a)({},e),{},{success:Object(u.a)(Object(u.a)({},e.success),{},{deletedOrderSetMember:!1})});case S(Lr):return Object(u.a)(Object(u.a)({},e),{},{loading:!1,orderSet:t.payload.data.results});case S(kr):return Object(u.a)(Object(u.a)({},e),{},{success:Object(u.a)(Object(u.a)({},e.success),{},{savedOrderSet:!0})});case S(Fr):return Object(u.a)(Object(u.a)({},e),{},{success:Object(u.a)(Object(u.a)({},e.success),{},{deletedOrderSet:!0})});case S(Ur):return Object(u.a)(Object(u.a)({},e),{},{success:Object(u.a)(Object(u.a)({},e.success),{},{deletedOrderSetMember:!0})});default:return e}},Wr="drugs/GET_DRUGS_LIST",Gr={loading:!1,drugsList:[]},Hr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Gr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N(Wr):return Object(u.a)(Object(u.a)({},e),{},{loading:!0});case S(Wr):return Object(u.a)(Object(u.a)({},e),{},{loading:!1,drugsList:t.payload.data.results});default:return e}},Yr="order-frequency/GET_ORDER_FREQUENCIES",Qr={loading:!1,frequencies:[]},zr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N(Yr):return Object(u.a)(Object(u.a)({},e),{},{loading:!0});case S(Yr):return Object(u.a)(Object(u.a)({},e),{},{loading:!1,frequencies:t.payload.data.results});default:return e}},Kr="order-type/GET_ORDER_TYPE",Zr={loading:!1,orderTypes:[]},Jr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N(Kr):return Object(u.a)(Object(u.a)({},e),{},{loading:!0});case S(Kr):return Object(u.a)(Object(u.a)({},e),{},{loading:!1,orderTypes:t.payload.data.results});default:return e}},Xr=(n(1940),{getOrderSet:function(e){return{type:Lr,payload:C.a.get("/openmrs/ws/rest/v1/orderset?v=".concat(e?"custom:(".concat(e,")"):"full"))}},deleteOrderSet:function(e){return{type:Fr,payload:C.a.delete("/openmrs/ws/rest/v1/orderset/".concat(e))}},saveOrderSet:function(e,t){return{type:kr,payload:C.a.post("/openmrs/ws/rest/v1/orderset/".concat(t&&t),e)}},deleteOrderSetMember:function(e,t){return{type:Ur,payload:C.a.delete("/openmrs/ws/rest/v1/orderset/".concat(e,"/ordersetmember/").concat(t))}},getDrugsList:function(e){return{type:Wr,payload:C.a.get("/openmrs/ws/rest/v1/drug?v=".concat(e?"custom:(".concat(e,")"):"full"))}},getFrequencies:function(e){return{type:Yr,payload:C.a.get("/openmrs/ws/rest/v1/orderfrequency?v=".concat(e?"custom:(".concat(e,")"):"full"))}},getConcept:function(e,t){return{type:A,payload:C.a.get("/openmrs/ws/rest/v1/concept/".concat(e,"?v=").concat(t?"custom:(".concat(t,")"):"full"))}},getSettings:W,getOrderType:function(e){return{type:Kr,payload:C.a.get("/openmrs/ws/rest/v1/ordertype?v=".concat(e?"custom:(".concat(e,")"):"full"))}},setRegimens:Tr,setEditedRegimens:Pr,setRegimenToDelete:Ar,setDrugToDelete:Dr,setConfirmationModal:Mr}),_r=Object(x.connect)((function(e){var t=e.manageRegimens,n=t.regimens,a=t.editedRegimens,i=t.regimenToDelete,s=t.drugToDelete,o=t.confirmationModal,r=e.orderSet,c=r.loading,l=r.orderSet,d=r.success,u=e.concept.loading.concept,p=e.drugs,m=p.loading,f=p.drugsList,g=e.orderFrequency.loading,h=e.orderType,b=h.loading,j=h.orderTypes,v=e.settings,O=v.settings,x=void 0===O?[]:O,y=v.loading;return{isRegimensLoading:[c,u,m,g,b,y].some((function(e){return e})),drugDosingUnitsConcept:x.find((function(e){return e.property===lr})),settingsLoading:y,orderSet:l,drugsList:f,success:d,drugOrderType:j.find((function(e){var t=e.javaClassName;return"org.openmrs.DrugOrder"===(void 0===t?st:t)})),regimens:n,editedRegimens:a,regimenToDelete:i,drugToDelete:s,confirmationModal:o}}),Xr)(Object(L.c)((function(e){var t=e.intl.formatMessage,n=e.isRegimensLoading,i=e.settingsLoading,s=e.orderSet,o=e.drugsList,r=e.drugDosingUnitsConcept,c=e.drugOrderType,l=e.success,d=l.deletedOrderSet,u=l.deletedOrderSetMember,p=l.savedOrderSet,m=e.regimens,f=e.editedRegimens,h=e.regimenToDelete,b=e.drugToDelete,j=e.confirmationModal,v=e.getOrderSet,O=e.deleteOrderSet,x=e.saveOrderSet,y=e.deleteOrderSetMember,C=e.getSettings,N=e.getDrugsList,S=e.getFrequencies,w=e.getConcept,T=e.getOrderType,P=e.setRegimens,A=e.setEditedRegimens,D=e.setRegimenToDelete,M=e.setDrugToDelete,E=e.setConfirmationModal,V=Object(a.useState)(!1),L=Object(Xi.a)(V,2),k=L[0],F=L[1],U=Object(a.useCallback)((function(){return window.location.href="/openmrs/adminui/metadata/configureMetadata.page"}),[]),B=Object(a.useMemo)((function(){return s.map((function(e){var t=e.display,n=e.orderSetMembers;return{regimenName:t,isValid:!0,uuid:e.uuid,drugs:n.filter((function(e){return!e.retired})).map((function(e){var t=e.orderTemplate,n=e.uuid,a=JSON.parse(t),i=a.drug,s=a.doseUnits,o=a.dose,r=a.frequency;return{uuid:n,drugDetails:{label:i.display,value:i.uuid,abbreviation:i.abbreviation,isValid:!0},doseUnits:{label:s.display,value:s.uuid,isValid:!0},dose:o,frequency:{label:r.display,value:r.uuid,isValid:!0}}}))}}))}),[s]);Object(a.useEffect)((function(){C(lr),v("display,uuid,orderSetMembers"),T("name,uuid,javaClassName"),N("display,uuid,abbreviation,concept"),S("display,uuid")}),[N,S,v,T,C]),Object(a.useEffect)((function(){!i&&(null===r||void 0===r?void 0:r.value)&&w(r.value,"uuid,setMembers")}),[i,null===r||void 0===r?void 0:r.value,w]),Object(a.useEffect)((function(){s.length&&P(B)}),[s,B,P]),Object(a.useEffect)((function(){d&&Object(Pe.b)(t({id:"manageRegimens.regimenDeleted"}))}),[d,t]),Object(a.useEffect)((function(){u&&Object(Pe.b)(t({id:"manageRegimens.drugDeleted"}))}),[u,t]),Object(a.useEffect)((function(){p&&U()}),[p,U]);var q=Object(a.useCallback)((function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:m;return n.every((function(n,a){var i=n.regimenName;return a===t||i!==e}))}),[m]),W=Object(a.useCallback)((function(e){var t=e.regimenUuid,n=e.regimenIdx,a=Object(R.cloneDeep)(m);a.splice(n,1),a.length||a.push(br),a.forEach((function(e,i){var s=e.regimenName,o=m.filter((function(e,a){var i=e.uuid;return t?i!==t:a!==n}));q(s,i,o)&&(a[i].isValid=!0,a[i].errorMessage=st)})),P(a),t&&(A(Object(R.without)(f,t)),O(t))}),[m,P,q,A,f,O]),G=Object(a.useCallback)((function(e){var t=e.regimenUuid,n=e.regimenIdx,a=e.drugUuid,i=e.drugIdx,s=Object(R.cloneDeep)(m);s[n].drugs.splice(i,1),t&&A(Object(R.uniq)([].concat(Object(ge.a)(f),[t]))),s[n].drugs.length||s[n].drugs.push(hr),P(s),a&&y(t,a)}),[m,A,f,P,y]),H=Object(a.useCallback)((function(){var e=Object(R.cloneDeep)(m);e.push(br),P(e)}),[m,P]),Y=Object(a.useCallback)((function(){var e=Object(R.cloneDeep)(m),t=!0;return e.forEach((function(n,a){var i=n.regimenName,s=n.drugs,o=n.isValid;e[a].errorMessage=st,e[a].isValid=!0,i&&(o||q(i,a))||(e[a].isValid=!1,t=!1,e[a].errorMessage=i?mr:pr),s.forEach((function(n,i){var s=n.doseUnits,o=n.drugDetails,r=n.frequency,c=n.dose;Number(c)||(t=!1),s.value||(e[a].drugs[i].doseUnits.isValid=!1,t=!1),o.value||(e[a].drugs[i].drugDetails.isValid=!1,t=!1),r.value||(e[a].drugs[i].frequency.isValid=!1,t=!1)}))})),P(e),t}),[q,m,P]),Q=Object(a.useCallback)((function(){if(!Y())return Object(Pe.a)(t({id:"manageRegimens.regimensNotSaved"}));var e=m.filter((function(e){return!e.uuid})),n=f.map((function(e){return m.find((function(t){var n=t.uuid;return e===n}))})).concat(e),a=function(e){return e.drugs.map((function(e){var t=e.drugDetails,n=e.doseUnits,a=e.dose,i=e.frequency,s=o.find((function(t){return t.uuid===e.drugDetails.value})),r={drug:{display:t.label,uuid:t.value,abbreviation:t.abbreviation},doseUnits:{display:n.label,uuid:n.value},dose:a,frequency:{display:i.label,uuid:i.value}};return{orderType:c,orderTemplate:JSON.stringify(r),orderTemplateType:"cfl.drug.order.json",concept:s.concept.uuid}}))};n.length&&n.forEach((function(e){return x(function(e){return{operator:"ALL",name:e.regimenName,description:"Manage regimens with drugs",orderSetMembers:a(e)}}(e),null===e||void 0===e?void 0:e.uuid)}))}),[o,f,t,c,m,x,Y]),z=Object(a.useCallback)((function(){return E(fr)}),[E]),K=Object(a.useCallback)((function(){switch(j.type){case dr:W(h),D(jr);break;case ur:G(b),M(vr)}E(fr)}),[j.type,b,h,G,W,E,M,D]);return Object(Ae.jsxs)("div",{id:"manage-regimens",children:[Object(Ae.jsx)(Ga,{header:{id:"manageRegimens.".concat(j.type,".header")},body:{id:"manageRegimens.".concat(j.type,".body")},onYes:K,onNo:z,isOpen:j.open}),Object(Ae.jsxs)("div",{className:"title",children:[Object(Ae.jsx)(g.a,{id:"manageRegimens.title",tagName:"h2"}),!n&&Object(Ae.jsx)(I.a,{onClick:function(){return F(!k)},className:"cancel","data-testid":"allSectionExpandedButton",children:Object(Ae.jsx)(g.a,{id:"notificationTemplates.button.".concat(k?"collapse":"expand")})})]}),n?Object(Ae.jsx)("div",{className:"spinner","data-testid":"spinner",children:Object(Ae.jsx)(Ie.a,{})}):Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsxs)("div",{className:"section",children:[m.map((function(e,t){return Object(Ae.jsx)(Ir,{regimen:e,regimenIdx:t,isAllSectionsExpanded:k},"".concat(e.uuid,"-").concat(t))})),Object(Ae.jsx)("div",{className:"d-flex justify-content-end mt-4 mb-2",children:Object(Ae.jsx)(I.a,{className:"btn btn-primary",onClick:H,"data-testid":"addNewRegimenButton",children:Object(Ae.jsx)(g.a,{id:"manageRegimens.addNewRegimen"})})})]}),Object(Ae.jsxs)("div",{className:"mt-5 pb-5",children:[Object(Ae.jsx)("div",{className:"d-inline",children:Object(Ae.jsx)(I.a,{className:"cancel",onClick:U,"data-testid":"returnButton",children:Object(Ae.jsx)(g.a,{id:"common.return"})})}),Object(Ae.jsx)("div",{className:"d-inline pull-right confirm-button-container",children:Object(Ae.jsx)(I.a,{className:"save",onClick:Q,"data-testid":"saveButton",children:Object(Ae.jsx)(g.a,{id:"common.save"})})})]})]})]})}))),$r="columns-configuration/SET_POSSIBLE_COLUMN_LIST",ec="columns-configuration/SET_COLUMNS_CONFIGURATION",tc={allPossibleColumns:[],columnsConfiguration:vt},nc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tc,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case $r:return Object(u.a)(Object(u.a)({},e),{},{allPossibleColumns:t.data});case ec:return Object(u.a)(Object(u.a)({},e),{},{columnsConfiguration:t.data});default:return e}},ac=function(e){return{type:ec,data:e}},ic={setColumnsConfiguration:ac},sc=Object(x.connect)((function(e){var t=e.findPatientColumnsConfiguration;return{allPossibleColumns:t.allPossibleColumns,columnsConfiguration:t.columnsConfiguration}}),ic)(Object(L.c)((function(e){var t=e.intl,n=e.allPossibleColumns,i=e.columnsConfiguration,s=e.column,o=e.columnIdx,r=e.setColumnsConfiguration,c=t.formatMessage,l=s.value?s:null,d=Object(a.useCallback)((function(){return Object(R.differenceWith)(n,i,R.isEqual)}),[n,i]),u=function(e){var t=Object(R.cloneDeep)(i),n=Ka(t,o,e);r(n)},p=Object(a.useCallback)((function(e){var t=Object(R.cloneDeep)(i),n=ka(e);t[o]=n,t[o].isValid=!0,r(t)}),[o,i,r]),m=Object(a.useCallback)((function(){var e=Object(R.cloneDeep)(i);e.push(gt),r(e)}),[i,r]),f=Object(a.useCallback)((function(){var e=Object(R.cloneDeep)(i);e.splice(o,1),e.length||e.push(gt),r(e)}),[o,i,r]);return Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsxs)("div",{className:"column-row inline-fields","data-testid":"columnRow",children:[Object(Ae.jsxs)("div",{className:"d-flex flex-column order-icons",children:[Object(Ae.jsx)("span",{className:Co()("glyphicon glyphicon-chevron-up",{disabled:!o}),title:c({id:"common.moveUp"}),"aria-hidden":"true",onClick:function(){return u(-1)},"data-testid":"moveUpButton"}),Object(Ae.jsx)("span",{className:Co()("glyphicon glyphicon-chevron-down",{disabled:o===i.length-1}),title:c({id:"common.moveDown"}),"aria-hidden":"true",onClick:function(){return u(1)},"data-testid":"moveDownButton"})]}),Object(Ae.jsx)(ii,{placeholder:c({id:"findPatientColumnsConfiguration.columnName"}),showPlaceholder:!!l,value:l,onChange:p,options:d(),wrapperClassName:Co()({invalid:!l&&!s.isValid}),classNamePrefix:"default-select",theme:Ba,"data-testid":"columnSelect"}),Object(Ae.jsx)(di,{intl:t,onPlusClick:m,onMinusClick:f,isPlusButtonVisible:o===i.length-1})]}),!l&&!s.isValid&&Object(Ae.jsx)(li,{message:"findPatientColumnsConfiguration.emptyColumnsConfiguration"})]})}))),oc=(n(1941),{setAllPossibleColumns:function(e){return{type:$r,data:e}},setColumnsConfiguration:ac,getSettingByQuery:G,createSetting:H,updateSetting:Y}),rc=[{path:"/patient-record-columns-configuration",component:Object(x.connect)((function(e){var t,n,a=e.apps,i=a.loading,s=a.patientRegistrationSteps,o=e.findPatientColumnsConfiguration.columnsConfiguration,r=e.settings,c=r.success,l=r.isSettingExist.value,d=r.setting;return{isAppLoading:i,settingsSaved:c,patientRegistrationSteps:s,columnsConfiguration:o,isSettingExist:l,settingUuid:null!==(t=null===d||void 0===d?void 0:d.uuid)&&void 0!==t?t:st,settingValue:null!==(n=null===d||void 0===d?void 0:d.value)&&void 0!==n?n:st}}),oc)(Object(L.c)((function(e){var t=e.intl.formatMessage,n=e.isAppLoading,i=e.patientRegistrationSteps,s=e.columnsConfiguration,o=e.isSettingExist,r=e.settingUuid,c=e.settingValue,l=e.settingsSaved,d=e.setAllPossibleColumns,u=e.setColumnsConfiguration,p=e.getSettingByQuery,m=e.createSetting,f=e.updateSetting;Object(a.useEffect)((function(){p(ft)}),[p]),Object(a.useEffect)((function(){c&&u(JSON.parse(c))}),[u,c]),Object(a.useEffect)((function(){l&&Object(Pe.b)(t({id:"findPatientColumnsConfiguration.configurationSaved"}))}),[t,l]),Object(a.useEffect)((function(){if(i){var e=Object(ge.a)(jt);i.map((function(t){return t.fields.forEach((function(t){var n=t.name;if(n){var a=n.replace(ht,(function(e){return e.charAt(0).toUpperCase()+e.substring(1)})).replace(bt,"$1 $2");e.push({label:a,value:n})}}))})),d(Object(R.uniqWith)(e,R.isEqual))}}),[i,d]);var h=Object(a.useState)(!1),b=Object(Xi.a)(h,2),j=b[0],v=b[1],O=Object(a.useCallback)((function(){return window.location.href="/openmrs/adminui/metadata/configureMetadata.page"}),[]),x=Object(a.useCallback)((function(){return v(!0)}),[]),y=Object(a.useCallback)((function(){var e=Object(R.cloneDeep)(s);e[0].isValid=!1,Object(Pe.a)(t({id:"findPatientColumnsConfiguration.configurationNotSaved"})),u(e),v(!1)}),[s,t,u]),C=Object(a.useCallback)((function(){return v(!1)}),[]),N=Object(a.useCallback)((function(){var e=s.filter((function(e){return e.value}));if(!e.length)return y();var t=e.map((function(e){return{label:e.label,value:e.value}})),n=JSON.stringify(t);o?f({uuid:r,value:n}):m(ft,n),v(!1)}),[s,m,o,r,f,y]);return Object(Ae.jsxs)("div",{id:"find-patient-columns-configuration","data-testid":"findPatientColumnsConfiguration",children:[Object(Ae.jsx)(Ga,{header:{id:"findPatientColumnsConfiguration.modal.header"},body:{id:"findPatientColumnsConfiguration.modal.body"},onYes:N,onNo:C,isOpen:j}),Object(Ae.jsx)("div",{className:"title",children:Object(Ae.jsx)(g.a,{id:"findPatientColumnsConfiguration.title",tagName:"h2"})}),n?Object(Ae.jsx)("div",{className:"spinner","data-testid":"spinner",children:Object(Ae.jsx)(Ie.a,{})}):Object(Ae.jsxs)(Ae.Fragment,{children:[Object(Ae.jsxs)("div",{className:"section",children:[Object(Ae.jsx)("div",{className:"title",children:Object(Ae.jsx)(g.a,{id:"findPatientColumnsConfiguration.configureColumns",tagName:"h4"})}),Object(Ae.jsx)("div",{className:"columns",children:s.map((function(e,t){return Object(Ae.jsx)(sc,{column:e,columnIdx:t},"".concat(e.value,"-").concat(t))}))})]}),Object(Ae.jsxs)("div",{className:"mt-5 pb-5",children:[Object(Ae.jsx)("div",{className:"d-inline",children:Object(Ae.jsx)(I.a,{className:"cancel",onClick:O,"data-testid":"returnButton",children:Object(Ae.jsx)(g.a,{id:"common.return"})})}),Object(Ae.jsx)("div",{className:"d-inline pull-right confirm-button-container",children:Object(Ae.jsx)(I.a,{className:"save",onClick:x,"data-testid":"saveButton",children:Object(Ae.jsx)(g.a,{id:"common.save"})})})]})]})]})}))),breadcrumb:"findPatientColumnsConfiguration.title"},{path:"/regimens",component:_r,breadcrumb:"manageRegimens.title"},{path:"/locations/edit-location/:locationId",component:wo,breadcrumb:"locations.location.edit.title"},{path:"/locations/create-location",component:wo,breadcrumb:"locations.location.create.title"},{path:"/user-account",component:cr,breadcrumb:"userAccount.title"},{path:"/conditions/:patientUuid/manage",component:Re,breadcrumb:"manageCondition.title"},{path:"/conditions/:patientUuid",component:Da,breadcrumb:"conditions.title"},{path:"/vmp-config",component:Vi,breadcrumb:"vmpConfig.title"},{path:"/vmp-vaccination-schedule",component:Bi,breadcrumb:"vmpVaccinationSchedule.title"},{path:"/address-data",component:ns,breadcrumb:"addressData.title"},{path:"/vmp-translations",component:vs,breadcrumb:"vmpTranslations.title"},{path:"/notification-configuration",component:$s,breadcrumb:"notificationConfiguration.title"},{path:"/notification-templates",component:xo,breadcrumb:"notificationTemplates.title"},{path:"/find-patient",component:yt,breadcrumb:"findPatient.title",requiredPrivilege:St},{path:"/find-caregiver",component:It,breadcrumb:"findCaregiver.title",requiredPrivilege:Nt},{path:"/register-patient",component:va,breadcrumb:"registerPatient.title",requiredPrivilege:wt},{path:"/edit-patient/:id",component:va,breadcrumb:"editPatient.title",requiredPrivilege:Ct},{path:"/register-caregiver",component:Oa,breadcrumb:"registerCaregiver.title",requiredPrivilege:wt},{path:"/edit-caregiver/:id",component:Oa,breadcrumb:"editCaregiver.title",requiredPrivilege:Ct},{path:"/",component:xa,breadcrumb:"home.title"}],cc=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return Object(Ae.jsx)("span",{className:"separator",children:e&&">>"})},lc=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).routeBreadcrumbs=function(){return e.props.breadcrumbs.map((function(e,t){var n=e.match,a=(e.key,e.breadcrumb),i=a&&a.props&&a.props.children,s={labelId:i,order:t,url:"#".concat(n.url)};return 0===t&&(s.url=j),-1!==i.indexOf(".")?s:null})).filter((function(e){return!!e}))},e}return Object(c.a)(n,[{key:"render",value:function(){var e=this.routeBreadcrumbs(),t=O(this.props.location.search),n=function(e){var t=b.a.parse(e);return t.name&&t.name.toString()}(this.props.location.search);return t&&n&&e.push({url:t,label:n,order:1}),e=e.concat(this.props.additionalBreadcrumbs).sort((function(e,t){return e.order-t.order})),Object(Ae.jsx)("div",{className:"breadcrumbs",children:e.map((function(t,n){var a=t.url,i=t.labelId,s=t.label;return Object(Ae.jsxs)(Ae.Fragment,{children:[n===e.length-1?Object(Ae.jsx)("span",{children:s||Object(Ae.jsx)(g.a,{id:i})}):Object(Ae.jsx)("a",{href:a,children:s||Object(Ae.jsx)(g.a,{id:i})}),cc(n!==e.length-1)]})}))})}}]),n}(i.a.Component),dc=Object(x.connect)((function(e){return{additionalBreadcrumbs:e.breadcrumbs.additionalBreadcrumbs}}),{})(Object(f.a)(rc)(Object(m.withRouter)(lc))),uc=(n(1942),n(103)),pc=function(){return Object(Ae.jsx)(uc.Header,{})},mc=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).state={hasError:!1},e}return Object(c.a)(n,[{key:"render",value:function(){return this.state.hasError?Object(Ae.jsx)("h1",{children:"Something went wrong."}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),n}(i.a.Component),fc=(n(1943),function(){return Object(Ae.jsx)("div",{className:"page-container unauthorized",children:Object(Ae.jsx)("div",{className:"page danger",children:Object(Ae.jsxs)("div",{className:"page-content",children:[Object(Ae.jsx)("span",{className:"toast-item-image toast-item-image-alert"}),Object(Ae.jsx)("div",{className:"message",children:Object(Ae.jsx)("span",{children:"You are not authorized to see this page."})})]})})})}),gc=n(1014),hc=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).renderComponent=function(t){var n=e.props,a=n.authenticated,i=n.privileges,s=n.loading;if(t.requiredPrivilege){if(s)return Object(Ae.jsx)(Ie.a,{});if(!a||!i.includes(t.requiredPrivilege))return Object(Ae.jsx)(fc,{})}var o=t.component;return Object(Ae.jsx)(o,Object(u.a)({},e.props))},e.render=function(){return Object(Ae.jsxs)(p.a,{children:[Object(Ae.jsx)(gc.a,{}),Object(Ae.jsx)(pc,{}),Object(Ae.jsxs)("div",{className:"content",children:[Object(Ae.jsx)(dc,{}),Object(Ae.jsx)(mc,{children:Object(Ae.jsx)(m.Switch,{children:E.a.map(rc,(function(t){return Object(Ae.jsx)(m.Route,{path:t.path,children:e.renderComponent(t)},t.path)}))})})]})]})},e}return n}(i.a.Component),bc=Object(x.connect)((function(e){var t=e.session;return{authenticated:t.authenticated,loading:t.loading,privileges:t.privileges}}),{})(hc),jc="session/GET_SESSION",vc="session/GET_LOGIN_LOCATIONS",Oc="session/SET_LOGIN_LOCATION",xc="session/RESET_SESSION",yc={loading:!1,errorMessage:null,session:null,loginLocations:[],authenticated:!1,privileges:[]},Cc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yc,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N(jc):case N(vc):case N(Oc):return Object(u.a)(Object(u.a)({},e),{},{loading:!0});case w(jc):return Object(u.a)(Object(u.a)({},yc),{},{errorMessage:t.payload.message});case w(vc):case w(Oc):return Object(u.a)(Object(u.a)({},e),{},{errorMessage:t.payload.message});case S(jc):var n=t.payload.data.authenticated;return Object(u.a)(Object(u.a)({},yc),{},{authenticated:n,privileges:n?t.payload.data.user.privileges.map((function(e){return e.name?e.name:e.display})):[],session:t.payload.data});case S(vc):return Object(u.a)(Object(u.a)({},e),{},{loginLocations:t.payload.data,loading:!1,errorMessage:null});case S(Oc):return Object(u.a)(Object(u.a)({},e),{},{loading:!1,errorMessage:null});case xc:return Object(u.a)({},yc);default:return e}},Nc=n(999),Sc=(n(949),n(1963),n(1964),n(1965),function(e,t){var n=wc(e,t);return n&&n.config}),wc=function(e,t){return e&&e.find((function(e){return e.uuid===t}))},Tc="cflui.configureMetadataApps",Pc="settings/GET_APPS",Ac={loading:!1,errorMessage:null,apps:[],findPatientTableColumns:null,findCaregiverTableColumns:null,patientRegistrationSteps:null,caregiverRegistrationSteps:null,vmpSyncScopes:null,vmpAuthSteps:null,vmpDosingVisitTypes:null,vmpRegimenUpdatePermitted:null},Dc=function(e){var t,n,a,i,s,o,r,c;return{apps:e,findPatientTableColumns:null===(t=Sc(e,"cflui.findPatient"))||void 0===t?void 0:t.tableColumns,findCaregiverTableColumns:null===(n=Sc(e,"cflui.findCaregiver"))||void 0===n?void 0:n.tableColumns,patientRegistrationSteps:null===(a=Sc(e,"cflui.registerPatient"))||void 0===a?void 0:a.steps,caregiverRegistrationSteps:null===(i=Sc(e,"cflui.registerCaregiver"))||void 0===i?void 0:i.steps,vmpSyncScopes:null===(s=Sc(e,Tc))||void 0===s?void 0:s.syncScopes,vmpAuthSteps:null===(o=Sc(e,Tc))||void 0===o?void 0:o.authSteps,vmpDosingVisitTypes:null===(r=Sc(e,Tc))||void 0===r?void 0:r.dosingVisitTypes,vmpRegimenUpdatePermitted:null===(c=Sc(e,Tc))||void 0===c?void 0:c.regimenUpdatePermitted}},Mc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ac,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N(Pc):return Object(u.a)(Object(u.a)({},e),{},{loading:!0,errorMessage:null});case w(Pc):return Object(u.a)(Object(u.a)({},e),{},{loading:!1,errorMessage:t.payload.message});case S(Pc):return Object(u.a)(Object(u.a)({},Ac),Dc(t.payload.data.results));default:return e}},Rc=(n(1966),n(152));n(644);Rc.a.configure();var Ec=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.props.getSession(),this.props.getApps()}},{key:"render",value:function(){return Object(Ae.jsxs)("div",{id:"app",className:"app",children:[Object(Ae.jsx)(bc,{}),Object(Ae.jsx)(Nc.TinyButton,{})]})}}]),n}(i.a.Component),Vc={getSession:function(){return{type:jc,payload:C.a.get("/openmrs/ws/rest/v1/appui/session")}},getApps:function(){return{type:Pc,payload:C.a.get("/openmrs/ws/rest/v1/app?v=default")}}},Ic=Object(x.connect)((function(e){return{session:e.session.session}}),Vc)(Ec),Lc=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,2009)).then((function(t){var n=t.getCLS,a=t.getFID,i=t.getFCP,s=t.getLCP,o=t.getTTFB;n(e),a(e),i(e),s(e),o(e)}))},kc=n(133),Fc=n(1e3),Uc=n(1001),Bc=n(2006),qc=n(1002),Wc=n(1003),Gc=n(1004),Hc=n(1011),Yc=Object(kc.c)({cflPatient:Te,cflPerson:sn,cflPeople:Dt,session:Cc,settings:Q,location:Jn,relationshipType:Tn,registration:Xt,apps:Mc,concept:M,condition:oe,breadcrumbs:pe,person:Wc.a,patient:Gc.a,personStatus:Hc.a,role:Xo,user:ar,customizeReducer:qc.a,visit:ki,addressData:Ki,provider:Ss,messages:no,manageRegimens:wr,orderSet:qr,drugs:Hr,orderFrequency:zr,orderType:Jr,findPatientColumnsConfiguration:nc,openmrs:uc.reducers,form:Bc.a}),Qc=n(1009),zc=Object(Qc.a)(),Kc=[Uc.a,Fc.a,zc],Zc=function(e){return Object(kc.d)(kc.a.apply(void 0,Kc.concat(Object(ge.a)(e))))},Jc=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=Object(kc.e)(Yc,e,Zc(t));return zc.run(uc.sagas),n},Xc=n(2007),_c=n(1006),$c=n(1007),el=n.n($c),tl=Jc(),nl=el()(_c);o.a.render(Object(Ae.jsx)(i.a.StrictMode,{children:Object(Ae.jsx)(x.Provider,{store:tl,children:Object(Ae.jsx)(Xc.a,{locale:"en",messages:nl,children:Object(Ae.jsx)(Ic,{})})})}),document.getElementById("root")),Lc()},641:function(e,t,n){},942:function(e,t,n){},960:function(e){e.exports=JSON.parse('[{"label":"Name","title":"Patient Demographics","subtitle":"What\'s the patient\'s name?","fields":[{"name":"givenName","required":true},{"name":"middleName","required":false},{"name":"familyName","required":true}]},{"label":"Gender","title":"Patient Demographics","subtitle":"What\'s the patient\'s gender? (Required)","fields":[{"name":"gender","required":true,"type":"buttons","options":[{"label":"Male","value":"M"},{"label":"Female","value":"F"}]}]},{"label":"Birthdate","title":"Patient Demographics","subtitle":"What\'s the patient\'s birth date? (Required)","fields":[{"name":"birthdate","required":true,"type":"date"},{"label":"Or","type":"separator"},{"name":"birthdateYears","required":false,"type":"number"},{"name":"birthdateMonths","required":false,"type":"number"}]},{"label":"Address","title":"Patient Demographics","subtitle":"What\'s the patient\'s address?","columns":2,"fields":[{"name":"address1","required":false},{"name":"address2","required":false},{"name":"cityVillage","required":false},{"name":"stateProvince","required":false},{"name":"country","required":false},{"name":"postalCode","required":false}]},{"label":"Language","title":"Patient Demographics","subtitle":"What language does the patient prefer?","fields":[{"name":"personLanguage","required":false,"type":"select","options":["English","Marathi","Hindi"]}]},{"label":"Phone Number","title":"Patient Demographics","subtitle":"What\'s the patient\'s phone number?","fields":[{"name":"Telephone Number","required":false,"type":"phone"}]},{"label":"Patient Location","title":"Patient Demographics","subtitle":"What\'s the patient\'s location?","fields":[{"name":"LocationAttribute","label":"Patient Location","required":false,"type":"select","optionSource":"locations"}]},{"label":"Aadhar Number","title":"Patient Demographics","subtitle":"What\'s the patient\'s Aadhar Number?","fields":[{"name":"Aadhar Number","label":"AADHAR Number","required":false,"type":"number"}]},{"label":"ART Number","title":"Patient Demographics","subtitle":"What\'s the patient\'s ART Number?","fields":[{"name":"ART Number","label":"ART Number","required":false,"type":"number"}]},{"label":"Relatives","title":"Patient Demographics","subtitle":"Who is the patient related to?","fields":[{"name":"relatives","required":false,"type":"relatives"}]}]')},961:function(e){e.exports=JSON.parse('[{"label":"Name","title":"Demographics","subtitle":"What\'s the caregiver\'s name?","fields":[{"name":"givenName","required":true},{"name":"middleName","required":false},{"name":"familyName","required":true}]},{"label":"Language","title":"Demographics","subtitle":"What language does the caregiver prefer?","fields":[{"name":"personLanguage","required":false,"type":"select","options":["English","Marathi","Hindi"]}]},{"label":"Phone Number","title":"Demographics","subtitle":"What\'s the caregiver\'s phone number?","fields":[{"name":"Telephone Number","required":false,"type":"phone"}]},{"label":"Person Location","title":"Demographics","subtitle":"What\'s the caregiver\'s location?","fields":[{"name":"LocationAttribute","label":"Person Location","required":false,"type":"select","optionSource":"locations"}]},{"label":"Relatives","title":"Demographics","subtitle":"Who is the caregiver related to?","fields":[{"name":"relatives","required":false,"type":"relatives"}]}]')},97:function(e,t,n){},974:function(e,t){}},[[1968,1,2]]]);
//# sourceMappingURL=main.35d864bd.chunk.js.map